// ==UserScript==
// @name         RealSports Draft Helper
// @namespace    local.realsports.drafthelper
// @version      0.91.03
// @description  RealSports Draft Helper (Svelte + TypeScript)
// @homepageURL  https://github.com/itsreverence/real-helper
// @supportURL   https://github.com/itsreverence/real-helper/issues
// @downloadURL  https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @updateURL    https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @match        https://realsports.io/*
// @run-at       document-idle
// @grant        GM_setClipboard
// @grant        GM_xmlhttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @connect      openrouter.ai
// @connect      realsports.io
// ==/UserScript==

(function(){"use strict";const ai='@import"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&display=swap";:host,#app{font-family:Inter,ui-sans-serif,system-ui,-apple-system,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*,*:before,*:after{box-sizing:border-box}:host{--rsdh-bg: #0D0D12;--rsdh-panel-bg: rgba(18, 18, 26, .95);--rsdh-accent: #00E5FF;--rsdh-accent-green: #7CFF01;--rsdh-accent-red: #FF3D00;--rsdh-text: #F5F5F7;--rsdh-text-muted: #8E8E93;--rsdh-text-dim: #48484A;--rsdh-border: rgba(255, 255, 255, .08);--rsdh-border-accent: rgba(0, 229, 255, .3);--rsdh-glass: rgba(0, 0, 0, .4);--rsdh-ease-out: cubic-bezier(.34, 1.56, .64, 1);--rsdh-transition-fast: .12s ease;--rsdh-transition-base: .24s ease;--rsdh-transition-hero: .4s var(--rsdh-ease-out);--rsdh-shadow-lg: 0 24px 48px -12px rgba(0, 0, 0, .8);--rsdh-glow: 0 0 20px rgba(0, 229, 255, .2)}.texture-overlay{position:absolute;inset:0;pointer-events:none;opacity:.03;background-image:radial-gradient(circle at 2px 2px,white 1px,transparent 0);background-size:24px 24px}.panel{position:fixed;right:12px;top:12px;bottom:12px;width:440px;max-width:calc(100vw - 24px);z-index:2147483647;background:var(--rsdh-panel-bg);backdrop-filter:blur(32px) saturate(180%);-webkit-backdrop-filter:blur(32px) saturate(180%);color:var(--rsdh-text);border:1px solid var(--rsdh-border);border-radius:4px;box-shadow:var(--rsdh-shadow-lg);display:flex;flex-direction:column;overflow:hidden;animation:panelSlideIn var(--rsdh-transition-hero)}@keyframes panelSlideIn{0%{opacity:0;transform:translate(40px)}to{opacity:1;transform:translate(0)}}.header{display:flex;justify-content:space-between;align-items:center;padding:12px 20px;background:linear-gradient(90deg,rgba(0,229,255,.05) 0%,transparent 100%);border-bottom:1px solid var(--rsdh-border);position:relative}.title{font-weight:900;font-size:11px;text-transform:uppercase;letter-spacing:.15em;color:var(--rsdh-accent);display:flex;align-items:center;gap:8px}.title i{color:var(--rsdh-accent-green);font-style:normal}.ticker-container{background:#0000004d;height:32px;border-bottom:1px solid var(--rsdh-border);display:flex;align-items:center;overflow:hidden;font-size:10px;font-weight:700;text-transform:uppercase}.ticker-label{background:var(--rsdh-accent);color:#000;padding:0 12px;height:100%;display:flex;align-items:center;flex-shrink:0}.ticker-content{display:flex;gap:20px;padding-left:20px;white-space:nowrap;animation:tickerScroll 30s linear infinite}@keyframes tickerScroll{0%{transform:translate(0)}to{transform:translate(-50%)}}.tabs{display:flex;padding:0 12px;gap:4px;background:#0003;border-bottom:1px solid var(--rsdh-border)}.tab{padding:14px 16px;background:transparent;border:none;border-bottom:2px solid transparent;color:var(--rsdh-text-muted);font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;cursor:pointer;transition:all var(--rsdh-transition-fast);width:auto;box-shadow:none}.tab:hover{color:var(--rsdh-text);background:#ffffff08;transform:none}.tab.active{color:var(--rsdh-accent);border-bottom-color:var(--rsdh-accent);background:linear-gradient(to top,rgba(0,229,255,.05),transparent)}.view{flex:1;min-height:0;overflow-y:auto;overflow-x:hidden;padding:24px}.view::-webkit-scrollbar{width:4px}.view::-webkit-scrollbar-track{background:transparent}.view::-webkit-scrollbar-thumb{background:var(--rsdh-text-dim);border-radius:2px}.card{background:#ffffff03;border:1px solid var(--rsdh-border);border-left:3px solid var(--rsdh-border);padding:16px;margin-bottom:16px;transition:all var(--rsdh-transition-base);position:relative;overflow:hidden}.card:hover{background:#ffffff08;border-color:var(--rsdh-border-accent);border-left-color:var(--rsdh-accent);transform:translate(4px)}.card:after{content:"";position:absolute;top:0;right:0;width:40px;height:40px;background:linear-gradient(45deg,transparent 50%,rgba(255,255,255,.02) 50%)}.h{font-weight:800;font-size:14px;text-transform:uppercase;letter-spacing:.05em;margin-bottom:12px;display:flex;justify-content:space-between;align-items:center}.sub{font-size:12px;line-height:1.6;color:var(--rsdh-text-muted)}.player-row{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--rsdh-border)}.player-rank{font-family:JetBrains Mono,monospace;font-size:10px;color:var(--rsdh-accent-green);font-weight:700}.player-info{flex:1}.player-name{font-weight:800;font-size:13px;color:#fff}.player-meta{font-size:10px;text-transform:uppercase;letter-spacing:.05em;color:var(--rsdh-text-dim)}.meter-container{height:4px;background:var(--rsdh-text-dim);border-radius:2px;margin-top:8px;overflow:hidden}.meter-fill{height:100%;background:linear-gradient(90deg,var(--rsdh-accent),var(--rsdh-accent-green));transition:width 1s var(--rsdh-ease-out)}button{background:#fff;color:#000;border:none;border-radius:2px;padding:12px 20px;font-weight:900;font-size:11px;text-transform:uppercase;letter-spacing:.1em;cursor:pointer;transition:all var(--rsdh-transition-fast);position:relative;overflow:hidden}button:hover{transform:translateY(-2px);box-shadow:0 4px 12px #fff3}button:active{transform:translateY(0)}button.secondary{background:transparent;color:var(--rsdh-text);border:1px solid var(--rsdh-border)}button.secondary:hover{background:#ffffff0d;border-color:var(--rsdh-text);box-shadow:none}button.accent{background:var(--rsdh-accent);color:#000}input[type=text],input[type=password],select{background:#0000004d;border:1px solid var(--rsdh-border);border-radius:2px;color:var(--rsdh-text);padding:10px 14px;font-size:12px;width:100%;transition:all var(--rsdh-transition-fast)}input:focus,select:focus{outline:none;border-color:var(--rsdh-accent);box-shadow:var(--rsdh-glow)}.status-pill{padding:2px 8px;border-radius:2px;font-size:9px;font-weight:900;text-transform:uppercase}.status-pulsing{animation:rsdh-pulse 2s infinite}@keyframes rsdh-pulse{0%{opacity:1}50%{opacity:.5}to{opacity:1}}.text-accent{color:var(--rsdh-accent)}.text-green{color:var(--rsdh-accent-green)}.text-red{color:var(--rsdh-accent-red)}.font-mono{font-family:JetBrains Mono,monospace}.flex-row{display:flex;align-items:center;gap:8px}.space-between{justify-content:space-between}.mt-12{margin-top:12px}.mb-12{margin-bottom:12px}.fab{border-radius:4px;background:var(--rsdh-bg);border:2px solid var(--rsdh-accent);color:var(--rsdh-accent);width:48px;height:48px;font-weight:900;box-shadow:0 8px 16px #00000080}.fab:hover{background:var(--rsdh-accent);color:#000;box-shadow:var(--rsdh-glow)}.spinner{width:24px;height:24px;border:2px solid var(--rsdh-text-dim);border-top-color:var(--rsdh-accent);border-radius:2px;animation:spin .6s linear infinite}.modal-overlay{background:#000000d9;backdrop-filter:blur(8px)}.modal-content{background:var(--rsdh-panel-bg);border:1px solid var(--rsdh-border);border-top:4px solid var(--rsdh-accent)}.hidden{display:none!important}';typeof window<"u"&&((window.__svelte??={}).v??=new Set).add("5");let Gr=!1,oi=!1;function ii(){Gr=!0}ii();const li=1,ci=2,Js=4,ui=8,di=16,fi=1,pi=2,Te=Symbol(),vi="http://www.w3.org/1999/xhtml",$n=!1;var qn=Array.isArray,hi=Array.prototype.indexOf,hn=Array.from,mi=Object.defineProperty,Yr=Object.getOwnPropertyDescriptor,Ws=Object.getOwnPropertyDescriptors,gi=Object.prototype,_i=Array.prototype,Un=Object.getPrototypeOf,Vs=Object.isExtensible;function yi(e){return e()}function Gn(e){for(var t=0;t<e.length;t++)e[t]()}function Xs(){var e,t,r=new Promise((n,s)=>{e=n,t=s});return{promise:r,resolve:e,reject:t}}const ye=2,Yn=4,mn=8,bi=1<<24,xt=16,wt=32,Zt=64,gn=128,at=512,ke=1024,Me=2048,dt=4096,Ge=8192,Dt=16384,zn=32768,yr=65536,Zs=1<<17,Qs=1<<18,br=1<<19,ea=1<<20,St=1<<25,Qt=32768,Hn=1<<21,jn=1<<22,Ft=1<<23,er=Symbol("$state"),xi=Symbol(""),xr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function wi(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Si(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ei(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ai(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ti(e){throw new Error("https://svelte.dev/e/effect_orphan")}function ki(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ci(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Pi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Oi(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ri(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}function Ni(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Ii(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function ta(e){return e===this.v}function Mi(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ra(e){return!Mi(e,this.v)}let ue=null;function wr(e){ue=e}function na(e,t=!1,r){ue={p:ue,i:!1,c:null,e:null,s:e,x:null,l:Gr&&!t?{s:null,u:null,$:[]}:null}}function sa(e){var t=ue,r=t.e;if(r!==null){t.e=null;for(var n of r)Sa(n)}return t.i=!0,ue=t.p,{}}function zr(){return!Gr||ue!==null&&ue.l===null}let tr=[];function aa(){var e=tr;tr=[],Gn(e)}function Hr(e){if(tr.length===0&&!Kr){var t=tr;queueMicrotask(()=>{t===tr&&aa()})}tr.push(e)}function Li(){for(;tr.length>0;)aa()}function oa(e){var t=W;if(t===null)return U.f|=Ft,e;if((t.f&zn)===0){if((t.f&gn)===0)throw e;t.b.error(e)}else Sr(e,t)}function Sr(e,t){for(;t!==null;){if((t.f&gn)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e}const _n=new Set;let Y=null,jr=null,Xe=null,Ze=[],yn=null,Kn=!1,Kr=!1;class ft{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#l=null;#a=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#r>0}process(t){Ze=[],jr=null,this.apply();var r={parent:null,effect:null,effects:[],render_effects:[]};for(const n of t)this.#o(n,r);this.is_fork||this.#u(),this.is_deferred()?(this.#i(r.effects),this.#i(r.render_effects)):(jr=this,Y=null,la(r.render_effects),la(r.effects),jr=null,this.#l?.resolve()),Xe=null}#o(t,r){t.f^=ke;for(var n=t.first;n!==null;){var s=n.f,a=(s&(wt|Zt))!==0,i=a&&(s&ke)!==0,u=i||(s&Ge)!==0||this.skipped_effects.has(n);if((n.f&gn)!==0&&n.b?.is_pending()&&(r={parent:r,effect:n,effects:[],render_effects:[]}),!u&&n.fn!==null){a?n.f^=ke:(s&Yn)!==0?r.effects.push(n):Qr(n)&&((n.f&xt)!==0&&this.#a.add(n),en(n));var l=n.first;if(l!==null){n=l;continue}}var c=n.parent;for(n=n.next;n===null&&c!==null;)c===r.effect&&(this.#i(r.effects),this.#i(r.render_effects),r=r.parent),n=c.next,c=c.parent}}#i(t){for(const r of t)(r.f&Me)!==0?this.#a.add(r):(r.f&dt)!==0&&this.#s.add(r),this.#c(r.deps),Ce(r,ke)}#c(t){if(t!==null)for(const r of t)(r.f&ye)===0||(r.f&Qt)===0||(r.f^=Qt,this.#c(r.deps))}capture(t,r){this.previous.has(t)||this.previous.set(t,r),(t.f&Ft)===0&&(this.current.set(t,t.v),Xe?.set(t,t.v))}activate(){Y=this,this.apply()}deactivate(){Y===this&&(Y=null,Xe=null)}flush(){if(this.activate(),Ze.length>0){if(ia(),Y!==null&&Y!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#u(){if(this.#r===0){for(const t of this.#e)t();this.#e.clear()}this.#n===0&&this.#d()}#d(){if(_n.size>1){this.previous.clear();var t=Xe,r=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const a of _n){if(a===this){r=!1;continue}const i=[];for(const[l,c]of this.current){if(a.current.has(l))if(r&&c!==a.current.get(l))a.current.set(l,c);else continue;i.push(l)}if(i.length===0)continue;const u=[...a.current.keys()].filter(l=>!this.current.has(l));if(u.length>0){var s=Ze;Ze=[];const l=new Set,c=new Map;for(const d of i)ca(d,u,l,c);if(Ze.length>0){Y=a,a.apply();for(const d of Ze)a.#o(d,n);a.deactivate()}Ze=s}}Y=null,Xe=t}this.committed=!0,_n.delete(this)}increment(t){this.#n+=1,t&&(this.#r+=1)}decrement(t){this.#n-=1,t&&(this.#r-=1),this.revive()}revive(){for(const t of this.#a)this.#s.delete(t),Ce(t,Me),rr(t);for(const t of this.#s)Ce(t,dt),rr(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=Xs()).promise}static ensure(){if(Y===null){const t=Y=new ft;_n.add(Y),Kr||ft.enqueue(()=>{Y===t&&t.flush()})}return Y}static enqueue(t){Hr(t)}apply(){}}function Di(e){var t=Kr;Kr=!0;try{for(var r;;){if(Li(),Ze.length===0&&(Y?.flush(),Ze.length===0))return yn=null,r;ia()}}finally{Kr=t}}function ia(){var e=or;Kn=!0;var t=null;try{var r=0;for(wn(!0);Ze.length>0;){var n=ft.ensure();if(r++>1e3){var s,a;Fi()}n.process(Ze),Bt.clear()}}finally{Kn=!1,wn(e),yn=null}}function Fi(){try{ki()}catch(e){Sr(e,yn)}}let Et=null;function la(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var n=e[r++];if((n.f&(Dt|Ge))===0&&Qr(n)&&(Et=new Set,en(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?ka(n):n.fn=null),Et?.size>0)){Bt.clear();for(const s of Et){if((s.f&(Dt|Ge))!==0)continue;const a=[s];let i=s.parent;for(;i!==null;)Et.has(i)&&(Et.delete(i),a.push(i)),i=i.parent;for(let u=a.length-1;u>=0;u--){const l=a[u];(l.f&(Dt|Ge))===0&&en(l)}}Et.clear()}}Et=null}}function ca(e,t,r,n){if(!r.has(e)&&(r.add(e),e.reactions!==null))for(const s of e.reactions){const a=s.f;(a&ye)!==0?ca(s,t,r,n):(a&(jn|xt))!==0&&(a&Me)===0&&ua(s,t,n)&&(Ce(s,Me),rr(s))}}function ua(e,t,r){const n=r.get(e);if(n!==void 0)return n;if(e.deps!==null)for(const s of e.deps){if(t.includes(s))return!0;if((s.f&ye)!==0&&ua(s,t,r))return r.set(s,!0),!0}return r.set(e,!1),!1}function rr(e){for(var t=yn=e;t.parent!==null;){t=t.parent;var r=t.f;if(Kn&&t===W&&(r&xt)!==0&&(r&Qs)===0)return;if((r&(Zt|wt))!==0){if((r&ke)===0)return;t.f^=ke}}Ze.push(t)}function Bi(e){let t=0,r=nr(0),n;return()=>{Xr()&&(o(r),es(()=>(t===0&&(n=Tr(()=>e(()=>Jr(r)))),t+=1,()=>{Hr(()=>{t-=1,t===0&&(n?.(),n=void 0,Jr(r))})})))}}var $i=yr|br|gn;function qi(e,t,r){new Ui(e,t,r)}class Ui{parent;#e=!1;#t;#n=null;#r;#l;#a;#s=null;#o=null;#i=null;#c=null;#u=null;#d=0;#f=0;#v=!1;#p=null;#y=Bi(()=>(this.#p=nr(this.#d),()=>{this.#p=null}));constructor(t,r,n){this.#t=t,this.#r=r,this.#l=n,this.parent=W.b,this.#e=!!this.#r.pending,this.#a=ts(()=>{W.b=this;{var s=this.#g();try{this.#s=Qe(()=>n(s))}catch(a){this.error(a)}this.#f>0?this.#m():this.#e=!1}return()=>{this.#u?.remove()}},$i)}#b(){try{this.#s=Qe(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#x(){const t=this.#r.pending;t&&(this.#o=Qe(()=>t(this.#t)),ft.enqueue(()=>{var r=this.#g();this.#s=this.#h(()=>(ft.ensure(),Qe(()=>this.#l(r)))),this.#f>0?this.#m():(ar(this.#o,()=>{this.#o=null}),this.#e=!1)}))}#g(){var t=this.#t;return this.#e&&(this.#u=At(),this.#t.before(this.#u),t=this.#u),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#h(t){var r=W,n=U,s=ue;mt(this.#a),De(this.#a),wr(this.#a.ctx);try{return t()}catch(a){return oa(a),null}finally{mt(r),De(n),wr(s)}}#m(){const t=this.#r.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),Oa(this.#s,this.#c)),this.#o===null&&(this.#o=Qe(()=>t(this.#t)))}#_(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(t);return}this.#f+=t,this.#f===0&&(this.#e=!1,this.#o&&ar(this.#o,()=>{this.#o=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#_(t),this.#d+=t,this.#p&&sr(this.#p,this.#d)}get_effect_pending(){return this.#y(),o(this.#p)}error(t){var r=this.#r.onerror;let n=this.#r.failed;if(this.#v||!r&&!n)throw t;this.#s&&(Le(this.#s),this.#s=null),this.#o&&(Le(this.#o),this.#o=null),this.#i&&(Le(this.#i),this.#i=null);var s=!1,a=!1;const i=()=>{if(s){Ii();return}s=!0,a&&Ri(),ft.ensure(),this.#d=0,this.#i!==null&&ar(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#s=this.#h(()=>(this.#v=!1,Qe(()=>this.#l(this.#t)))),this.#f>0?this.#m():this.#e=!1};var u=U;try{De(null),a=!0,r?.(t,i),a=!1}catch(l){Sr(l,this.#a&&this.#a.parent)}finally{De(u)}n&&Hr(()=>{this.#i=this.#h(()=>{ft.ensure(),this.#v=!0;try{return Qe(()=>{n(this.#t,()=>t,()=>i)})}catch(l){return Sr(l,this.#a.parent),null}finally{this.#v=!1}})})}}function Gi(e,t,r,n){const s=zr()?Jn:pt;if(r.length===0&&e.length===0){n(t.map(s));return}var a=Y,i=W,u=Yi();function l(){Promise.all(r.map(c=>zi(c))).then(c=>{u();try{n([...t.map(s),...c])}catch(d){(i.f&Dt)===0&&Sr(d,i)}a?.deactivate(),bn()}).catch(c=>{Sr(c,i)})}e.length>0?Promise.all(e).then(()=>{u();try{return l()}finally{a?.deactivate(),bn()}}):l()}function Yi(){var e=W,t=U,r=ue,n=Y;return function(a=!0){mt(e),De(t),wr(r),a&&n?.activate()}}function bn(){mt(null),De(null),wr(null)}function Jn(e){var t=ye|Me,r=U!==null&&(U.f&ye)!==0?U:null;return W!==null&&(W.f|=br),{ctx:ue,deps:null,effects:null,equals:ta,f:t,fn:e,reactions:null,rv:0,v:Te,wv:0,parent:r??W,ac:null}}function zi(e,t){let r=W;r===null&&Si();var n=r.b,s=void 0,a=nr(Te),i=!U,u=new Map;return tl(()=>{var l=Xs();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{c===Y&&c.committed&&c.deactivate(),bn()})}catch(v){l.reject(v),bn()}var c=Y;if(i){var d=!n.is_pending();n.update_pending_count(1),c.increment(d),u.get(c)?.reject(xr),u.delete(c),u.set(c,l)}const f=(v,m=void 0)=>{if(c.activate(),m)m!==xr&&(a.f|=Ft,sr(a,m));else{(a.f&Ft)!==0&&(a.f^=Ft),sr(a,v);for(const[x,k]of u){if(u.delete(x),x===c)break;k.reject(xr)}}i&&(n.update_pending_count(-1),c.decrement(d))};l.promise.then(f,v=>f(null,v||"unknown"))}),Zn(()=>{for(const l of u.values())l.reject(xr)}),new Promise(l=>{function c(d){function f(){d===s?l(a):c(s)}d.then(f,f)}c(s)})}function pt(e){const t=Jn(e);return t.equals=ra,t}function da(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)Le(t[r])}}function Hi(e){for(var t=e.parent;t!==null;){if((t.f&ye)===0)return(t.f&Dt)===0?t:null;t=t.parent}return null}function Wn(e){var t,r=W;mt(Hi(e));try{e.f&=~Qt,da(e),t=Da(e)}finally{mt(r)}return t}function fa(e){var t=Wn(e);if(e.equals(t)||(Y?.is_fork||(e.v=t),e.wv=Ma()),!Ar)if(Xe!==null)(Xr()||Y?.is_fork)&&Xe.set(e,t);else{var r=(e.f&at)===0?dt:ke;Ce(e,r)}}let Vn=new Set;const Bt=new Map;let pa=!1;function nr(e,t){var r={f:0,v:e,reactions:null,equals:ta,rv:0,wv:0};return r}function $t(e,t){const r=nr(e);return al(r),r}function J(e,t=!1,r=!0){const n=nr(e);return t||(n.equals=ra),Gr&&r&&ue!==null&&ue.l!==null&&(ue.l.s??=[]).push(n),n}function E(e,t,r=!1){U!==null&&(!ht||(U.f&Zs)!==0)&&zr()&&(U.f&(ye|xt|jn|Zs))!==0&&!Tt?.includes(e)&&Oi();let n=r?Wr(t):t;return sr(e,n)}function sr(e,t){if(!e.equals(t)){var r=e.v;Ar?Bt.set(e,t):Bt.set(e,r),e.v=t;var n=ft.ensure();n.capture(e,r),(e.f&ye)!==0&&((e.f&Me)!==0&&Wn(e),Ce(e,(e.f&at)!==0?ke:dt)),e.wv=Ma(),va(e,Me),zr()&&W!==null&&(W.f&ke)!==0&&(W.f&(wt|Zt))===0&&(et===null?ol([e]):et.push(e)),!n.is_fork&&Vn.size>0&&!pa&&ji()}return t}function ji(){pa=!1;var e=or;wn(!0);const t=Array.from(Vn);try{for(const r of t)(r.f&ke)!==0&&Ce(r,dt),Qr(r)&&en(r)}finally{wn(e)}Vn.clear()}function Jr(e){E(e,e.v+1)}function va(e,t){var r=e.reactions;if(r!==null)for(var n=zr(),s=r.length,a=0;a<s;a++){var i=r[a],u=i.f;if(!(!n&&i===W)){var l=(u&Me)===0;if(l&&Ce(i,t),(u&ye)!==0){var c=i;Xe?.delete(c),(u&Qt)===0&&(u&at&&(i.f|=Qt),va(c,dt))}else l&&((u&xt)!==0&&Et!==null&&Et.add(i),rr(i))}}}function Wr(e){if(typeof e!="object"||e===null||er in e)return e;const t=Un(e);if(t!==gi&&t!==_i)return e;var r=new Map,n=qn(e),s=$t(0),a=ir,i=u=>{if(ir===a)return u();var l=U,c=ir;De(null),Ia(a);var d=u();return De(l),Ia(c),d};return n&&r.set("length",$t(e.length)),new Proxy(e,{defineProperty(u,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Ci();var d=r.get(l);return d===void 0?d=i(()=>{var f=$t(c.value);return r.set(l,f),f}):E(d,c.value,!0),!0},deleteProperty(u,l){var c=r.get(l);if(c===void 0){if(l in u){const d=i(()=>$t(Te));r.set(l,d),Jr(s)}}else E(c,Te),Jr(s);return!0},get(u,l,c){if(l===er)return e;var d=r.get(l),f=l in u;if(d===void 0&&(!f||Yr(u,l)?.writable)&&(d=i(()=>{var m=Wr(f?u[l]:Te),x=$t(m);return x}),r.set(l,d)),d!==void 0){var v=o(d);return v===Te?void 0:v}return Reflect.get(u,l,c)},getOwnPropertyDescriptor(u,l){var c=Reflect.getOwnPropertyDescriptor(u,l);if(c&&"value"in c){var d=r.get(l);d&&(c.value=o(d))}else if(c===void 0){var f=r.get(l),v=f?.v;if(f!==void 0&&v!==Te)return{enumerable:!0,configurable:!0,value:v,writable:!0}}return c},has(u,l){if(l===er)return!0;var c=r.get(l),d=c!==void 0&&c.v!==Te||Reflect.has(u,l);if(c!==void 0||W!==null&&(!d||Yr(u,l)?.writable)){c===void 0&&(c=i(()=>{var v=d?Wr(u[l]):Te,m=$t(v);return m}),r.set(l,c));var f=o(c);if(f===Te)return!1}return d},set(u,l,c,d){var f=r.get(l),v=l in u;if(n&&l==="length")for(var m=c;m<f.v;m+=1){var x=r.get(m+"");x!==void 0?E(x,Te):m in u&&(x=i(()=>$t(Te)),r.set(m+"",x))}if(f===void 0)(!v||Yr(u,l)?.writable)&&(f=i(()=>$t(void 0)),E(f,Wr(c)),r.set(l,f));else{v=f.v!==Te;var k=i(()=>Wr(c));E(f,k)}var b=Reflect.getOwnPropertyDescriptor(u,l);if(b?.set&&b.set.call(d,c),!v){if(n&&typeof l=="string"){var P=r.get("length"),D=Number(l);Number.isInteger(D)&&D>=P.v&&E(P,D+1)}Jr(s)}return!0},ownKeys(u){o(s);var l=Reflect.ownKeys(u).filter(f=>{var v=r.get(f);return v===void 0||v.v!==Te});for(var[c,d]of r)d.v!==Te&&!(c in u)&&l.push(c);return l},setPrototypeOf(){Pi()}})}function ha(e){try{if(e!==null&&typeof e=="object"&&er in e)return e[er]}catch{}return e}function Ki(e,t){return Object.is(ha(e),ha(t))}var ma,ga,_a,ya;function Ji(){if(ma===void 0){ma=window,ga=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;_a=Yr(t,"firstChild").get,ya=Yr(t,"nextSibling").get,Vs(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Vs(r)&&(r.__t=void 0)}}function At(e=""){return document.createTextNode(e)}function qt(e){return _a.call(e)}function Vr(e){return ya.call(e)}function p(e,t){return qt(e)}function ee(e,t=!1){{var r=qt(e);return r instanceof Comment&&r.data===""?Vr(r):r}}function h(e,t=1,r=!1){let n=e;for(;t--;)n=Vr(n);return n}function Wi(e){e.textContent=""}function ba(){return!1}let xa=!1;function Vi(){xa||(xa=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function xn(e){var t=U,r=W;De(null),mt(null);try{return e()}finally{De(t),mt(r)}}function Xn(e,t,r,n=r){e.addEventListener(t,()=>xn(r));const s=e.__on_r;s?e.__on_r=()=>{s(),n(!0)}:e.__on_r=()=>n(!0),Vi()}function wa(e){W===null&&(U===null&&Ti(),Ai()),Ar&&Ei()}function Xi(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function vt(e,t,r){var n=W;n!==null&&(n.f&Ge)!==0&&(e|=Ge);var s={ctx:ue,deps:null,nodes:null,f:e|Me|at,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{en(s),s.f|=zn}catch(u){throw Le(s),u}else t!==null&&rr(s);var a=s;if(r&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&br)===0&&(a=a.first,(e&xt)!==0&&(e&yr)!==0&&a!==null&&(a.f|=yr)),a!==null&&(a.parent=n,n!==null&&Xi(a,n),U!==null&&(U.f&ye)!==0&&(e&Zt)===0)){var i=U;(i.effects??=[]).push(a)}return s}function Xr(){return U!==null&&!ht}function Zn(e){const t=vt(mn,null,!1);return Ce(t,ke),t.teardown=e,t}function Qn(e){wa();var t=W.f,r=!U&&(t&wt)!==0&&(t&zn)===0;if(r){var n=ue;(n.e??=[]).push(e)}else return Sa(e)}function Sa(e){return vt(Yn|ea,e,!1)}function Zi(e){return wa(),vt(mn|ea,e,!0)}function Qi(e){ft.ensure();const t=vt(Zt|br,e,!0);return(r={})=>new Promise(n=>{r.outro?ar(t,()=>{Le(t),n(void 0)}):(Le(t),n(void 0))})}function el(e){return vt(Yn,e,!1)}function tl(e){return vt(jn|br,e,!0)}function es(e,t=0){return vt(mn|t,e,!0)}function O(e,t=[],r=[],n=[]){Gi(n,t,r,s=>{vt(mn,()=>e(...s.map(o)),!0)})}function ts(e,t=0){var r=vt(xt|t,e,!0);return r}function Qe(e){return vt(wt|br,e,!0)}function Ea(e){var t=e.teardown;if(t!==null){const r=Ar,n=U;Ra(!0),De(null);try{t.call(null)}finally{Ra(r),De(n)}}}function Aa(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const s=r.ac;s!==null&&xn(()=>{s.abort(xr)});var n=r.next;(r.f&Zt)!==0?r.parent=null:Le(r,t),r=n}}function rl(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&wt)===0&&Le(t),t=r}}function Le(e,t=!0){var r=!1;(t||(e.f&Qs)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Ta(e.nodes.start,e.nodes.end),r=!0),Aa(e,t&&!r),Sn(e,0),Ce(e,Dt);var n=e.nodes&&e.nodes.t;if(n!==null)for(const a of n)a.stop();Ea(e);var s=e.parent;s!==null&&s.first!==null&&ka(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Ta(e,t){for(;e!==null;){var r=e===t?null:Vr(e);e.remove(),e=r}}function ka(e){var t=e.parent,r=e.prev,n=e.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function ar(e,t,r=!0){var n=[];Ca(e,n,!0);var s=()=>{r&&Le(e),t&&t()},a=n.length;if(a>0){var i=()=>--a||s();for(var u of n)u.out(i)}else s()}function Ca(e,t,r){if((e.f&Ge)===0){e.f^=Ge;var n=e.nodes&&e.nodes.t;if(n!==null)for(const u of n)(u.is_global||r)&&t.push(u);for(var s=e.first;s!==null;){var a=s.next,i=(s.f&yr)!==0||(s.f&wt)!==0&&(e.f&xt)!==0;Ca(s,t,i?r:!1),s=a}}}function rs(e){Pa(e,!0)}function Pa(e,t){if((e.f&Ge)!==0){e.f^=Ge,(e.f&ke)===0&&(Ce(e,Me),rr(e));for(var r=e.first;r!==null;){var n=r.next,s=(r.f&yr)!==0||(r.f&wt)!==0;Pa(r,s?t:!1),r=n}var a=e.nodes&&e.nodes.t;if(a!==null)for(const i of a)(i.is_global||t)&&i.in()}}function Oa(e,t){if(e.nodes)for(var r=e.nodes.start,n=e.nodes.end;r!==null;){var s=r===n?null:Vr(r);t.append(r),r=s}}let Er=null;function nl(e){var t=Er;try{if(Er=new Set,Tr(e),t!==null)for(var r of Er)t.add(r);return Er}finally{Er=t}}function sl(e){for(var t of nl(e))sr(t,t.v)}let or=!1;function wn(e){or=e}let Ar=!1;function Ra(e){Ar=e}let U=null,ht=!1;function De(e){U=e}let W=null;function mt(e){W=e}let Tt=null;function al(e){U!==null&&(Tt===null?Tt=[e]:Tt.push(e))}let Ne=null,Ye=0,et=null;function ol(e){et=e}let Na=1,Zr=0,ir=Zr;function Ia(e){ir=e}function Ma(){return++Na}function Qr(e){var t=e.f;if((t&Me)!==0)return!0;if(t&ye&&(e.f&=~Qt),(t&dt)!==0){var r=e.deps;if(r!==null)for(var n=r.length,s=0;s<n;s++){var a=r[s];if(Qr(a)&&fa(a),a.wv>e.wv)return!0}(t&at)!==0&&Xe===null&&Ce(e,ke)}return!1}function La(e,t,r=!0){var n=e.reactions;if(n!==null&&!Tt?.includes(e))for(var s=0;s<n.length;s++){var a=n[s];(a.f&ye)!==0?La(a,t,!1):t===a&&(r?Ce(a,Me):(a.f&ke)!==0&&Ce(a,dt),rr(a))}}function Da(e){var t=Ne,r=Ye,n=et,s=U,a=Tt,i=ue,u=ht,l=ir,c=e.f;Ne=null,Ye=0,et=null,U=(c&(wt|Zt))===0?e:null,Tt=null,wr(e.ctx),ht=!1,ir=++Zr,e.ac!==null&&(xn(()=>{e.ac.abort(xr)}),e.ac=null);try{e.f|=Hn;var d=e.fn,f=d(),v=e.deps;if(Ne!==null){var m;if(Sn(e,Ye),v!==null&&Ye>0)for(v.length=Ye+Ne.length,m=0;m<Ne.length;m++)v[Ye+m]=Ne[m];else e.deps=v=Ne;if(Xr()&&(e.f&at)!==0)for(m=Ye;m<v.length;m++)(v[m].reactions??=[]).push(e)}else v!==null&&Ye<v.length&&(Sn(e,Ye),v.length=Ye);if(zr()&&et!==null&&!ht&&v!==null&&(e.f&(ye|dt|Me))===0)for(m=0;m<et.length;m++)La(et[m],e);return s!==null&&s!==e&&(Zr++,et!==null&&(n===null?n=et:n.push(...et))),(e.f&Ft)!==0&&(e.f^=Ft),f}catch(x){return oa(x)}finally{e.f^=Hn,Ne=t,Ye=r,et=n,U=s,Tt=a,wr(i),ht=u,ir=l}}function il(e,t){let r=t.reactions;if(r!==null){var n=hi.call(r,e);if(n!==-1){var s=r.length-1;s===0?r=t.reactions=null:(r[n]=r[s],r.pop())}}r===null&&(t.f&ye)!==0&&(Ne===null||!Ne.includes(t))&&(Ce(t,dt),(t.f&at)!==0&&(t.f^=at,t.f&=~Qt),da(t),Sn(t,0))}function Sn(e,t){var r=e.deps;if(r!==null)for(var n=t;n<r.length;n++)il(e,r[n])}function en(e){var t=e.f;if((t&Dt)===0){Ce(e,ke);var r=W,n=or;W=e,or=!0;try{(t&(xt|bi))!==0?rl(e):Aa(e),Ea(e);var s=Da(e);e.teardown=typeof s=="function"?s:null,e.wv=Na;var a;$n&&oi&&(e.f&Me)!==0&&e.deps}finally{or=n,W=r}}}async function ll(){await Promise.resolve(),Di()}function o(e){var t=e.f,r=(t&ye)!==0;if(Er?.add(e),U!==null&&!ht){var n=W!==null&&(W.f&Dt)!==0;if(!n&&!Tt?.includes(e)){var s=U.deps;if((U.f&Hn)!==0)e.rv<Zr&&(e.rv=Zr,Ne===null&&s!==null&&s[Ye]===e?Ye++:Ne===null?Ne=[e]:Ne.includes(e)||Ne.push(e));else{(U.deps??=[]).push(e);var a=e.reactions;a===null?e.reactions=[U]:a.includes(U)||a.push(U)}}}if(Ar){if(Bt.has(e))return Bt.get(e);if(r){var i=e,u=i.v;return((i.f&ke)===0&&i.reactions!==null||Ba(i))&&(u=Wn(i)),Bt.set(i,u),u}}else r&&(!Xe?.has(e)||Y?.is_fork&&!Xr())&&(i=e,Qr(i)&&fa(i),or&&Xr()&&(i.f&at)===0&&Fa(i));if(Xe?.has(e))return Xe.get(e);if((e.f&Ft)!==0)throw e.v;return e.v}function Fa(e){if(e.deps!==null){e.f^=at;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&ye)!==0&&(t.f&at)===0&&Fa(t)}}function Ba(e){if(e.v===Te)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Bt.has(t)||(t.f&ye)!==0&&Ba(t))return!0;return!1}function Tr(e){var t=ht;try{return ht=!0,e()}finally{ht=t}}const cl=-7169;function Ce(e,t){e.f=e.f&cl|t}function ul(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(er in e)ns(e);else if(!Array.isArray(e))for(let t in e){const r=e[t];typeof r=="object"&&r&&er in r&&ns(r)}}}function ns(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{ns(e[n],t)}catch{}const r=Un(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=Ws(r);for(let s in n){const a=n[s].get;if(a)try{a.call(e)}catch{}}}}}const dl=new Set,$a=new Set;function fl(e,t,r,n={}){function s(a){if(n.capture||tn.call(t,a),!a.cancelBubble)return xn(()=>r?.call(this,a))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Hr(()=>{t.addEventListener(e,s,n)}):t.addEventListener(e,s,n),s}function fe(e,t,r,n,s){var a={capture:n,passive:s},i=fl(e,t,r,a);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Zn(()=>{t.removeEventListener(e,i,a)})}let qa=null;function tn(e){var t=this,r=t.ownerDocument,n=e.type,s=e.composedPath?.()||[],a=s[0]||e.target;qa=e;var i=0,u=qa===e&&e.__root;if(u){var l=s.indexOf(u);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var c=s.indexOf(t);if(c===-1)return;l<=c&&(i=l)}if(a=s[i]||e.target,a!==t){mi(e,"currentTarget",{configurable:!0,get(){return a||r}});var d=U,f=W;De(null),mt(null);try{for(var v,m=[];a!==null;){var x=a.assignedSlot||a.parentNode||a.host||null;try{var k=a["__"+n];k!=null&&(!a.disabled||e.target===a)&&k.call(a,e)}catch(b){v?m.push(b):v=b}if(e.cancelBubble||x===t||x===null)break;a=x}if(v){for(let b of m)queueMicrotask(()=>{throw b});throw v}}finally{e.__root=t,delete e.currentTarget,De(d),mt(f)}}}function Ua(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function rn(e,t){var r=W;r.nodes===null&&(r.nodes={start:e,end:t,a:null,t:null})}function w(e,t){var r=(t&fi)!==0,n=(t&pi)!==0,s,a=!e.startsWith("<!>");return()=>{s===void 0&&(s=Ua(a?e:"<!>"+e),r||(s=qt(s)));var i=n||ga?document.importNode(s,!0):s.cloneNode(!0);if(r){var u=qt(i),l=i.lastChild;rn(u,l)}else rn(i,i);return i}}function ze(e=""){{var t=At(e+"");return rn(t,t),t}}function ot(){var e=document.createDocumentFragment(),t=document.createComment(""),r=At();return e.append(t,r),rn(t,r),e}function y(e,t){e!==null&&e.before(t)}const pl=["touchstart","touchmove"];function vl(e){return pl.includes(e)}function T(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function hl(e,t){return ml(e,t)}const kr=new Map;function ml(e,{target:t,anchor:r,props:n={},events:s,context:a,intro:i=!0}){Ji();var u=new Set,l=f=>{for(var v=0;v<f.length;v++){var m=f[v];if(!u.has(m)){u.add(m);var x=vl(m);t.addEventListener(m,tn,{passive:x});var k=kr.get(m);k===void 0?(document.addEventListener(m,tn,{passive:x}),kr.set(m,1)):kr.set(m,k+1)}}};l(hn(dl)),$a.add(l);var c=void 0,d=Qi(()=>{var f=r??t.appendChild(At());return qi(f,{pending:()=>{}},v=>{if(a){na({});var m=ue;m.c=a}s&&(n.$$events=s),c=e(v,n)||{},a&&sa()}),()=>{for(var v of u){t.removeEventListener(v,tn);var m=kr.get(v);--m===0?(document.removeEventListener(v,tn),kr.delete(v)):kr.set(v,m)}$a.delete(l),f!==r&&f.parentNode?.removeChild(f)}});return gl.set(c,d),c}let gl=new WeakMap;class _l{anchor;#e=new Map;#t=new Map;#n=new Map;#r=new Set;#l=!0;constructor(t,r=!0){this.anchor=t,this.#l=r}#a=()=>{var t=Y;if(this.#e.has(t)){var r=this.#e.get(t),n=this.#t.get(r);if(n)rs(n),this.#r.delete(r);else{var s=this.#n.get(r);s&&(this.#t.set(r,s.effect),this.#n.delete(r),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),n=s.effect)}for(const[a,i]of this.#e){if(this.#e.delete(a),a===t)break;const u=this.#n.get(i);u&&(Le(u.effect),this.#n.delete(i))}for(const[a,i]of this.#t){if(a===r||this.#r.has(a))continue;const u=()=>{if(Array.from(this.#e.values()).includes(a)){var c=document.createDocumentFragment();Oa(i,c),c.append(At()),this.#n.set(a,{effect:i,fragment:c})}else Le(i);this.#r.delete(a),this.#t.delete(a)};this.#l||!n?(this.#r.add(a),ar(i,u,!1)):u()}}};#s=t=>{this.#e.delete(t);const r=Array.from(this.#e.values());for(const[n,s]of this.#n)r.includes(n)||(Le(s.effect),this.#n.delete(n))};ensure(t,r){var n=Y,s=ba();if(r&&!this.#t.has(t)&&!this.#n.has(t))if(s){var a=document.createDocumentFragment(),i=At();a.append(i),this.#n.set(t,{effect:Qe(()=>r(i)),fragment:a})}else this.#t.set(t,Qe(()=>r(this.anchor)));if(this.#e.set(n,t),s){for(const[u,l]of this.#t)u===t?n.skipped_effects.delete(l):n.skipped_effects.add(l);for(const[u,l]of this.#n)u===t?n.skipped_effects.delete(l.effect):n.skipped_effects.add(l.effect);n.oncommit(this.#a),n.ondiscard(this.#s)}else this.#a()}}function yl(e){ue===null&&wi(),Gr&&ue.l!==null?bl(ue).m.push(e):Qn(()=>{const t=Tr(e);if(typeof t=="function")return t})}function bl(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}function C(e,t,r=!1){var n=new _l(e),s=r?yr:0;function a(i,u){n.ensure(i,u)}ts(()=>{var i=!1;t((u,l=!0)=>{i=!0,a(l,u)}),i||a(!1,null)},s)}function kt(e,t){return t}function xl(e,t,r){for(var n=[],s=t.length,a,i=t.length,u=0;u<s;u++){let f=t[u];ar(f,()=>{if(a){if(a.pending.delete(f),a.done.add(f),a.pending.size===0){var v=e.outrogroups;ss(hn(a.done)),v.delete(a),v.size===0&&(e.outrogroups=null)}}else i-=1},!1)}if(i===0){var l=n.length===0&&r!==null;if(l){var c=r,d=c.parentNode;Wi(d),d.append(c),e.items.clear()}ss(t,!l)}else a={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(a)}function ss(e,t=!0){for(var r=0;r<e.length;r++)Le(e[r],t)}var Ga;function Ct(e,t,r,n,s,a=null){var i=e,u=new Map,l=(t&Js)!==0;if(l){var c=e;i=c.appendChild(At())}var d=null,f=pt(()=>{var P=r();return qn(P)?P:P==null?[]:hn(P)}),v,m=!0;function x(){b.fallback=d,wl(b,v,i,t,n),d!==null&&(v.length===0?(d.f&St)===0?rs(d):(d.f^=St,nn(d,null,i)):ar(d,()=>{d=null}))}var k=ts(()=>{v=o(f);for(var P=v.length,D=new Set,$=Y,z=ba(),te=0;te<P;te+=1){var V=v[te],H=n(V,te),se=m?null:u.get(H);se?(se.v&&sr(se.v,V),se.i&&sr(se.i,te),z&&$.skipped_effects.delete(se.e)):(se=Sl(u,m?i:Ga??=At(),V,H,te,s,t,r),m||(se.e.f|=St),u.set(H,se)),D.add(H)}if(P===0&&a&&!d&&(m?d=Qe(()=>a(i)):(d=Qe(()=>a(Ga??=At())),d.f|=St)),!m)if(z){for(const[M,xe]of u)D.has(M)||$.skipped_effects.add(xe.e);$.oncommit(x),$.ondiscard(()=>{})}else x();o(f)}),b={effect:k,items:u,outrogroups:null,fallback:d};m=!1}function wl(e,t,r,n,s){var a=(n&ui)!==0,i=t.length,u=e.items,l=e.effect.first,c,d=null,f,v=[],m=[],x,k,b,P;if(a)for(P=0;P<i;P+=1)x=t[P],k=s(x,P),b=u.get(k).e,(b.f&St)===0&&(b.nodes?.a?.measure(),(f??=new Set).add(b));for(P=0;P<i;P+=1){if(x=t[P],k=s(x,P),b=u.get(k).e,e.outrogroups!==null)for(const xe of e.outrogroups)xe.pending.delete(b),xe.done.delete(b);if((b.f&St)!==0)if(b.f^=St,b===l)nn(b,null,r);else{var D=d?d.next:l;b===e.effect.last&&(e.effect.last=b.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),Ut(e,d,b),Ut(e,b,D),nn(b,D,r),d=b,v=[],m=[],l=d.next;continue}if((b.f&Ge)!==0&&(rs(b),a&&(b.nodes?.a?.unfix(),(f??=new Set).delete(b))),b!==l){if(c!==void 0&&c.has(b)){if(v.length<m.length){var $=m[0],z;d=$.prev;var te=v[0],V=v[v.length-1];for(z=0;z<v.length;z+=1)nn(v[z],$,r);for(z=0;z<m.length;z+=1)c.delete(m[z]);Ut(e,te.prev,V.next),Ut(e,d,te),Ut(e,V,$),l=$,d=V,P-=1,v=[],m=[]}else c.delete(b),nn(b,l,r),Ut(e,b.prev,b.next),Ut(e,b,d===null?e.effect.first:d.next),Ut(e,d,b),d=b;continue}for(v=[],m=[];l!==null&&l!==b;)(c??=new Set).add(l),m.push(l),l=l.next;if(l===null)continue}(b.f&St)===0&&v.push(b),d=b,l=b.next}if(e.outrogroups!==null){for(const xe of e.outrogroups)xe.pending.size===0&&(ss(hn(xe.done)),e.outrogroups?.delete(xe));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||c!==void 0){var H=[];if(c!==void 0)for(b of c)(b.f&Ge)===0&&H.push(b);for(;l!==null;)(l.f&Ge)===0&&l!==e.fallback&&H.push(l),l=l.next;var se=H.length;if(se>0){var M=(n&Js)!==0&&i===0?r:null;if(a){for(P=0;P<se;P+=1)H[P].nodes?.a?.measure();for(P=0;P<se;P+=1)H[P].nodes?.a?.fix()}xl(e,H,M)}}a&&Hr(()=>{if(f!==void 0)for(b of f)b.nodes?.a?.apply()})}function Sl(e,t,r,n,s,a,i,u){var l=(i&li)!==0?(i&di)===0?J(r,!1,!1):nr(r):null,c=(i&ci)!==0?nr(s):null;return{v:l,i:c,e:Qe(()=>(a(t,l??r,c??s,u),()=>{e.delete(n)}))}}function nn(e,t,r){if(e.nodes)for(var n=e.nodes.start,s=e.nodes.end,a=t&&(t.f&St)===0?t.nodes.start:r;n!==null;){var i=Vr(n);if(a.before(n),n===s)return;n=i}}function Ut(e,t,r){t===null?e.effect.first=r:t.next=r,r===null?e.effect.last=t:r.prev=t}function Ya(e,t,r=!1,n=!1,s=!1){var a=e,i="";O(()=>{var u=W;if(i!==(i=t()??"")&&(u.nodes!==null&&(Ta(u.nodes.start,u.nodes.end),u.nodes=null),i!=="")){var l=i+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var c=Ua(l);if((r||n)&&(c=qt(c)),rn(qt(c),c.lastChild),r||n)for(;qt(c);)a.before(qt(c));else a.before(c)}})}function El(e,t,r){var n=e==null?"":""+e;return n===""?null:n}function Al(e,t){return e==null?null:String(e)}function tt(e,t,r,n,s,a){var i=e.__className;if(i!==r||i===void 0){var u=El(r);u==null?e.removeAttribute("class"):e.className=u,e.__className=r}return a}function Pt(e,t,r,n){var s=e.__style;if(s!==t){var a=Al(t);a==null?e.removeAttribute("style"):e.style.cssText=a,e.__style=t}return n}function za(e,t,r=!1){if(e.multiple){if(t==null)return;if(!qn(t))return Ni();for(var n of e.options)n.selected=t.includes(sn(n));return}for(n of e.options){var s=sn(n);if(Ki(s,t)){n.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function Tl(e){var t=new MutationObserver(()=>{za(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Zn(()=>{t.disconnect()})}function kl(e,t,r=t){var n=new WeakSet,s=!0;Xn(e,"change",a=>{var i=a?"[selected]":":checked",u;if(e.multiple)u=[].map.call(e.querySelectorAll(i),sn);else{var l=e.querySelector(i)??e.querySelector("option:not([disabled])");u=l&&sn(l)}r(u),Y!==null&&n.add(Y)}),el(()=>{var a=t();if(e===document.activeElement){var i=jr??Y;if(n.has(i))return}if(za(e,a,s),s&&a===void 0){var u=e.querySelector(":checked");u!==null&&(a=sn(u),r(a))}e.__value=a,s=!1}),Tl(e)}function sn(e){return"__value"in e?e.__value:e.value}const Cl=Symbol("is custom element"),Pl=Symbol("is html");function it(e,t){var r=as(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function Ol(e,t){var r=as(e);r.checked!==(r.checked=t??void 0)&&(e.checked=t)}function Ha(e,t,r,n){var s=as(e);s[t]!==(s[t]=r)&&(t==="loading"&&(e[xi]=r),r==null?e.removeAttribute(t):typeof r!="string"&&Rl(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function as(e){return e.__attributes??={[Cl]:e.nodeName.includes("-"),[Pl]:e.namespaceURI===vi}}var ja=new Map;function Rl(e){var t=e.getAttribute("is")||e.nodeName,r=ja.get(t);if(r)return r;ja.set(t,r=[]);for(var n,s=e,a=Element.prototype;a!==s;){n=Ws(s);for(var i in n)n[i].set&&r.push(i);s=Un(s)}return r}function Ka(e,t,r=t){var n=new WeakSet;Xn(e,"input",async s=>{var a=s?e.defaultValue:e.value;if(a=os(e)?is(a):a,r(a),Y!==null&&n.add(Y),await ll(),a!==(a=t())){var i=e.selectionStart,u=e.selectionEnd,l=e.value.length;if(e.value=a??"",u!==null){var c=e.value.length;i===u&&u===l&&c>l?(e.selectionStart=c,e.selectionEnd=c):(e.selectionStart=i,e.selectionEnd=Math.min(u,c))}}}),Tr(t)==null&&e.value&&(r(os(e)?is(e.value):e.value),Y!==null&&n.add(Y)),es(()=>{var s=t();if(e===document.activeElement){var a=jr??Y;if(n.has(a))return}os(e)&&s===is(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function Cr(e,t,r=t){Xn(e,"change",n=>{var s=n?e.defaultChecked:e.checked;r(s)}),Tr(t)==null&&r(e.checked),es(()=>{var n=t();e.checked=!!n})}function os(e){var t=e.type;return t==="number"||t==="range"}function is(e){return e===""?null:+e}function Nl(e=!1){const t=ue,r=t.l.u;if(!r)return;let n=()=>ul(t.s);if(e){let s=0,a={};const i=Jn(()=>{let u=!1;const l=t.s;for(const c in l)l[c]!==a[c]&&(a[c]=l[c],u=!0);return u&&s++,s});n=()=>o(i)}r.b.length&&Zi(()=>{Ja(t,n),Gn(r.b)}),Qn(()=>{const s=Tr(()=>r.m.map(yi));return()=>{for(const a of s)typeof a=="function"&&a()}}),r.a.length&&Qn(()=>{Ja(t,n),Gn(r.a)})}function Ja(e,t){if(e.l.s)for(const r of e.l.s)o(r);t()}function rt(e,t=document){return Array.from(t.querySelectorAll(e))}function ne(e){const t=e;return String(t&&(t.innerText||t.textContent)||"").trim()}const Il=["Select 5 players","Press two player","Press two players","to swap"],Wa=/(\d+(?:\.\d+)?)x\b/gi,Ml=/^\+(\d+(?:\.\d+)?)x\b/i,Ll=200,Va=["NFL","NHL","NBA","MLB","CFB","CBB","FC","WNBA"],Xa="rsdh_accent_rgb",ls="rsdh_openrouter_api_key",cs="rsdh_openrouter_model",us="rsdh_openrouter_temp",ds="rsdh_openrouter_max_tokens",fs="rsdh_openrouter_web_max_results",En="rsdh_openrouter_structured_json",An="rsdh_openrouter_response_healing",lr="google/gemini-2.5-flash",Tn=.2,kn=1e3,an=2,Dl=!0,Fl=!0,Bl="https://openrouter.ai/api/v1/chat/completions",Cn="https://rsdh-proxy.cloudflare-okay454.workers.dev",$l="H8UIBeO5C9BJ8Ze8WUXb+Y+x4wuNp2K+Lz+HwVdanBk=",on=!!Cn,Za="rsdh_last_payload",ps="rsdh_last_ai_sources",ql="rsdh_last_ai_json",Qa="rsdh_last_tool_trace",Pn="rsdh_last_debug_events",Ul="rsdh_last_messages",ln="rsdh_force_tool_call",cn="rsdh_force_search_tool",cr="rsdh_bypass_proxy",un="rsdh_enable_profile_tool",vs="rsdh_enable_web_search",dn="rsdh_enable_search_tool",hs="rsdh_lineup_strategy";function I(e,t){try{if(typeof GM_getValue=="function")return GM_getValue(e,t)}catch{}try{const r=localStorage.getItem(e);return r??t}catch{return t}}function Fe(e,t){try{if(typeof GM_setValue=="function"){GM_setValue(e,t);return}}catch{}try{localStorage.setItem(e,String(t))}catch{}}function ur(){try{return localStorage.getItem("rsdh_debug_mode")==="1"}catch{return!1}}function Gl(e){try{localStorage.setItem("rsdh_debug_mode",e?"1":"0")}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-debug-mode",{detail:{on:e}}))}catch{}}function Pr(e){const r=String(e||"").match(/rgba?\(\s*(\d+)[,\s]+(\d+)[,\s]+(\d+)/i);return r?{r:parseInt(r[1],10),g:parseInt(r[2],10),b:parseInt(r[3],10)}:null}function Yl(e){return(.2126*e.r+.7152*e.g+.0722*e.b)/255}function ms(e,t){const r=e.r-t.r,n=e.g-t.g,s=e.b-t.b;return Math.sqrt(r*r+n*n+s*s)}function zl(e){const t=Math.max(e.r,e.g,e.b),r=Math.min(e.r,e.g,e.b);return(t-r)/255}function eo(e){const t=String(e||"").toLowerCase();return t==="transparent"||t.includes("rgba(")&&t.endsWith(", 0)")||t.includes(",0)")}function Hl(){const e=Math.max(240,window.innerHeight*.6),t=rt("div,nav,aside").map(r=>{try{const n=r.getBoundingClientRect();return n.width<40||n.width>95||n.height<e||n.left>40||n.top>80?null:{el:r,area:n.width*n.height}}catch{return null}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function jl(){function e(){try{const i=localStorage.getItem(Xa);if(!i)return null;const u=JSON.parse(i);return!u||typeof u.r!="number"||typeof u.g!="number"||typeof u.b!="number"?null:{r:u.r,g:u.g,b:u.b}}catch{return null}}function t(i){try{localStorage.setItem(Xa,JSON.stringify(i))}catch{}}const r=Hl()||document,n=r===document?null:(()=>{try{const i=r.getBoundingClientRect();return{top:i.top,height:i.height}}catch{return null}})(),s=rt("div,button,a,span",r).map(i=>{try{const u=i.getBoundingClientRect();if(u.width<16||u.width>80||u.height<16||u.height>80||u.width/u.height<.7||u.width/u.height>1.3)return null;const l=getComputedStyle(i),c=parseFloat(l.borderWidth||"0"),d=parseFloat(l.outlineWidth||"0");if((Number.isNaN(c)||c<=0)&&(Number.isNaN(d)||d<=0))return null;const f=Pr(l.borderColor)||Pr(l.outlineColor);if(!f)return null;const v=zl(f);if(v<.1)return null;let m=1;n&&(m=(u.top-n.top)/Math.max(1,n.height)>.4?1.4:.8);const x=Math.min(u.width,u.height)>=20?1.1:1,k=(v*3+(c>=2?.2:0))*m*x;return{rgb:f,score:k}}catch{return null}}).filter(Boolean);if(s.length===0){const i=e();return i?{rgb:i,source:"cache",scope:r===document?"document":"sidebar"}:null}s.sort((i,u)=>u.score-i.score);const a=s[0];return t(a.rgb),{rgb:a.rgb,source:"borderColor",scope:r===document?"document":"sidebar"}}function to(){const t=rt("div,nav,header").filter(c=>{const d=ne(c);return d?Va.filter(v=>d.includes(v)).length>=4:!1})[0]||null;if(!t)return{sport:null,method:"not_found"};const r=Va.filter(c=>ne(t).includes(c)),n=rt("a,button,[role='tab'],[role='button'],div,span",t).map(c=>({el:c,t:ne(c)})).filter(c=>r.includes(c.t));function s(c){const d=c.getAttribute("aria-selected"),f=c.getAttribute("aria-current");if(d==="true"||f&&f!=="false"||c.getAttribute("data-active")==="true"||c.getAttribute("data-state")==="active")return!0;const v=(c.className||"").toString().toLowerCase();return!!(v.includes("active")||v.includes("selected")||v.includes("current"))}const a=n.find(c=>s(c.el));if(a)return{sport:String(a.t),method:"navbar_active_attr"};const i=jl();if(i?.rgb&&n.length>0){const c=n.map(d=>{let f=1/0;try{const v=getComputedStyle(d.el),m=Pr(v.color),x=Pr(v.borderBottomColor),k=Pr(v.borderColor);m&&(f=Math.min(f,ms(i.rgb,m))),x&&!eo(v.borderBottomColor)&&(f=Math.min(f,ms(i.rgb,x))),k&&!eo(v.borderColor)&&(f=Math.min(f,ms(i.rgb,k)))}catch{}return{sport:String(d.t),dist:f}}).sort((d,f)=>d.dist-f.dist);if(c.length>0&&c[0].dist<60)return{sport:c[0].sport,method:"navbar_theme_accent",accent:i}}if(n.length>0){const c=n.map(d=>{let f=0;try{const v=getComputedStyle(d.el),m=parseInt(v.fontWeight,10);!Number.isNaN(m)&&m>=600&&(f+=2);const x=parseFloat(v.opacity);!Number.isNaN(x)&&x>=.95&&(f+=1),(v.textDecorationLine||"").includes("underline")&&(f+=2);const k=parseFloat(v.borderBottomWidth);!Number.isNaN(k)&&k>0&&(v.borderBottomStyle||"")!=="none"&&(f+=2);const b=Pr(v.color);b&&(f+=Yl(b))}catch{}return{sport:String(d.t),score:f}}).sort((d,f)=>f.score-d.score);if(c.length===1)return{sport:c[0].sport,method:"navbar_style_single"};if(c.length>=2&&c[0].score-c[1].score>=1)return{sport:c[0].sport,method:"navbar_style_score"}}const u=location.href.toUpperCase(),l=r.find(c=>u.includes("/"+c+"/")||u.endsWith("/"+c)||u.includes("SPORT="+c));return l?{sport:String(l),method:"url_hint"}:{sport:null,method:"navbar_no_active"}}function Kl(){const e=[],t=rt('div[tabindex="0"]').filter(r=>{const n=(r.textContent||"").trim();if(!n||/\+\d+\.?\d*x/i.test(n))return!1;const s=/\d{1,2}:\d{2}\s*(AM|PM)/i.test(n),a=/\bFinal\b/i.test(n);return s||a});for(const r of t)try{const n=Array.from(r.querySelectorAll('div[dir="auto"]')),s=ne(r),a=/\bFinal\b/i.test(s),i=/\d{1,2}:\d{2}\s*(AM|PM)/i.test(s);let u="",l="",c=null,d=null,f=null,v=null;const m=/^\d{1,2}-\d{1,2}(-\d{1,2})?$/,x=/^\d{1,2}$/,k=/^(\d{1,2}|:|AM|PM|\d{2}\s*(AM|PM)|Final)$/i,b=[],P=[],D=[],$=[];for(const te of n){const V=(te.textContent||"").trim();V&&(m.test(V)?$.push(V):x.test(V)&&a?P.push(V):k.test(V)?b.push(V):V.length>2&&V.length<25&&!V.includes("%")&&/^[A-Za-z\s]+$/.test(V)&&D.push(V))}D.length>=2?(u=D[0],l=D[1]):D.length===1&&(u=D[0]),a&&P.length>=2?f=`${P[0]}-${P[1]}`:$.length>=2?(c=$[0],d=$[1]):$.length===1&&(c=$[0]),b.length>0&&!a&&(v=b.join("").replace(/\s+/g," ").trim(),v||(v=b.filter(te=>te!==":").join(":").replace("::",":")),v=v.replace(/\d+$/,"").trim());let z="upcoming";a?z="finished":v&&(z="upcoming"),u&&l&&e.push({team1:u,team1_record:c,team2:l,team2_record:d,time:v,status:z,score:f})}catch{}return e}function Jl(){const e=/^(\d+)\s+(NFL|NHL|NBA|MLB|CFB|CBB|FC|WNBA)\s+entr(?:y|ies)\s+remaining\s+today$/i,t=rt("div");for(const r of t){const s=(r.textContent||"").trim().match(e);if(s)return{isGameDraft:!0,entriesRemaining:parseInt(s[1],10),sport:s[2].toUpperCase()}}return{isGameDraft:!1,entriesRemaining:null,sport:null}}function Wl(){const e=new Set(["games","game","nfl","nba","nhl","mlb","cfb","cbb","wnba","fc","ufc","golf","final","live","upcoming","finished","draft","update","submit","cancel","close","settings","home","profile","menu","pm","am"]),t=rt("div").filter(P=>{const D=P.getAttribute("style")||"",$=D.includes("background-color: rgb(0, 0, 0)")||D.includes("background-color:rgb(0,0,0)"),z=D.includes("border-bottom")||D.includes("border-color");if(!$||!z||Array.from(P.querySelectorAll('div[tabindex="0"]')).filter(H=>{const se=H.querySelectorAll("img");return Array.from(se).some(M=>(M.getAttribute("src")||"").includes("media.realapp.com/assets/teams"))}).length!==2)return!1;const V=(P.textContent||"").trim();return!/\+\d+\.?\d*x/i.test(V)});if(t.length===0)return null;const r=t[0],n=Array.from(r.querySelectorAll('div[tabindex="0"]')).filter(P=>{const D=P.querySelectorAll("img");return Array.from(D).some($=>($.getAttribute("src")||"").includes("media.realapp.com/assets/teams"))}).slice(0,2),s=/^\d{1,2}-\d{1,2}(-\d{1,2})?$/,a=/^\d{1,3}$/;function i(P){const D=Array.from(P.querySelectorAll('div[dir="auto"]'));let $="",z=null,te=null;for(const V of D){const H=(V.textContent||"").trim();if(!H)continue;const se=H.toLowerCase();e.has(se)||(s.test(H)?z=H:a.test(H)?te=parseInt(H,10):H.length>=3&&H.length<=25&&/^[A-Za-z]+$/.test(H)&&($=H))}return{name:$,record:z,score:te}}const u=n.length>=1?i(n[0]):{name:"",record:null,score:null},l=n.length>=2?i(n[1]):{name:"",record:null,score:null};if(!u.name&&!l.name)return null;let c=null,d=null,f=!1;const m=(r.textContent||"").match(/\d{1,2}:\d{2}\s*(AM|PM)/i);m&&(c=m[0]);const x=new Set(n.flatMap(P=>Array.from(P.querySelectorAll('div[dir="auto"]')))),k=Array.from(r.querySelectorAll('div[dir="auto"]'));for(const P of k){if(x.has(P))continue;const D=(P.textContent||"").trim();D.toLowerCase()==="final"?f=!0:/^[A-Z]{2,4}\s+by\s+\d+(\.\d+)?$/i.test(D)&&(d=D)}let b="upcoming";return f||u.score!==null&&l.score!==null?b="finished":c&&(b="upcoming"),{team1:u.name,team1_record:u.record,team1_score:u.score,team2:l.name,team2_record:l.record,team2_score:l.score,time:c,spread:d,status:b}}function dr(){const e=document.querySelector("#rsdh-modal-actions");if(e){let r=e;for(let n=0;n<18&&r;n++){if((ne(r).match(/\d+(?:\.\d+)?x\b/gi)||[]).length>=3)return r;r=r.parentElement}return e.parentElement}const t=rt('div[tabindex="0"]');for(const r of t){const n=ne(r);if(!n)continue;const s=/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n),a=(n.match(/\d+(?:\.\d+)?x\b/gi)||[]).length;if(s&&a>=3)return r}for(const r of t){const n=ne(r);if(n&&/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n))return r}return null}function Vl(e,t=[]){let r=-1;for(const n of t){const s=e.indexOf(n);s!==-1&&(r===-1||s<r)&&(r=s)}return r===-1?e:e.slice(0,r)}function Xl(e,t=[]){let r=-1;for(const s of t){const a=e.indexOf(s);a!==-1&&(r===-1||a<r)&&(r=a)}if(r===-1)return"";const n=e.indexOf(`
`,r);return n===-1?"":e.slice(n+1)}function ro(e,t=[],r=null){e=Vl(e,t);const n=[];Wa.lastIndex=0;let s;for(;(s=Wa.exec(e))!==null;)s.index>0&&e[s.index-1]==="+"||n.push({idx:s.index,end:s.index+s[0].length,mult:parseFloat(s[1])});const a=[];for(let i=0;i<n.length&&!(typeof r=="number"&&a.length>=r);i++){const u=n[i],l=n[i+1];let c=e.slice(u.end,l?l.idx:e.length).trim();for(const v of t){const m=c.indexOf(v);m!==-1&&(c=c.slice(0,m).trim())}c=c.split(`
`)[0].trim(),c.length>80&&(c=c.slice(0,80).trim());let d=c||null,f=!1;d&&d.toLowerCase()==="empty"&&(d=null,f=!0),a.push({multiplier:u.mult,selection:d,is_empty:f})}return a}function Zl(e){const t=Xl(e,["Press two player","Press two players"]);if(!t)return[];const r=t.split(`
`).map(i=>(i||"").trim()).filter(Boolean),n=[];let s=null;function a(){s&&(s.name&&!/%$/.test(s.name.trim())&&n.push(s),s=null)}for(const i of r){if(/^(submit|update|cancel|close|done)$/i.test(i)){a();break}if(/^(draft lineup)$/i.test(i)||/^\d+%$/.test(i))continue;const u=i.match(Ml);if(u){const f=parseFloat(u[1]);s?s.boost_x=f:n.length>0&&n[n.length-1].boost_x==null&&(n[n.length-1].boost_x=f),s&&a();continue}const l=i.split("").map(f=>f.trim()).filter(Boolean),c=l[0]||i,d=l.length>1?l.slice(1).join("  "):null;s&&a(),s={name:c,status:d,boost_x:null}}return a(),n}function no(e){const t=/\+(\d+(?:\.\d+)?)x\b/i,r=rt("div[tabindex='0'],div[tabindex='-1'],[role='button'],button,a",e).filter(a=>{const i=ne(a);if(!i)return!1;const u=a.getBoundingClientRect();return u.width>120&&u.height>=28?t.test(i)?!0:!(a.querySelector("img")!==null)||i.includes("Submit")||i.includes("Update")||i.includes("Draft")?!1:/[a-zA-Z]{2,}/.test(i)&&i.length<100:!1}).slice(0,400),n=new Set,s=[];for(const a of r){const i=ne(a),u=i.match(t);let l=null;u&&(l=parseFloat(u[1]),Number.isFinite(l)||(l=null));const d=(u?i.slice(0,i.toLowerCase().lastIndexOf(u[0].toLowerCase())).trim():i.trim()).split("").map(P=>P.trim()).filter(Boolean),f=d[0]||"";if(!f)continue;const v=d.length>1?d.slice(1).join("  "):null,m=f.toLowerCase();if(n.has(m))continue;let x=null;const k=a.querySelector("a[href]")||a.parentElement?.querySelector("a[href]")||a.closest("a[href]");if(k?.getAttribute("href")&&(x=k.getAttribute("href")),!x){const P=a.querySelector("svg")||a.parentElement?.querySelector("svg"),D=P?P.closest("a[href]"):null;D?.getAttribute("href")&&(x=D.getAttribute("href"))}const b=x?new URL(x,location.href).toString():null;s.push({name:f,status:v,boost_x:l,profile_url:b}),n.add(m)}return s}function Ql(){const e=rt("div,button").filter(n=>{const s=ne(n);return s.includes("Draft")&&/\bUpdate\b/i.test(s)&&/\bx\b/i.test(s)}),t=new Set,r=[];for(const n of e){const s=ne(n);!s||t.has(s)||(t.add(s),r.push(n))}return r.slice(0,10)}function ec(){function e(n){try{n.scrollIntoView({block:"center",inline:"center"})}catch{}try{n.focus()}catch{}let s=0,a=0;try{const i=n.getBoundingClientRect();s=Math.max(1,Math.floor(i.left+i.width/2)),a=Math.max(1,Math.floor(i.top+i.height/2))}catch{}try{const i=window.PointerEvent;typeof i=="function"&&(n.dispatchEvent(new i("pointerdown",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:s,clientY:a})),n.dispatchEvent(new i("pointerup",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:s,clientY:a})))}catch{}try{n.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:a}))}catch{}try{n.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:a}))}catch{}try{n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:a}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.click()}catch{}}const t=document.querySelector("#realrootcontents")||document,r=rt("div[tabindex='0'],button,[role='button'],a,span",t).map(n=>{const s=ne(n);if(!s||!/^(draft|update)$/i.test(s.trim()))return null;const a=n.getBoundingClientRect();if(!(a.width>=60&&a.width<=500&&a.height>=20&&a.height<=80))return null;const i=a.top>=0&&a.top<=window.innerHeight?1.5:1,u=a.width*i;return{el:n,score:u,text:s.trim()}}).filter(Boolean);return r.length===0?!1:(r.sort((n,s)=>s.score-n.score),e(r[0].el),!0)}async function tc(e){const t=e.timeoutMs,r=Date.now();function n(){return document.querySelector("#rsdh-modal-actions")?!0:!!dr()}function s(){const u=document.querySelector("#realrootcontents")||document,l=rt("div[tabindex='0'],button,[role='button'],a,span",u).map(c=>{const d=ne(c);if(!d||!/^(draft|update)$/i.test(d.trim()))return null;const f=c.getBoundingClientRect();return f.width>=60&&f.width<=500&&f.height>=20&&f.height<=80?{el:c,width:f.width}:null}).filter(Boolean);return l.length===0?null:(l.sort((c,d)=>d.width-c.width),l[0].el)}function a(u){try{const l=u.getBoundingClientRect(),c=Math.floor(l.left+l.width/2),d=Math.floor(l.top+l.height/2),f=document.elementFromPoint(c,d);return f===u||!!f&&u.contains(f)}catch{return!0}}for(;Date.now()-r<t;){if(n())return{clicked:!1,opened:!0};const u=s();if(u&&a(u))break;await new Promise(l=>setTimeout(l,200))}let i=!1;for(let u=0;u<3&&Date.now()-r<t;u++){if(n())return{clicked:i,opened:!0};const l=s();if(!l){await new Promise(d=>setTimeout(d,250));continue}try{i=ec()||i}catch{}if(!n()){const d=l.parentElement;if(d){try{d.scrollIntoView({block:"center"})}catch{}try{d.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0}))}catch{}}}if(await new Promise(d=>{const f=Date.now()+2200,v=()=>{if(n())return d(!0);if(Date.now()>f)return d(!1);setTimeout(v,100)};v()}))return{clicked:i,opened:!0};await new Promise(d=>setTimeout(d,350))}return{clicked:i,opened:n()}}function rc(e){const t=ne(e),r=["Update",...Il],n=ro(t,r);return{text:t.slice(0,500),slots:n}}function nc(e={}){const t=typeof e.includeDebug=="boolean"?e.includeDebug:ur(),r=to(),n=dr();if(!n){const k=Ql().map(rc).filter(b=>b.slots.length>0);return k.length===0?{ok:!1,error:"Draft modal not found. Click the site's Draft/Update button to open the Draft Lineup modal, then click Capture again.",url:location.href,sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{}}:{ok:!0,mode:"tile",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{},drafts:k}}const s=ne(n),a=s.match(/Select\s+(\d+)\s+players/i),i=a?parseInt(a[1],10):null,l=ro(s,["Press two player","Press two players"],i),c=no(n),d=c.length>0?c:Zl(s),f=Jl(),v=f.isGameDraft?"game":"league";let m=[],x;return f.isGameDraft?x=Wl()??void 0:m=Kl(),{ok:!0,mode:"modal",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,draft_type:v,...f.isGameDraft?{game_entries_remaining:f.entriesRemaining}:{},...x?{game_matchup:x}:{},...t?{sport_detection:r}:{},...t?{modal_text_sample:s.slice(0,400)}:{},expected_slots:i,slots:l,player_pool_count:d.length,player_pool:d,...m.length>0?{games:m}:{}}}function so(e){let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]);const r=(t||[]).map((m,x)=>{const k=m.selection?`selected="${m.selection}"`:"selected=<empty>";return`- slot ${x+1}: multiplier=${m.multiplier}x, ${k}`}).join(`
`),n=Array.isArray(e?.player_pool)?e.player_pool:[],s=n.slice(0,Ll),a=s.map(m=>{const x=m.status?` (${m.status})`:"",k=typeof m.boost_x=="number"?` +${m.boost_x}x`:"";return`- ${m.name}${x}${k}`}).join(`
`),i=n.length>s.length?`NOTE: player pool truncated to first ${s.length} of ${n.length} for prompt size. For the full list, re-capture and inspect the payload in Debug Mode.`:`Player pool items: ${n.length}.`,u=typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:Array.isArray(t)?t.length:5,l=e?.draft_type||"league",c=e?.game_matchup,d=Array.isArray(e?.games)?e.games:[];let f=[];if(l==="game"&&c){const m=c.team1+(c.team1_record?` (${c.team1_record})`:""),x=c.team2+(c.team2_record?` (${c.team2_record})`:"");let k="";c.status==="finished"&&c.team1_score!==null&&c.team2_score!==null?k=`Final: ${c.team1} ${c.team1_score} - ${c.team2} ${c.team2_score}`:c.time?k=`Game time: ${c.time}`:c.status==="live"&&(k="Game in progress"),f=["### Game Draft (Single Matchup)","This is a GAME DRAFT for a specific matchup, not a league-wide draft.",`Matchup: ${m} vs ${x}`,...k?[k]:[],...c.spread?[`Spread: ${c.spread}`]:[],...typeof e?.game_entries_remaining=="number"?[`Entries remaining today: ${e.game_entries_remaining}`]:[],"All players in the pool are from these two teams ONLY.",""]}else d.length>0&&(f=["### Today's Games","The following games are scheduled. Players from these teams will be playing:",d.map(x=>{let k="";return x.status==="finished"&&x.score?k=` (Final: ${x.score})`:x.time?k=` @ ${x.time}`:x.status==="finished"&&(k=" (Final)"),`- ${x.team1} vs ${x.team2}${k}`}).join(`
`),""]);return{context:["You are helping build an optimal Draft Lineup.","","### Context (captured from realsports.io UI)",`URL: ${e?.url||"<unknown>"}`,`Captured At: ${e?.captured_at||"<unknown>"}`,`Capture Mode: ${e?.mode||"<unknown>"}`,`Sport: ${e?.sport||"<unknown>"}`,`Draft Type: ${l==="game"?"Game (single matchup)":"League (all games)"}`,"",...f,"### Rules / how scoring multipliers work",`- You must select EXACTLY ${u} unique players.`,"- Each lineup slot has a slot multiplier (e.g. 2.0x, 1.8x, 1.6x...).","- Each player also has a boost shown as +Bx (e.g. +0.9x).","- ASSUME boosts are additive with the slot multiplier:","  effective_multiplier = slot_multiplier + player_boost_x","  example: slot 2.0x + player +0.9x => effective 2.9x","- Goal: assign the best combination of players to slots to maximize expected Real score.","","### Betting payouts (Rax)","- Entry fee is ALWAYS 100 Rax for any bet tier.","- If lineup finishes Top 50%: payout 170 Rax (profit +70).","- If lineup finishes Top 20%: payout 350 Rax (profit +250).","- If lineup finishes Top 10%: payout 700 Rax (profit +600).","","Slots (higher multiplier = bigger boost):",r||"- <no slots found>","","Available player pool (with their +boost values shown in the UI):",a||"- <no pool detected>",i,"","### Task","Choose exactly the required number of players from the pool and assign them to slots.","Important: All players in the pool are from teams playing today. Focus on their status (Active/Questionable/Out) rather than checking team schedules.","Prefer players who are Active. Be cautious with Questionable players. Never pick Out/Inactive players.","Explain briefly why each player goes into each slot.","Also provide bet recommendations for: Top 50%, Top 20%, Top 10.",""].join(`
`),expectedSlots:u}}function ao(e){const{context:t,expectedSlots:r}=so(e);return[t,"### Output format (human-readable)","Reply in plain English with these sections:","1) Lineup (final)",`- List exactly ${r} slots in order (slot 1..${r}), showing: player, slot multiplier, player boost, and effective multiplier.`,"2) Why this lineup","- 13 bullets summarizing the approach.","3) Slot-by-slot rationale","- Short note per slot explaining the assignment.","4) Bets","- Recommendations for Top 50%, Top 20%, Top 10 (recommend yes/no + confidence + one sentence reason).","","Do NOT include JSON. Keep it readable and actionable."].join(`
`)}function oo(e,t){const{context:r}=so(e),n=t?.webHint?"If web search is available, use it ONLY to verify time-sensitive info like injury status, starters, scratches, minutes restrictions, and recent news.":null,s=t?.toolHint?["","### Player Profile Lookup Tool","You have access to `get_player_profile_stats` - use it to fetch detailed stats for any player when:","- Boost values alone aren't enough to decide between players","- You need recent performance data (game logs, rankings, trends)","- A player's floor/ceiling matters for the decision","Call it with the player's name exactly as shown in the pool. The tool will scrape their profile and return stats.",""].join(`
`):"If you need player projections/stats beyond the boost values, DO NOT ask the user generic follow-up questions. Instead, request player profile stats using the tool for specific players you want to evaluate.",a=t?.searchHint?["","### Draft Player Search Tool","The initial player pool shows up to ~50 players, but more may be available.","You have access to `search_draft_players` - use it to search for specific players by name if they aren't in the current pool.","- Search by player name or partial name (e.g. 'McDavid', 'Ovi', 'Connor')","- Note: only searches by player name, NOT by position or team","- Useful when a player you're looking for isn't in the visible list",""].join(`
`):"";let i="";const u=t?.strategy||"balanced";return u==="safe"?i=["","### Lineup Strategy: SAFE","The user has requested a SAFE, consistent lineup. Prioritize:","- Players with high floor and consistent production","- Established stars with predictable output","- Lower variance, reliable performers","- Avoid boom-or-bust picks",""].join(`
`):u==="risky"&&(i=["","### Lineup Strategy: RISKY (High Upside)","The user wants a RISKY, high-ceiling lineup. Prioritize:","- Players with explosive potential who can outperform their boost","- Boom-or-bust picks with high upside","- Hot streaks, favorable matchups, breakout candidates","- Accept lower floor for higher ceiling",""].join(`
`)),[r,n?`
${n}
`:"",s,a,i,"Return data that matches the provided JSON schema exactly."].join(`
`).trim()}function sc(){try{return localStorage.getItem(Za)||""}catch{return""}}function ac(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));return ao(t)}function oc(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));const r=I(un,"1")!=="0",n=I(dn,"1")!=="0";return oo(t,{toolHint:r,searchHint:n})}const gs="rsdh_user_identity";function _s(){try{const e=localStorage.getItem(gs);if(!e)return null;const t=JSON.parse(e);return t?.username&&t?.displayName?t:null}catch{return null}}function ic(e){localStorage.setItem(gs,JSON.stringify(e))}function lc(){localStorage.removeItem(gs)}function cc(){const e=window.location.href;return e==="https://realsports.io/"||e==="https://realsports.io"||e.startsWith("https://realsports.io/?")||e.startsWith("https://realsports.io/#")}function uc(){const e=Array.from(document.querySelectorAll("img"));for(const t of e)if((t.getAttribute("src")||"").includes("media.realapp.com/assets/user/")){const n=t.closest('[tabindex="0"]');if(n)return n}return null}async function dc(){const e=uc();return e?(e.click(),await new Promise(t=>setTimeout(t,500)),!0):!1}function fc(){if(!cc())return null;const e=Array.from(document.querySelectorAll("div"));let t=null,r=null;for(const l of e){const c=l.textContent?.trim()||"";if(c.startsWith("@")&&c.length>1&&c.length<30&&!c.includes(" ")&&l.closest('[style*="padding-top"]')?.textContent?.includes("Karma")){t=l;break}}if(!t)return null;const n=t.parentElement;if(n){const l=n.parentElement?.parentElement;if(l){const c=Array.from(l.querySelectorAll("div"));for(const d of c){const f=d.textContent?.trim()||"";if(f&&!f.startsWith("@")&&!f.includes("@")&&f.length>1&&f.length<50&&d!==t&&!f.includes("Karma")&&!f.includes("Rax")&&d.childElementCount===0){r=d;break}}}}const s=t.textContent?.trim().replace(/^@/,"")||"",a=r?.textContent?.trim()||s;let i,u=t;for(let l=0;l<10&&u&&!i;l++)if(u=u.parentElement,u){const c=Array.from(u.querySelectorAll("img"));for(const d of c){const f=d.getAttribute("src")||"";if(f.includes("media.realapp.com/assets/user/")){i=f.replace(/\/(xsmall|small)\//,"/large/");break}}}return s?{username:s,displayName:a,avatarUrl:i,linkedAt:new Date().toISOString()}:null}function pc(e){return e?`rgb(${e.r}, ${e.g}, ${e.b})`:null}function vc(){try{const t=to()?.accent?.rgb;return pc(t||null)}catch{return null}}const io="rsdh-debug-highlight-",hc=999999;function lo(e,t,r="rgba(4, 131, 215, 0.4)"){if(!e||!ur())return null;const n=io+Date.now(),s=e.getBoundingClientRect(),a=document.createElement("div");a.id=n,a.style.cssText=`
    position: fixed;
    top: ${s.top}px;
    left: ${s.left}px;
    width: ${s.width}px;
    height: ${s.height}px;
    background: ${r};
    border: 2px solid ${r.replace(/[\d.]+\)$/,"0.9)")};
    border-radius: 4px;
    z-index: ${hc};
    pointer-events: none;
    transition: opacity 0.3s ease;
  `;const i=document.createElement("div");return i.style.cssText=`
    position: absolute;
    bottom: 100%;
    left: 0;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    padding: 4px 8px;
    font-size: 12px;
    font-family: system-ui, sans-serif;
    border-radius: 4px;
    white-space: nowrap;
    margin-bottom: 4px;
  `,i.textContent=t,a.appendChild(i),document.body.appendChild(a),n}function co(e){if(e)try{document.getElementById(e)?.remove()}catch{}}function mc(){try{document.querySelectorAll(`[id^="${io}"]`).forEach(e=>e.remove())}catch{}}function Or(e,t){const r=t?.timeoutMs??8e3,n=t?.intervalMs??100,s=Date.now();return new Promise(a=>{const i=()=>{if(e())return a(!0);if(Date.now()-s>r)return a(!1);setTimeout(i,n)};i()})}function gc(e){try{e.focus()}catch{}let t=0,r=0;try{const n=e.getBoundingClientRect();t=Math.max(1,Math.floor(n.left+n.width/2)),r=Math.max(1,Math.floor(n.top+n.height/2))}catch{}try{const n=window.PointerEvent;typeof n=="function"&&(e.dispatchEvent(new n("pointerdown",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})),e.dispatchEvent(new n("pointerup",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})))}catch{}try{e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.click()}catch{}}function _c(e,t=6e3){try{const r=JSON.stringify(e);return r?r.length<=t?e:{_truncated:!0,_len:r.length}:null}catch{return{_unserializable:!0}}}function yc(){try{const e=String(localStorage.getItem(Pn)||"");if(!e.trim())return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function bc(e){try{localStorage.setItem(Pn,JSON.stringify(e.slice(-250)))}catch{}}function L(e,t,r){if(!ur())return;const n={t:new Date().toISOString(),kind:e,scope:r?.scope,msg:String(t||""),data:_c(r?.data)},s=yc();s.push(n),bc(s);try{window.dispatchEvent(new CustomEvent("rsdh-debug-event",{detail:n})),window.dispatchEvent(new CustomEvent("rsdh-debug-events",{detail:{events:s.slice(-250)}}))}catch{}}let Gt=null;function xc(){return Gt&&document.body.contains(Gt)||(Gt=document.createElement("div"),Gt.id="rsdh-toast-container",Gt.style.cssText=`
    position: fixed;
    bottom: 40px;
    left: 40px;
    z-index: 2147483647;
    display: flex;
    flex-direction: column;
    gap: 12px;
    align-items: flex-start;
    pointer-events: none;
  `,document.body.appendChild(Gt)),Gt}function ys(e,t="info",r=3e3){const n=xc(),s=document.createElement("div"),i={success:"#7CFF01",error:"#FF3D00",info:"#00E5FF"}[t];s.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
    font-size: 11px;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    padding: 14px 20px;
    border-radius: 2px;
    color: white;
    background: #0D0D12;
    border-left: 4px solid ${i};
    pointer-events: auto;
    box-shadow: 0 12px 32px rgba(0,0,0,0.8), 0 0 10px ${i}20;
    animation: broadcastToastIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    max-width: 320px;
    position: relative;
    overflow: hidden;
  `;const u=document.createElement("div");u.style.cssText=`
    position: absolute;
    inset: 0;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
    background-size: 100% 2px, 3px 100%;
    pointer-events: none;
  `,s.appendChild(u);const l=document.createTextNode(e);if(s.appendChild(l),!document.getElementById("rsdh-toast-styles")){const c=document.createElement("style");c.id="rsdh-toast-styles",c.textContent=`
      @keyframes broadcastToastIn {
        from { opacity: 0; transform: translateX(-40px); }
        to { opacity: 1; transform: translateX(0); }
      }
      @keyframes broadcastToastOut {
        from { opacity: 1; transform: scale(1); }
        to { opacity: 0; transform: scale(0.9) translateX(-20px); }
      }
    `,document.head.appendChild(c)}n.appendChild(s),setTimeout(()=>{s.style.animation="broadcastToastOut 0.2s ease forwards",setTimeout(()=>{s.remove()},200)},r)}const fn=(e,t)=>ys(e,"success",t),fr=(e,t)=>ys(e,"error",t),uo=(e,t)=>ys(e,"info",t);function bs(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div, span, button"));let r=null,n=null,s=null;for(const a of t){const i=ne(a).trim().toLowerCase(),u=a.getBoundingClientRect();if(!(u.width<=20||u.width>200||u.height<=10||u.height>60)){if(i==="feed"){r=a;const l=window.getComputedStyle(a);(a.className.includes("r-1q142lx")||l.borderBottomColor==="rgb(4, 131, 215)"||l.color==="rgb(4, 131, 215)"||a.getAttribute("aria-selected")==="true")&&(s="feed")}else if(i==="plays"){n=a;const l=window.getComputedStyle(a);(a.className.includes("r-1q142lx")||l.borderBottomColor==="rgb(4, 131, 215)"||l.color==="rgb(4, 131, 215)"||a.getAttribute("aria-selected")==="true")&&(s="plays")}}}if(s===null&&(r||n)){const a=ne(e).toLowerCase();/\d+(?:\.\d+)?\s*fps\s+\d/.test(a)&&/vs\s+[A-Z]{2,4}|@\s+[A-Z]{2,4}/i.test(a)?s="feed":/\d+-\d+\s+P\d+\s+\d{1,2}:\d{2}/i.test(a)&&(s="plays")}return{feedBtn:r,playsBtn:n,activeTab:s}}async function wc(){const{feedBtn:e,activeTab:t}=bs();if(L("info",`Toggle to Feed: activeTab=${t}, feedBtn=${e?"found":"not found"}`,{scope:"scrape"}),t==="feed")return!0;if(!e)return!1;L("step","Clicking Feed button with humanActivate",{scope:"scrape"}),gc(e);const r=await Or(()=>bs().activeTab==="feed",{timeoutMs:4e3});return L("info",`Feed tab switch result: ${r}`,{scope:"scrape"}),r}function Sc(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div,header")).map(r=>{const n=ne(r);if(!n||!n.includes("Player"))return null;const s=r.getBoundingClientRect();return s.top<-5||s.top>80||s.height<32||s.height>90?null:{el:r,area:s.width*s.height}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function Ec(){const e=Sc();if(!e)return!1;const r=Array.from(e.querySelectorAll("button,[role='button'],a,div[tabindex='0']")).map(n=>{const s=n.getBoundingClientRect();if(s.width<=0||s.height<=0||s.width>80||s.height>80)return null;const a=Math.max(0,120-s.left),i=n.querySelector("svg")?20:0,u=ne(n).toLowerCase(),l=(n.getAttribute("aria-label")||"").toLowerCase(),c=u.includes("back")||l.includes("back")?30:0;return{el:n,score:a+i+c}}).filter(Boolean);if(r.length===0)return!1;r.sort((n,s)=>s.score-n.score);try{return r[0].el.click(),!0}catch{return!1}}const Ac={code:"NHL",name:"National Hockey League",stats:[{code:"G",name:"Goals",aliases:["goal","goals","g"],isPrimary:!0},{code:"A",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"PTS",name:"Points",aliases:["pt","pts","points"],isPrimary:!0},{code:"SOG",name:"Shots on Goal",aliases:["sog","shot","shots"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"HIT",name:"Hits",aliases:["hit","hits"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]},{code:"PIM",name:"Penalty Minutes",aliases:["pim","penalty"]},{code:"FOW",name:"Faceoff Wins",aliases:["fow","fo","faceoff"]},{code:"FO%",name:"Faceoff Percentage",aliases:["fo%","fopct"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"GA",name:"Goals Against",aliases:["ga","goalsagainst"]},{code:"SV%",name:"Save Percentage",aliases:["sv%","savepct"]},{code:"GAA",name:"Goals Against Average",aliases:["gaa"]},{code:"SO",name:"Shutouts",aliases:["so","shutout","shutouts"]},{code:"GP",name:"Games Played",aliases:["gp","games"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"OTL",name:"Overtime Losses",aliases:["otl","ot loss"]},{code:"TOI",name:"Time on Ice",aliases:["toi"]},{code:"GVA",name:"Giveaways",aliases:["gva","gwa","giveaway","giveaways"]},{code:"TKA",name:"Takeaways",aliases:["tka","takeaway","takeaways"]},{code:"PPG",name:"Power Play Goals",aliases:["ppg","pp goal"]},{code:"SHG",name:"Short Handed Goals",aliases:["shg","sh goal"]}],periods:{pattern:/P[1-3]|OT\d?|SO/i,labels:["P1","P2","P3","OT","SO"],hasClock:!0,timePattern:/:?\d{1,2}(?::\d{2})?/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["G","A","PTS","SOG","BLK"]},xs={code:"NBA",name:"National Basketball Association",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"FGM",name:"Field Goals Made",aliases:["fgm","fg"]},{code:"FGA",name:"Field Goals Attempted",aliases:["fga"]},{code:"3PM",name:"3-Pointers Made",aliases:["3pm","3pt","three","threes"],isPrimary:!0},{code:"3PA",name:"3-Pointers Attempted",aliases:["3pa"]},{code:"FTM",name:"Free Throws Made",aliases:["ftm","ft"]},{code:"FTA",name:"Free Throws Attempted",aliases:["fta"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"],isPrimary:!0},{code:"OREB",name:"Offensive Rebounds",aliases:["oreb","or"]},{code:"DREB",name:"Defensive Rebounds",aliases:["dreb","dr"]},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"],isPrimary:!0},{code:"BLK",name:"Blocks",aliases:["blk","block","blocks"],isPrimary:!0},{code:"MIN",name:"Minutes",aliases:["min","mins","minutes"]},{code:"PF",name:"Personal Fouls",aliases:["pf","foul","fouls"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","REB","AST","STL","BLK","3PM"]},fo={code:"NFL",name:"National Football League",stats:[{code:"PASS_YD",name:"Passing Yards",aliases:["pass yd","pass yds","passing","pass"],isPrimary:!0},{code:"PASS_TD",name:"Passing Touchdowns",aliases:["pass td","pass tds","ptd"]},{code:"INT",name:"Interceptions Thrown",aliases:["int","ints","interception"]},{code:"CMP",name:"Completions",aliases:["cmp","comp","completions"]},{code:"ATT",name:"Pass Attempts",aliases:["att","attempts"]},{code:"RUSH_YD",name:"Rushing Yards",aliases:["rush yd","rush yds","rushing","rush"],isPrimary:!0},{code:"RUSH_TD",name:"Rushing Touchdowns",aliases:["rush td","rush tds","rtd"]},{code:"CAR",name:"Carries",aliases:["car","carry","carries"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception","receptions"],isPrimary:!0},{code:"REC_YD",name:"Receiving Yards",aliases:["rec yd","rec yds","receiving"]},{code:"REC_TD",name:"Receiving Touchdowns",aliases:["rec td","rec tds"]},{code:"TGT",name:"Targets",aliases:["tgt","target","targets"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown","touchdowns"],isPrimary:!0},{code:"YD",name:"Total Yards",aliases:["yd","yds","yards"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"XP",name:"Extra Points",aliases:["xp","pat","extra point"]},{code:"SACK",name:"Sacks",aliases:["sack","sacks","sk"]},{code:"TKL",name:"Tackles",aliases:["tkl","tackle","tackles"]},{code:"FF",name:"Forced Fumbles",aliases:["ff","forced fumble"]},{code:"FR",name:"Fumble Recoveries",aliases:["fr","fumble recovery"]},{code:"DEF_INT",name:"Defensive Interceptions",aliases:["def int","pick"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PASS_YD","RUSH_YD","REC","TD"]},Tc={code:"MLB",name:"Major League Baseball",stats:[{code:"H",name:"Hits",aliases:["h","hit","hits"],isPrimary:!0},{code:"HR",name:"Home Runs",aliases:["hr","hrs","homer","homers","home run"],isPrimary:!0},{code:"RBI",name:"Runs Batted In",aliases:["rbi","rbis"],isPrimary:!0},{code:"R",name:"Runs",aliases:["r","run","runs"],isPrimary:!0},{code:"SB",name:"Stolen Bases",aliases:["sb","stolen","steal","steals"]},{code:"BB",name:"Walks",aliases:["bb","walk","walks"]},{code:"K",name:"Strikeouts",aliases:["k","so","strikeout","strikeouts"]},{code:"AB",name:"At Bats",aliases:["ab","at bat","at bats"]},{code:"2B",name:"Doubles",aliases:["2b","double","doubles"]},{code:"3B",name:"Triples",aliases:["3b","triple","triples"]},{code:"AVG",name:"Batting Average",aliases:["avg","average"]},{code:"IP",name:"Innings Pitched",aliases:["ip","innings"]},{code:"ER",name:"Earned Runs",aliases:["er","earned run","earned runs"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"ERA",name:"Earned Run Average",aliases:["era"]},{code:"WHIP",name:"Walks+Hits per IP",aliases:["whip"]},{code:"QS",name:"Quality Starts",aliases:["qs","quality start"]}],periods:{pattern:/(?:Top|Bot|T|B)\s*\d+|Inning\s*\d+|\d+(?:st|nd|rd|th)/i,labels:["1st","2nd","3rd","4th","5th","6th","7th","8th","9th","Extra"],hasClock:!1},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["H","HR","RBI","R","SB"]},ws={code:"NFL",name:"Generic Sport",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"]},{code:"G",name:"Goals",aliases:["goal","goals","g"]},{code:"SOG",name:"Shots",aliases:["sog","shot","shots"]},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"3PM",name:"3-Pointers",aliases:["3pm","3pt","three","threes"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown"]},{code:"YD",name:"Yards",aliases:["yd","yds","yards"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception"]},{code:"BIRDIE",name:"Birdies",aliases:["birdie","birdies"]},{code:"PAR",name:"Pars",aliases:["par","pars"]},{code:"BOGEY",name:"Bogeys",aliases:["bogey","bogeys"]},{code:"EAGLE",name:"Eagles",aliases:["eagle","eagles"]},{code:"KO",name:"Knockouts",aliases:["ko","knockout","knockouts"]},{code:"SUB",name:"Submissions",aliases:["sub","submission","submissions"]},{code:"TKD",name:"Takedowns",aliases:["tkd","takedown","takedowns"]},{code:"STR",name:"Strikes",aliases:["str","strike","strikes"]},{code:"GLS",name:"Goals",aliases:["gls","goal","goals"]},{code:"SHT",name:"Shots",aliases:["sht","shot","shots"]},{code:"SOT",name:"Shots on Target",aliases:["sot"]},{code:"CRN",name:"Corners",aliases:["crn","corner","corners"]}],periods:{pattern:/(?:P[1-3]|Q[1-4]|H[1-2]|OT\d?|SO|R\d+|RD\s*\d+)/i,labels:["1","2","3","4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","G","TD","REC"]};function kc(e,t){return{...ws,code:e,name:t}}const Cc={NHL:Ac,NBA:xs,NFL:fo,MLB:Tc,CFB:{...fo,code:"CFB",name:"College Football"},CBB:{...xs,code:"CBB",name:"College Basketball"},WNBA:{...xs,code:"WNBA",name:"Women's NBA"},FC:kc("FC","Football Club / Soccer")};function Pc(e){if(!e)return ws;const t=e.toUpperCase().trim();return Cc[t]||ws}function Ss(e){return(e||"").trim().toLowerCase()}function Oc(e){const t=(e||"").trim(),r=t.split("").map(a=>a.trim()).filter(Boolean),n=r[0]||t,s=r.slice(1).join("  ");return{name:n,rest:s}}function po(e,t){const r=Ss(t);if(!r)return null;const n=/\+(\d+(?:\.\d+)?)x\b/i,s=Array.from(e.querySelectorAll("div[tabindex='0'],[role='button'],button")).map(a=>{const i=ne(a);if(!i||!n.test(i))return null;const{name:u}=Oc(i),l=a.getBoundingClientRect();if(l.width<=140||l.height<28)return null;const c=(Ss(u)===r?1e3:Ss(u).includes(r)?100:0)+Math.min(200,Math.round(l.width));return c<=0?null:{el:a,score:c,rect:l,name:u}}).filter(Boolean);return s.length===0?null:(s.sort((a,i)=>i.score-a.score),s[0].el)}function vo(e){const s=Array.from(e.querySelectorAll("a[href],a,button,div[tabindex='0'],[role='button']")).filter(u=>!!u.querySelector("svg")).map(u=>({el:u,r:u.getBoundingClientRect()})).filter(u=>u.r.width>8&&u.r.width<=28&&u.r.height>8&&u.r.height<=28);if(s.length===0)return null;s.sort((u,l)=>l.r.left-u.r.left);const a=s[0].el;return(a instanceof HTMLAnchorElement?a:null)||a.querySelector("a[href]")||a.closest("a[href]")||a}async function Rc(e){const t=dr();if(!t)return L("warn","No modal found for profile URL discovery",{scope:"profile"}),null;L("step",`Finding player row: ${e}`,{scope:"profile"});const r=po(t,e);if(!r)return L("warn","Player row not found",{scope:"profile"}),null;const n=vo(r);if(!n)return L("warn","Profile icon button not found",{scope:"profile"}),null;const s=n instanceof HTMLAnchorElement?n:n.closest("a[href]");if(s?.getAttribute("href")){const a=new URL(String(s.getAttribute("href")),location.href).toString();return L("info","Got profile URL from href",{scope:"profile",data:{url:a}}),a}return L("info","No href on icon, will click to navigate",{scope:"profile"}),"__CLICK_TO_NAVIGATE__"}function Nc(e){const t=e.querySelector("#realrootcontents")||e.querySelector("#realweb")||e.body,n=Array.from(t.querySelectorAll("div,section,header,article")).slice(0,2e3).map(s=>{const a=(ne(s)||"").replace(/\s+/g," ").trim();if(!a||a.length<40||a.length>320)return null;const i=a.toUpperCase();let u=0;return i.includes("7-DAY")&&(u+=4),i.includes("30-DAY")&&(u+=4),i.includes("SEASON")&&(u+=3),i.includes("CARD")&&(u+=2),a.includes("")&&(u+=2),/#\d+/.test(a)&&(u+=1),/\b\d+(st|nd|rd|th)\b/i.test(a)&&(u+=2),u<6?null:{t:a,score:u}}).filter(Boolean);return n.length===0?null:(n.sort((s,a)=>a.score-s.score),n[0].t)}function Ic(e){const t={},r=e.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/gi);if(r)for(const s of r){const a=s.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/i);if(a){const i=parseInt(a[1],10),u=a[3]||"overall";t[`rank_${u.toLowerCase().replace("-","_")}`]=i}}const n=e.match(/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)\s*\s*([A-Z]+)\s*\s*#(\d+)/);return n&&(t.team=n[1],t.position=n[2],t.number=parseInt(n[3],10)),t}function Mc(e){const t=e.replace(/\s+/g," "),r=/([A-Z]+(?:%||\+\/-)?)\s+(-?\d+(?:\.\d+)?(?::\d+)?)\s+(\d+)(?:st|nd|rd|th)\b/gi,n=[];let s;for(;(s=r.exec(t))!==null;)n.push({stat:s[1],value:s[2],rank:parseInt(s[3],10)});return n.length>0?{entries:n}:null}function ho(e){const t=e.replace(/\s+/g," ");let r=[];const n=t.match(/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps[^A-Z]*/gi);if(n&&(r=n.map(s=>s.trim().slice(0,200)).filter(s=>s.length>20).slice(0,15)),r.length===0){const s=e.split(/\n/).map(a=>a.trim()).filter(Boolean);for(const a of s)if((/\d+(?:\.\d+)?\s*fps/i.test(a)||/\d+(?:\.\d+)?\s*@\s*[A-Z]{2,4}/i.test(a))&&(r.push(a.slice(0,200)),r.length>=15))break}return r.length>0?{entries:r}:null}function mo(e){const t=e.replace(/\s+/g," "),r=[],n=/([A-Z]\.[\s]*[\w'-]+)\s*\s*(\d+(?:\.\d+)?)\s*fps\s+([\d.]+)?/gi;let s;const a=[];for(;(s=n.exec(t))!==null&&(a.push({player:s[1].trim(),fps:parseFloat(s[2]),multiplier:s[3]?parseFloat(s[3]):null,startIdx:s.index,endIdx:s.index+s[0].length}),!(a.length>=30)););for(let i=0;i<a.length;i++){const u=a[i],l=a[i+1]?.startIdx??t.length,c=t.slice(u.endIdx,l).trim(),d=c.match(/(\d+\s+(?:hours?|days?|weeks?|months?)\s+ago|yesterday|today)/i),f=c.match(/(vs|@)\s*([A-Z]{2,4})\s*([WL])?/i);let v=c;d?v=c.slice(0,d.index).trim():f&&(v=c.slice(0,f.index).trim()),v=v.replace(/\s+\d+\s*$/,"").trim(),r.push({player:u.player,fps:u.fps,multiplier:u.multiplier,stats:v.slice(0,100),date:d?.[1]||"",opponent:f?.[2]||"",result:f?.[3]||""})}return r}async function Lc(e,t,r=null){Pc(r),L("step","Scraping profile from current DOM",{scope:"scrape"});const n=Nc(document),s=n?Ic(n):null,a=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,i=ne(a),u=Mc(i),{activeTab:l}=bs();L("info",`Initial tab: ${l||"unknown"}`,{scope:"scrape"});let c=[],d=null;if(l==="plays"){if(L("step","Switching to Feed tab",{scope:"scrape"}),await wc()){await Or(()=>{const x=ne(a).replace(/\s+/g," ");return/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(x)},{timeoutMs:3e3,intervalMs:100});const m=ne(a);c=mo(m),d=ho(m)}}else c=mo(i),d=ho(i);L("info",`Feed extraction: ${c.length} entries`,{scope:"scrape"});const f={player_name:e,profile_url:t,title:document.title||"",header_text:n,header_parsed:s,season_summary:u,recent_performances:d,feed_entries:c,active_tab:l,raw_text_length:i.length};return L("info","Scrape complete",{scope:"scrape",data:{header:!!n,season_summary:u?.entries?.length??0,recent_performances:d?.entries?.length??0,feed_entries:c.length,active_tab:l}}),f}async function Dc(e){const t=location.href,r=e.profile_url==="__CLICK_TO_NAVIGATE__";L("step","Starting profile scrape flow",{scope:"flow",data:{player_name:e.player_name,profile_url:r?"(will click icon)":e.profile_url,return_to_draft:e.return_to_draft}});const n=dr();L("info",`Draft modal at start: ${n?"found":"not found"}`,{scope:"flow"}),L("step","Navigating to profile page",{scope:"flow"});const s=n?po(n,e.player_name):null,a=s?vo(s):null;let i=null,u=null;if(s&&ur()&&(i=lo(s,`Player: ${e.player_name}`,"rgba(0, 161, 99, 0.3)")),a&&ur()&&(u=lo(a,"Profile Icon","rgba(4, 131, 215, 0.5)")),r||a)a?(L("step","Clicking profile icon",{scope:"flow"}),a.click()):L("warn","Could not find icon button to click",{scope:"flow"});else if(e.profile_url&&!r){L("step","Using pushState to navigate",{scope:"flow"});try{const m=new URL(e.profile_url,location.href);history.pushState({},"",m.pathname+m.search+m.hash),window.dispatchEvent(new PopStateEvent("popstate"))}catch(m){L("warn","pushState failed",{scope:"flow",data:{error:String(m)}})}}co(i),co(u),L("step","Waiting for profile page to load",{scope:"flow"});const l=await Or(()=>location.href!==t,{timeoutMs:6e3,intervalMs:100});L("info",`Navigation result: ${l?"URL changed":"URL unchanged"}`,{scope:"flow",data:{prevUrl:t,currentUrl:location.href}}),l&&(L("step","Waiting for profile content to render",{scope:"flow"}),await Or(()=>{const m=document.querySelector("#realrootcontents")||document.body,x=ne(m),k=/[A-Z]\.\s*[\w'-]+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(x),b=/PTS\s+\d+\s+\d+/i.test(x)||/GOAL\s+\d+/i.test(x);return k||b},{timeoutMs:1e4,intervalMs:100}));const c=l?location.href:e.profile_url,d=await Lc(e.player_name,c,e.sport||null);let f=!1,v=!1;if(e.return_to_draft&&l){L("step","Going back to home page",{scope:"flow"});try{history.back()}catch{}if(f=await Or(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}),f||(L("step","Clicking back button in nav",{scope:"flow"}),Ec()&&(f=await Or(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}))),L("info",`Returned to home: ${f}`,{scope:"flow",data:{currentUrl:location.href}}),f)if(L("step","Reopening draft modal",{scope:"flow"}),await new Promise(m=>setTimeout(m,500)),dr())v=!0,L("info","Modal already open",{scope:"flow"});else{const m=await tc({timeoutMs:8e3});v=m.opened,L("info",`Modal reopen attempt: clicked=${m.clicked}, opened=${m.opened}`,{scope:"flow"})}}return mc(),{...d,return_to_draft:e.return_to_draft,returned_to_draft:f,modal_reopened:v,prev_url:t,navigated_to_profile:l,modal_was_open:!!n}}function be(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Es(e){const t=typeof e=="number"&&!Number.isNaN(e)?e:null;return t==null?"":`${(Math.round(t*100)/100).toString()}X`}function Fc(e){if(!e||e.ok!==!0)return`
      <div class="card" style="border-left-color: var(--rsdh-accent-red);">
        <div class="h">SIGNAL INTERRUPTED</div>
        <div class="sub">${be(e?.error||"Awaiting RealSports draft synchronization.")}</div>
      </div>
    `;let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]);const r=typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:t.length,n=e?.sport||"",s=e?.mode||"",a=Array.isArray(e?.player_pool)?e.player_pool:[],i=(t||[]).map((l,c)=>{const d=l?.selection?be(l.selection):"<span style='opacity: 0.3;'>EMPTY_SLOT</span>",f=Es(l?.multiplier);return`
      <tr>
        <td><span class="font-mono">${c+1}</span></td>
        <td><span class="text-accent font-mono">${f}</span></td>
        <td style="font-weight: 700;">${d}</td>
      </tr>
    `}).join(""),u=a.slice(0,40).map((l,c)=>{const d=be(l?.name||""),f=l?.status?`<span class="status-pill" style="background: rgba(255,255,255,0.05); color: var(--rsdh-text-dim); margin-left: 8px;">${be(l.status)}</span>`:"",v=typeof l?.boost_x=="number"?`<span class="text-green font-mono">+${be(l.boost_x)}X</span>`:"";return`
      <div class="player-row">
        <div class="player-rank">#${c+1}</div>
        <div class="player-info">
          <div class="player-name">${d}${f}</div>
          <div class="player-meta">${l.team||n}  ${l.position||s}</div>
        </div>
        <div class="player-stats">
          ${v}
        </div>
      </div>
    `}).join("");return`
    <div class="card">
      <div class="h">TRANSMISSION DATA</div>
      <div class="sub">
        <span class="text-accent">SPORT:</span> ${be(n)} &nbsp;&nbsp; 
        <span class="text-accent">MODE:</span> ${be(s)} &nbsp;&nbsp; 
        <span class="text-accent">SLOTS:</span> ${be(r)}
      </div>
    </div>
    
    <div class="card">
      <div class="h">ROSTER CONFIGURATION</div>
      <table class="table">
        <thead>
          <tr>
            <th>SLOT</th>
            <th>MULT</th>
            <th>SELECTION</th>
          </tr>
        </thead>
        <tbody>
          ${i||"<tr><td colspan='3' style='text-align:center; padding: 24px; opacity: 0.3;'>NO SLOTS DETECTED</td></tr>"}
        </tbody>
      </table>
    </div>

    <div class="card" style="border-left-color: var(--rsdh-accent-green);">
      <div class="h">
        <span>AVAILABLE ASSETS</span>
        <span class="status-pill text-green status-pulsing">LIVE_POOL</span>
      </div>
      <div class="list">
        ${u||"<div style='text-align:center; padding: 24px; opacity: 0.3;'>POOL DATA UNAVAILABLE</div>"}
      </div>
      ${a.length>40?`<div class="sub" style="margin-top: 12px; text-align: center;">+ ${a.length-40} MORE ASSETS IN POOL</div>`:""}
    </div>
  `.trim()}function go(e,t=[]){const r=Array.isArray(e?.lineup)?e.lineup:[],n=Array.isArray(e?.bets)?e.bets:[],s=Array.isArray(e?.assumptions)?e.assumptions:[],a=Array.isArray(e?.questions)?e.questions:[],i=r.map(c=>{const d=be(c?.slot_index),f=be(c?.player||""),v=Es(c?.slot_multiplier),m=typeof c?.player_boost_x=="number"?`+${be(c.player_boost_x)}X`:"+0X",x=Es(c?.effective_multiplier);return`
      <tr>
        <td class="font-mono">${d}</td>
        <td style="font-weight: 800;">${f}</td>
        <td class="font-mono">${v}</td>
        <td class="text-green font-mono">${m}</td>
        <td><span class="text-accent font-mono" style="font-weight: 900;">${x}</span></td>
      </tr>
    `}).join(""),u=n.map(c=>{const d=be(c?.tier||""),f=c?.recommend?"OPTIMAL":"AVOID",v=c?.recommend?"":"text-red",m=c?.recommend?"var(--rsdh-accent-green)":"var(--rsdh-accent-red)",x=Math.min(100,Math.max(0,parseInt(c?.confidence)||0)),k=be(c?.reason||"");return`
      <div class="card" style="border-left-color: ${m}; padding: 12px 16px;">
        <div class="h" style="margin-bottom: 4px;">
          <span style="font-size: 11px;">${d}</span>
          <span class="status-pill ${v}" style="background: ${m}20; color: ${m};">${f}</span>
        </div>
        <div class="sub" style="margin-bottom: 8px;">${k}</div>
        <div class="flex-row space-between">
          <span class="player-meta">CONFIDENCE SCORE</span>
          <span class="font-mono text-accent" style="font-size: 10px;">${x}%</span>
        </div>
        <div class="meter-container">
          <div class="meter-fill" style="width: ${x}%; background: ${m};"></div>
        </div>
      </div>
    `}).join(""),l=(t||[]).slice(0,5).map(c=>`
    <div class="row">
      <a class="link font-mono" style="font-size: 10px; overflow: hidden; text-overflow: ellipsis;" href="${be(c)}" target="_blank" rel="noreferrer">
        LINK: ${be(c)}
      </a>
    </div>
  `).join("");return`
    <div class="card" style="border-left: 4px solid var(--rsdh-accent-green);">
      <div class="h">AI CO-PILOT ANALYSIS</div>
      <div class="sub">Structured data synchronization complete. Multi-source validation active.</div>
    </div>

    <div class="card">
      <div class="h">OPTIMIZED LINEUP</div>
      <table class="table">
        <thead>
          <tr>
            <th>SLOT</th>
            <th>PLAYER</th>
            <th>MULT</th>
            <th>BOOST</th>
            <th>EFF.</th>
          </tr>
        </thead>
        <tbody>
          ${i||"<tr><td colspan='5' style='text-align:center; padding: 24px; opacity: 0.3;'>ANALYSIS PENDING</td></tr>"}
        </tbody>
      </table>
    </div>

    <div class="h" style="padding-left: 4px; border-left: 3px solid var(--rsdh-accent); margin: 24px 0 12px 0;">BETTING INTEL</div>
    ${u||"<div class='card sub' style='text-align:center;'>NO INTELLIGENCE GATHERED</div>"}

    ${a.length?`<div class="card"><div class="h">ANOMALIES DETECTED</div><div class="list">${a.map(c=>`<div class="row text-red">${be(c)}</div>`).join("")}</div></div>`:""}
    ${s.length?`<div class="card"><div class="h">MODEL ASSUMPTIONS</div><div class="list">${s.map(c=>`<div class="row">${be(c)}</div>`).join("")}</div></div>`:""}
    ${l?`<div class="card"><div class="h">INTELLIGENCE SOURCES</div><div class="list">${l}</div></div>`:""}
  `.trim()}function Bc(){const e=String(I(ls,"")||"").trim(),t=String(I(cs,lr)||lr).trim()||lr,r=I(us,Tn),n=I(ds,kn),s=I(fs,an),a=I(En,Dl),i=I(An,Fl),u=Math.max(0,Math.min(2,parseFloat(String(r)))),l=Math.max(64,Math.min(4e3,parseInt(String(n),10)||kn)),c=Math.max(1,Math.min(5,parseInt(String(s),10)||an)),d=String(a)==="1"||a===!0,f=String(i)==="1"||i===!0;return{apiKey:e,model:t,temperature:u,max_tokens:l,web_max_results:c,structured:d,response_healing:f}}function $c({method:e,url:t,headers:r,bodyObj:n,timeoutMs:s=6e4}){return new Promise((a,i)=>{const u=n==null?null:JSON.stringify(n);if(typeof GM_xmlhttpRequest!="function"){i(new Error("GM_xmlhttpRequest is not available (check grants)."));return}GM_xmlhttpRequest({method:e,url:t,headers:{"Content-Type":"application/json",...r||{}},data:u??void 0,timeout:s,onload:l=>{try{const c=l?.responseText||"",d=c?JSON.parse(c):null;l.status>=200&&l.status<300?a(d):i(new Error(d?.error?.message||d?.message||`HTTP ${l.status}`))}catch(c){i(c)}},onerror:()=>i(new Error("Network error.")),ontimeout:()=>i(new Error("Request timed out."))})})}function qc(){return{type:"object",additionalProperties:!1,properties:{lineup:{type:"array",items:{type:"object",additionalProperties:!1,properties:{slot_index:{type:"number"},slot_multiplier:{type:"number"},player:{type:"string"},player_boost_x:{type:["number","null"]},effective_multiplier:{type:"number"}},required:["slot_index","slot_multiplier","player","player_boost_x","effective_multiplier"]}},bets:{type:"array",items:{type:"object",additionalProperties:!1,properties:{tier:{type:"string",enum:["top50","top20","top10"]},recommend:{type:"boolean"},confidence:{type:"string",enum:["low","medium","high"]},reason:{type:"string"}},required:["tier","recommend","confidence","reason"]}},assumptions:{type:"array",items:{type:"string"}},questions:{type:"array",items:{type:"string"}}},required:["lineup","bets","assumptions","questions"]}}function _o(e){const r=(Array.isArray(e?.annotations)?e.annotations:[]).filter(n=>n&&n.type==="url_citation"&&n.url_citation&&n.url_citation.url).map(n=>n.url_citation.url).slice(0,25);return Array.from(new Set(r))}function Uc(e){return String(e?.message||e||"").toLowerCase().includes("no endpoints found")}function Rr(){return new Date().toISOString()}function Nr(e){try{localStorage.setItem(Qa,JSON.stringify(e,null,2))}catch{}}async function yo(e,t){let r=null;for(const n of e)try{return{res:await $c({method:"POST",url:t.url,headers:t.headers,bodyObj:n.body,timeoutMs:t.timeoutMs}),usedLabel:n.label}}catch(s){if(r=s,!Uc(s))throw s}throw r||new Error("OpenRouter request failed.")}function Gc(){return{type:"function",function:{name:"get_player_profile_stats",description:"Fetch and summarize a player's RealSports profile page (rankings, prior performances, recent game logs). Clicks the player's profile icon in the draft modal, scrapes their stats, then returns to the draft. Use when deciding between players beyond boost values.",parameters:{type:"object",additionalProperties:!1,properties:{player_name:{type:"string",description:"Player name exactly as shown in the draft modal."}},required:["player_name"]}}}}function Yc(){return{type:"function",function:{name:"search_draft_players",description:"Search the draft modal for players by name. The initial pool shows up to ~50 players, but many more may be available. Use this to find specific players by name (full or partial) that might not appear in the initial list. Returns matching players with boost values. Note: only searches by player name, not position or team.",parameters:{type:"object",additionalProperties:!1,properties:{query:{type:"string",description:"Player name or partial name to search for (e.g. 'McDavid', 'Connor', 'Ovi')."}},required:["query"]}}}}async function zc(e,t,r){if(e==="get_player_profile_stats"){const n=String(t?.player_name||"").trim();if(!n)return{error:"missing_player_name"};L("step",`Tool call: get_player_profile_stats(${n})`,{scope:"tool"}),L("step","Discovering profile URL via click",{scope:"tool"});const s=await Rc(n);if(!s)return{error:"player_not_found",player_name:n,hint:"Could not find this player in the draft modal. Make sure the draft modal is open and the player is visible in the list."};L("step","Scraping profile",{scope:"tool",data:{profile_url:s}});const a=r.payload?.sport||null,i=await Dc({player_name:n,profile_url:s,return_to_draft:!0,sport:a});return L("info","Tool result ready",{scope:"tool",data:{scraped_via:i?.scraped_via,navigated_to_profile:i?.navigated_to_profile}}),{...i,discovery:"click",mode:"live_dom"}}if(e==="search_draft_players"){const n=String(t?.query||"").trim();if(!n)return{error:"missing_query"};L("step",`Tool call: search_draft_players(${n})`,{scope:"tool"});const s=dr();if(!s)return L("warn","Draft modal not found for search",{scope:"tool"}),{error:"no_draft_modal",message:"Draft modal not found. Make sure the draft modal is open."};L("info","Found draft modal",{scope:"tool"});const a=s.querySelector('input[placeholder*="Search"]')||s.querySelector('input[placeholder*="search"]')||document.querySelector('input[placeholder*="Search"]');if(!a)return L("warn","Search input not found in modal",{scope:"tool"}),{error:"no_search_input",message:"Search input not found in modal"};L("step","Found search input, entering query...",{scope:"tool"}),a.value="",a.focus();const i=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value")?.set;i?i.call(a,n):a.value=n,a.dispatchEvent(new Event("input",{bubbles:!0})),a.dispatchEvent(new Event("change",{bubbles:!0})),await new Promise(c=>setTimeout(c,800)),L("step","Scraping filtered player pool...",{scope:"tool"});const u=no(s);L("info",`Found ${u.length} players matching '${n}'`,{scope:"tool"}),i?i.call(a,""):a.value="",a.dispatchEvent(new Event("input",{bubbles:!0})),a.dispatchEvent(new Event("change",{bubbles:!0}));const l=u.map(c=>({name:c.name,boost:c.boost_x!==null&&c.boost_x!==void 0?`+${c.boost_x}x`:null,status:c.status,profile_url:c.profile_url||null}));return{query:n,players_found:l.length,players:l}}return{error:"unknown_tool",toolName:e}}async function Hc(e){const t=Bc(),r=String(I(cr,"0"))==="1"||I(cr,"0")===!0;if((!on||r)&&!t.apiKey)throw new Error("Missing OpenRouter API key.");if(on&&!r&&!_s()?.username)throw new Error("Please link your account in Settings before using Ask AI.");const a=String(I(ln,"0"))==="1"||I(ln,"0")===!0,i=String(I(cn,"0"))==="1"||I(cn,"0")===!0;let u=e.prompt;a?u=["DEBUG TOOL TEST: You MUST call the tool `get_player_profile_stats` exactly once before producing the final JSON schema answer.","Pick ONE player from the available pool (prefer a high-boost or a close decision).","IMPORTANT: Call the tool with return_to_draft=true so you can read dynamic Feed/Plays content, then come back to the draft.","After you receive the tool result, continue normally and return the final JSON schema output.","",e.prompt].join(`
`):i&&(u=["DEBUG TOOL TEST: You MUST call the tool `search_draft_players` exactly once before producing the final JSON schema answer.","Search for a player by name (e.g. 'McDavid', 'Crosby', 'Ovi') to find additional players that may not be in the initial list.","Note: This search only works with player names, not positions or teams.","After you receive the search results, continue normally and return the final JSON schema output.","",e.prompt].join(`
`));const l=[{t:Rr(),kind:"start",model:t.model,web:!!e.web}];Nr(l);const c=I(un,"1")!=="0",d=I(dn,"1")!=="0",f=e.payload?.player_pool_count??e.payload?.player_pool?.length??0,v=d&&f>=50,m=[...c?[Gc()]:[],...v?[Yc()]:[]],x=a?{type:"function",function:{name:"get_player_profile_stats"}}:i?{type:"function",function:{name:"search_draft_players"}}:"auto",k=String(I(cr,"0"))==="1"||I(cr,"0")===!0,b=on&&!k,P=b?{"X-RSDH-Auth":$l,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"}:{Authorization:`Bearer ${t.apiKey}`,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"};if(b){const we=_s();we?.username&&(P["X-RSDH-User"]=we.username,we.displayName&&(P["X-RSDH-DisplayName"]=we.displayName))}const D=b?Cn:Bl,$=[];e.web&&$.push({id:"web",engine:"exa",max_results:t.web_max_results}),t.response_healing&&$.push({id:"response-healing"});const z=[],te=[{role:"user",content:u}],V=6;let H=[];for(let we=0;we<V;we++){const mr={model:t.model,messages:te,temperature:t.temperature,max_tokens:t.max_tokens,tools:m},Rn=[{label:"tools+tool_choice+parallel+provider",body:{...mr,tool_choice:x,parallel_tool_calls:!1,provider:{require_parameters:!0},plugins:z}},{label:"tools+tool_choice+provider",body:{...mr,tool_choice:x,provider:{require_parameters:!0},plugins:z}},{label:"tools+tool_choice",body:{...mr,tool_choice:x,plugins:z}},{label:"tools-only",body:{...mr,plugins:z}}],{res:Nn,usedLabel:Yt}=await yo(Rn,{url:D,headers:P,timeoutMs:9e4});Yt!==Rn[0].label&&(l.push({t:Rr(),kind:"routing_fallback",stage:"tool_loop",label:Yt}),Nr(l));const zt=Nn?.choices?.[0]?.message;H=_o(zt);const _t=Array.isArray(zt?.tool_calls)?zt.tool_calls:null;if(!_t||_t.length===0)break;te.push({role:"assistant",content:zt?.content??null,tool_calls:_t});for(const pn of _t.slice(0,3)){const Ht=pn?.function?.name,Ir=pn?.function?.arguments;let jt={};try{jt=Ir?JSON.parse(Ir):{}}catch{jt={_raw:Ir}}const Mr=String(pn?.id||"");l.push({t:Rr(),kind:"tool_call",name:String(Ht||""),id:Mr,args:jt}),Nr(l);const ks=performance.now(),In=await zc(String(Ht||""),jt,{payload:e.payload}),Mn=Math.round(performance.now()-ks),R=In,Cs=!R?.error,re={};Ht==="get_player_profile_stats"&&(re.player_name=R?.player_name||jt?.player_name,re.profile_url=R?.profile_url||null,re.discovery=R?.discovery||null,re.mode=R?.mode||"live_dom",re.returned_to_draft=typeof R?.returned_to_draft=="boolean"?R.returned_to_draft:null,re.modal_reopened=typeof R?.modal_reopened=="boolean"?R.modal_reopened:null,re.navigated_to_profile=typeof R?.navigated_to_profile=="boolean"?R.navigated_to_profile:null,re.modal_was_open=typeof R?.modal_was_open=="boolean"?R.modal_was_open:null,re.header=!!R?.header_text,re.season_summary=R?.season_summary?.entries?R.season_summary.entries.length:null,re.recent_performances=R?.recent_performances?.entries?R.recent_performances.entries.length:null,re.feed_entries=Array.isArray(R?.feed_entries)?R.feed_entries.length:null,re.lines=Array.isArray(R?.interesting_lines)?R.interesting_lines.length:null,re.tables=Array.isArray(R?.tables)?R.tables.length:null,re.embedded_json=Array.isArray(R?.embedded_json)?R.embedded_json.length:null,re.facts=Array.isArray(R?.facts)?R.facts.length:null,re.recent_log=Array.isArray(R?.recent_log)?R.recent_log.length:null,R?.error&&(re.error=R.error),re.scraped_data={header_text:R?.header_text||null,season_summary:R?.season_summary||null,recent_performances:R?.recent_performances||null,feed_entries:R?.feed_entries||[]}),Ht==="search_draft_players"&&(re.query=R?.query||jt?.query||null,re.players_found=typeof R?.players_found=="number"?R.players_found:0,Array.isArray(R?.players)&&R.players.length>0&&(re.sample_players=R.players.slice(0,5).map(Ps=>Ps.name)),R?.error&&(re.error=R.error)),l.push({t:Rr(),kind:"tool_result",name:String(Ht||""),id:Mr,ok:Cs,ms:Mn,summary:re}),Nr(l),te.push({role:"tool",tool_call_id:Mr,content:JSON.stringify(In)})}}const se={type:"json_schema",json_schema:{name:"draft_lineup",strict:!0,schema:qc()}},M={model:t.model,messages:te,temperature:t.temperature,max_tokens:t.max_tokens,response_format:se},xe=[{label:"final+tools+tool_choice+provider+plugins",body:{...M,tools:m,tool_choice:"none",provider:{require_parameters:!0},plugins:$}},{label:"final+tools+tool_choice",body:{...M,tools:m,tool_choice:"none",plugins:[]}},{label:"final+schema+plugins",body:{...M,plugins:$}},{label:"final+schema-only",body:{...M}}],{res:vr,usedLabel:hr}=await yo(xe,{url:D,headers:P,timeoutMs:9e4});hr!==xe[0].label&&(l.push({t:Rr(),kind:"routing_fallback",stage:"final",label:hr}),Nr(l));const gt=vr?.choices?.[0]?.message,ce=gt?.content;if(!ce)throw new Error("No content returned.");try{localStorage.setItem(ql,ce)}catch{}const Ie=_o(gt);try{localStorage.setItem(ps,JSON.stringify(Ie,null,2))}catch{}try{localStorage.setItem(Ul,JSON.stringify(te,null,2))}catch{}return l.push({t:Rr(),kind:"done"}),Nr(l),{jsonText:ce,sources:Ie.length?Ie:H||[]}}function jc(e){try{localStorage.setItem(Za,JSON.stringify(e,null,2))}catch{}}function bo(e){try{window.dispatchEvent(new CustomEvent("rsdh-output",{detail:{raw:e}}))}catch{}}function pr(e){try{window.dispatchEvent(new CustomEvent("rsdh-status",{detail:{text:e}}))}catch{}}function xo(e,t=!1){const r=document.createElement("button");return r.type="button",r.textContent=e.toUpperCase(),r.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
    font-size: 11px;
    font-weight: 900;
    letter-spacing: 0.1em;
    padding: 12px 16px;
    border-radius: 2px;
    cursor: pointer;
    width: 100%;
    white-space: nowrap;
    transition: all 0.15s ease;
    ${t?`background: #00E5FF;
         color: #000;
         border: none;
         box-shadow: 0 4px 12px rgba(0, 229, 255, 0.3);`:`background: rgba(13, 13, 18, 0.8);
         color: #F5F5F7;
         border: 1px solid rgba(255, 255, 255, 0.1);
         box-shadow: none;`}
  `,r.addEventListener("mouseenter",()=>{r.style.transform="translateY(-2px)",t?r.style.boxShadow="0 8px 24px rgba(0, 229, 255, 0.5), 0 0 15px rgba(0, 229, 255, 0.4)":(r.style.background="rgba(255, 255, 255, 0.05)",r.style.borderColor="rgba(255, 255, 255, 0.3)",r.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)")}),r.addEventListener("mouseleave",()=>{r.style.transform="translateY(0)",t?r.style.boxShadow="0 4px 12px rgba(0, 229, 255, 0.3)":(r.style.background="rgba(13, 13, 18, 0.8)",r.style.borderColor="rgba(255, 255, 255, 0.1)",r.style.boxShadow="none")}),r.addEventListener("mousedown",()=>{r.style.transform="translateY(1px)"}),r}function Kc(){const e=document.createElement("div");e.id="rsdh-modal-actions",e.style.cssText=`
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-top: 16px;
    padding: 20px 20px 0 20px;
    background: rgba(13, 13, 18, 0.4);
    border-top: 2px solid rgba(0, 229, 255, 0.2);
    position: relative;
    backdrop-filter: blur(8px);
  `;const t=document.createElement("div");return t.textContent="AI COMMANDS ENABLED",t.style.cssText=`
    grid-column: 1 / -1;
    font-size: 9px;
    font-weight: 900;
    color: #00E5FF;
    letter-spacing: 0.15em;
    margin-bottom: -4px;
    opacity: 0.6;
  `,e.appendChild(t),e}function Jc(e){const r=Array.from(e.querySelectorAll("button,div,[role='button']")).find(n=>{const s=(n.innerText||n.textContent||"").trim();return/^(submit|update)$/i.test(s)});return r?r.parentElement||r:null}async function wo(e){pr("Capturing...");const t=nc({includeDebug:ur()});if(jc(t),bo(JSON.stringify(t,null,2)),!t||t.ok!==!0){const c=t?.error||"SIGNAL LOST: COULD NOT CAPTURE MODAL.";pr(c),fr(c);return}if(e==="copy_prompt"){const c=ao(t);GM_setClipboard(c),pr("PROMPT GATHERED. COPIED TO CLIPBOARD."),fn("PROMPT GATHERED.");return}const r=I(vs,"1")!=="0",n=I(un,"1")!=="0",s=I(dn,"1")!=="0",a=String(I(hs,"balanced")||"balanced"),i=r?"INITIATING MULTI-SOURCE AI SCAN...":"INITIATING AI CORE SCAN...";pr(i),uo(i);const u=oo(t,{webHint:r,toolHint:n,searchHint:s,strategy:a}),l=await Hc({prompt:u,web:r,payload:t});bo(l.jsonText),pr("DATA SYNC COMPLETE. AI ANALYSIS READY."),fn("SYNC COMPLETE.")}function Wc(){const e=()=>{const r=dr();if(!r||r.querySelector("#rsdh-modal-actions"))return;const n=Kc(),s=xo("Copy Prompt"),a=xo("Ask AI",!0);s.addEventListener("click",()=>wo("copy_prompt").catch(u=>{const l=String(u?.message||u);pr(l),fr(l)})),a.addEventListener("click",()=>wo("ask_ai").catch(u=>{const l=String(u?.message||u);pr(l),fr(l)})),n.appendChild(s),n.appendChild(a);const i=Jc(r);i&&i.parentElement?i.parentElement.insertBefore(n,i.nextSibling):r.appendChild(n)};e(),new MutationObserver(()=>e()).observe(document.documentElement,{childList:!0,subtree:!0})}const So="rsdh_openrouter_models_cache",Vc=1440*60*1e3,On=["google/gemini-2.5-flash","google/gemini-2.5-pro","google/gemini-2.0-flash-001","anthropic/claude-sonnet-4","anthropic/claude-3.5-sonnet","anthropic/claude-3.5-haiku","openai/gpt-4o","openai/gpt-4o-mini","openai/gpt-4-turbo","openai/o1","openai/o1-mini","meta-llama/llama-3.3-70b-instruct","deepseek/deepseek-chat-v3-0324","mistralai/mistral-large","qwen/qwen-2.5-72b-instruct"];function Eo(){try{const e=localStorage.getItem(So);if(!e)return null;const t=JSON.parse(e);return Date.now()-t.timestamp>Vc?null:t}catch{return null}}function Xc(e){try{const t={models:e,timestamp:Date.now()};localStorage.setItem(So,JSON.stringify(t))}catch{}}async function Zc(){const e=Eo();if(e&&e.models.length>0)return e.models;try{if(typeof GM_xmlhttpRequest!="function")return On;const t=await new Promise((r,n)=>{GM_xmlhttpRequest({method:"GET",url:"https://openrouter.ai/api/v1/models",headers:{"Content-Type":"application/json"},timeout:1e4,onload:s=>{try{const a=s?.responseText?JSON.parse(s.responseText):null;r(a)}catch{n(new Error("Failed to parse models response"))}},onerror:()=>n(new Error("Network error")),ontimeout:()=>n(new Error("Request timed out"))})});if(t?.data&&Array.isArray(t.data)){const r=t.data.map(n=>n.id).filter(n=>n&&!n.includes(":free")&&!n.includes(":extended")).sort((n,s)=>{const a=["google/","anthropic/","openai/","meta-llama/","deepseek/","mistralai/"],i=a.findIndex(l=>n.startsWith(l)),u=a.findIndex(l=>s.startsWith(l));return i!==-1&&u===-1?-1:u!==-1&&i===-1?1:i!==-1&&u!==-1?i-u:n.localeCompare(s)});if(r.length>0)return Xc(r),r}return On}catch{return On}}function Qc(){return Eo()?.models||On}const Ao="rsdh_svelte_ui_state";function As(){try{const e=localStorage.getItem(Ao);if(!e)return{tab:"context",hidden:!1};const t=JSON.parse(e),r=String(t?.tab||"context");return{tab:r==="settings"?"settings":r==="results"?"results":r==="debug"?"debug":"context",hidden:!!t?.hidden}}catch{return{tab:"context",hidden:!1}}}function Ts(e){const r={...As(),...e};try{localStorage.setItem(Ao,JSON.stringify(r))}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-ui-state",{detail:r}))}catch{}}var eu=w('<div class="spinner"></div>'),tu=w('<span> </span> <span class="text-accent"></span>',1),ru=w('<span>WAITING FOR DRAFT DATA...</span> <span class="text-accent"></span> <span>AI ANALYSIS READY...</span> <span class="text-accent"></span>',1),nu=w('<button style="--rsdh-accent: #f59e0b;">Debug</button>'),su=w('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),au=w("<div><!></div>"),ou=w(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">NO SIGNAL DETECTED</h3> <p class="empty-description">Awaiting input from RealSports draft modal. Capture to initiate
          analysis.</p> <div class="empty-hint"><span class="text-accent">READY TO RECEIVE</span></div></div>`),iu=w('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),lu=w("<div><!></div>"),cu=w(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">AI CO-PILOT OFFLINE</h3> <p class="empty-description">Execute 'ASK AI' to generate real-time roster optimizations and fit
          scores.</p> <div class="empty-hint"><span class="text-green">SYSTEMS READY</span></div></div>`),uu=w('<img alt="" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--rsdh-accent);"/>'),du=w('<div style="width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center;"></div>'),fu=w('<div style="font-weight: 600; color: rgba(255,255,255,0.9);"> </div>'),pu=w('<div class="sub" style="margin-top: 8px; color: rgba(245,158,11,0.9);"> </div>'),vu=w('<div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;"><!> <div><!> <div class="sub"> </div></div></div> <div style="display: flex; gap: 8px; flex-wrap: wrap;"><button style="font-size: 11px;"> Update</button> <button class="secondary" style="font-size: 11px;">Unlink</button></div> <!>',1),hu=w('<div class="sub" style="margin-top: 8px; color: rgba(245,158,11,0.9);"> </div>'),mu=w('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(245,158,11,0.08); border-radius: 6px; border-left: 2px solid rgba(245,158,11,0.4);">Link your RealSports account to enable usage tracking.</div> <button> Link Account</button> <!>',1),gu=w('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(255,200,0,0.08); border-radius: 6px; border-left: 2px solid rgba(255,200,0,0.4);">Your API key is stored locally and never shared.</div> <label class="sub" for="or-key">API Key</label> <input id="or-key" style="width:100%; margin-bottom:8px;" type="password" placeholder="sk-or-..."/>',1),_u=w("<option> </option>"),yu=w('<datalist id="model-list"></datalist>'),bu=w('<div style="grid-column: span 2; padding: 8px; background: rgba(0,229,255,0.03); border: 1px dashed rgba(0,229,255,0.2); border-radius: 4px; text-align: center; margin-top: 4px;"><span class="sub" style="font-size: 9px; color: var(--rsdh-accent); opacity: 0.8;"> SETTINGS_LOADED_FROM_PROXY</span></div>'),xu=w('<div><label class="sub" for="or-web"> </label> <input id="or-web" style="width:100%;" type="range" min="1" max="5" step="1"/></div>'),wu=w('<label class="sub" for="or-key">Your OpenRouter API Key</label> <input id="or-key" style="width:100%; margin-bottom:8px;" type="password" placeholder="sk-or-..."/> <div class="sub" style="color: rgba(245,158,11,0.8);"> Your key is stored locally. You will be billed directly.</div>',1),Su=w("<span> </span>"),Eu=w("<span> </span>"),Au=w("<span> </span>"),Tu=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),ku=w('<div style="display: flex; flex-wrap: wrap; gap: 16px; font-size: 13px; color: rgba(255,255,255,0.7);"><span><strong> </strong></span> <!> <span> </span> <span> </span> <!> <!></div> <div style="font-size: 11px; color: rgba(255,255,255,0.4); margin-top: 6px;"> </div>',1),Cu=w('<div class="sub">Unable to parse payload</div>'),Pu=w('<div class="sub">No capture yet. Open a draft modal and click Capture.</div>'),Ou=w("&nbsp;|&nbsp; <strong>Draft:</strong> <span> </span>",1),Ru=w('&nbsp;|&nbsp; <span style="color: rgba(255,255,255,0.6);"> </span>',1),Nu=w(' <span style="color: #22c55e;"> </span>',1),Iu=w(' <span style="color: rgba(255,255,255,0.4);">Empty</span>',1),Mu=w('<div style="padding: 2px 0; font-size: 11px;"> <span style="color: var(--rsdh-accent-light);"> </span> <!></div>'),Lu=w('<div style="margin-left: 12px; margin-top: 4px;"></div>'),Du=w('<span class="sub">None detected</span>'),Fu=w("<span> </span>"),Bu=w('<div style="padding: 2px 0; font-size: 11px; display: flex; gap: 8px;"><span style="min-width: 140px;"> </span> <span style="color: var(--rsdh-accent-light); min-width: 50px;"> </span> <!></div>'),$u=w('<div class="sub" style="margin-top: 4px;"> </div>'),qu=w('<div style="margin-left: 12px; margin-top: 4px; max-height: 120px; overflow-y: auto;"><!> <!></div>'),Uu=w('<span class="sub">None detected</span>'),Gu=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),Yu=w('<span style="color: #22c55e; font-weight: 600;"> </span>'),zu=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),Hu=w('<span style="color: #22c55e; font-weight: 600;"> </span>'),ju=w('<div style="margin-bottom: 10px;"><strong> Game Matchup:</strong> <div style="margin-left: 12px; margin-top: 4px; font-size: 11px;"><div style="display: flex; gap: 8px; align-items: center;"><span> </span> <!> <!> <span style="color: rgba(255,255,255,0.4);">vs</span> <span> </span> <!> <!></div> <div style="margin-top: 4px; color: rgba(255,255,255,0.5);"><!> <!> <!></div></div></div>'),Ku=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),Ju=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),Wu=w('<div style="padding: 2px 0; font-size: 11px;"> <!></div>'),Vu=w('<div class="sub"> </div>'),Xu=w('<div><strong> </strong> <div style="margin-left: 12px; margin-top: 4px;"><!> <!></div></div>'),Zu=w('<div style="font-size: 12px; color: rgba(255,255,255,0.75); line-height: 1.6;"><div style="margin-bottom: 10px;"><strong>Sport:</strong> <strong>Mode:</strong> <!> <!></div> <div style="margin-bottom: 10px;"><strong> </strong> <!></div> <div style="margin-bottom: 10px;"><strong> </strong> <!></div> <!> <!></div>'),Qu=w('<div class="sub">No data captured yet</div>'),ed=w('<textarea readonly="" style="min-height: 100px; font-size: 10px; margin-top: 6px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy Chat</button>',1),td=w('<div class="sub" style="margin-top: 6px;">Capture a draft modal to generate</div>'),rd=w('<textarea readonly="" style="min-height: 100px; font-size: 10px; margin-top: 6px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy Structured</button>',1),nd=w('<div class="sub" style="margin-top: 6px;">Use Ask AI to generate</div>'),sd=w('<br/>Found: <span style="color: #22c55e;"> </span>',1),ad=w("Query: <strong> </strong> <!>",1),od=w("<br/> ",1),id=w("Player: <strong> </strong> <!>",1),ld=w('<div style="background: rgba(255,255,255,0.04); border-radius: 8px; padding: 10px; border-left: 3px solid var(--rsdh-accent);"><div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;"><span style="font-weight: 600; font-size: 12px; color: var(--rsdh-accent-light);"> </span></div> <div style="font-size: 11px; color: rgba(255,255,255,0.7);"><!></div></div>'),cd=w(`<div class="sub">Tool calls detected but couldn't parse details. Check Raw
                    Data.</div>`),ud=w('<div style="display: flex; flex-direction: column; gap: 8px;"><!> <!></div>'),dd=w('<div class="sub">No tools were called</div>'),fd=w('<div style="padding: 3px 0; font-size: 11px; display: flex; gap: 8px; align-items: baseline;"><span style="color: var(--rsdh-accent-light); min-width: 20px;"> </span> <span style="min-width: 140px; font-weight: 500;"> </span> <span style="color: rgba(255,255,255,0.5); font-size: 10px;"> <span style="color: #22c55e;"> </span></span></div>'),pd=w('<div style="margin-left: 12px; margin-top: 4px;"></div>'),vd=w('<span class="sub">None</span>'),hd=w('<div style="padding: 4px 0; font-size: 11px; display: flex; gap: 8px; align-items: baseline;"><span style="min-width: 70px; font-weight: 500;"> </span> <span> </span> <span style="color: rgba(255,255,255,0.5); font-size: 10px; flex: 1;"> </span></div>'),md=w('<div style="margin-left: 12px; margin-top: 4px;"></div>'),gd=w('<span class="sub">None</span>'),_d=w('<div style="font-size: 12px; color: rgba(255,255,255,0.75); line-height: 1.6;"><div style="margin-bottom: 12px;"><strong> </strong> <!></div> <div><strong>Bet Recommendations:</strong> <!></div></div>'),yd=w('<div class="sub">No response yet</div>'),bd=w('<div style="padding: 2px 0;"> </div>'),xd=w('<details class="timeline-step"><summary class="timeline-summary"><span class="timeline-icon success"></span> <span class="timeline-title">Web Search</span> <span class="timeline-status"> </span></summary> <div class="timeline-content"><div style="font-size: 11px; color: rgba(255,255,255,0.6);"></div></div></details>'),wd=w(`<div><div class="card" style="border-left: 3px solid var(--rsdh-accent);"><div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;"><span style="font-size: 18px;"></span> <span style="font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em;">TELEMETRY SUMMARY</span></div> <!></div> <div class="card"><div class="h" style="margin-bottom: 12px;"> Request Timeline</div> <details class="timeline-step" open><summary class="timeline-summary"><span> </span> <span class="timeline-title">1. Capture</span> <span class="timeline-status"><!></span></summary> <div class="timeline-content"><!></div></details> <details class="timeline-step"><summary class="timeline-summary"><span> </span> <span class="timeline-title">2. Prompt Built</span> <span class="timeline-status"> </span></summary> <div class="timeline-content"><div style="font-size: 11px; color: rgba(255,255,255,0.5); margin-bottom: 8px;">Two prompts are generated: <strong>Chat</strong> (for copy/paste
              to chatbots) and <strong>Structured</strong> (for OpenRouter with tool
              hints).</div> <details class="details" style="margin-bottom: 8px;"><summary style="font-size: 11px;"> Chat Prompt (for copy/paste)</summary> <!></details> <details class="details" open><summary style="font-size: 11px;"> Structured Prompt (for OpenRouter/API)</summary> <!></details></div></details> <details class="timeline-step"><summary class="timeline-summary"><span> </span> <span class="timeline-title">3. Tool Calls</span> <span class="timeline-status"><!></span></summary> <div class="timeline-content"><!></div></details> <details class="timeline-step"><summary class="timeline-summary"><span> </span> <span class="timeline-title">4. AI Response</span> <span class="timeline-status"><!></span></summary> <div class="timeline-content"><!></div></details> <!></div> <div class="card" style="background: rgba(255,255,255,0.04);"><div class="h" style="margin-bottom: 8px; font-size: 12px;"> Dev Options</div> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer;"><input type="checkbox"/> <span><strong>Force Profile Tool</strong> <span class="sub"> Makes AI call get_player_profile_stats</span></span></label> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 8px;"><input type="checkbox"/> <span><strong>Force Search Tool</strong> <span class="sub"> Makes AI call search_draft_players</span></span></label></div> <div class="card"><details class="details"><summary style="font-size: 13px; font-weight: 600;"> Raw Data</summary> <div style="margin-top: 12px;"><details class="details" style="margin-bottom: 8px;"><summary style="font-size: 12px;">Capture JSON</summary> <textarea readonly="" style="min-height: 100px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy</button></details> <details class="details" style="margin-bottom: 8px;"><summary style="font-size: 12px;">Tool Trace</summary> <textarea readonly="" style="min-height: 100px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy</button></details> <details class="details" style="margin-bottom: 8px;"><summary style="font-size: 12px;">AI Response JSON</summary> <textarea readonly="" style="min-height: 100px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy</button></details> <details class="details"><summary style="font-size: 12px;">Prompts</summary> <div class="sub" style="margin: 6px 0 4px;">Chat Prompt:</div> <textarea readonly="" style="min-height: 60px;"></textarea> <div class="sub" style="margin: 8px 0 4px;">Structured Prompt:</div> <textarea readonly="" style="min-height: 60px;"></textarea></details></div></details></div></div>`),Sd=w('<div class="panel"><div class="texture-overlay"></div> <div class="header"><div class="title"><i></i> BROADCAST COMMAND CENTER</div> <div class="flex-row"><!> <button class="secondary" style="width: auto; padding: 6px 10px;">EXIT</button></div></div> <div class="ticker-container"><div class="ticker-label">LIVE FEED</div> <div class="ticker-content"><!></div></div> <div class="tabs"><button>Context</button> <button>Results</button> <button>Settings</button> <!></div> <div><!></div> <div><!></div> <div><div class="card"><div class="h"><span>ACCOUNT IDENTITY</span></div> <!></div> <div class="card"><div class="h"><span>API ENDPOINT CONFIG</span></div> <!> <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 8px;"><div style="grid-column: span 2;"><label class="sub" for="or-model">Model</label> <input id="or-model" type="text" list="model-list"/> <!></div> <div><label class="sub" for="or-max">Max tokens</label> <input id="or-max" type="text"/></div> <div style="grid-column: span 2;"><label class="sub" for="or-temp"> </label> <input id="or-temp" type="range" min="0" max="2" step="0.1"/></div> <!></div> <label><input type="checkbox"/> <span><strong>Web Search</strong><br/><span class="sub">Search the web for current player news and updates</span></span></label> <!> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Player Profile Lookup</strong><br/><span class="sub">Allow AI to look up detailed player stats from their profile</span></span></label> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Draft Player Search</strong><br/><span class="sub">Allow AI to search for players not in the initial ~50 shown</span></span></label> <div style="margin-top: 16px;"><label class="sub" for="lineup-strategy">Lineup Strategy</label> <select id="lineup-strategy" style="width:100%; margin-top: 4px; padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.15); background: rgba(0,0,0,0.3); color: #fff; font-size: 13px;"><option> Safe - Consistent, high floor players</option><option> Balanced - Mix of floor and upside</option><option> Risky - Boom-or-bust, high ceiling</option></select> <div class="sub" style="margin-top: 4px;"><!></div></div></div> <div class="card"><details class="details" style="margin: -12px -14px; padding: 12px 14px;"><summary> Advanced</summary> <div style="margin-top: 12px;"><label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-bottom: 12px;"><input type="checkbox"/> <span><strong>Use my own API key</strong><br/><span class="sub">Bypass hosted proxy and call OpenRouter directly</span></span></label> <!> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Debug Mode</strong><br/><span class="sub">Show Debug tab with raw data and developer tools</span></span></label></div></details></div> <div style="display:flex; gap:8px; margin-top:14px;"><button style="display:flex; align-items:center; justify-content:center; gap:6px;"><span></span> Save Settings</button></div></div> <!></div>');function Ed(e,t){na(t,!1);let r=J("context"),n=J(""),s=J(""),a=J(""),i=J(!1),u=J(""),l=J(""),c=J(""),d=J(""),f=J(""),v=J(""),m="",x=J(""),k=J(!1),b=J(""),P=J(lr),D=J(Tn),$=J(String(kn)),z=J(an),te=!0,V=!0,H=J(!1),se=J(!1),M=J(!1),xe=J(!0),vr=J(!0),hr=J(!0),gt=J("balanced"),ce=J(null),Ie=J(null),we=J("");async function mr(){if(E(we,"Navigating to profile..."),!await dc()){E(we,"Could not find profile button. Are you on realsports.io?"),fr("Profile button not found");return}await new Promise(F=>setTimeout(F,800));const A=fc();A?(ic(A),E(Ie,A),E(we,""),fn(`Linked as @${A.username}`)):(E(we,"Could not find profile. Make sure you're logged in."),fr("Profile not found"))}function Rn(){lc(),E(Ie,null),uo("Account unlinked")}let Nn=J(Qc());function Yt(_){_==="debug"&&!o(k)&&(_="context"),E(r,_),Ts({tab:_})}yl(()=>{const _=As();E(k,ur()),E(r,_.tab==="debug"&&!o(k)?"context":_.tab),E(s,sc()),E(n,o(s)),zt(),E(b,String(I(ls,"")||"")),E(P,String(I(cs,lr)||lr)),E(D,parseFloat(String(I(us,Tn)))||Tn),E($,String(I(ds,kn))),E(z,parseInt(String(I(fs,an)),10)||an),te=String(I(En,!0))==="1"||I(En,!0)===!0,V=String(I(An,!0))==="1"||I(An,!0)===!0,E(H,String(I(ln,"0"))==="1"||I(ln,"0")===!0),E(se,String(I(cn,"0"))==="1"||I(cn,"0")===!0),E(M,String(I(cr,"0"))==="1"||I(cr,"0")===!0),E(xe,I(un,"1")!=="0"),E(vr,I(vs,"1")!=="0"),E(hr,I(dn,"1")!=="0"),E(gt,String(I(hs,"balanced")||"balanced")),E(Ie,_s()),Zc().then(K=>{E(Nn,K)}),on&&Cn&&fetch(`${Cn}/api/info`).then(K=>K.json()).then(K=>{E(ce,K)}).catch(()=>{});const A=K=>{};document.addEventListener("click",A,!0);const F=K=>{const N=K.detail;if(N?.raw){try{const G=JSON.parse(N.raw);if(G?.ok===!0){E(n,N.raw),E(s,N.raw),E(l,""),E(v,""),E(f,"");try{E(c,ac(N.raw))}catch{E(c,"")}try{E(d,oc(N.raw))}catch{E(d,"")}zt(),E(r,"context");return}if(G&&Array.isArray(G.lineup)&&Array.isArray(G.bets)){E(l,N.raw);try{const Se=JSON.parse(localStorage.getItem(ps)||"[]");E(f,Array.isArray(Se)?Se.join(`
`):String(Se))}catch{E(f,"")}try{E(v,String(localStorage.getItem(Qa)||""))}catch{E(v,"")}try{m=String(localStorage.getItem(Pn)||"")}catch{m=""}E(x,go(G,o(f)?o(f).split(`
`):[])),E(r,"results");return}}catch{}E(n,N.raw),zt(),E(r,"context")}},j=()=>{try{m=String(localStorage.getItem(Pn)||"")}catch{m=""}};return window.addEventListener("rsdh-output",F),window.addEventListener("rsdh-debug-events",j),()=>{document.removeEventListener("click",A,!0),window.removeEventListener("rsdh-output",F),window.removeEventListener("rsdh-debug-events",j)}});function zt(){const _=(o(n)||"").trim();if(!_){E(a,'<div class="card"><div class="h">Output</div><div class="sub">Capture a draft modal or run Ask AI.</div></div>');return}try{const A=JSON.parse(_);if(A&&A.ok===!0){E(a,Fc(A));return}if(A&&Array.isArray(A.lineup)&&Array.isArray(A.bets)){let F=[];try{F=JSON.parse(localStorage.getItem(ps)||"[]")||[]}catch{}E(a,go(A,F));return}}catch{}E(a,`<div class="card"><div class="h">Output</div><pre class="code-output">${_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</pre></div>`)}function _t(_){try{GM_setClipboard(_),fn("Copied to clipboard!")}catch(A){const F=`Copy failed: ${String(A?.message||A)}`;fr(F)}}function pn(){const _=parseInt(o($),10);if(isNaN(_)||_<1){E($,"1"),fr("Max tokens must be at least 1");return}o(b).trim()&&o(b).trim()!=="********"&&Fe(ls,o(b).trim()),Fe(cs,(o(P)||lr).trim()),Fe(us,String(o(D))),Fe(ds,String(_)),Fe(fs,String(o(z))),Fe(En,te?"1":"0"),Fe(An,V?"1":"0"),Fe(ln,o(H)?"1":"0"),Fe(cn,o(se)?"1":"0"),Fe(cr,o(M)?"1":"0"),Fe(un,o(xe)?"1":"0"),Fe(vs,o(vr)?"1":"0"),Fe(dn,o(hr)?"1":"0"),Gl(o(k)),!o(k)&&o(r)==="debug"&&Yt("context"),fn("Settings saved!")}Nl();var Ht=Sd(),Ir=h(p(Ht),2),jt=h(p(Ir),2),Mr=p(jt);{var ks=_=>{var A=eu();y(_,A)};C(Mr,_=>{o(i)&&_(ks)})}var In=h(Mr,2),Mn=h(Ir,2),R=h(p(Mn),2),Cs=p(R);{var re=_=>{const A=pt(()=>JSON.parse(o(s)));var F=ot(),j=ee(F);{var K=N=>{var G=ot(),Se=ee(G);Ct(Se,1,()=>o(A).player_pool.slice(0,10),kt,(Dr,Kt)=>{var Fr=tu(),Br=ee(Fr),$r=p(Br);O(()=>T($r,`${o(Kt).name??""} (${o(Kt).boost_x??0??""}x)`)),y(Dr,Fr)}),y(N,G)};C(j,N=>{o(A).player_pool&&N(K)})}y(_,F)},Ps=_=>{var A=ru();y(_,A)};C(Cs,_=>{o(s)?_(re):_(Ps,!1)})}var ko=h(Mn,2),Os=p(ko),Rs=h(Os,2),Ns=h(Rs,2),Pd=h(Ns,2);{var Od=_=>{var A=nu();O(()=>tt(A,1,`tab ${o(r)==="debug"?"active":""}`)),fe("click",A,()=>Yt("debug")),y(_,A)};C(Pd,_=>{o(k)&&_(Od)})}var Is=h(ko,2),Rd=p(Is);{var Nd=_=>{var A=su(),F=h(p(A),2),j=p(F);O(()=>T(j,o(u))),y(_,A)},Id=_=>{var A=ot(),F=ee(A);{var j=N=>{var G=au(),Se=p(G);Ya(Se,()=>o(a)),y(N,G)},K=N=>{var G=ou();y(N,G)};C(F,N=>{o(a)?N(j):N(K,!1)},!0)}y(_,A)};C(Rd,_=>{o(i)?_(Nd):_(Id,!1)})}var Ms=h(Is,2),Md=p(Ms);{var Ld=_=>{var A=iu(),F=h(p(A),2),j=p(F);O(()=>T(j,o(u))),y(_,A)},Dd=_=>{var A=ot(),F=ee(A);{var j=N=>{var G=lu(),Se=p(G);Ya(Se,()=>o(x)),y(N,G)},K=N=>{var G=cu();y(N,G)};C(F,N=>{o(x)?N(j):N(K,!1)},!0)}y(_,A)};C(Md,_=>{o(i)?_(Ld):_(Dd,!1)})}var Ls=h(Ms,2),Co=p(Ls),Fd=h(p(Co),2);{var Bd=_=>{var A=vu(),F=ee(A),j=p(F);{var K=Pe=>{var nt=uu();O(()=>Ha(nt,"src",o(Ie).avatarUrl)),y(Pe,nt)},N=Pe=>{var nt=du();y(Pe,nt)};C(j,Pe=>{o(Ie).avatarUrl?Pe(K):Pe(N,!1)})}var G=h(j,2),Se=p(G);{var Dr=Pe=>{var nt=fu(),vn=p(nt);O(()=>T(vn,o(Ie).displayName)),y(Pe,nt)};C(Se,Pe=>{o(Ie).displayName&&o(Ie).displayName!==o(Ie).username&&Pe(Dr)})}var Kt=h(Se,2),Fr=p(Kt),Br=h(F,2),$r=p(Br),qs=h($r,2),Us=h(Br,2);{var Gs=Pe=>{var nt=pu(),vn=p(nt);O(()=>T(vn,o(we))),y(Pe,nt)};C(Us,Pe=>{o(we)&&Pe(Gs)})}O(()=>T(Fr,`@${o(Ie).username??""}`)),fe("click",$r,mr),fe("click",qs,Rn),y(_,A)},$d=_=>{var A=mu(),F=h(ee(A),2),j=h(F,2);{var K=N=>{var G=hu(),Se=p(G);O(()=>T(Se,o(we))),y(N,G)};C(j,N=>{o(we)&&N(K)})}fe("click",F,mr),y(_,A)};C(Fd,_=>{o(Ie)?_(Bd):_($d,!1)})}var Po=h(Co,2),Oo=h(p(Po),2);{var qd=_=>{var A=gu(),F=h(ee(A),4);Ka(F,()=>o(b),j=>E(b,j)),y(_,A)};C(Oo,_=>{on||_(qd)})}var Ro=h(Oo,2),No=p(Ro),Lr=h(p(No),2),Ud=h(Lr,2);{var Gd=_=>{var A=yu();Ct(A,5,()=>o(Nn),kt,(F,j)=>{var K=_u(),N=p(K),G={};O(()=>{T(N,o(j)),G!==(G=o(j))&&(K.value=(K.__value=o(j))??"")}),y(F,K)}),y(_,A)};C(Ud,_=>{o(M)&&_(Gd)})}var Io=h(No,2),Ln=h(p(Io),2),Mo=h(Io,2),Lo=p(Mo),Yd=p(Lo),Dn=h(Lo,2),zd=h(Mo,2);{var Hd=_=>{var A=bu();y(_,A)};C(zd,_=>{o(M)||_(Hd)})}var Ds=h(Ro,2),Fs=p(Ds),Do=h(Ds,2);{var jd=_=>{var A=xu(),F=p(A),j=p(F),K=h(F,2);O(()=>{Pt(A,`margin-top:8px; margin-left: 28px; ${o(M)?"":"opacity: 0.6;"}`),T(j,`Max results: ${(!o(M)&&o(ce)?.webMaxResults!==void 0?o(ce).webMaxResults:o(z))??""}`),it(K,!o(M)&&o(ce)?.webMaxResults!==void 0?o(ce).webMaxResults:o(z)),K.disabled=!o(M)}),fe("input",K,N=>o(M)&&E(z,parseInt(N.target.value,10))),y(_,A)};C(Do,_=>{(!o(M)&&o(ce)?.enableWebSearch!==void 0?o(ce).enableWebSearch:o(vr))&&_(jd)})}var Fo=h(Do,2),Kd=p(Fo),Bo=h(Fo,2),Jd=p(Bo),Wd=h(Bo,2),Fn=h(p(Wd),2);O(()=>{o(gt),sl(()=>{})});var Bs=p(Fn);Bs.value=Bs.__value="safe";var $s=h(Bs);$s.value=$s.__value="balanced";var $o=h($s);$o.value=$o.__value="risky";var Vd=h(Fn,2),Xd=p(Vd);{var Zd=_=>{var A=ze("Prioritizes consistent performers for reliable results");y(_,A)},Qd=_=>{var A=ot(),F=ee(A);{var j=N=>{var G=ze("Targets high upside players for ceiling plays");y(N,G)},K=N=>{var G=ze("Default strategy balancing consistency and upside");y(N,G)};C(F,N=>{o(gt)==="risky"?N(j):N(K,!1)},!0)}y(_,A)};C(Xd,_=>{o(gt)==="safe"?_(Zd):_(Qd,!1)})}var qo=h(Po,2),ef=p(qo),tf=h(p(ef),2),Uo=p(tf),rf=p(Uo),Go=h(Uo,2);{var nf=_=>{var A=wu(),F=h(ee(A),2);Ka(F,()=>o(b),j=>E(b,j)),y(_,A)};C(Go,_=>{o(M)&&_(nf)})}var sf=h(Go,2),af=p(sf),of=h(qo,2),lf=p(of),cf=h(Ls,2);{var uf=_=>{var A=wd(),F=p(A),j=h(p(F),2);{var K=S=>{const g=pt(()=>(()=>{try{return JSON.parse(o(s))}catch{return null}})());var X=ot(),Be=ee(X);{var Ot=ae=>{var B=ku(),oe=ee(B),he=p(oe),yt=p(he),Rt=p(yt),Jt=h(he,2);{var gr=Z=>{var de=Su(),Ee=p(de);O(()=>{Pt(de,`color: ${o(g).draft_type==="game"?"#f59e0b":"inherit"};`),T(Ee,o(g).draft_type==="game"?" Game Draft":" League Draft")}),y(Z,de)};C(Jt,Z=>{o(g).draft_type&&Z(gr)})}var Nt=h(Jt,2),Wt=p(Nt),je=h(Nt,2),ie=p(je),me=h(je,2);{var lt=Z=>{var de=Eu(),Ee=p(de);O(()=>T(Ee,` ${o(g).game_matchup.team1??""} vs ${o(g).game_matchup.team2??""}`)),y(Z,de)},pe=Z=>{var de=ot(),Ee=ee(de);{var ct=It=>{var q=Au(),le=p(q);O(()=>T(le,` ${o(g).games.length??""} games`)),y(It,q)};C(Ee,It=>{o(g).games?.length&&It(ct)},!0)}y(Z,de)};C(me,Z=>{o(g).game_matchup?Z(lt):Z(pe,!1)})}var _e=h(me,2);{var ge=Z=>{var de=Tu(),Ee=p(de);O(()=>T(Ee,`${o(g).game_entries_remaining??""} entries left`)),y(Z,de)};C(_e,Z=>{typeof o(g).game_entries_remaining=="number"&&Z(ge)})}var Oe=h(oe,2),Ke=p(Oe);O(Z=>{T(Rt,o(g).sport||"Unknown"),T(Wt,` ${(o(g).player_pool_count||o(g).player_pool?.length||"?")??""} players`),T(ie,` ${(o(g).slots?.length||o(g).expected_slots||"?")??""} slots`),T(Ke,`Captured: ${Z??""}`)},[()=>o(g).captured_at?new Date(o(g).captured_at).toLocaleTimeString():"Unknown"]),y(ae,B)},He=ae=>{var B=Cu();y(ae,B)};C(Be,ae=>{o(g)?ae(Ot):ae(He,!1)})}y(S,X)},N=S=>{var g=Pu();y(S,g)};C(j,S=>{o(s)?S(K):S(N,!1)})}var G=h(F,2),Se=h(p(G),2),Dr=p(Se),Kt=p(Dr),Fr=p(Kt),Br=h(Kt,4),$r=p(Br);{var qs=S=>{const g=pt(()=>(()=>{try{return JSON.parse(o(n))}catch{return null}})());var X=ze();O(()=>T(X,`${(o(g)?.player_pool_count||o(g)?.player_pool?.length||"?")??""} players,
                ${(o(g)?.slots?.length||"?")??""} slots`)),y(S,X)},Us=S=>{var g=ze("Pending");y(S,g)};C($r,S=>{o(n)?S(qs):S(Us,!1)})}var Gs=h(Dr,2),Pe=p(Gs);{var nt=S=>{const g=pt(()=>(()=>{try{return JSON.parse(o(n))}catch{return null}})());var X=ot(),Be=ee(X);{var Ot=He=>{var ae=Zu(),B=p(ae),oe=h(p(B)),he=h(oe,2),yt=h(he);{var Rt=q=>{var le=Ou(),$e=h(ee(le),3),qe=p($e);O(()=>{Pt($e,`color: ${o(g).draft_type==="game"?"#f59e0b":"inherit"};`),T(qe,o(g).draft_type==="game"?" Game":" League")}),y(q,le)};C(yt,q=>{o(g).draft_type&&q(Rt)})}var Jt=h(yt,2);{var gr=q=>{var le=Ru(),$e=h(ee(le)),qe=p($e);O(()=>T(qe,`${o(g).game_entries_remaining??""} entries left`)),y(q,le)};C(Jt,q=>{typeof o(g).game_entries_remaining=="number"&&q(gr)})}var Nt=h(B,2),Wt=p(Nt),je=p(Wt),ie=h(Wt,2);{var me=q=>{var le=Lu();Ct(le,5,()=>o(g).slots,kt,($e,qe,Vt)=>{var Je=Mu(),Ae=p(Je);Ae.nodeValue=`${Vt+1}. `;var ut=h(Ae),We=p(ut),Re=h(ut,2);{var st=Ve=>{var bt=Nu(),Mt=h(ee(bt)),Ue=p(Mt);O(()=>T(Ue,o(qe).selection)),y(Ve,bt)},Xt=Ve=>{var bt=Iu();y(Ve,bt)};C(Re,Ve=>{o(qe).selection?Ve(st):Ve(Xt,!1)})}O(()=>T(We,`${o(qe).multiplier??""}x`)),y($e,Je)}),y(q,le)},lt=q=>{var le=Du();y(q,le)};C(ie,q=>{o(g).slots?.length?q(me):q(lt,!1)})}var pe=h(Nt,2),_e=p(pe),ge=p(_e),Oe=h(_e,2);{var Ke=q=>{var le=qu(),$e=p(le);Ct($e,1,()=>o(g).player_pool.slice(0,15),kt,(Je,Ae)=>{var ut=Bu(),We=p(ut),Re=p(We),st=h(We,2),Xt=p(st),Ve=h(st,2);{var bt=Mt=>{var Ue=Fu(),Lt=p(Ue);O(()=>{Pt(Ue,`color: ${o(Ae).status==="Out"?"#ef4444":"#f59e0b"}; font-size: 10px;`),T(Lt,o(Ae).status)}),y(Mt,Ue)};C(Ve,Mt=>{o(Ae).status&&o(Ae).status!=="Active"&&Mt(bt)})}O(()=>{T(Re,o(Ae).name),T(Xt,`+${o(Ae).boost_x??0??""}x`)}),y(Je,ut)});var qe=h($e,2);{var Vt=Je=>{var Ae=$u(),ut=p(Ae);O(()=>T(ut,`...and ${o(g).player_pool.length-15} more`)),y(Je,Ae)};C(qe,Je=>{o(g).player_pool.length>15&&Je(Vt)})}y(q,le)},Z=q=>{var le=Uu();y(q,le)};C(Oe,q=>{o(g).player_pool?.length?q(Ke):q(Z,!1)})}var de=h(pe,2);{var Ee=q=>{var le=ju(),$e=h(p(le),2),qe=p($e),Vt=p(qe),Je=p(Vt),Ae=h(Vt,2);{var ut=Q=>{var ve=Gu(),_r=p(ve);O(()=>T(_r,`(${o(g).game_matchup.team1_record??""})`)),y(Q,ve)};C(Ae,Q=>{o(g).game_matchup.team1_record&&Q(ut)})}var We=h(Ae,2);{var Re=Q=>{var ve=Yu(),_r=p(ve);O(()=>T(_r,o(g).game_matchup.team1_score)),y(Q,ve)};C(We,Q=>{o(g).game_matchup.team1_score!==null&&o(g).game_matchup.team1_score!==void 0&&Q(Re)})}var st=h(We,4),Xt=p(st),Ve=h(st,2);{var bt=Q=>{var ve=zu(),_r=p(ve);O(()=>T(_r,`(${o(g).game_matchup.team2_record??""})`)),y(Q,ve)};C(Ve,Q=>{o(g).game_matchup.team2_record&&Q(bt)})}var Mt=h(Ve,2);{var Ue=Q=>{var ve=Hu(),_r=p(ve);O(()=>T(_r,o(g).game_matchup.team2_score)),y(Q,ve)};C(Mt,Q=>{o(g).game_matchup.team2_score!==null&&o(g).game_matchup.team2_score!==void 0&&Q(Ue)})}var Lt=h(qe,2),qr=p(Lt);{var js=Q=>{var ve=ze();O(()=>T(ve,`@ ${o(g).game_matchup.time??""}`)),y(Q,ve)};C(qr,Q=>{o(g).game_matchup.time&&Q(js)})}var Ur=h(qr,2);{var Bn=Q=>{var ve=ze();O(()=>T(ve,` ${o(g).game_matchup.spread??""}`)),y(Q,ve)};C(Ur,Q=>{o(g).game_matchup.spread&&Q(Bn)})}var Ks=h(Ur,2);{var Qf=Q=>{var ve=ze();O(()=>T(ve,` ${o(g).game_matchup.status==="finished"?"Final":"Live"}`)),y(Q,ve)};C(Ks,Q=>{o(g).game_matchup.status!=="upcoming"&&Q(Qf)})}O(()=>{T(Je,o(g).game_matchup.team1),T(Xt,o(g).game_matchup.team2)}),y(q,le)};C(de,q=>{o(g).game_matchup&&q(Ee)})}var ct=h(de,2);{var It=q=>{var le=Xu(),$e=p(le),qe=p($e),Vt=h($e,2),Je=p(Vt);Ct(Je,1,()=>o(g).games.slice(0,6),kt,(We,Re)=>{var st=Wu(),Xt=p(st),Ve=h(Xt);{var bt=Ue=>{var Lt=Ku(),qr=p(Lt);O(()=>T(qr,`@ ${o(Re).time??""}`)),y(Ue,Lt)},Mt=Ue=>{var Lt=ot(),qr=ee(Lt);{var js=Ur=>{var Bn=Ju(),Ks=p(Bn);O(()=>T(Ks,`(Final${o(Re).score?`: ${o(Re).score}`:""})`)),y(Ur,Bn)};C(qr,Ur=>{o(Re).status==="finished"&&Ur(js)},!0)}y(Ue,Lt)};C(Ve,Ue=>{o(Re).time?Ue(bt):Ue(Mt,!1)})}O(()=>T(Xt,`${o(Re).team1??""} vs ${o(Re).team2??""} `)),y(We,st)});var Ae=h(Je,2);{var ut=We=>{var Re=Vu(),st=p(Re);O(()=>T(st,`...and ${o(g).games.length-6} more`)),y(We,Re)};C(Ae,We=>{o(g).games.length>6&&We(ut)})}O(()=>T(qe,`Games (${o(g).games.length??""}):`)),y(q,le)};C(ct,q=>{o(g).games?.length&&q(It)})}O(()=>{T(oe,` ${(o(g).sport||"Unknown")??""} (${(o(g).sport_detection_method||"unknown")??""}) | `),T(he,` ${(o(g).mode||"unknown")??""} `),T(je,`Slots (${(o(g).slots?.length||0)??""}):`),T(ge,`Player Pool (${(o(g).player_pool?.length||o(g).player_pool_count||0)??""}):`)}),y(He,ae)};C(Be,He=>{o(g)&&He(Ot)})}y(S,X)},vn=S=>{var g=Qu();y(S,g)};C(Pe,S=>{o(n)?S(nt):S(vn,!1)})}var Yo=h(Se,2),zo=p(Yo),Ys=p(zo),df=p(Ys),ff=h(Ys,4),pf=p(ff),vf=h(zo,2),Ho=h(p(vf),2),hf=h(p(Ho),2);{var mf=S=>{var g=ed(),X=ee(g),Be=h(X,2);O(()=>it(X,o(c))),fe("click",Be,()=>_t(o(c))),y(S,g)},gf=S=>{var g=td();y(S,g)};C(hf,S=>{o(c)?S(mf):S(gf,!1)})}var _f=h(Ho,2),yf=h(p(_f),2);{var bf=S=>{var g=rd(),X=ee(g),Be=h(X,2);O(()=>it(X,o(d))),fe("click",Be,()=>_t(o(d))),y(S,g)},xf=S=>{var g=nd();y(S,g)};C(yf,S=>{o(d)?S(bf):S(xf,!1)})}var jo=h(Yo,2),Ko=p(jo),zs=p(Ko),wf=p(zs),Sf=h(zs,4),Ef=p(Sf);{var Af=S=>{const g=pt(()=>(o(v).match(/tool_call/g)||[]).length);var X=ze();O(()=>T(X,`${o(g)??""} call${o(g)!==1?"s":""}`)),y(S,X)},Tf=S=>{var g=ze("None");y(S,g)};C(Ef,S=>{o(v)&&o(v).includes("tool_call")?S(Af):S(Tf,!1)})}var kf=h(Ko,2),Cf=p(kf);{var Pf=S=>{const g=pt(()=>(()=>{const ae=[];try{const B=JSON.parse(o(v));if(Array.isArray(B))for(const oe of B)oe.kind==="tool_call"&&ae.push({name:oe.name||"Unknown",args:oe.args||oe.arguments||{},result:oe.result||null})}catch{const B=o(v).split(`
`);for(const oe of B)if(oe.includes('"kind": "tool_call"')||oe.includes('"name":'))try{const he=JSON.parse(oe);he.name&&ae.push({name:he.name,args:he.args||he.arguments||{},result:he.result})}catch{}}return ae})());var X=ud(),Be=p(X);Ct(Be,1,()=>o(g),kt,(ae,B)=>{var oe=ld(),he=p(oe),yt=p(he),Rt=p(yt),Jt=h(he,2),gr=p(Jt);{var Nt=je=>{var ie=ad(),me=h(ee(ie)),lt=p(me),pe=h(me,2);{var _e=ge=>{var Oe=sd(),Ke=h(ee(Oe),2),Z=p(Ke);O(()=>T(Z,`${o(B).result?.players_found??o(B).result?.length??"?"??""} players`)),y(ge,Oe)};C(pe,ge=>{o(B).result&&ge(_e)})}O(()=>T(lt,`"${(o(B).args?.query||"N/A")??""}"`)),y(je,ie)},Wt=je=>{var ie=ot(),me=ee(ie);{var lt=_e=>{var ge=id(),Oe=h(ee(ge)),Ke=p(Oe),Z=h(Oe,2);{var de=Ee=>{var ct=od(),It=h(ee(ct));O(()=>T(It,`Team: ${(o(B).result.header.team||"N/A")??""} | Pos: ${(o(B).result.header.position||"N/A")??""}`)),y(Ee,ct)};C(Z,Ee=>{o(B).result?.header&&Ee(de)})}O(()=>T(Ke,o(B).args?.player_name||"N/A")),y(_e,ge)},pe=_e=>{var ge=ze();O(Oe=>T(ge,`Args: ${Oe??""}`),[()=>JSON.stringify(o(B).args).slice(0,100)]),y(_e,ge)};C(me,_e=>{o(B).name==="get_player_profile_stats"?_e(lt):_e(pe,!1)},!0)}y(je,ie)};C(gr,je=>{o(B).name==="search_draft_players"?je(Nt):je(Wt,!1)})}O(()=>T(Rt,`${o(B).name==="search_draft_players"?"":""}
                        ${o(B).name??""}`)),y(ae,oe)});var Ot=h(Be,2);{var He=ae=>{var B=cd();y(ae,B)};C(Ot,ae=>{o(g).length===0&&ae(He)})}y(S,X)},Of=S=>{var g=dd();y(S,g)};C(Cf,S=>{o(v)&&o(v).includes("tool_call")?S(Pf):S(Of,!1)})}var Jo=h(jo,2),Wo=p(Jo),Hs=p(Wo),Rf=p(Hs),Nf=h(Hs,4),If=p(Nf);{var Mf=S=>{const g=pt(()=>(()=>{try{return JSON.parse(o(l))}catch{return null}})());var X=ze();O(()=>T(X,`${(o(g)?.lineup?.length||"?")??""} players, ${(o(g)?.bets?.length||"?")??""} bets`)),y(S,X)},Lf=S=>{var g=ze("Pending");y(S,g)};C(If,S=>{o(l)?S(Mf):S(Lf,!1)})}var Df=h(Wo,2),Ff=p(Df);{var Bf=S=>{const g=pt(()=>(()=>{try{return JSON.parse(o(l))}catch{return null}})());var X=ot(),Be=ee(X);{var Ot=He=>{var ae=_d(),B=p(ae),oe=p(B),he=p(oe),yt=h(oe,2);{var Rt=ie=>{var me=pd();Ct(me,5,()=>o(g).lineup,kt,(lt,pe,_e)=>{var ge=fd(),Oe=p(ge),Ke=p(Oe),Z=h(Oe,2),de=p(Z),Ee=h(Z,2),ct=p(Ee),It=h(ct),q=p(It);O(()=>{T(Ke,`S${o(pe).slot_index??_e+1??""}`),T(de,o(pe).player||"N/A"),T(ct,`${o(pe).slot_multiplier??"?"??""}x slot + ${o(pe).player_boost_x??0??""}x boost = `),T(q,`${o(pe).effective_multiplier??"?"??""}x`)}),y(lt,ge)}),y(ie,me)},Jt=ie=>{var me=vd();y(ie,me)};C(yt,ie=>{o(g).lineup?.length?ie(Rt):ie(Jt,!1)})}var gr=h(B,2),Nt=h(p(gr),2);{var Wt=ie=>{var me=md();Ct(me,5,()=>o(g).bets,kt,(lt,pe)=>{var _e=hd(),ge=p(_e),Oe=p(ge),Ke=h(ge,2),Z=p(Ke),de=h(Ke,2),Ee=p(de);O(ct=>{T(Oe,o(pe).tier||"N/A"),Pt(Ke,`font-weight: 600; color: ${o(pe).recommend?"#22c55e":"#ef4444"}; min-width: 30px;`),T(Z,o(pe).recommend?"YES":"NO"),T(Ee,`${ct??""}${o(pe).reason?.length>60?"...":""}`)},[()=>o(pe).reason?.slice(0,60)||""]),y(lt,_e)}),y(ie,me)},je=ie=>{var me=gd();y(ie,me)};C(Nt,ie=>{o(g).bets?.length?ie(Wt):ie(je,!1)})}O(()=>T(he,`Lineup (${(o(g).lineup?.length||0)??""} players):`)),y(He,ae)};C(Be,He=>{o(g)&&He(Ot)})}y(S,X)},$f=S=>{var g=yd();y(S,g)};C(Ff,S=>{o(l)?S(Bf):S($f,!1)})}var qf=h(Jo,2);{var Uf=S=>{var g=xd(),X=p(g),Be=h(p(X),4),Ot=p(Be),He=h(X,2),ae=p(He);Ct(ae,5,()=>o(f).split(`
`).filter(B=>B.trim()).slice(0,5),kt,(B,oe)=>{var he=bd(),yt=p(he);O(Rt=>T(yt,` ${Rt??""}${o(oe).length>60?"...":""}`),[()=>o(oe).slice(0,60)]),y(B,he)}),O(B=>T(Ot,`${B??""} sources`),[()=>o(f).split(`
`).filter(B=>B.trim()).length]),y(S,g)};C(qf,S=>{o(f)&&S(Uf)})}var Vo=h(G,2),Xo=h(p(Vo),2),Gf=p(Xo),Yf=h(Xo,2),zf=p(Yf),Hf=h(Vo,2),jf=p(Hf),Kf=h(p(jf),2),Zo=p(Kf),Qo=h(p(Zo),2),Jf=h(Qo,2),ei=h(Zo,2),ti=h(p(ei),2),Wf=h(ti,2),ri=h(ei,2),ni=h(p(ri),2),Vf=h(ni,2),Xf=h(ri,2),si=h(p(Xf),4),Zf=h(si,4);O((S,g)=>{tt(A,1,`view ${o(r)==="debug"?"":"hidden"}`),tt(Kt,1,`timeline-icon ${o(n)?"success":""}`),T(Fr,o(n)?"":""),tt(Ys,1,`timeline-icon ${o(d)?"success":""}`),T(df,o(d)?"":""),T(pf,o(d)?`${o(d).length} chars`:"Pending"),tt(zs,1,`timeline-icon ${S??""}`),T(wf,g),tt(Hs,1,`timeline-icon ${o(l)?"success":""}`),T(Rf,o(l)?"":""),it(Qo,o(n)||"(No capture data)"),it(ti,o(v)||"(No tool calls)"),it(ni,o(l)||"(No AI response)"),it(si,o(c)||"(No chat prompt)"),it(Zf,o(d)||"(No structured prompt)")},[()=>o(v)&&o(v).includes("tool_call")?"success":"",()=>o(v)&&o(v).includes("tool_call")?"":""]),Cr(Gf,()=>o(H),S=>E(H,S)),Cr(zf,()=>o(se),S=>E(se,S)),fe("click",Jf,()=>_t(o(n))),fe("click",Wf,()=>_t(o(v))),fe("click",Vf,()=>_t(o(l))),y(_,A)};C(cf,_=>{o(k)&&_(uf)})}O(_=>{tt(Os,1,`tab ${o(r)==="context"?"active":""}`),tt(Rs,1,`tab ${o(r)==="results"?"active":""}`),tt(Ns,1,`tab ${o(r)==="settings"?"active":""}`),tt(Is,1,`view ${o(r)==="context"?"":"hidden"}`),tt(Ms,1,`view ${o(r)==="results"?"":"hidden"}`),tt(Ls,1,`view ${o(r)==="settings"?"":"hidden"}`),Pt(Lr,`width:100%; margin-bottom:8px; ${o(M)?"":"opacity: 0.6; font-style: italic;"}`),it(Lr,!o(M)&&o(ce)?.defaultModel?o(ce).defaultModel==="any"?"Dynamic Selection":o(ce).defaultModel:o(P)),Ha(Lr,"placeholder",o(M)?"Start typing to search...":"Managed by Admin"),Lr.disabled=!o(M),Pt(Ln,`width:100%; ${o(M)?"":"opacity: 0.6;"}`),it(Ln,_),Ln.disabled=!o(M),T(Yd,`Temperature: ${(!o(M)&&o(ce)?.temperature!==void 0?o(ce).temperature:o(D))??""}`),Pt(Dn,`width:100%; ${o(M)?"":"opacity: 0.6;"}`),it(Dn,!o(M)&&o(ce)?.temperature!==void 0?o(ce).temperature:o(D)),Dn.disabled=!o(M),Pt(Ds,`display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px; ${o(M)?"":"opacity: 0.6;"}`),Ol(Fs,!o(M)&&o(ce)?.enableWebSearch!==void 0?o(ce).enableWebSearch:o(vr)),Fs.disabled=!o(M)},[()=>!o(M)&&o(ce)?.maxTokens?String(o(ce).maxTokens):o($)]),fe("click",In,()=>Ts({hidden:!0})),fe("click",Os,()=>Yt("context")),fe("click",Rs,()=>Yt("results")),fe("click",Ns,()=>Yt("settings")),fe("input",Lr,_=>o(M)&&E(P,_.target.value)),fe("input",Ln,_=>o(M)&&E($,_.target.value)),fe("input",Dn,_=>o(M)&&E(D,parseFloat(_.target.value))),fe("change",Fs,_=>o(M)&&E(vr,_.target.checked)),Cr(Kd,()=>o(xe),_=>E(xe,_)),Cr(Jd,()=>o(hr),_=>E(hr,_)),kl(Fn,()=>o(gt),_=>E(gt,_)),fe("change",Fn,()=>Fe(hs,o(gt))),Cr(rf,()=>o(M),_=>E(M,_)),Cr(af,()=>o(k),_=>E(k,_)),fe("click",lf,pn),y(e,Ht),sa()}function Ad(){const e="rsdh-svelte-root";let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,document.documentElement.appendChild(t)),t}function Td(e){const t="rsdh-svelte-handle";let r=e.getElementById(t);return r||(r=document.createElement("button"),r.id=t,r.className="fab",r.type="button",r.title="Open Draft Helper",r.setAttribute("aria-label","Open Draft Helper"),r.style.cssText=`
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 2147483647;
      width: 50px;
      height: 50px;
      border-radius: 4px;
      background: rgba(18, 18, 26, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: #00E5FF;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
      transition: all 0.2s ease;
    `,r.innerHTML=`
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 2l1.2 4.3L17.5 8l-4.3 1.2L12 13.5l-1.2-4.3L6.5 8l4.3-1.7L12 2Z" fill="currentColor" opacity="0.95"/>
        <path d="M19 11l.8 2.8L22.6 15l-2.8.8L19 18.6l-.8-2.8L15.4 15l2.8-1.2L19 11Z" fill="currentColor" opacity="0.85"/>
      </svg>
    `,r.addEventListener("click",()=>Ts({hidden:!1})),r.addEventListener("mouseenter",()=>{r.style.background="#00E5FF",r.style.color="#000"}),r.addEventListener("mouseleave",()=>{r.style.background="rgba(18, 18, 26, 0.95)",r.style.color="#00E5FF"}),e.appendChild(r)),r}function To(e,t,r){e.style.display=r?"none":"",t.style.display=r?"":"none"}function kd(e){const t=()=>{const r=vc();r&&e.style.setProperty("--rsdh-accent",r)};t();try{setInterval(t,5e3)}catch{}}function Cd(){const e=Ad(),t=e.shadowRoot??e.attachShadow({mode:"open"}),r="rsdh-style";if(!t.getElementById(r)){const u=document.createElement("style");u.id=r,u.textContent=ai,t.appendChild(u)}const n=Td(t),s="app";let a=t.getElementById(s);a||(a=document.createElement("div"),a.id=s,t.appendChild(a)),hl(Ed,{target:a});const i=As();To(a,n,!!i.hidden),window.addEventListener("rsdh-ui-state",u=>{const l=u.detail;l&&typeof l.hidden=="boolean"&&To(a,n,l.hidden)}),kd(e)}Cd(),Wc()})();
