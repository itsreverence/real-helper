// ==UserScript==
// @name         RealSports Draft Helper
// @namespace    local.realsports.drafthelper
// @version      0.9.74
// @description  RealSports Draft Helper (Svelte + TypeScript)
// @homepageURL  https://github.com/itsreverence/real-helper
// @supportURL   https://github.com/itsreverence/real-helper/issues
// @downloadURL  https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @updateURL    https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @match        https://realsports.io/*
// @run-at       document-idle
// @grant        GM_setClipboard
// @grant        GM_xmlhttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @connect      openrouter.ai
// @connect      realsports.io
// ==/UserScript==

(function(){"use strict";const Co='@import"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap";:host,#app{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*,*:before,*:after{box-sizing:border-box}:host{--rsdh-accent: #2c6cff;--rsdh-accent-light: color-mix(in srgb, var(--rsdh-accent) 70%, white);--rsdh-accent-dark: color-mix(in srgb, var(--rsdh-accent) 80%, black);--rsdh-accent-glow: color-mix(in srgb, var(--rsdh-accent) 40%, transparent);--rsdh-accent-subtle: color-mix(in srgb, var(--rsdh-accent) 15%, transparent);--rsdh-glass: rgba(255, 255, 255, .03);--rsdh-glass-border: rgba(255, 255, 255, .08);--rsdh-transition-fast: .15s ease;--rsdh-transition: .25s ease}.panel{position:fixed;right:12px;top:12px;bottom:12px;width:380px;max-width:calc(100vw - 24px);z-index:2147483647;background:linear-gradient(135deg,#19191ef7,#0f0f12fa);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);color:#f5f5f5;border:1px solid var(--rsdh-glass-border);border-radius:16px;box-shadow:0 25px 50px -12px #0009,0 0 0 1px var(--rsdh-accent-glow),inset 0 1px #ffffff0d;display:flex;flex-direction:column;overflow:hidden}.header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px 12px;background:linear-gradient(180deg,rgba(255,255,255,.04) 0%,transparent 100%);border-bottom:1px solid var(--rsdh-glass-border)}.title{font-weight:800;font-size:14px;letter-spacing:-.02em;background:linear-gradient(135deg,#fff,#fffc);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.tabs{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:12px 16px 14px;background:#0003;border-bottom:1px solid var(--rsdh-glass-border)}.view{flex:1;min-height:0;overflow:auto;padding:16px;box-sizing:border-box;animation:fadeIn .2s ease}@keyframes fadeIn{0%{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}.actions{display:grid;grid-template-columns:1fr 1fr;gap:8px}.span2{grid-column:1 / -1}.split{position:relative;display:flex;gap:6px}.split>button:first-child{flex:1 1 auto}.splitCaret{flex:0 0 auto;width:42px;padding-left:0;padding-right:0}.menu{position:absolute;right:0;top:calc(100% + 8px);width:220px;z-index:2147483647;background:#141419fa;backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid var(--rsdh-glass-border);border-radius:12px;box-shadow:0 20px 40px #00000080,0 0 0 1px var(--rsdh-accent-glow);padding:8px;display:grid;gap:4px;animation:menuAppear .15s ease}@keyframes menuAppear{0%{opacity:0;transform:translateY(-8px) scale(.96)}to{opacity:1;transform:translateY(0) scale(1)}}.menuItem{text-align:left;background:#ffffff0f;border-radius:8px}.menuItem:hover{background:var(--rsdh-accent-subtle);color:var(--rsdh-accent-light)}button{background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);color:#fff;border:0;border-radius:10px;padding:10px 14px;font-weight:700;font-size:12px;letter-spacing:-.01em;cursor:pointer;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:transform var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast),background var(--rsdh-transition-fast);box-shadow:0 2px 8px #0003}button:hover{transform:translateY(-1px);box-shadow:0 4px 16px #0000004d,0 0 20px var(--rsdh-accent-glow)}button:active{transform:translateY(0);box-shadow:0 1px 4px #0003}button.secondary{background:#ffffff14;box-shadow:none;border:1px solid rgba(255,255,255,.08)}button.secondary:hover{background:#ffffff1f;border-color:#ffffff26;box-shadow:0 4px 12px #0003}button.tab{background:#ffffff0f;border:1px solid transparent;box-shadow:none}button.tab:hover{background:#ffffff1a;box-shadow:none}button.tab.active{background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);border-color:transparent;box-shadow:0 2px 12px var(--rsdh-accent-glow),inset 0 1px #ffffff1a}textarea{width:100%;min-height:140px;resize:none;background:#0006;color:#eaeaea;border:1px solid var(--rsdh-glass-border);border-radius:10px;padding:12px;font-family:SF Mono,Fira Code,Consolas,monospace;font-size:11px;line-height:1.5;box-sizing:border-box;transition:border-color var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}textarea:focus{outline:none;border-color:var(--rsdh-accent);box-shadow:0 0 0 3px var(--rsdh-accent-glow)}textarea::placeholder{color:#ffffff59}.status{margin-top:12px;padding:8px 12px;font-size:11px;font-weight:500;color:#ffffffbf;background:#ffffff08;border-radius:8px;border-left:3px solid var(--rsdh-accent);transition:all var(--rsdh-transition-fast)}.card{border:1px solid var(--rsdh-glass-border);background:linear-gradient(135deg,var(--rsdh-glass) 0%,transparent 100%);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);border-radius:12px;padding:14px;margin-bottom:12px;transition:border-color var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}.card:hover{border-color:#ffffff1f;box-shadow:0 4px 20px #00000026}.h{font-weight:800;font-size:13px;margin-bottom:8px;letter-spacing:-.01em;color:#fff}.sub{font-size:11px;color:#fff9;line-height:1.45}.muted{color:#ffffff73}.table{width:100%;border-collapse:collapse;font-size:11px}.table th,.table td{text-align:left;padding:8px 10px;border-bottom:1px solid var(--rsdh-glass-border);vertical-align:top}.table thead th{color:var(--rsdh-accent-light);font-weight:700;text-transform:uppercase;font-size:10px;letter-spacing:.04em}.table tbody tr:hover{background:#ffffff05}.table tbody tr:last-child td{border-bottom:none}.list{display:grid;gap:8px;margin-top:10px}.row{display:flex;gap:10px;align-items:baseline;justify-content:space-between;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.04)}.row:last-child{border-bottom:none}.rowLeft{flex:1;min-width:0}.rowRight{flex:0 0 auto}.pill{display:inline-block;padding:3px 8px;border-radius:999px;border:1px solid var(--rsdh-accent-glow);background:linear-gradient(135deg,var(--rsdh-accent-subtle) 0%,transparent 100%);font-size:10px;font-weight:600;color:var(--rsdh-accent-light)}.link{color:var(--rsdh-accent-light);text-decoration:none;transition:color var(--rsdh-transition-fast)}.link:hover{color:#fff;text-decoration:underline}.code-output{margin:0;white-space:pre-wrap;font-family:SF Mono,Fira Code,Consolas,monospace;font-size:11px;line-height:1.5;color:#ffffffd9;background:#0003;padding:10px;border-radius:8px;overflow-x:auto}.bet-item{padding:10px 0;border-bottom:1px solid var(--rsdh-glass-border)}.bet-item:last-child{border-bottom:none}.bet-header{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.bet-tier{font-weight:700;color:#fff}.bet-rec{font-size:10px;font-weight:700;padding:3px 8px;border-radius:4px}.bet-rec.yes{background:#22c55e33;color:#22c55e}.bet-rec.no{background:#ef444433;color:#ef4444}.bet-reason{margin-top:6px;font-size:11px;color:#ffffffa6;line-height:1.4;word-wrap:break-word;overflow-wrap:break-word}.details summary{cursor:pointer;color:#fff9;font-size:11px;font-weight:600;user-select:none;padding:8px 0;transition:color var(--rsdh-transition-fast)}.details summary:hover{color:#ffffffd9}.details[open] summary{margin-bottom:8px}input[type=text],input[type=password]{width:100%;max-width:100%;background:#00000059;color:#eaeaea;border:1px solid var(--rsdh-glass-border);border-radius:8px;padding:10px 12px;font-size:12px;font-family:inherit;transition:border-color var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}input[type=text]:focus,input[type=password]:focus{outline:none;border-color:var(--rsdh-accent);box-shadow:0 0 0 3px var(--rsdh-accent-glow)}input[type=text]::placeholder,input[type=password]::placeholder{color:#ffffff4d}input[type=checkbox]{width:16px;height:16px;accent-color:var(--rsdh-accent);cursor:pointer}input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:6px;background:#ffffff1a;border-radius:3px;cursor:pointer;margin-top:6px}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);cursor:pointer;box-shadow:0 2px 6px #0000004d;transition:transform .15s ease}input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.15)}input[type=range]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;border:none;background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);cursor:pointer;box-shadow:0 2px 6px #0000004d}.hidden{display:none}.fab{position:fixed;right:20px;bottom:20px;width:56px;height:56px;z-index:2147483647;border-radius:999px;border:1px solid rgba(255,255,255,.1);background:radial-gradient(circle at 30% 30%,color-mix(in srgb,var(--rsdh-accent) 50%,white) 0%,transparent 50%),radial-gradient(circle at 70% 70%,var(--rsdh-accent-dark) 0%,transparent 60%),linear-gradient(135deg,#19191ef2,#0f0f12fa);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);box-shadow:0 8px 32px #0006,0 0 0 1px var(--rsdh-accent-glow),inset 0 1px #ffffff1a;color:#fff;cursor:pointer;display:grid;place-items:center;transition:transform var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}.fab:hover{transform:translateY(-2px) scale(1.04);box-shadow:0 12px 40px #00000080,0 0 30px var(--rsdh-accent-glow),inset 0 1px #ffffff26}.fab:active{transform:translateY(0) scale(.98)}.view::-webkit-scrollbar{width:6px}.view::-webkit-scrollbar-track{background:transparent}.view::-webkit-scrollbar-thumb{background:#ffffff26;border-radius:3px}.view::-webkit-scrollbar-thumb:hover{background:#ffffff40}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;gap:16px}.spinner{width:40px;height:40px;border:3px solid rgba(255,255,255,.1);border-top-color:var(--rsdh-accent);border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.loading-text{font-size:13px;font-weight:600;color:#ffffffb3;animation:pulse 1.5s ease-in-out infinite}@keyframes pulse{0%,to{opacity:.7}50%{opacity:1}}.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:48px 24px;gap:16px}.empty-icon{font-size:48px;opacity:.6;filter:grayscale(20%)}.empty-title{font-size:15px;font-weight:700;color:#ffffffe6;margin:0}.empty-description{font-size:12px;color:#ffffff8c;max-width:280px;line-height:1.5;margin:0}.empty-hint{display:inline-flex;align-items:center;gap:6px;margin-top:8px;padding:8px 14px;background:var(--rsdh-accent-subtle);border:1px solid var(--rsdh-accent-glow);border-radius:8px;font-size:11px;font-weight:600;color:var(--rsdh-accent-light)}';typeof window<"u"&&((window.__svelte??={}).v??=new Set).add("5");let Pt=!1,Po=!1;function Ro(){Pt=!0}Ro();const Oo=1,Mo=2,Io=16,No=1,Lo=2,J=Symbol(),Bo="http://www.w3.org/1999/xhtml",Pr=!1;var xn=Array.isArray,Do=Array.prototype.indexOf,or=Array.from,Fo=Object.defineProperty,Rt=Object.getOwnPropertyDescriptor,wn=Object.getOwnPropertyDescriptors,$o=Object.prototype,qo=Array.prototype,Rr=Object.getPrototypeOf,Sn=Object.isExtensible;function Yo(e){return e()}function Or(e){for(var t=0;t<e.length;t++)e[t]()}function kn(){var e,t,r=new Promise((n,s)=>{e=n,t=s});return{promise:r,resolve:e,reject:t}}const W=2,En=4,ar=8,Ho=1<<24,Ce=16,Pe=32,Ve=64,ir=128,ye=512,V=1024,ne=2048,xe=4096,ce=8192,Fe=16384,Mr=32768,ft=65536,An=1<<17,Tn=1<<18,pt=1<<19,Cn=1<<20,$e=1<<25,Xe=32768,Ir=1<<21,Nr=1<<22,qe=1<<23,Ot=Symbol("$state"),ht=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Uo(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function zo(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Go(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function jo(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ko(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Wo(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Jo(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Vo(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Xo(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Zo(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}function Qo(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Pn(e){return e===this.v}function ea(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Rn(e){return!ea(e,this.v)}let q=null;function mt(e){q=e}function On(e,t=!1,r){q={p:q,i:!1,c:null,e:null,s:e,x:null,l:Pt&&!t?{s:null,u:null,$:[]}:null}}function Mn(e){var t=q,r=t.e;if(r!==null){t.e=null;for(var n of r)Qn(n)}return t.i=!0,q=t.p,{}}function Mt(){return!Pt||q!==null&&q.l===null}let Ze=[];function In(){var e=Ze;Ze=[],Or(e)}function lr(e){if(Ze.length===0&&!It){var t=Ze;queueMicrotask(()=>{t===Ze&&In()})}Ze.push(e)}function ta(){for(;Ze.length>0;)In()}function Nn(e){var t=O;if(t===null)return C.f|=qe,e;if((t.f&Mr)===0){if((t.f&ir)===0)throw e;t.b.error(e)}else vt(e,t)}function vt(e,t){for(;t!==null;){if((t.f&ir)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e}const cr=new Set;let I=null,ur=null,me=null,ve=[],dr=null,Lr=!1,It=!1;class we{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#l=null;#o=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#r>0}process(t){ve=[],ur=null,this.apply();var r={parent:null,effect:null,effects:[],render_effects:[]};for(const n of t)this.#a(n,r);this.is_fork||this.#u(),this.is_deferred()?(this.#i(r.effects),this.#i(r.render_effects)):(ur=this,I=null,Bn(r.render_effects),Bn(r.effects),ur=null,this.#l?.resolve()),me=null}#a(t,r){t.f^=V;for(var n=t.first;n!==null;){var s=n.f,o=(s&(Pe|Ve))!==0,l=o&&(s&V)!==0,a=l||(s&ce)!==0||this.skipped_effects.has(n);if((n.f&ir)!==0&&n.b?.is_pending()&&(r={parent:r,effect:n,effects:[],render_effects:[]}),!a&&n.fn!==null){o?n.f^=V:(s&En)!==0?r.effects.push(n):$t(n)&&((n.f&Ce)!==0&&this.#o.add(n),qt(n));var c=n.first;if(c!==null){n=c;continue}}var i=n.parent;for(n=n.next;n===null&&i!==null;)i===r.effect&&(this.#i(r.effects),this.#i(r.render_effects),r=r.parent),n=i.next,i=i.parent}}#i(t){for(const r of t)(r.f&ne)!==0?this.#o.add(r):(r.f&xe)!==0&&this.#s.add(r),this.#c(r.deps),X(r,V)}#c(t){if(t!==null)for(const r of t)(r.f&W)===0||(r.f&Xe)===0||(r.f^=Xe,this.#c(r.deps))}capture(t,r){this.previous.has(t)||this.previous.set(t,r),(t.f&qe)===0&&(this.current.set(t,t.v),me?.set(t,t.v))}activate(){I=this,this.apply()}deactivate(){I===this&&(I=null,me=null)}flush(){if(this.activate(),ve.length>0){if(Ln(),I!==null&&I!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#u(){if(this.#r===0){for(const t of this.#e)t();this.#e.clear()}this.#n===0&&this.#d()}#d(){if(cr.size>1){this.previous.clear();var t=me,r=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const o of cr){if(o===this){r=!1;continue}const l=[];for(const[c,i]of this.current){if(o.current.has(c))if(r&&i!==o.current.get(c))o.current.set(c,i);else continue;l.push(c)}if(l.length===0)continue;const a=[...o.current.keys()].filter(c=>!this.current.has(c));if(a.length>0){var s=ve;ve=[];const c=new Set,i=new Map;for(const d of l)Dn(d,a,c,i);if(ve.length>0){I=o,o.apply();for(const d of ve)o.#a(d,n);o.deactivate()}ve=s}}I=null,me=t}this.committed=!0,cr.delete(this)}increment(t){this.#n+=1,t&&(this.#r+=1)}decrement(t){this.#n-=1,t&&(this.#r-=1),this.revive()}revive(){for(const t of this.#o)this.#s.delete(t),X(t,ne),Qe(t);for(const t of this.#s)X(t,xe),Qe(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=kn()).promise}static ensure(){if(I===null){const t=I=new we;cr.add(I),It||we.enqueue(()=>{I===t&&t.flush()})}return I}static enqueue(t){lr(t)}apply(){}}function ra(e){var t=It;It=!0;try{for(var r;;){if(ta(),ve.length===0&&(I?.flush(),ve.length===0))return dr=null,r;Ln()}}finally{It=t}}function Ln(){var e=rt;Lr=!0;var t=null;try{var r=0;for(hr(!0);ve.length>0;){var n=we.ensure();if(r++>1e3){var s,o;na()}n.process(ve),Ye.clear()}}finally{Lr=!1,hr(e),dr=null}}function na(){try{Wo()}catch(e){vt(e,dr)}}let Re=null;function Bn(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var n=e[r++];if((n.f&(Fe|ce))===0&&$t(n)&&(Re=new Set,qt(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?ns(n):n.fn=null),Re?.size>0)){Ye.clear();for(const s of Re){if((s.f&(Fe|ce))!==0)continue;const o=[s];let l=s.parent;for(;l!==null;)Re.has(l)&&(Re.delete(l),o.push(l)),l=l.parent;for(let a=o.length-1;a>=0;a--){const c=o[a];(c.f&(Fe|ce))===0&&qt(c)}}Re.clear()}}Re=null}}function Dn(e,t,r,n){if(!r.has(e)&&(r.add(e),e.reactions!==null))for(const s of e.reactions){const o=s.f;(o&W)!==0?Dn(s,t,r,n):(o&(Nr|Ce))!==0&&(o&ne)===0&&Fn(s,t,n)&&(X(s,ne),Qe(s))}}function Fn(e,t,r){const n=r.get(e);if(n!==void 0)return n;if(e.deps!==null)for(const s of e.deps){if(t.includes(s))return!0;if((s.f&W)!==0&&Fn(s,t,r))return r.set(s,!0),!0}return r.set(e,!1),!1}function Qe(e){for(var t=dr=e;t.parent!==null;){t=t.parent;var r=t.f;if(Lr&&t===O&&(r&Ce)!==0&&(r&Tn)===0)return;if((r&(Ve|Pe))!==0){if((r&V)===0)return;t.f^=V}}ve.push(t)}function sa(e){let t=0,r=et(0),n;return()=>{Dt()&&(p(r),qr(()=>(t===0&&(n=Yt(()=>e(()=>Nt(r)))),t+=1,()=>{lr(()=>{t-=1,t===0&&(n?.(),n=void 0,Nt(r))})})))}}var oa=ft|pt|ir;function aa(e,t,r){new ia(e,t,r)}class ia{parent;#e=!1;#t;#n=null;#r;#l;#o;#s=null;#a=null;#i=null;#c=null;#u=null;#d=0;#f=0;#h=!1;#p=null;#_=sa(()=>(this.#p=et(this.#d),()=>{this.#p=null}));constructor(t,r,n){this.#t=t,this.#r=r,this.#l=n,this.parent=O.b,this.#e=!!this.#r.pending,this.#o=Yr(()=>{O.b=this;{var s=this.#g();try{this.#s=ge(()=>n(s))}catch(o){this.error(o)}this.#f>0?this.#v():this.#e=!1}return()=>{this.#u?.remove()}},oa)}#y(){try{this.#s=ge(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#x(){const t=this.#r.pending;t&&(this.#a=ge(()=>t(this.#t)),we.enqueue(()=>{var r=this.#g();this.#s=this.#m(()=>(we.ensure(),ge(()=>this.#l(r)))),this.#f>0?this.#v():(tt(this.#a,()=>{this.#a=null}),this.#e=!1)}))}#g(){var t=this.#t;return this.#e&&(this.#u=Oe(),this.#t.before(this.#u),t=this.#u),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(t){var r=O,n=C,s=q;ke(this.#o),ae(this.#o),mt(this.#o.ctx);try{return t()}catch(o){return Nn(o),null}finally{ke(r),ae(n),mt(s)}}#v(){const t=this.#r.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),as(this.#s,this.#c)),this.#a===null&&(this.#a=ge(()=>t(this.#t)))}#b(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#b(t);return}this.#f+=t,this.#f===0&&(this.#e=!1,this.#a&&tt(this.#a,()=>{this.#a=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#b(t),this.#d+=t,this.#p&&gt(this.#p,this.#d)}get_effect_pending(){return this.#_(),p(this.#p)}error(t){var r=this.#r.onerror;let n=this.#r.failed;if(this.#h||!r&&!n)throw t;this.#s&&(oe(this.#s),this.#s=null),this.#a&&(oe(this.#a),this.#a=null),this.#i&&(oe(this.#i),this.#i=null);var s=!1,o=!1;const l=()=>{if(s){Qo();return}s=!0,o&&Zo(),we.ensure(),this.#d=0,this.#i!==null&&tt(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#s=this.#m(()=>(this.#h=!1,ge(()=>this.#l(this.#t)))),this.#f>0?this.#v():this.#e=!1};var a=C;try{ae(null),o=!0,r?.(t,l),o=!1}catch(c){vt(c,this.#o&&this.#o.parent)}finally{ae(a)}n&&lr(()=>{this.#i=this.#m(()=>{we.ensure(),this.#h=!0;try{return ge(()=>{n(this.#t,()=>t,()=>l)})}catch(c){return vt(c,this.#o.parent),null}finally{this.#h=!1}})})}}function la(e,t,r,n){const s=Mt()?Br:$n;if(r.length===0&&e.length===0){n(t.map(s));return}var o=I,l=O,a=ca();function c(){Promise.all(r.map(i=>ua(i))).then(i=>{a();try{n([...t.map(s),...i])}catch(d){(l.f&Fe)===0&&vt(d,l)}o?.deactivate(),fr()}).catch(i=>{vt(i,l)})}e.length>0?Promise.all(e).then(()=>{a();try{return c()}finally{o?.deactivate(),fr()}}):c()}function ca(){var e=O,t=C,r=q,n=I;return function(o=!0){ke(e),ae(t),mt(r),o&&n?.activate()}}function fr(){ke(null),ae(null),mt(null)}function Br(e){var t=W|ne,r=C!==null&&(C.f&W)!==0?C:null;return O!==null&&(O.f|=pt),{ctx:q,deps:null,effects:null,equals:Pn,f:t,fn:e,reactions:null,rv:0,v:J,wv:0,parent:r??O,ac:null}}function ua(e,t){let r=O;r===null&&zo();var n=r.b,s=void 0,o=et(J),l=!C,a=new Map;return _a(()=>{var c=kn();s=c.promise;try{Promise.resolve(e()).then(c.resolve,c.reject).then(()=>{i===I&&i.committed&&i.deactivate(),fr()})}catch(f){c.reject(f),fr()}var i=I;if(l){var d=!n.is_pending();n.update_pending_count(1),i.increment(d),a.get(i)?.reject(ht),a.delete(i),a.set(i,c)}const u=(f,h=void 0)=>{if(i.activate(),h)h!==ht&&(o.f|=qe,gt(o,h));else{(o.f&qe)!==0&&(o.f^=qe),gt(o,f);for(const[m,x]of a){if(a.delete(m),m===i)break;x.reject(ht)}}l&&(n.update_pending_count(-1),i.decrement(d))};c.promise.then(u,f=>u(null,f||"unknown"))}),Zn(()=>{for(const c of a.values())c.reject(ht)}),new Promise(c=>{function i(d){function u(){d===s?c(o):i(s)}d.then(u,u)}i(s)})}function $n(e){const t=Br(e);return t.equals=Rn,t}function qn(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)oe(t[r])}}function da(e){for(var t=e.parent;t!==null;){if((t.f&W)===0)return(t.f&Fe)===0?t:null;t=t.parent}return null}function Dr(e){var t,r=O;ke(da(e));try{e.f&=~Xe,qn(e),t=fs(e)}finally{ke(r)}return t}function Yn(e){var t=Dr(e);if(e.equals(t)||(I?.is_fork||(e.v=t),e.wv=us()),!_t)if(me!==null)(Dt()||I?.is_fork)&&me.set(e,t);else{var r=(e.f&ye)===0?xe:V;X(e,r)}}let Fr=new Set;const Ye=new Map;let Hn=!1;function et(e,t){var r={f:0,v:e,reactions:null,equals:Pn,rv:0,wv:0};return r}function He(e,t){const r=et(e);return xa(r),r}function N(e,t=!1,r=!0){const n=et(e);return t||(n.equals=Rn),Pt&&r&&q!==null&&q.l!==null&&(q.l.s??=[]).push(n),n}function b(e,t,r=!1){C!==null&&(!Se||(C.f&An)!==0)&&Mt()&&(C.f&(W|Ce|Nr|An))!==0&&!Ie?.includes(e)&&Xo();let n=r?Lt(t):t;return gt(e,n)}function gt(e,t){if(!e.equals(t)){var r=e.v;_t?Ye.set(e,t):Ye.set(e,r),e.v=t;var n=we.ensure();n.capture(e,r),(e.f&W)!==0&&((e.f&ne)!==0&&Dr(e),X(e,(e.f&ye)!==0?V:xe)),e.wv=us(),Un(e,ne),Mt()&&O!==null&&(O.f&V)!==0&&(O.f&(Pe|Ve))===0&&(be===null?wa([e]):be.push(e)),!n.is_fork&&Fr.size>0&&!Hn&&fa()}return t}function fa(){Hn=!1;var e=rt;hr(!0);const t=Array.from(Fr);try{for(const r of t)(r.f&V)!==0&&X(r,xe),$t(r)&&qt(r)}finally{hr(e)}Fr.clear()}function Nt(e){b(e,e.v+1)}function Un(e,t){var r=e.reactions;if(r!==null)for(var n=Mt(),s=r.length,o=0;o<s;o++){var l=r[o],a=l.f;if(!(!n&&l===O)){var c=(a&ne)===0;if(c&&X(l,t),(a&W)!==0){var i=l;me?.delete(i),(a&Xe)===0&&(a&ye&&(l.f|=Xe),Un(i,xe))}else c&&((a&Ce)!==0&&Re!==null&&Re.add(l),Qe(l))}}}function Lt(e){if(typeof e!="object"||e===null||Ot in e)return e;const t=Rr(e);if(t!==$o&&t!==qo)return e;var r=new Map,n=xn(e),s=He(0),o=nt,l=a=>{if(nt===o)return a();var c=C,i=nt;ae(null),cs(o);var d=a();return ae(c),cs(i),d};return n&&r.set("length",He(e.length)),new Proxy(e,{defineProperty(a,c,i){(!("value"in i)||i.configurable===!1||i.enumerable===!1||i.writable===!1)&&Jo();var d=r.get(c);return d===void 0?d=l(()=>{var u=He(i.value);return r.set(c,u),u}):b(d,i.value,!0),!0},deleteProperty(a,c){var i=r.get(c);if(i===void 0){if(c in a){const d=l(()=>He(J));r.set(c,d),Nt(s)}}else b(i,J),Nt(s);return!0},get(a,c,i){if(c===Ot)return e;var d=r.get(c),u=c in a;if(d===void 0&&(!u||Rt(a,c)?.writable)&&(d=l(()=>{var h=Lt(u?a[c]:J),m=He(h);return m}),r.set(c,d)),d!==void 0){var f=p(d);return f===J?void 0:f}return Reflect.get(a,c,i)},getOwnPropertyDescriptor(a,c){var i=Reflect.getOwnPropertyDescriptor(a,c);if(i&&"value"in i){var d=r.get(c);d&&(i.value=p(d))}else if(i===void 0){var u=r.get(c),f=u?.v;if(u!==void 0&&f!==J)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return i},has(a,c){if(c===Ot)return!0;var i=r.get(c),d=i!==void 0&&i.v!==J||Reflect.has(a,c);if(i!==void 0||O!==null&&(!d||Rt(a,c)?.writable)){i===void 0&&(i=l(()=>{var f=d?Lt(a[c]):J,h=He(f);return h}),r.set(c,i));var u=p(i);if(u===J)return!1}return d},set(a,c,i,d){var u=r.get(c),f=c in a;if(n&&c==="length")for(var h=i;h<u.v;h+=1){var m=r.get(h+"");m!==void 0?b(m,J):h in a&&(m=l(()=>He(J)),r.set(h+"",m))}if(u===void 0)(!f||Rt(a,c)?.writable)&&(u=l(()=>He(void 0)),b(u,Lt(i)),r.set(c,u));else{f=u.v!==J;var x=l(()=>Lt(i));b(u,x)}var w=Reflect.getOwnPropertyDescriptor(a,c);if(w?.set&&w.set.call(d,i),!f){if(n&&typeof c=="string"){var L=r.get("length"),R=Number(c);Number.isInteger(R)&&R>=L.v&&b(L,R+1)}Nt(s)}return!0},ownKeys(a){p(s);var c=Reflect.ownKeys(a).filter(u=>{var f=r.get(u);return f===void 0||f.v!==J});for(var[i,d]of r)d.v!==J&&!(i in a)&&c.push(i);return c},setPrototypeOf(){Vo()}})}var zn,Gn,jn,Kn;function pa(){if(zn===void 0){zn=window,Gn=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;jn=Rt(t,"firstChild").get,Kn=Rt(t,"nextSibling").get,Sn(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Sn(r)&&(r.__t=void 0)}}function Oe(e=""){return document.createTextNode(e)}function Ue(e){return jn.call(e)}function Bt(e){return Kn.call(e)}function _(e,t){return Ue(e)}function bt(e,t=!1){{var r=Ue(e);return r instanceof Comment&&r.data===""?Bt(r):r}}function g(e,t=1,r=!1){let n=e;for(;t--;)n=Bt(n);return n}function ha(e){e.textContent=""}function Wn(){return!1}let Jn=!1;function ma(){Jn||(Jn=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function pr(e){var t=C,r=O;ae(null),ke(null);try{return e()}finally{ae(t),ke(r)}}function Vn(e,t,r,n=r){e.addEventListener(t,()=>pr(r));const s=e.__on_r;s?e.__on_r=()=>{s(),n(!0)}:e.__on_r=()=>n(!0),ma()}function Xn(e){O===null&&(C===null&&Ko(),jo()),_t&&Go()}function va(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function Me(e,t,r){var n=O;n!==null&&(n.f&ce)!==0&&(e|=ce);var s={ctx:q,deps:null,nodes:null,f:e|ne|ye,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{qt(s),s.f|=Mr}catch(a){throw oe(s),a}else t!==null&&Qe(s);var o=s;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&pt)===0&&(o=o.first,(e&Ce)!==0&&(e&ft)!==0&&o!==null&&(o.f|=ft)),o!==null&&(o.parent=n,n!==null&&va(o,n),C!==null&&(C.f&W)!==0&&(e&Ve)===0)){var l=C;(l.effects??=[]).push(o)}return s}function Dt(){return C!==null&&!Se}function Zn(e){const t=Me(ar,null,!1);return X(t,V),t.teardown=e,t}function $r(e){Xn();var t=O.f,r=!C&&(t&Pe)!==0&&(t&Mr)===0;if(r){var n=q;(n.e??=[]).push(e)}else return Qn(e)}function Qn(e){return Me(En|Cn,e,!1)}function ga(e){return Xn(),Me(ar|Cn,e,!0)}function ba(e){we.ensure();const t=Me(Ve|pt,e,!0);return(r={})=>new Promise(n=>{r.outro?tt(t,()=>{oe(t),n(void 0)}):(oe(t),n(void 0))})}function _a(e){return Me(Nr|pt,e,!0)}function qr(e,t=0){return Me(ar|t,e,!0)}function se(e,t=[],r=[],n=[]){la(n,t,r,s=>{Me(ar,()=>e(...s.map(p)),!0)})}function Yr(e,t=0){var r=Me(Ce|t,e,!0);return r}function ge(e){return Me(Pe|pt,e,!0)}function es(e){var t=e.teardown;if(t!==null){const r=_t,n=C;is(!0),ae(null);try{t.call(null)}finally{is(r),ae(n)}}}function ts(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const s=r.ac;s!==null&&pr(()=>{s.abort(ht)});var n=r.next;(r.f&Ve)!==0?r.parent=null:oe(r,t),r=n}}function ya(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&Pe)===0&&oe(t),t=r}}function oe(e,t=!0){var r=!1;(t||(e.f&Tn)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(rs(e.nodes.start,e.nodes.end),r=!0),ts(e,t&&!r),mr(e,0),X(e,Fe);var n=e.nodes&&e.nodes.t;if(n!==null)for(const o of n)o.stop();es(e);var s=e.parent;s!==null&&s.first!==null&&ns(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function rs(e,t){for(;e!==null;){var r=e===t?null:Bt(e);e.remove(),e=r}}function ns(e){var t=e.parent,r=e.prev,n=e.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function tt(e,t,r=!0){var n=[];ss(e,n,!0);var s=()=>{r&&oe(e),t&&t()},o=n.length;if(o>0){var l=()=>--o||s();for(var a of n)a.out(l)}else s()}function ss(e,t,r){if((e.f&ce)===0){e.f^=ce;var n=e.nodes&&e.nodes.t;if(n!==null)for(const a of n)(a.is_global||r)&&t.push(a);for(var s=e.first;s!==null;){var o=s.next,l=(s.f&ft)!==0||(s.f&Pe)!==0&&(e.f&Ce)!==0;ss(s,t,l?r:!1),s=o}}}function Hr(e){os(e,!0)}function os(e,t){if((e.f&ce)!==0){e.f^=ce,(e.f&V)===0&&(X(e,ne),Qe(e));for(var r=e.first;r!==null;){var n=r.next,s=(r.f&ft)!==0||(r.f&Pe)!==0;os(r,s?t:!1),r=n}var o=e.nodes&&e.nodes.t;if(o!==null)for(const l of o)(l.is_global||t)&&l.in()}}function as(e,t){if(e.nodes)for(var r=e.nodes.start,n=e.nodes.end;r!==null;){var s=r===n?null:Bt(r);t.append(r),r=s}}let rt=!1;function hr(e){rt=e}let _t=!1;function is(e){_t=e}let C=null,Se=!1;function ae(e){C=e}let O=null;function ke(e){O=e}let Ie=null;function xa(e){C!==null&&(Ie===null?Ie=[e]:Ie.push(e))}let ee=null,ue=0,be=null;function wa(e){be=e}let ls=1,Ft=0,nt=Ft;function cs(e){nt=e}function us(){return++ls}function $t(e){var t=e.f;if((t&ne)!==0)return!0;if(t&W&&(e.f&=~Xe),(t&xe)!==0){var r=e.deps;if(r!==null)for(var n=r.length,s=0;s<n;s++){var o=r[s];if($t(o)&&Yn(o),o.wv>e.wv)return!0}(t&ye)!==0&&me===null&&X(e,V)}return!1}function ds(e,t,r=!0){var n=e.reactions;if(n!==null&&!Ie?.includes(e))for(var s=0;s<n.length;s++){var o=n[s];(o.f&W)!==0?ds(o,t,!1):t===o&&(r?X(o,ne):(o.f&V)!==0&&X(o,xe),Qe(o))}}function fs(e){var t=ee,r=ue,n=be,s=C,o=Ie,l=q,a=Se,c=nt,i=e.f;ee=null,ue=0,be=null,C=(i&(Pe|Ve))===0?e:null,Ie=null,mt(e.ctx),Se=!1,nt=++Ft,e.ac!==null&&(pr(()=>{e.ac.abort(ht)}),e.ac=null);try{e.f|=Ir;var d=e.fn,u=d(),f=e.deps;if(ee!==null){var h;if(mr(e,ue),f!==null&&ue>0)for(f.length=ue+ee.length,h=0;h<ee.length;h++)f[ue+h]=ee[h];else e.deps=f=ee;if(Dt()&&(e.f&ye)!==0)for(h=ue;h<f.length;h++)(f[h].reactions??=[]).push(e)}else f!==null&&ue<f.length&&(mr(e,ue),f.length=ue);if(Mt()&&be!==null&&!Se&&f!==null&&(e.f&(W|xe|ne))===0)for(h=0;h<be.length;h++)ds(be[h],e);return s!==null&&s!==e&&(Ft++,be!==null&&(n===null?n=be:n.push(...be))),(e.f&qe)!==0&&(e.f^=qe),u}catch(m){return Nn(m)}finally{e.f^=Ir,ee=t,ue=r,be=n,C=s,Ie=o,mt(l),Se=a,nt=c}}function Sa(e,t){let r=t.reactions;if(r!==null){var n=Do.call(r,e);if(n!==-1){var s=r.length-1;s===0?r=t.reactions=null:(r[n]=r[s],r.pop())}}r===null&&(t.f&W)!==0&&(ee===null||!ee.includes(t))&&(X(t,xe),(t.f&ye)!==0&&(t.f^=ye,t.f&=~Xe),qn(t),mr(t,0))}function mr(e,t){var r=e.deps;if(r!==null)for(var n=t;n<r.length;n++)Sa(e,r[n])}function qt(e){var t=e.f;if((t&Fe)===0){X(e,V);var r=O,n=rt;O=e,rt=!0;try{(t&(Ce|Ho))!==0?ya(e):ts(e),es(e);var s=fs(e);e.teardown=typeof s=="function"?s:null,e.wv=ls;var o;Pr&&Po&&(e.f&ne)!==0&&e.deps}finally{rt=n,O=r}}}async function ka(){await Promise.resolve(),ra()}function p(e){var t=e.f,r=(t&W)!==0;if(C!==null&&!Se){var n=O!==null&&(O.f&Fe)!==0;if(!n&&!Ie?.includes(e)){var s=C.deps;if((C.f&Ir)!==0)e.rv<Ft&&(e.rv=Ft,ee===null&&s!==null&&s[ue]===e?ue++:ee===null?ee=[e]:ee.includes(e)||ee.push(e));else{(C.deps??=[]).push(e);var o=e.reactions;o===null?e.reactions=[C]:o.includes(C)||o.push(C)}}}if(_t){if(Ye.has(e))return Ye.get(e);if(r){var l=e,a=l.v;return((l.f&V)===0&&l.reactions!==null||hs(l))&&(a=Dr(l)),Ye.set(l,a),a}}else r&&(!me?.has(e)||I?.is_fork&&!Dt())&&(l=e,$t(l)&&Yn(l),rt&&Dt()&&(l.f&ye)===0&&ps(l));if(me?.has(e))return me.get(e);if((e.f&qe)!==0)throw e.v;return e.v}function ps(e){if(e.deps!==null){e.f^=ye;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&W)!==0&&(t.f&ye)===0&&ps(t)}}function hs(e){if(e.v===J)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Ye.has(t)||(t.f&W)!==0&&hs(t))return!0;return!1}function Yt(e){var t=Se;try{return Se=!0,e()}finally{Se=t}}const Ea=-7169;function X(e,t){e.f=e.f&Ea|t}function Aa(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Ot in e)Ur(e);else if(!Array.isArray(e))for(let t in e){const r=e[t];typeof r=="object"&&r&&Ot in r&&Ur(r)}}}function Ur(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{Ur(e[n],t)}catch{}const r=Rr(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=wn(r);for(let s in n){const o=n[s].get;if(o)try{o.call(e)}catch{}}}}}const Ta=new Set,ms=new Set;function Ca(e,t,r,n={}){function s(o){if(n.capture||Ht.call(t,o),!o.cancelBubble)return pr(()=>r?.call(this,o))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?lr(()=>{t.addEventListener(e,s,n)}):t.addEventListener(e,s,n),s}function te(e,t,r,n,s){var o={capture:n,passive:s},l=Ca(e,t,r,o);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Zn(()=>{t.removeEventListener(e,l,o)})}let vs=null;function Ht(e){var t=this,r=t.ownerDocument,n=e.type,s=e.composedPath?.()||[],o=s[0]||e.target;vs=e;var l=0,a=vs===e&&e.__root;if(a){var c=s.indexOf(a);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var i=s.indexOf(t);if(i===-1)return;c<=i&&(l=c)}if(o=s[l]||e.target,o!==t){Fo(e,"currentTarget",{configurable:!0,get(){return o||r}});var d=C,u=O;ae(null),ke(null);try{for(var f,h=[];o!==null;){var m=o.assignedSlot||o.parentNode||o.host||null;try{var x=o["__"+n];x!=null&&(!o.disabled||e.target===o)&&x.call(o,e)}catch(w){f?h.push(w):f=w}if(e.cancelBubble||m===t||m===null)break;o=m}if(f){for(let w of h)queueMicrotask(()=>{throw w});throw f}}finally{e.__root=t,delete e.currentTarget,ae(d),ke(u)}}}function gs(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Ut(e,t){var r=O;r.nodes===null&&(r.nodes={start:e,end:t,a:null,t:null})}function Y(e,t){var r=(t&No)!==0,n=(t&Lo)!==0,s,o=!e.startsWith("<!>");return()=>{s===void 0&&(s=gs(o?e:"<!>"+e),r||(s=Ue(s)));var l=n||Gn?document.importNode(s,!0):s.cloneNode(!0);if(r){var a=Ue(l),c=l.lastChild;Ut(a,c)}else Ut(l,l);return l}}function ze(e=""){{var t=Oe(e+"");return Ut(t,t),t}}function bs(){var e=document.createDocumentFragment(),t=document.createComment(""),r=Oe();return e.append(t,r),Ut(t,r),e}function M(e,t){e!==null&&e.before(t)}const Pa=["touchstart","touchmove"];function Ra(e){return Pa.includes(e)}function Ee(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function Oa(e,t){return Ma(e,t)}const yt=new Map;function Ma(e,{target:t,anchor:r,props:n={},events:s,context:o,intro:l=!0}){pa();var a=new Set,c=u=>{for(var f=0;f<u.length;f++){var h=u[f];if(!a.has(h)){a.add(h);var m=Ra(h);t.addEventListener(h,Ht,{passive:m});var x=yt.get(h);x===void 0?(document.addEventListener(h,Ht,{passive:m}),yt.set(h,1)):yt.set(h,x+1)}}};c(or(Ta)),ms.add(c);var i=void 0,d=ba(()=>{var u=r??t.appendChild(Oe());return aa(u,{pending:()=>{}},f=>{if(o){On({});var h=q;h.c=o}s&&(n.$$events=s),i=e(f,n)||{},o&&Mn()}),()=>{for(var f of a){t.removeEventListener(f,Ht);var h=yt.get(f);--h===0?(document.removeEventListener(f,Ht),yt.delete(f)):yt.set(f,h)}ms.delete(c),u!==r&&u.parentNode?.removeChild(u)}});return Ia.set(i,d),i}let Ia=new WeakMap;class Na{anchor;#e=new Map;#t=new Map;#n=new Map;#r=new Set;#l=!0;constructor(t,r=!0){this.anchor=t,this.#l=r}#o=()=>{var t=I;if(this.#e.has(t)){var r=this.#e.get(t),n=this.#t.get(r);if(n)Hr(n),this.#r.delete(r);else{var s=this.#n.get(r);s&&(this.#t.set(r,s.effect),this.#n.delete(r),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),n=s.effect)}for(const[o,l]of this.#e){if(this.#e.delete(o),o===t)break;const a=this.#n.get(l);a&&(oe(a.effect),this.#n.delete(l))}for(const[o,l]of this.#t){if(o===r||this.#r.has(o))continue;const a=()=>{if(Array.from(this.#e.values()).includes(o)){var i=document.createDocumentFragment();as(l,i),i.append(Oe()),this.#n.set(o,{effect:l,fragment:i})}else oe(l);this.#r.delete(o),this.#t.delete(o)};this.#l||!n?(this.#r.add(o),tt(l,a,!1)):a()}}};#s=t=>{this.#e.delete(t);const r=Array.from(this.#e.values());for(const[n,s]of this.#n)r.includes(n)||(oe(s.effect),this.#n.delete(n))};ensure(t,r){var n=I,s=Wn();if(r&&!this.#t.has(t)&&!this.#n.has(t))if(s){var o=document.createDocumentFragment(),l=Oe();o.append(l),this.#n.set(t,{effect:ge(()=>r(l)),fragment:o})}else this.#t.set(t,ge(()=>r(this.anchor)));if(this.#e.set(n,t),s){for(const[a,c]of this.#t)a===t?n.skipped_effects.delete(c):n.skipped_effects.add(c);for(const[a,c]of this.#n)a===t?n.skipped_effects.delete(c.effect):n.skipped_effects.add(c.effect);n.oncommit(this.#o),n.ondiscard(this.#s)}else this.#o()}}function La(e){q===null&&Uo(),Pt&&q.l!==null?Ba(q).m.push(e):$r(()=>{const t=Yt(e);if(typeof t=="function")return t})}function Ba(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}function j(e,t,r=!1){var n=new Na(e),s=r?ft:0;function o(l,a){n.ensure(l,a)}Yr(()=>{var l=!1;t((a,c=!0)=>{l=!0,o(c,a)}),l||o(!1,null)},s)}function Da(e,t){return t}function Fa(e,t,r){for(var n=[],s=t.length,o,l=t.length,a=0;a<s;a++){let u=t[a];tt(u,()=>{if(o){if(o.pending.delete(u),o.done.add(u),o.pending.size===0){var f=e.outrogroups;zr(or(o.done)),f.delete(o),f.size===0&&(e.outrogroups=null)}}else l-=1},!1)}if(l===0){var c=n.length===0&&r!==null;if(c){var i=r,d=i.parentNode;ha(d),d.append(i),e.items.clear()}zr(t,!c)}else o={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(o)}function zr(e,t=!0){for(var r=0;r<e.length;r++)oe(e[r],t)}var _s;function $a(e,t,r,n,s,o=null){var l=e,a=new Map;{var c=e;l=c.appendChild(Oe())}var i=null,d=$n(()=>{var w=r();return xn(w)?w:w==null?[]:or(w)}),u,f=!0;function h(){x.fallback=i,qa(x,u,l,t,n),i!==null&&(u.length===0?(i.f&$e)===0?Hr(i):(i.f^=$e,zt(i,null,l)):tt(i,()=>{i=null}))}var m=Yr(()=>{u=p(d);for(var w=u.length,L=new Set,R=I,fe=Wn(),z=0;z<w;z+=1){var pe=u[z],ie=n(pe,z),G=f?null:a.get(ie);G?(G.v&&gt(G.v,pe),G.i&&gt(G.i,z),fe&&R.skipped_effects.delete(G.e)):(G=Ya(a,f?l:_s??=Oe(),pe,ie,z,s,t,r),f||(G.e.f|=$e),a.set(ie,G)),L.add(ie)}if(w===0&&o&&!i&&(f?i=ge(()=>o(l)):(i=ge(()=>o(_s??=Oe())),i.f|=$e)),!f)if(fe){for(const[re,Ae]of a)L.has(re)||R.skipped_effects.add(Ae.e);R.oncommit(h),R.ondiscard(()=>{})}else h();p(d)}),x={effect:m,items:a,outrogroups:null,fallback:i};f=!1}function qa(e,t,r,n,s){var o=t.length,l=e.items,a=e.effect.first,c,i=null,d=[],u=[],f,h,m,x;for(x=0;x<o;x+=1){if(f=t[x],h=s(f,x),m=l.get(h).e,e.outrogroups!==null)for(const re of e.outrogroups)re.pending.delete(m),re.done.delete(m);if((m.f&$e)!==0)if(m.f^=$e,m===a)zt(m,null,r);else{var w=i?i.next:a;m===e.effect.last&&(e.effect.last=m.prev),m.prev&&(m.prev.next=m.next),m.next&&(m.next.prev=m.prev),Ge(e,i,m),Ge(e,m,w),zt(m,w,r),i=m,d=[],u=[],a=i.next;continue}if((m.f&ce)!==0&&Hr(m),m!==a){if(c!==void 0&&c.has(m)){if(d.length<u.length){var L=u[0],R;i=L.prev;var fe=d[0],z=d[d.length-1];for(R=0;R<d.length;R+=1)zt(d[R],L,r);for(R=0;R<u.length;R+=1)c.delete(u[R]);Ge(e,fe.prev,z.next),Ge(e,i,fe),Ge(e,z,L),a=L,i=z,x-=1,d=[],u=[]}else c.delete(m),zt(m,a,r),Ge(e,m.prev,m.next),Ge(e,m,i===null?e.effect.first:i.next),Ge(e,i,m),i=m;continue}for(d=[],u=[];a!==null&&a!==m;)(c??=new Set).add(a),u.push(a),a=a.next;if(a===null)continue}(m.f&$e)===0&&d.push(m),i=m,a=m.next}if(e.outrogroups!==null){for(const re of e.outrogroups)re.pending.size===0&&(zr(or(re.done)),e.outrogroups?.delete(re));e.outrogroups.size===0&&(e.outrogroups=null)}if(a!==null||c!==void 0){var pe=[];if(c!==void 0)for(m of c)(m.f&ce)===0&&pe.push(m);for(;a!==null;)(a.f&ce)===0&&a!==e.fallback&&pe.push(a),a=a.next;var ie=pe.length;if(ie>0){var G=o===0?r:null;Fa(e,pe,G)}}}function Ya(e,t,r,n,s,o,l,a){var c=(l&Oo)!==0?(l&Io)===0?N(r,!1,!1):et(r):null,i=(l&Mo)!==0?et(s):null;return{v:c,i,e:ge(()=>(o(t,c??r,i??s,a),()=>{e.delete(n)}))}}function zt(e,t,r){if(e.nodes)for(var n=e.nodes.start,s=e.nodes.end,o=t&&(t.f&$e)===0?t.nodes.start:r;n!==null;){var l=Bt(n);if(o.before(n),n===s)return;n=l}}function Ge(e,t,r){t===null?e.effect.first=r:t.next=r,r===null?e.effect.last=t:r.prev=t}function ys(e,t,r=!1,n=!1,s=!1){var o=e,l="";se(()=>{var a=O;if(l!==(l=t()??"")&&(a.nodes!==null&&(rs(a.nodes.start,a.nodes.end),a.nodes=null),l!=="")){var c=l+"";r?c=`<svg>${c}</svg>`:n&&(c=`<math>${c}</math>`);var i=gs(c);if((r||n)&&(i=Ue(i)),Ut(Ue(i),i.lastChild),r||n)for(;Ue(i);)o.before(Ue(i));else o.before(i)}})}function Ha(e,t,r){var n=e==null?"":""+e;return n===""?null:n}function Ua(e,t){return e==null?null:String(e)}function je(e,t,r,n,s,o){var l=e.__className;if(l!==r||l===void 0){var a=Ha(r);a==null?e.removeAttribute("class"):e.className=a,e.__className=r}return o}function Gt(e,t,r,n){var s=e.__style;if(s!==t){var o=Ua(t);o==null?e.removeAttribute("style"):e.style.cssText=o,e.__style=t}return n}const za=Symbol("is custom element"),Ga=Symbol("is html");function jt(e,t){var r=xs(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function ja(e,t,r,n){var s=xs(e);s[t]!==(s[t]=r)&&(r==null?e.removeAttribute(t):typeof r!="string"&&Ka(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function xs(e){return e.__attributes??={[za]:e.nodeName.includes("-"),[Ga]:e.namespaceURI===Bo}}var ws=new Map;function Ka(e){var t=e.getAttribute("is")||e.nodeName,r=ws.get(t);if(r)return r;ws.set(t,r=[]);for(var n,s=e,o=Element.prototype;o!==s;){n=wn(s);for(var l in n)n[l].set&&r.push(l);s=Rr(s)}return r}function st(e,t,r=t){var n=new WeakSet;Vn(e,"input",async s=>{var o=s?e.defaultValue:e.value;if(o=Gr(e)?jr(o):o,r(o),I!==null&&n.add(I),await ka(),o!==(o=t())){var l=e.selectionStart,a=e.selectionEnd,c=e.value.length;if(e.value=o??"",a!==null){var i=e.value.length;l===a&&a===c&&i>c?(e.selectionStart=i,e.selectionEnd=i):(e.selectionStart=l,e.selectionEnd=Math.min(a,i))}}}),Yt(t)==null&&e.value&&(r(Gr(e)?jr(e.value):e.value),I!==null&&n.add(I)),qr(()=>{var s=t();if(e===document.activeElement){var o=ur??I;if(n.has(o))return}Gr(e)&&s===jr(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function ot(e,t,r=t){Vn(e,"change",n=>{var s=n?e.defaultChecked:e.checked;r(s)}),Yt(t)==null&&r(e.checked),qr(()=>{var n=t();e.checked=!!n})}function Gr(e){var t=e.type;return t==="number"||t==="range"}function jr(e){return e===""?null:+e}function Wa(e=!1){const t=q,r=t.l.u;if(!r)return;let n=()=>Aa(t.s);if(e){let s=0,o={};const l=Br(()=>{let a=!1;const c=t.s;for(const i in c)c[i]!==o[i]&&(o[i]=c[i],a=!0);return a&&s++,s});n=()=>p(l)}r.b.length&&ga(()=>{Ss(t,n),Or(r.b)}),$r(()=>{const s=Yt(()=>r.m.map(Yo));return()=>{for(const o of s)typeof o=="function"&&o()}}),r.a.length&&$r(()=>{Ss(t,n),Or(r.a)})}function Ss(e,t){if(e.l.s)for(const r of e.l.s)p(r);t()}function Ne(e,t=document){return Array.from(t.querySelectorAll(e))}function D(e){const t=e;return String(t&&(t.innerText||t.textContent)||"").trim()}const Ja=["Select 5 players","Press two player","Press two players","to swap"],ks=/(\d+(?:\.\d+)?)x\b/gi,Va=/^\+(\d+(?:\.\d+)?)x\b/i,Xa=200,Es=["NFL","NHL","NBA","MLB","CFB","CBB","UFC","Golf","FC","WNBA"],As="rsdh_accent_rgb",Kr="rsdh_openrouter_api_key",Wr="rsdh_openrouter_model",Jr="rsdh_openrouter_temp",Vr="rsdh_openrouter_max_tokens",Xr="rsdh_openrouter_web_max_results",vr="rsdh_openrouter_structured_json",gr="rsdh_openrouter_response_healing",at="google/gemini-2.5-flash",br=.2,_r=1e3,Kt=2,Za=!0,Qa=!0,ei="https://openrouter.ai/api/v1/chat/completions",Ts="https://rsdh-proxy.cloudflare-okay454.workers.dev",ti="H8UIBeO5C9BJ8Ze8WUXb+Y+x4wuNp2K+Lz+HwVdanBk=",yr=!!Ts,Cs="rsdh_last_payload",Zr="rsdh_last_ai_sources",ri="rsdh_last_ai_json",Ps="rsdh_last_tool_trace",xr="rsdh_last_debug_events",ni="rsdh_last_messages",Wt="rsdh_force_tool_call",Jt="rsdh_force_search_tool",it="rsdh_bypass_proxy",Vt="rsdh_enable_profile_tool",Qr="rsdh_enable_web_search",Xt="rsdh_enable_search_tool";function S(e,t){try{if(typeof GM_getValue=="function")return GM_getValue(e,t)}catch{}try{const r=localStorage.getItem(e);return r??t}catch{return t}}function de(e,t){try{if(typeof GM_setValue=="function"){GM_setValue(e,t);return}}catch{}try{localStorage.setItem(e,String(t))}catch{}}function lt(){try{return localStorage.getItem("rsdh_debug_mode")==="1"}catch{return!1}}function si(e){try{localStorage.setItem("rsdh_debug_mode",e?"1":"0")}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-debug-mode",{detail:{on:e}}))}catch{}}function xt(e){const r=String(e||"").match(/rgba?\(\s*(\d+)[,\s]+(\d+)[,\s]+(\d+)/i);return r?{r:parseInt(r[1],10),g:parseInt(r[2],10),b:parseInt(r[3],10)}:null}function oi(e){return(.2126*e.r+.7152*e.g+.0722*e.b)/255}function en(e,t){const r=e.r-t.r,n=e.g-t.g,s=e.b-t.b;return Math.sqrt(r*r+n*n+s*s)}function ai(e){const t=Math.max(e.r,e.g,e.b),r=Math.min(e.r,e.g,e.b);return(t-r)/255}function Rs(e){const t=String(e||"").toLowerCase();return t==="transparent"||t.includes("rgba(")&&t.endsWith(", 0)")||t.includes(",0)")}function ii(){const e=Math.max(240,window.innerHeight*.6),t=Ne("div,nav,aside").map(r=>{try{const n=r.getBoundingClientRect();return n.width<40||n.width>95||n.height<e||n.left>40||n.top>80?null:{el:r,area:n.width*n.height}}catch{return null}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function li(){function e(){try{const l=localStorage.getItem(As);if(!l)return null;const a=JSON.parse(l);return!a||typeof a.r!="number"||typeof a.g!="number"||typeof a.b!="number"?null:{r:a.r,g:a.g,b:a.b}}catch{return null}}function t(l){try{localStorage.setItem(As,JSON.stringify(l))}catch{}}const r=ii()||document,n=r===document?null:(()=>{try{const l=r.getBoundingClientRect();return{top:l.top,height:l.height}}catch{return null}})(),s=Ne("div,button,a,span",r).map(l=>{try{const a=l.getBoundingClientRect();if(a.width<16||a.width>80||a.height<16||a.height>80||a.width/a.height<.7||a.width/a.height>1.3)return null;const c=getComputedStyle(l),i=parseFloat(c.borderWidth||"0"),d=parseFloat(c.outlineWidth||"0");if((Number.isNaN(i)||i<=0)&&(Number.isNaN(d)||d<=0))return null;const u=xt(c.borderColor)||xt(c.outlineColor);if(!u)return null;const f=ai(u);if(f<.1)return null;let h=1;n&&(h=(a.top-n.top)/Math.max(1,n.height)>.4?1.4:.8);const m=Math.min(a.width,a.height)>=20?1.1:1,x=(f*3+(i>=2?.2:0))*h*m;return{rgb:u,score:x}}catch{return null}}).filter(Boolean);if(s.length===0){const l=e();return l?{rgb:l,source:"cache",scope:r===document?"document":"sidebar"}:null}s.sort((l,a)=>a.score-l.score);const o=s[0];return t(o.rgb),{rgb:o.rgb,source:"borderColor",scope:r===document?"document":"sidebar"}}function Os(){const t=Ne("div,nav,header").filter(i=>{const d=D(i);return d?Es.filter(f=>d.includes(f)).length>=4:!1})[0]||null;if(!t)return{sport:null,method:"not_found"};const r=Es.filter(i=>D(t).includes(i)),n=Ne("a,button,[role='tab'],[role='button'],div,span",t).map(i=>({el:i,t:D(i)})).filter(i=>r.includes(i.t));function s(i){const d=i.getAttribute("aria-selected"),u=i.getAttribute("aria-current");if(d==="true"||u&&u!=="false"||i.getAttribute("data-active")==="true"||i.getAttribute("data-state")==="active")return!0;const f=(i.className||"").toString().toLowerCase();return!!(f.includes("active")||f.includes("selected")||f.includes("current"))}const o=n.find(i=>s(i.el));if(o)return{sport:String(o.t),method:"navbar_active_attr"};const l=li();if(l?.rgb&&n.length>0){const i=n.map(d=>{let u=1/0;try{const f=getComputedStyle(d.el),h=xt(f.color),m=xt(f.borderBottomColor),x=xt(f.borderColor);h&&(u=Math.min(u,en(l.rgb,h))),m&&!Rs(f.borderBottomColor)&&(u=Math.min(u,en(l.rgb,m))),x&&!Rs(f.borderColor)&&(u=Math.min(u,en(l.rgb,x)))}catch{}return{sport:String(d.t),dist:u}}).sort((d,u)=>d.dist-u.dist);if(i.length>0&&i[0].dist<60)return{sport:i[0].sport,method:"navbar_theme_accent",accent:l}}if(n.length>0){const i=n.map(d=>{let u=0;try{const f=getComputedStyle(d.el),h=parseInt(f.fontWeight,10);!Number.isNaN(h)&&h>=600&&(u+=2);const m=parseFloat(f.opacity);!Number.isNaN(m)&&m>=.95&&(u+=1),(f.textDecorationLine||"").includes("underline")&&(u+=2);const x=parseFloat(f.borderBottomWidth);!Number.isNaN(x)&&x>0&&(f.borderBottomStyle||"")!=="none"&&(u+=2);const w=xt(f.color);w&&(u+=oi(w))}catch{}return{sport:String(d.t),score:u}}).sort((d,u)=>u.score-d.score);if(i.length===1)return{sport:i[0].sport,method:"navbar_style_single"};if(i.length>=2&&i[0].score-i[1].score>=1)return{sport:i[0].sport,method:"navbar_style_score"}}const a=location.href.toUpperCase(),c=r.find(i=>a.includes("/"+i+"/")||a.endsWith("/"+i)||a.includes("SPORT="+i));return c?{sport:String(c),method:"url_hint"}:{sport:null,method:"navbar_no_active"}}function wt(){const e=document.querySelector("#rsdh-modal-actions");if(e){let r=e;for(let n=0;n<18&&r;n++){if((D(r).match(/\d+(?:\.\d+)?x\b/gi)||[]).length>=3)return r;r=r.parentElement}return e.parentElement}const t=Ne('div[tabindex="0"]');for(const r of t){const n=D(r);if(!n)continue;const s=/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n),o=(n.match(/\d+(?:\.\d+)?x\b/gi)||[]).length;if(s&&o>=3)return r}for(const r of t){const n=D(r);if(n&&/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n))return r}return null}function ci(e,t=[]){let r=-1;for(const n of t){const s=e.indexOf(n);s!==-1&&(r===-1||s<r)&&(r=s)}return r===-1?e:e.slice(0,r)}function ui(e,t=[]){let r=-1;for(const s of t){const o=e.indexOf(s);o!==-1&&(r===-1||o<r)&&(r=o)}if(r===-1)return"";const n=e.indexOf(`
`,r);return n===-1?"":e.slice(n+1)}function Ms(e,t=[],r=null){e=ci(e,t);const n=[];ks.lastIndex=0;let s;for(;(s=ks.exec(e))!==null;)s.index>0&&e[s.index-1]==="+"||n.push({idx:s.index,end:s.index+s[0].length,mult:parseFloat(s[1])});const o=[];for(let l=0;l<n.length&&!(typeof r=="number"&&o.length>=r);l++){const a=n[l],c=n[l+1];let i=e.slice(a.end,c?c.idx:e.length).trim();for(const f of t){const h=i.indexOf(f);h!==-1&&(i=i.slice(0,h).trim())}i=i.split(`
`)[0].trim(),i.length>80&&(i=i.slice(0,80).trim());let d=i||null,u=!1;d&&d.toLowerCase()==="empty"&&(d=null,u=!0),o.push({multiplier:a.mult,selection:d,is_empty:u})}return o}function di(e){const t=ui(e,["Press two player","Press two players"]);if(!t)return[];const r=t.split(`
`).map(l=>(l||"").trim()).filter(Boolean),n=[];let s=null;function o(){s&&(s.name&&!/%$/.test(s.name.trim())&&n.push(s),s=null)}for(const l of r){if(/^(submit|update|cancel|close|done)$/i.test(l)){o();break}if(/^(draft lineup)$/i.test(l)||/^\d+%$/.test(l))continue;const a=l.match(Va);if(a){const u=parseFloat(a[1]);s?s.boost_x=u:n.length>0&&n[n.length-1].boost_x==null&&(n[n.length-1].boost_x=u),s&&o();continue}const c=l.split("").map(u=>u.trim()).filter(Boolean),i=c[0]||l,d=c.length>1?c.slice(1).join("  "):null;s&&o(),s={name:i,status:d,boost_x:null}}return o(),n}function fi(e){const t=/\+(\d+(?:\.\d+)?)x\b/i,r=Ne("div[tabindex='0'],[role='button'],button,a",e).filter(o=>{const l=D(o);if(!l||!t.test(l))return!1;const a=o.getBoundingClientRect();return a.width>120&&a.height>=28}).slice(0,400),n=new Set,s=[];for(const o of r){const l=D(o),a=l.match(t);if(!a)continue;const c=parseFloat(a[1]);if(!Number.isFinite(c))continue;const d=l.slice(0,l.toLowerCase().lastIndexOf(a[0].toLowerCase())).trim().split("").map(L=>L.trim()).filter(Boolean),u=d[0]||"";if(!u)continue;const f=d.length>1?d.slice(1).join("  "):null,h=u.toLowerCase();if(n.has(h))continue;let m=null;const x=o.querySelector("a[href]")||o.parentElement?.querySelector("a[href]")||o.closest("a[href]");if(x?.getAttribute("href")&&(m=x.getAttribute("href")),!m){const L=o.querySelector("svg")||o.parentElement?.querySelector("svg"),R=L?L.closest("a[href]"):null;R?.getAttribute("href")&&(m=R.getAttribute("href"))}const w=m?new URL(m,location.href).toString():null;s.push({name:u,status:f,boost_x:c,profile_url:w}),n.add(h)}return s}function pi(){const e=Ne("div,button").filter(n=>{const s=D(n);return s.includes("Draft")&&/\bUpdate\b/i.test(s)&&/\bx\b/i.test(s)}),t=new Set,r=[];for(const n of e){const s=D(n);!s||t.has(s)||(t.add(s),r.push(n))}return r.slice(0,10)}function hi(){function e(n){try{n.scrollIntoView({block:"center",inline:"center"})}catch{}try{n.focus()}catch{}let s=0,o=0;try{const l=n.getBoundingClientRect();s=Math.max(1,Math.floor(l.left+l.width/2)),o=Math.max(1,Math.floor(l.top+l.height/2))}catch{}try{const l=window.PointerEvent;typeof l=="function"&&(n.dispatchEvent(new l("pointerdown",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:s,clientY:o})),n.dispatchEvent(new l("pointerup",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:s,clientY:o})))}catch{}try{n.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:o}))}catch{}try{n.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:o}))}catch{}try{n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:o}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.click()}catch{}}const t=document.querySelector("#realrootcontents")||document,r=Ne("div[tabindex='0'],button,[role='button'],a,span",t).map(n=>{const s=D(n);if(!s||!/^(draft|update)$/i.test(s.trim()))return null;const o=n.getBoundingClientRect();if(!(o.width>=60&&o.width<=500&&o.height>=20&&o.height<=80))return null;const l=o.top>=0&&o.top<=window.innerHeight?1.5:1,a=o.width*l;return{el:n,score:a,text:s.trim()}}).filter(Boolean);return r.length===0?!1:(r.sort((n,s)=>s.score-n.score),e(r[0].el),!0)}async function mi(e){const t=e.timeoutMs,r=Date.now();function n(){return document.querySelector("#rsdh-modal-actions")?!0:!!wt()}function s(){const a=document.querySelector("#realrootcontents")||document,c=Ne("div[tabindex='0'],button,[role='button'],a,span",a).map(i=>{const d=D(i);if(!d||!/^(draft|update)$/i.test(d.trim()))return null;const u=i.getBoundingClientRect();return u.width>=60&&u.width<=500&&u.height>=20&&u.height<=80?{el:i,width:u.width}:null}).filter(Boolean);return c.length===0?null:(c.sort((i,d)=>d.width-i.width),c[0].el)}function o(a){try{const c=a.getBoundingClientRect(),i=Math.floor(c.left+c.width/2),d=Math.floor(c.top+c.height/2),u=document.elementFromPoint(i,d);return u===a||!!u&&a.contains(u)}catch{return!0}}for(;Date.now()-r<t;){if(n())return{clicked:!1,opened:!0};const a=s();if(a&&o(a))break;await new Promise(c=>setTimeout(c,200))}let l=!1;for(let a=0;a<3&&Date.now()-r<t;a++){if(n())return{clicked:l,opened:!0};const c=s();if(!c){await new Promise(d=>setTimeout(d,250));continue}try{l=hi()||l}catch{}if(!n()){const d=c.parentElement;if(d){try{d.scrollIntoView({block:"center"})}catch{}try{d.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0}))}catch{}}}if(await new Promise(d=>{const u=Date.now()+2200,f=()=>{if(n())return d(!0);if(Date.now()>u)return d(!1);setTimeout(f,100)};f()}))return{clicked:l,opened:!0};await new Promise(d=>setTimeout(d,350))}return{clicked:l,opened:n()}}function vi(e){const t=D(e),r=["Update",...Ja],n=Ms(t,r);return{text:t.slice(0,500),slots:n}}function gi(e={}){const t=typeof e.includeDebug=="boolean"?e.includeDebug:lt(),r=Os(),n=wt();if(!n){const u=pi().map(vi).filter(f=>f.slots.length>0);return u.length===0?{ok:!1,error:"Draft modal not found. Click the site's Draft/Update button to open the Draft Lineup modal, then click Capture again.",url:location.href,sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{}}:{ok:!0,mode:"tile",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{},drafts:u}}const s=D(n),o=s.match(/Select\s+(\d+)\s+players/i),l=o?parseInt(o[1],10):null,c=Ms(s,["Press two player","Press two players"],l),i=fi(n),d=i.length>0?i:di(s);return{ok:!0,mode:"modal",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{},...t?{modal_text_sample:s.slice(0,400)}:{},expected_slots:l,slots:c,player_pool_count:d.length,player_pool:d}}function Is(e){let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]);const r=(t||[]).map((i,d)=>{const u=i.selection?`selected="${i.selection}"`:"selected=<empty>";return`- slot ${d+1}: multiplier=${i.multiplier}x, ${u}`}).join(`
`),n=Array.isArray(e?.player_pool)?e.player_pool:[],s=n.slice(0,Xa),o=s.map(i=>{const d=i.status?` (${i.status})`:"",u=typeof i.boost_x=="number"?` +${i.boost_x}x`:"";return`- ${i.name}${d}${u}`}).join(`
`),l=n.length>s.length?`NOTE: player pool truncated to first ${s.length} of ${n.length} for prompt size. For the full list, re-capture and inspect the payload in Debug Mode.`:`Player pool items: ${n.length}.`,a=typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:Array.isArray(t)?t.length:5;return{context:["You are helping build an optimal Draft Lineup.","","### Context (captured from realsports.io UI)",`URL: ${e?.url||"<unknown>"}`,`Captured At: ${e?.captured_at||"<unknown>"}`,`Capture Mode: ${e?.mode||"<unknown>"}`,`Sport: ${e?.sport||"<unknown>"}`,"","### Rules / how scoring multipliers work",`- You must select EXACTLY ${a} unique players.`,"- Each lineup slot has a slot multiplier (e.g. 2.0x, 1.8x, 1.6x...).","- Each player also has a boost shown as +Bx (e.g. +0.9x).","- ASSUME boosts are additive with the slot multiplier:","  effective_multiplier = slot_multiplier + player_boost_x","  example: slot 2.0x + player +0.9x => effective 2.9x","- Goal: assign the best combination of players to slots to maximize expected Real score.","","### Betting payouts (Rax)","- Entry fee is ALWAYS 100 Rax for any bet tier.","- If lineup finishes Top 50%: payout 170 Rax (profit +70).","- If lineup finishes Top 20%: payout 350 Rax (profit +250).","- If lineup finishes Top 10%: payout 700 Rax (profit +600).","","Slots (higher multiplier = bigger boost):",r||"- <no slots found>","","Available player pool (with their +boost values shown in the UI):",o||"- <no pool detected>",l,"","### Task","Choose exactly the required number of players from the pool and assign them to slots.","Prefer players who are not Out/Inactive (if status is provided).","Explain briefly why each player goes into each slot.","Also provide bet recommendations for: Top 50%, Top 20%, Top 10.",""].join(`
`),expectedSlots:a}}function Ns(e){const{context:t,expectedSlots:r}=Is(e);return[t,"### Output format (human-readable)","Reply in plain English with these sections:","1) Lineup (final)",`- List exactly ${r} slots in order (slot 1..${r}), showing: player, slot multiplier, player boost, and effective multiplier.`,"2) Why this lineup","- 13 bullets summarizing the approach.","3) Slot-by-slot rationale","- Short note per slot explaining the assignment.","4) Bets","- Recommendations for Top 50%, Top 20%, Top 10 (recommend yes/no + confidence + one sentence reason).","","Do NOT include JSON. Keep it readable and actionable."].join(`
`)}function Ls(e,t){const{context:r}=Is(e),n=t?.webHint?"If web search is available, use it ONLY to verify time-sensitive info like injury status, starters, scratches, minutes restrictions, and recent news.":null,s=t?.toolHint?["","### Player Profile Lookup Tool","You have access to `get_player_profile_stats` - use it to fetch detailed stats for any player when:","- Boost values alone aren't enough to decide between players","- You need recent performance data (game logs, rankings, trends)","- A player's floor/ceiling matters for the decision","Call it with the player's name exactly as shown in the pool. The tool will scrape their profile and return stats.",""].join(`
`):"If you need player projections/stats beyond the boost values, DO NOT ask the user generic follow-up questions. Instead, request player profile stats using the tool for specific players you want to evaluate.",o=t?.searchHint?["","### Draft Player Search Tool","The initial player pool shows up to ~50 players, but more may be available.","You have access to `search_draft_players` - use it to find specific players by:","- Player name (e.g. 'McDavid')","- Position (e.g. 'goalie', 'QB', 'center')","- Team name (e.g. 'Oilers', 'Chiefs')","This is useful when you want to check if a specific player is available that isn't in the current list.",""].join(`
`):"";return[r,n?`
${n}
`:"",s,o,"Return data that matches the provided JSON schema exactly."].join(`
`).trim()}function bi(){try{return localStorage.getItem(Cs)||""}catch{return""}}function _i(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));return Ns(t)}function yi(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));const r=S(Vt,"1")!=="0",n=S(Xt,"1")!=="0";return Ls(t,{toolHint:r,searchHint:n})}const tn="rsdh_user_identity";function rn(){try{const e=localStorage.getItem(tn);if(!e)return null;const t=JSON.parse(e);return t?.username&&t?.displayName?t:null}catch{return null}}function xi(e){localStorage.setItem(tn,JSON.stringify(e))}function wi(){localStorage.removeItem(tn)}function Si(){const e=window.location.href;return e==="https://realsports.io/"||e==="https://realsports.io"||e.startsWith("https://realsports.io/?")||e.startsWith("https://realsports.io/#")}function ki(){const e=Array.from(document.querySelectorAll("img"));for(const t of e)if((t.getAttribute("src")||"").includes("media.realapp.com/assets/user/")){const n=t.closest('[tabindex="0"]');if(n)return n}return null}async function Ei(){const e=ki();return e?(e.click(),await new Promise(t=>setTimeout(t,500)),!0):!1}function Ai(){if(!Si())return null;const e=Array.from(document.querySelectorAll("div"));let t=null,r=null;for(const c of e){const i=c.textContent?.trim()||"";if(i.startsWith("@")&&i.length>1&&i.length<30&&!i.includes(" ")&&c.closest('[style*="padding-top"]')?.textContent?.includes("Karma")){t=c;break}}if(!t)return null;const n=t.parentElement;if(n){const c=n.parentElement?.parentElement;if(c){const i=Array.from(c.querySelectorAll("div"));for(const d of i){const u=d.textContent?.trim()||"";if(u&&!u.startsWith("@")&&!u.includes("@")&&u.length>1&&u.length<50&&d!==t&&!u.includes("Karma")&&!u.includes("Rax")&&d.childElementCount===0){r=d;break}}}}const s=t.textContent?.trim().replace(/^@/,"")||"",o=r?.textContent?.trim()||s;let l,a=t;for(let c=0;c<10&&a&&!l;c++)if(a=a.parentElement,a){const i=Array.from(a.querySelectorAll("img"));for(const d of i){const u=d.getAttribute("src")||"";if(u.includes("media.realapp.com/assets/user/")){l=u.replace(/\/(xsmall|small)\//,"/large/");break}}}return s?{username:s,displayName:o,avatarUrl:l,linkedAt:new Date().toISOString()}:null}function Ti(e){return e?`rgb(${e.r}, ${e.g}, ${e.b})`:null}function Ci(){try{const t=Os()?.accent?.rgb;return Ti(t||null)}catch{return null}}const Bs="rsdh-debug-highlight-",Pi=999999;function Ds(e,t,r="rgba(4, 131, 215, 0.4)"){if(!e||!lt())return null;const n=Bs+Date.now(),s=e.getBoundingClientRect(),o=document.createElement("div");o.id=n,o.style.cssText=`
    position: fixed;
    top: ${s.top}px;
    left: ${s.left}px;
    width: ${s.width}px;
    height: ${s.height}px;
    background: ${r};
    border: 2px solid ${r.replace(/[\d.]+\)$/,"0.9)")};
    border-radius: 4px;
    z-index: ${Pi};
    pointer-events: none;
    transition: opacity 0.3s ease;
  `;const l=document.createElement("div");return l.style.cssText=`
    position: absolute;
    bottom: 100%;
    left: 0;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    padding: 4px 8px;
    font-size: 12px;
    font-family: system-ui, sans-serif;
    border-radius: 4px;
    white-space: nowrap;
    margin-bottom: 4px;
  `,l.textContent=t,o.appendChild(l),document.body.appendChild(o),n}function Fs(e){if(e)try{document.getElementById(e)?.remove()}catch{}}function Ri(){try{document.querySelectorAll(`[id^="${Bs}"]`).forEach(e=>e.remove())}catch{}}function St(e,t){const r=t?.timeoutMs??8e3,n=t?.intervalMs??100,s=Date.now();return new Promise(o=>{const l=()=>{if(e())return o(!0);if(Date.now()-s>r)return o(!1);setTimeout(l,n)};l()})}function Oi(e){try{e.focus()}catch{}let t=0,r=0;try{const n=e.getBoundingClientRect();t=Math.max(1,Math.floor(n.left+n.width/2)),r=Math.max(1,Math.floor(n.top+n.height/2))}catch{}try{const n=window.PointerEvent;typeof n=="function"&&(e.dispatchEvent(new n("pointerdown",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})),e.dispatchEvent(new n("pointerup",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})))}catch{}try{e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.click()}catch{}}function Mi(e,t=6e3){try{const r=JSON.stringify(e);return r?r.length<=t?e:{_truncated:!0,_len:r.length}:null}catch{return{_unserializable:!0}}}function Ii(){try{const e=String(localStorage.getItem(xr)||"");if(!e.trim())return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function Ni(e){try{localStorage.setItem(xr,JSON.stringify(e.slice(-250)))}catch{}}function E(e,t,r){if(!lt())return;const n={t:new Date().toISOString(),kind:e,scope:r?.scope,msg:String(t||""),data:Mi(r?.data)},s=Ii();s.push(n),Ni(s);try{window.dispatchEvent(new CustomEvent("rsdh-debug-event",{detail:n})),window.dispatchEvent(new CustomEvent("rsdh-debug-events",{detail:{events:s.slice(-250)}}))}catch{}}let Ke=null;function Li(){return Ke&&document.body.contains(Ke)||(Ke=document.createElement("div"),Ke.id="rsdh-toast-container",Ke.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 2147483647;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: flex-start;
    pointer-events: none;
  `,document.body.appendChild(Ke)),Ke}function nn(e,t="info",r=3e3){const n=Li(),s=document.createElement("div");if(s.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
    font-size: 13px;
    font-weight: 600;
    padding: 12px 20px;
    border-radius: 10px;
    color: white;
    pointer-events: auto;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    animation: toastIn 0.25s ease;
    max-width: 320px;
    text-align: center;
    ${t==="success"?"background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); border: 1px solid rgba(34, 197, 94, 0.3);":t==="error"?"background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); border: 1px solid rgba(239, 68, 68, 0.3);":"background: linear-gradient(135deg, #2c6cff 0%, #1d4ed8 100%); border: 1px solid rgba(44, 108, 255, 0.3);"}
  `,s.textContent=e,!document.getElementById("rsdh-toast-styles")){const o=document.createElement("style");o.id="rsdh-toast-styles",o.textContent=`
      @keyframes toastIn {
        from { opacity: 0; transform: translateY(20px) scale(0.95); }
        to { opacity: 1; transform: translateY(0) scale(1); }
      }
      @keyframes toastOut {
        from { opacity: 1; transform: translateY(0) scale(1); }
        to { opacity: 0; transform: translateY(-10px) scale(0.95); }
      }
    `,document.head.appendChild(o)}n.appendChild(s),setTimeout(()=>{s.style.animation="toastOut 0.2s ease forwards",setTimeout(()=>{s.remove()},200)},r)}const Zt=(e,t)=>nn(e,"success",t),ct=(e,t)=>nn(e,"error",t),$s=(e,t)=>nn(e,"info",t);function sn(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div, span, button"));let r=null,n=null,s=null;for(const o of t){const l=D(o).trim().toLowerCase(),a=o.getBoundingClientRect();if(!(a.width<=20||a.width>200||a.height<=10||a.height>60)){if(l==="feed"){r=o;const c=window.getComputedStyle(o);(o.className.includes("r-1q142lx")||c.borderBottomColor==="rgb(4, 131, 215)"||c.color==="rgb(4, 131, 215)"||o.getAttribute("aria-selected")==="true")&&(s="feed")}else if(l==="plays"){n=o;const c=window.getComputedStyle(o);(o.className.includes("r-1q142lx")||c.borderBottomColor==="rgb(4, 131, 215)"||c.color==="rgb(4, 131, 215)"||o.getAttribute("aria-selected")==="true")&&(s="plays")}}}if(s===null&&(r||n)){const o=D(e).toLowerCase();/\d+(?:\.\d+)?\s*fps\s+\d/.test(o)&&/vs\s+[A-Z]{2,4}|@\s+[A-Z]{2,4}/i.test(o)?s="feed":/\d+-\d+\s+P\d+\s+\d{1,2}:\d{2}/i.test(o)&&(s="plays")}return{feedBtn:r,playsBtn:n,activeTab:s}}async function Bi(){const{feedBtn:e,activeTab:t}=sn();if(E("info",`Toggle to Feed: activeTab=${t}, feedBtn=${e?"found":"not found"}`,{scope:"scrape"}),t==="feed")return!0;if(!e)return!1;E("step","Clicking Feed button with humanActivate",{scope:"scrape"}),Oi(e);const r=await St(()=>sn().activeTab==="feed",{timeoutMs:4e3});return E("info",`Feed tab switch result: ${r}`,{scope:"scrape"}),r}function Di(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div,header")).map(r=>{const n=D(r);if(!n||!n.includes("Player"))return null;const s=r.getBoundingClientRect();return s.top<-5||s.top>80||s.height<32||s.height>90?null:{el:r,area:s.width*s.height}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function Fi(){const e=Di();if(!e)return!1;const r=Array.from(e.querySelectorAll("button,[role='button'],a,div[tabindex='0']")).map(n=>{const s=n.getBoundingClientRect();if(s.width<=0||s.height<=0||s.width>80||s.height>80)return null;const o=Math.max(0,120-s.left),l=n.querySelector("svg")?20:0,a=D(n).toLowerCase(),c=(n.getAttribute("aria-label")||"").toLowerCase(),i=a.includes("back")||c.includes("back")?30:0;return{el:n,score:o+l+i}}).filter(Boolean);if(r.length===0)return!1;r.sort((n,s)=>s.score-n.score);try{return r[0].el.click(),!0}catch{return!1}}const $i={code:"NHL",name:"National Hockey League",stats:[{code:"G",name:"Goals",aliases:["goal","goals","g"],isPrimary:!0},{code:"A",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"PTS",name:"Points",aliases:["pt","pts","points"],isPrimary:!0},{code:"SOG",name:"Shots on Goal",aliases:["sog","shot","shots"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"HIT",name:"Hits",aliases:["hit","hits"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]},{code:"PIM",name:"Penalty Minutes",aliases:["pim","penalty"]},{code:"FOW",name:"Faceoff Wins",aliases:["fow","fo","faceoff"]},{code:"FO%",name:"Faceoff Percentage",aliases:["fo%","fopct"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"GA",name:"Goals Against",aliases:["ga","goalsagainst"]},{code:"SV%",name:"Save Percentage",aliases:["sv%","savepct"]},{code:"GAA",name:"Goals Against Average",aliases:["gaa"]},{code:"SO",name:"Shutouts",aliases:["so","shutout","shutouts"]},{code:"GP",name:"Games Played",aliases:["gp","games"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"OTL",name:"Overtime Losses",aliases:["otl","ot loss"]},{code:"TOI",name:"Time on Ice",aliases:["toi"]},{code:"GVA",name:"Giveaways",aliases:["gva","gwa","giveaway","giveaways"]},{code:"TKA",name:"Takeaways",aliases:["tka","takeaway","takeaways"]},{code:"PPG",name:"Power Play Goals",aliases:["ppg","pp goal"]},{code:"SHG",name:"Short Handed Goals",aliases:["shg","sh goal"]}],periods:{pattern:/P[1-3]|OT\d?|SO/i,labels:["P1","P2","P3","OT","SO"],hasClock:!0,timePattern:/:?\d{1,2}(?::\d{2})?/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["G","A","PTS","SOG","BLK"]},on={code:"NBA",name:"National Basketball Association",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"FGM",name:"Field Goals Made",aliases:["fgm","fg"]},{code:"FGA",name:"Field Goals Attempted",aliases:["fga"]},{code:"3PM",name:"3-Pointers Made",aliases:["3pm","3pt","three","threes"],isPrimary:!0},{code:"3PA",name:"3-Pointers Attempted",aliases:["3pa"]},{code:"FTM",name:"Free Throws Made",aliases:["ftm","ft"]},{code:"FTA",name:"Free Throws Attempted",aliases:["fta"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"],isPrimary:!0},{code:"OREB",name:"Offensive Rebounds",aliases:["oreb","or"]},{code:"DREB",name:"Defensive Rebounds",aliases:["dreb","dr"]},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"],isPrimary:!0},{code:"BLK",name:"Blocks",aliases:["blk","block","blocks"],isPrimary:!0},{code:"MIN",name:"Minutes",aliases:["min","mins","minutes"]},{code:"PF",name:"Personal Fouls",aliases:["pf","foul","fouls"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","REB","AST","STL","BLK","3PM"]},qs={code:"NFL",name:"National Football League",stats:[{code:"PASS_YD",name:"Passing Yards",aliases:["pass yd","pass yds","passing","pass"],isPrimary:!0},{code:"PASS_TD",name:"Passing Touchdowns",aliases:["pass td","pass tds","ptd"]},{code:"INT",name:"Interceptions Thrown",aliases:["int","ints","interception"]},{code:"CMP",name:"Completions",aliases:["cmp","comp","completions"]},{code:"ATT",name:"Pass Attempts",aliases:["att","attempts"]},{code:"RUSH_YD",name:"Rushing Yards",aliases:["rush yd","rush yds","rushing","rush"],isPrimary:!0},{code:"RUSH_TD",name:"Rushing Touchdowns",aliases:["rush td","rush tds","rtd"]},{code:"CAR",name:"Carries",aliases:["car","carry","carries"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception","receptions"],isPrimary:!0},{code:"REC_YD",name:"Receiving Yards",aliases:["rec yd","rec yds","receiving"]},{code:"REC_TD",name:"Receiving Touchdowns",aliases:["rec td","rec tds"]},{code:"TGT",name:"Targets",aliases:["tgt","target","targets"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown","touchdowns"],isPrimary:!0},{code:"YD",name:"Total Yards",aliases:["yd","yds","yards"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"XP",name:"Extra Points",aliases:["xp","pat","extra point"]},{code:"SACK",name:"Sacks",aliases:["sack","sacks","sk"]},{code:"TKL",name:"Tackles",aliases:["tkl","tackle","tackles"]},{code:"FF",name:"Forced Fumbles",aliases:["ff","forced fumble"]},{code:"FR",name:"Fumble Recoveries",aliases:["fr","fumble recovery"]},{code:"DEF_INT",name:"Defensive Interceptions",aliases:["def int","pick"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PASS_YD","RUSH_YD","REC","TD"]},qi={code:"MLB",name:"Major League Baseball",stats:[{code:"H",name:"Hits",aliases:["h","hit","hits"],isPrimary:!0},{code:"HR",name:"Home Runs",aliases:["hr","hrs","homer","homers","home run"],isPrimary:!0},{code:"RBI",name:"Runs Batted In",aliases:["rbi","rbis"],isPrimary:!0},{code:"R",name:"Runs",aliases:["r","run","runs"],isPrimary:!0},{code:"SB",name:"Stolen Bases",aliases:["sb","stolen","steal","steals"]},{code:"BB",name:"Walks",aliases:["bb","walk","walks"]},{code:"K",name:"Strikeouts",aliases:["k","so","strikeout","strikeouts"]},{code:"AB",name:"At Bats",aliases:["ab","at bat","at bats"]},{code:"2B",name:"Doubles",aliases:["2b","double","doubles"]},{code:"3B",name:"Triples",aliases:["3b","triple","triples"]},{code:"AVG",name:"Batting Average",aliases:["avg","average"]},{code:"IP",name:"Innings Pitched",aliases:["ip","innings"]},{code:"ER",name:"Earned Runs",aliases:["er","earned run","earned runs"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"ERA",name:"Earned Run Average",aliases:["era"]},{code:"WHIP",name:"Walks+Hits per IP",aliases:["whip"]},{code:"QS",name:"Quality Starts",aliases:["qs","quality start"]}],periods:{pattern:/(?:Top|Bot|T|B)\s*\d+|Inning\s*\d+|\d+(?:st|nd|rd|th)/i,labels:["1st","2nd","3rd","4th","5th","6th","7th","8th","9th","Extra"],hasClock:!1},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["H","HR","RBI","R","SB"]},an={code:"NFL",name:"Generic Sport",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"]},{code:"G",name:"Goals",aliases:["goal","goals","g"]},{code:"SOG",name:"Shots",aliases:["sog","shot","shots"]},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"3PM",name:"3-Pointers",aliases:["3pm","3pt","three","threes"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown"]},{code:"YD",name:"Yards",aliases:["yd","yds","yards"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception"]},{code:"BIRDIE",name:"Birdies",aliases:["birdie","birdies"]},{code:"PAR",name:"Pars",aliases:["par","pars"]},{code:"BOGEY",name:"Bogeys",aliases:["bogey","bogeys"]},{code:"EAGLE",name:"Eagles",aliases:["eagle","eagles"]},{code:"KO",name:"Knockouts",aliases:["ko","knockout","knockouts"]},{code:"SUB",name:"Submissions",aliases:["sub","submission","submissions"]},{code:"TKD",name:"Takedowns",aliases:["tkd","takedown","takedowns"]},{code:"STR",name:"Strikes",aliases:["str","strike","strikes"]},{code:"GLS",name:"Goals",aliases:["gls","goal","goals"]},{code:"SHT",name:"Shots",aliases:["sht","shot","shots"]},{code:"SOT",name:"Shots on Target",aliases:["sot"]},{code:"CRN",name:"Corners",aliases:["crn","corner","corners"]}],periods:{pattern:/(?:P[1-3]|Q[1-4]|H[1-2]|OT\d?|SO|R\d+|RD\s*\d+)/i,labels:["1","2","3","4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","G","TD","REC"]};function Yi(e,t){return{...an,code:e,name:t}}const Hi={NHL:$i,NBA:on,NFL:qs,MLB:qi,CFB:{...qs,code:"CFB",name:"College Football"},CBB:{...on,code:"CBB",name:"College Basketball"},WNBA:{...on,code:"WNBA",name:"Women's NBA"},FC:Yi("FC","Football Club / Soccer")};function Ui(e){if(!e)return an;const t=e.toUpperCase().trim();return Hi[t]||an}function ln(e){return(e||"").trim().toLowerCase()}function zi(e){const t=(e||"").trim(),r=t.split("").map(o=>o.trim()).filter(Boolean),n=r[0]||t,s=r.slice(1).join("  ");return{name:n,rest:s}}function Ys(e,t){const r=ln(t);if(!r)return null;const n=/\+(\d+(?:\.\d+)?)x\b/i,s=Array.from(e.querySelectorAll("div[tabindex='0'],[role='button'],button")).map(o=>{const l=D(o);if(!l||!n.test(l))return null;const{name:a}=zi(l),c=o.getBoundingClientRect();if(c.width<=140||c.height<28)return null;const i=(ln(a)===r?1e3:ln(a).includes(r)?100:0)+Math.min(200,Math.round(c.width));return i<=0?null:{el:o,score:i,rect:c,name:a}}).filter(Boolean);return s.length===0?null:(s.sort((o,l)=>l.score-o.score),s[0].el)}function Hs(e){const s=Array.from(e.querySelectorAll("a[href],a,button,div[tabindex='0'],[role='button']")).filter(a=>!!a.querySelector("svg")).map(a=>({el:a,r:a.getBoundingClientRect()})).filter(a=>a.r.width>8&&a.r.width<=28&&a.r.height>8&&a.r.height<=28);if(s.length===0)return null;s.sort((a,c)=>c.r.left-a.r.left);const o=s[0].el;return(o instanceof HTMLAnchorElement?o:null)||o.querySelector("a[href]")||o.closest("a[href]")||o}async function Gi(e){const t=wt();if(!t)return E("warn","No modal found for profile URL discovery",{scope:"profile"}),null;E("step",`Finding player row: ${e}`,{scope:"profile"});const r=Ys(t,e);if(!r)return E("warn","Player row not found",{scope:"profile"}),null;const n=Hs(r);if(!n)return E("warn","Profile icon button not found",{scope:"profile"}),null;const s=n instanceof HTMLAnchorElement?n:n.closest("a[href]");if(s?.getAttribute("href")){const o=new URL(String(s.getAttribute("href")),location.href).toString();return E("info","Got profile URL from href",{scope:"profile",data:{url:o}}),o}return E("info","No href on icon, will click to navigate",{scope:"profile"}),"__CLICK_TO_NAVIGATE__"}function ji(e){const t=e.querySelector("#realrootcontents")||e.querySelector("#realweb")||e.body,n=Array.from(t.querySelectorAll("div,section,header,article")).slice(0,2e3).map(s=>{const o=(D(s)||"").replace(/\s+/g," ").trim();if(!o||o.length<40||o.length>320)return null;const l=o.toUpperCase();let a=0;return l.includes("7-DAY")&&(a+=4),l.includes("30-DAY")&&(a+=4),l.includes("SEASON")&&(a+=3),l.includes("CARD")&&(a+=2),o.includes("")&&(a+=2),/#\d+/.test(o)&&(a+=1),/\b\d+(st|nd|rd|th)\b/i.test(o)&&(a+=2),a<6?null:{t:o,score:a}}).filter(Boolean);return n.length===0?null:(n.sort((s,o)=>o.score-s.score),n[0].t)}function Ki(e){const t={},r=e.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/gi);if(r)for(const s of r){const o=s.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/i);if(o){const l=parseInt(o[1],10),a=o[3]||"overall";t[`rank_${a.toLowerCase().replace("-","_")}`]=l}}const n=e.match(/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)\s*\s*([A-Z]+)\s*\s*#(\d+)/);return n&&(t.team=n[1],t.position=n[2],t.number=parseInt(n[3],10)),t}function Wi(e){const t=e.replace(/\s+/g," "),r=/([A-Z]+(?:%||\+\/-)?)\s+(-?\d+(?:\.\d+)?(?::\d+)?)\s+(\d+)(?:st|nd|rd|th)\b/gi,n=[];let s;for(;(s=r.exec(t))!==null;)n.push({stat:s[1],value:s[2],rank:parseInt(s[3],10)});return n.length>0?{entries:n}:null}function Us(e){const t=e.replace(/\s+/g," ");let r=[];const n=t.match(/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps[^A-Z]*/gi);if(n&&(r=n.map(s=>s.trim().slice(0,200)).filter(s=>s.length>20).slice(0,15)),r.length===0){const s=e.split(/\n/).map(o=>o.trim()).filter(Boolean);for(const o of s)if((/\d+(?:\.\d+)?\s*fps/i.test(o)||/\d+(?:\.\d+)?\s*@\s*[A-Z]{2,4}/i.test(o))&&(r.push(o.slice(0,200)),r.length>=15))break}return r.length>0?{entries:r}:null}function zs(e){const t=e.replace(/\s+/g," "),r=[],n=/([A-Z]\.[\s]*[\w'-]+)\s*\s*(\d+(?:\.\d+)?)\s*fps\s+([\d.]+)?/gi;let s;const o=[];for(;(s=n.exec(t))!==null&&(o.push({player:s[1].trim(),fps:parseFloat(s[2]),multiplier:s[3]?parseFloat(s[3]):null,startIdx:s.index,endIdx:s.index+s[0].length}),!(o.length>=30)););for(let l=0;l<o.length;l++){const a=o[l],c=o[l+1]?.startIdx??t.length,i=t.slice(a.endIdx,c).trim(),d=i.match(/(\d+\s+(?:hours?|days?|weeks?|months?)\s+ago|yesterday|today)/i),u=i.match(/(vs|@)\s*([A-Z]{2,4})\s*([WL])?/i);let f=i;d?f=i.slice(0,d.index).trim():u&&(f=i.slice(0,u.index).trim()),f=f.replace(/\s+\d+\s*$/,"").trim(),r.push({player:a.player,fps:a.fps,multiplier:a.multiplier,stats:f.slice(0,100),date:d?.[1]||"",opponent:u?.[2]||"",result:u?.[3]||""})}return r}async function Ji(e,t,r=null){Ui(r),E("step","Scraping profile from current DOM",{scope:"scrape"});const n=ji(document),s=n?Ki(n):null,o=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,l=D(o),a=Wi(l),{activeTab:c}=sn();E("info",`Initial tab: ${c||"unknown"}`,{scope:"scrape"});let i=[],d=null;if(c==="plays"){if(E("step","Switching to Feed tab",{scope:"scrape"}),await Bi()){await St(()=>{const m=D(o).replace(/\s+/g," ");return/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(m)},{timeoutMs:3e3,intervalMs:100});const h=D(o);i=zs(h),d=Us(h)}}else i=zs(l),d=Us(l);E("info",`Feed extraction: ${i.length} entries`,{scope:"scrape"});const u={player_name:e,profile_url:t,title:document.title||"",header_text:n,header_parsed:s,season_summary:a,recent_performances:d,feed_entries:i,active_tab:c,raw_text_length:l.length};return E("info","Scrape complete",{scope:"scrape",data:{header:!!n,season_summary:a?.entries?.length??0,recent_performances:d?.entries?.length??0,feed_entries:i.length,active_tab:c}}),u}async function Vi(e){const t=location.href,r=e.profile_url==="__CLICK_TO_NAVIGATE__";E("step","Starting profile scrape flow",{scope:"flow",data:{player_name:e.player_name,profile_url:r?"(will click icon)":e.profile_url,return_to_draft:e.return_to_draft}});const n=wt();E("info",`Draft modal at start: ${n?"found":"not found"}`,{scope:"flow"}),E("step","Navigating to profile page",{scope:"flow"});const s=n?Ys(n,e.player_name):null,o=s?Hs(s):null;let l=null,a=null;if(s&&lt()&&(l=Ds(s,`Player: ${e.player_name}`,"rgba(0, 161, 99, 0.3)")),o&&lt()&&(a=Ds(o,"Profile Icon","rgba(4, 131, 215, 0.5)")),r||o)o?(E("step","Clicking profile icon",{scope:"flow"}),o.click()):E("warn","Could not find icon button to click",{scope:"flow"});else if(e.profile_url&&!r){E("step","Using pushState to navigate",{scope:"flow"});try{const h=new URL(e.profile_url,location.href);history.pushState({},"",h.pathname+h.search+h.hash),window.dispatchEvent(new PopStateEvent("popstate"))}catch(h){E("warn","pushState failed",{scope:"flow",data:{error:String(h)}})}}Fs(l),Fs(a),E("step","Waiting for profile page to load",{scope:"flow"});const c=await St(()=>location.href!==t,{timeoutMs:6e3,intervalMs:100});E("info",`Navigation result: ${c?"URL changed":"URL unchanged"}`,{scope:"flow",data:{prevUrl:t,currentUrl:location.href}}),c&&(E("step","Waiting for profile content to render",{scope:"flow"}),await St(()=>{const h=document.querySelector("#realrootcontents")||document.body,m=D(h),x=/[A-Z]\.\s*[\w'-]+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(m),w=/PTS\s+\d+\s+\d+/i.test(m)||/GOAL\s+\d+/i.test(m);return x||w},{timeoutMs:1e4,intervalMs:100}));const i=c?location.href:e.profile_url,d=await Ji(e.player_name,i,e.sport||null);let u=!1,f=!1;if(e.return_to_draft&&c){E("step","Going back to home page",{scope:"flow"});try{history.back()}catch{}if(u=await St(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}),u||(E("step","Clicking back button in nav",{scope:"flow"}),Fi()&&(u=await St(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}))),E("info",`Returned to home: ${u}`,{scope:"flow",data:{currentUrl:location.href}}),u)if(E("step","Reopening draft modal",{scope:"flow"}),await new Promise(h=>setTimeout(h,500)),wt())f=!0,E("info","Modal already open",{scope:"flow"});else{const h=await mi({timeoutMs:8e3});f=h.opened,E("info",`Modal reopen attempt: clicked=${h.clicked}, opened=${h.opened}`,{scope:"flow"})}}return Ri(),{...d,return_to_draft:e.return_to_draft,returned_to_draft:u,modal_reopened:f,prev_url:t,navigated_to_profile:c,modal_was_open:!!n}}function K(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function cn(e){const t=typeof e=="number"&&!Number.isNaN(e)?e:null;return t==null?"":`${(Math.round(t*100)/100).toString()}x`}function Xi(e){if(!e||e.ok!==!0)return`<div class="card"><div class="h">Nothing captured</div><div class="sub">${K(e?.error||"Open a draft modal and click Capture.")}</div></div>`;let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]);const r=typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:t.length,n=e?.sport||"",s=e?.mode||"",o=Array.isArray(e?.player_pool)?e.player_pool:[],l=(t||[]).map((i,d)=>{const u=i?.selection?K(i.selection):"<span class='muted'>Empty</span>",f=cn(i?.multiplier);return`<tr><td>${d+1}</td><td>${f}</td><td>${u}</td></tr>`}).join(""),a=o.slice(0,40).map(i=>{const d=K(i?.name||""),u=i?.status?`<span class="muted">(${K(i.status)})</span>`:"",f=typeof i?.boost_x=="number"?`<span class="pill">+${K(i.boost_x)}x</span>`:"";return`<div class="row"><div class="rowLeft">${d} ${u}</div><div class="rowRight">${f}</div></div>`}).join(""),c=o.length>40?`<div class="sub">Showing 40 of ${o.length} players.</div>`:`<div class="sub">Players: ${o.length}.</div>`;return`
    <div class="card">
      <div class="h">Capture</div>
      <div class="sub">Sport: <b>${K(n)}</b>  Mode: <b>${K(s)}</b>  Slots: <b>${K(r)}</b></div>
    </div>
    <div class="card">
      <div class="h">Slots</div>
      <table class="table">
        <thead><tr><th>#</th><th>Multiplier</th><th>Selection</th></tr></thead>
        <tbody>${l||"<tr><td colspan='3' class='muted'>No slots found.</td></tr>"}</tbody>
      </table>
    </div>
    <div class="card">
      <div class="h">Player pool</div>
      ${c}
      <div class="list">${a||"<div class='muted'>No pool detected.</div>"}</div>
    </div>
  `.trim()}function Gs(e,t=[]){const r=Array.isArray(e?.lineup)?e.lineup:[],n=Array.isArray(e?.bets)?e.bets:[],s=Array.isArray(e?.assumptions)?e.assumptions:[],o=Array.isArray(e?.questions)?e.questions:[],l=r.map(i=>{const d=K(i?.slot_index),u=K(i?.player||""),f=cn(i?.slot_multiplier),h=typeof i?.player_boost_x=="number"?`+${K(i.player_boost_x)}x`:"+0x",m=cn(i?.effective_multiplier);return`<tr><td>${d}</td><td>${u}</td><td>${f}</td><td>${h}</td><td><b>${m}</b></td></tr>`}).join(""),a=n.map(i=>{const d=K(i?.tier||""),u=i?.recommend?"YES":"NO",f=i?.recommend?"yes":"no",h=K(i?.confidence||""),m=K(i?.reason||"");return`<div class="bet-item"><div class="bet-header"><span class="bet-tier">${d}</span><span class="bet-rec ${f}">${u}</span><span class="muted">(${h})</span></div><div class="bet-reason">${m}</div></div>`}).join(""),c=(t||[]).slice(0,8).map(i=>`<div class="row"><a class="link" href="${K(i)}" target="_blank" rel="noreferrer">${K(i)}</a></div>`).join("");return`
    <div class="card"><div class="h">AI result</div><div class="sub">Structured JSON parsed successfully.</div></div>
    <div class="card">
      <div class="h">Lineup</div>
      <table class="table">
        <thead><tr><th>Slot</th><th>Player</th><th>Slot</th><th>Boost</th><th>Effective</th></tr></thead>
        <tbody>${l||"<tr><td colspan='5' class='muted'>No lineup returned.</td></tr>"}</tbody>
      </table>
    </div>
    <div class="card"><div class="h">Bets</div><div class="list">${a||"<div class='muted'>No bets returned.</div>"}</div></div>
    ${o.length?`<div class="card"><div class="h">Questions</div><div class="list">${o.map(i=>`<div class="row">${K(i)}</div>`).join("")}</div></div>`:""}
    ${s.length?`<div class="card"><div class="h">Assumptions</div><div class="list">${s.map(i=>`<div class="row">${K(i)}</div>`).join("")}</div></div>`:""}
    ${c?`<div class="card"><div class="h">Sources</div><div class="list">${c}</div></div>`:""}
  `.trim()}function Zi(){const e=String(S(Kr,"")||"").trim(),t=String(S(Wr,at)||at).trim()||at,r=S(Jr,br),n=S(Vr,_r),s=S(Xr,Kt),o=S(vr,Za),l=S(gr,Qa),a=Math.max(0,Math.min(2,parseFloat(String(r)))),c=Math.max(64,Math.min(4e3,parseInt(String(n),10)||_r)),i=Math.max(1,Math.min(5,parseInt(String(s),10)||Kt)),d=String(o)==="1"||o===!0,u=String(l)==="1"||l===!0;return{apiKey:e,model:t,temperature:a,max_tokens:c,web_max_results:i,structured:d,response_healing:u}}function Qi({method:e,url:t,headers:r,bodyObj:n,timeoutMs:s=6e4}){return new Promise((o,l)=>{const a=n==null?null:JSON.stringify(n);if(typeof GM_xmlhttpRequest!="function"){l(new Error("GM_xmlhttpRequest is not available (check grants)."));return}GM_xmlhttpRequest({method:e,url:t,headers:{"Content-Type":"application/json",...r||{}},data:a??void 0,timeout:s,onload:c=>{try{const i=c?.responseText||"",d=i?JSON.parse(i):null;c.status>=200&&c.status<300?o(d):l(new Error(d?.error?.message||d?.message||`HTTP ${c.status}`))}catch(i){l(i)}},onerror:()=>l(new Error("Network error.")),ontimeout:()=>l(new Error("Request timed out."))})})}function el(){return{type:"object",additionalProperties:!1,properties:{lineup:{type:"array",items:{type:"object",additionalProperties:!1,properties:{slot_index:{type:"number"},slot_multiplier:{type:"number"},player:{type:"string"},player_boost_x:{type:["number","null"]},effective_multiplier:{type:"number"}},required:["slot_index","slot_multiplier","player","player_boost_x","effective_multiplier"]}},bets:{type:"array",items:{type:"object",additionalProperties:!1,properties:{tier:{type:"string",enum:["top50","top20","top10"]},recommend:{type:"boolean"},confidence:{type:"string",enum:["low","medium","high"]},reason:{type:"string"}},required:["tier","recommend","confidence","reason"]}},assumptions:{type:"array",items:{type:"string"}},questions:{type:"array",items:{type:"string"}}},required:["lineup","bets","assumptions","questions"]}}function js(e){const r=(Array.isArray(e?.annotations)?e.annotations:[]).filter(n=>n&&n.type==="url_citation"&&n.url_citation&&n.url_citation.url).map(n=>n.url_citation.url).slice(0,25);return Array.from(new Set(r))}function tl(e){return String(e?.message||e||"").toLowerCase().includes("no endpoints found")}function kt(){return new Date().toISOString()}function Et(e){try{localStorage.setItem(Ps,JSON.stringify(e,null,2))}catch{}}async function Ks(e,t){let r=null;for(const n of e)try{return{res:await Qi({method:"POST",url:t.url,headers:t.headers,bodyObj:n.body,timeoutMs:t.timeoutMs}),usedLabel:n.label}}catch(s){if(r=s,!tl(s))throw s}throw r||new Error("OpenRouter request failed.")}function rl(){return{type:"function",function:{name:"get_player_profile_stats",description:"Fetch and summarize a player's RealSports profile page (rankings, prior performances, recent game logs). Clicks the player's profile icon in the draft modal, scrapes their stats, then returns to the draft. Use when deciding between players beyond boost values.",parameters:{type:"object",additionalProperties:!1,properties:{player_name:{type:"string",description:"Player name exactly as shown in the draft modal."}},required:["player_name"]}}}}function nl(){return{type:"function",function:{name:"search_draft_players",description:"Search the draft modal for players matching a query. The initial pool shows up to ~50 players, but many more may be available. Use this to find specific players by name, position, or team that might not appear in the initial list. Returns the matching players with their boost values.",parameters:{type:"object",additionalProperties:!1,properties:{query:{type:"string",description:"Search query - player name, position (e.g. 'goalie', 'QB'), or team name."}},required:["query"]}}}}async function sl(e,t,r){if(e==="get_player_profile_stats"){const n=String(t?.player_name||"").trim();if(!n)return{error:"missing_player_name"};E("step",`Tool call: get_player_profile_stats(${n})`,{scope:"tool"}),E("step","Discovering profile URL via click",{scope:"tool"});const s=await Gi(n);if(!s)return{error:"player_not_found",player_name:n,hint:"Could not find this player in the draft modal. Make sure the draft modal is open and the player is visible in the list."};E("step","Scraping profile",{scope:"tool",data:{profile_url:s}});const o=r.payload?.sport||null,l=await Vi({player_name:n,profile_url:s,return_to_draft:!0,sport:o});return E("info","Tool result ready",{scope:"tool",data:{scraped_via:l?.scraped_via,navigated_to_profile:l?.navigated_to_profile}}),{...l,discovery:"click",mode:"live_dom"}}if(e==="search_draft_players"){const n=String(t?.query||"").trim();if(!n)return{error:"missing_query"};E("step",`Tool call: search_draft_players(${n})`,{scope:"tool"});const s=document.querySelector('[class*="r-1kqtdi0"]')||document.querySelector('[role="dialog"]');if(!s)return{error:"no_draft_modal",message:"Draft modal not found"};const o=s.querySelector('input[placeholder*="Search"]');if(!o)return{error:"no_search_input",message:"Search input not found in modal"};E("step","Found search input, entering query...",{scope:"tool"}),o.value="",o.focus();const l=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value")?.set;l?l.call(o,n):o.value=n,o.dispatchEvent(new Event("input",{bubbles:!0})),o.dispatchEvent(new Event("change",{bubbles:!0})),await new Promise(i=>setTimeout(i,500)),E("step","Scraping filtered player pool...",{scope:"tool"});const a=s.querySelectorAll('[tabindex="0"][class*="r-1loqt21"]'),c=[];return a.forEach(i=>{const d=i.querySelectorAll('div[dir="auto"]');let u="",f=null,h=null;d.forEach(m=>{const x=(m.textContent||"").trim();if(x.includes("")){const w=x.split("").map(L=>L.trim());u=w[0],w[1]&&(h=w[1])}else x.match(/^\+?\d+\.?\d*x$/i)?f=x:!u&&x.length>2&&!x.includes("x")&&(u=x)}),u&&c.push({name:u,boost:f,status:h})}),E("info",`Found ${c.length} players matching '${n}'`,{scope:"tool"}),l?l.call(o,""):o.value="",o.dispatchEvent(new Event("input",{bubbles:!0})),o.dispatchEvent(new Event("change",{bubbles:!0})),{query:n,players_found:c.length,players:c}}return{error:"unknown_tool",toolName:e}}async function ol(e){const t=Zi(),r=String(S(it,"0"))==="1"||S(it,"0")===!0;if((!yr||r)&&!t.apiKey)throw new Error("Missing OpenRouter API key.");if(yr&&!r&&!rn()?.username)throw new Error("Please link your account in Settings before using Ask AI.");const o=String(S(Wt,"0"))==="1"||S(Wt,"0")===!0,l=String(S(Jt,"0"))==="1"||S(Jt,"0")===!0;let a=e.prompt;o?a=["DEBUG TOOL TEST: You MUST call the tool `get_player_profile_stats` exactly once before producing the final JSON schema answer.","Pick ONE player from the available pool (prefer a high-boost or a close decision).","IMPORTANT: Call the tool with return_to_draft=true so you can read dynamic Feed/Plays content, then come back to the draft.","After you receive the tool result, continue normally and return the final JSON schema output.","",e.prompt].join(`
`):l&&(a=["DEBUG TOOL TEST: You MUST call the tool `search_draft_players` exactly once before producing the final JSON schema answer.","Search for a specific position (e.g. 'goalie', 'center', 'quarterback') to find additional players that may not be in the initial list.","After you receive the search results, continue normally and return the final JSON schema output.","",e.prompt].join(`
`));const c=[{t:kt(),kind:"start",model:t.model,web:!!e.web}];Et(c);const i=S(Vt,"1")!=="0",d=S(Xt,"1")!=="0",u=[...i?[rl()]:[],...d?[nl()]:[]],f=String(S(it,"0"))==="1"||S(it,"0")===!0,h=yr&&!f,m=h?{"X-RSDH-Auth":ti,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"}:{Authorization:`Bearer ${t.apiKey}`,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"};if(h){const H=rn();H?.username&&(m["X-RSDH-User"]=H.username,H.displayName&&(m["X-RSDH-DisplayName"]=H.displayName))}const x=h?Ts:ei,w=[];e.web&&w.push({id:"web",engine:"exa",max_results:t.web_max_results}),t.response_healing&&w.push({id:"response-healing"});const L=[],R=[{role:"user",content:a}],fe=6;let z=[];for(let H=0;H<fe;H++){const he={model:t.model,messages:R,temperature:t.temperature,max_tokens:t.max_tokens,tools:u},Qt=[{label:"tools+tool_choice+parallel+provider",body:{...he,tool_choice:"auto",parallel_tool_calls:!1,provider:{require_parameters:!0},plugins:L}},{label:"tools+tool_choice+provider",body:{...he,tool_choice:"auto",provider:{require_parameters:!0},plugins:L}},{label:"tools+tool_choice",body:{...he,tool_choice:"auto",plugins:L}},{label:"tools-only",body:{...he,plugins:L}}],{res:fn,usedLabel:er}=await Ks(Qt,{url:x,headers:m,timeoutMs:9e4});er!==Qt[0].label&&(c.push({t:kt(),kind:"routing_fallback",stage:"tool_loop",label:er}),Et(c));const Te=fn?.choices?.[0]?.message;z=js(Te);const Be=Array.isArray(Te?.tool_calls)?Te.tool_calls:null;if(!Be||Be.length===0)break;R.push({role:"assistant",content:Te?.content??null,tool_calls:Be});for(const De of Be.slice(0,3)){const At=De?.function?.name,Tt=De?.function?.arguments;let Je={};try{Je=Tt?JSON.parse(Tt):{}}catch{Je={_raw:Tt}}const tr=String(De?.id||"");c.push({t:kt(),kind:"tool_call",name:String(At||""),id:tr,args:Je}),Et(c);const rr=performance.now(),Ct=await sl(String(At||""),Je,{payload:e.payload}),nr=Math.round(performance.now()-rr),k=Ct,pn=!k?.error,F={};At==="get_player_profile_stats"&&(F.player_name=k?.player_name||Je?.player_name,F.profile_url=k?.profile_url||null,F.discovery=k?.discovery||null,F.mode=k?.mode||"live_dom",F.returned_to_draft=typeof k?.returned_to_draft=="boolean"?k.returned_to_draft:null,F.modal_reopened=typeof k?.modal_reopened=="boolean"?k.modal_reopened:null,F.navigated_to_profile=typeof k?.navigated_to_profile=="boolean"?k.navigated_to_profile:null,F.modal_was_open=typeof k?.modal_was_open=="boolean"?k.modal_was_open:null,F.header=!!k?.header_text,F.season_summary=k?.season_summary?.entries?k.season_summary.entries.length:null,F.recent_performances=k?.recent_performances?.entries?k.recent_performances.entries.length:null,F.feed_entries=Array.isArray(k?.feed_entries)?k.feed_entries.length:null,F.lines=Array.isArray(k?.interesting_lines)?k.interesting_lines.length:null,F.tables=Array.isArray(k?.tables)?k.tables.length:null,F.embedded_json=Array.isArray(k?.embedded_json)?k.embedded_json.length:null,F.facts=Array.isArray(k?.facts)?k.facts.length:null,F.recent_log=Array.isArray(k?.recent_log)?k.recent_log.length:null,k?.error&&(F.error=k.error),F.scraped_data={header_text:k?.header_text||null,season_summary:k?.season_summary||null,recent_performances:k?.recent_performances||null,feed_entries:k?.feed_entries||[]}),c.push({t:kt(),kind:"tool_result",name:String(At||""),id:tr,ok:pn,ms:nr,summary:F}),Et(c),R.push({role:"tool",tool_call_id:tr,content:JSON.stringify(Ct)})}}const pe={type:"json_schema",json_schema:{name:"draft_lineup",strict:!0,schema:el()}},ie={model:t.model,messages:R,temperature:t.temperature,max_tokens:t.max_tokens,response_format:pe},G=[{label:"final+tools+tool_choice+provider+plugins",body:{...ie,tools:u,tool_choice:"none",provider:{require_parameters:!0},plugins:w}},{label:"final+tools+tool_choice",body:{...ie,tools:u,tool_choice:"none",plugins:[]}},{label:"final+schema+plugins",body:{...ie,plugins:w}},{label:"final+schema-only",body:{...ie}}],{res:re,usedLabel:Ae}=await Ks(G,{url:x,headers:m,timeoutMs:9e4});Ae!==G[0].label&&(c.push({t:kt(),kind:"routing_fallback",stage:"final",label:Ae}),Et(c));const dt=re?.choices?.[0]?.message,Le=dt?.content;if(!Le)throw new Error("No content returned.");try{localStorage.setItem(ri,Le)}catch{}const We=js(dt);try{localStorage.setItem(Zr,JSON.stringify(We,null,2))}catch{}try{localStorage.setItem(ni,JSON.stringify(R,null,2))}catch{}return c.push({t:kt(),kind:"done"}),Et(c),{jsonText:Le,sources:We.length?We:z||[]}}function al(e){try{localStorage.setItem(Cs,JSON.stringify(e,null,2))}catch{}}function Ws(e){try{window.dispatchEvent(new CustomEvent("rsdh-output",{detail:{raw:e}}))}catch{}}function ut(e){try{window.dispatchEvent(new CustomEvent("rsdh-status",{detail:{text:e}}))}catch{}}function Js(e,t=!1){const r=document.createElement("button");return r.type="button",r.textContent=e,r.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: -0.01em;
    padding: 10px 14px;
    border-radius: 10px;
    cursor: pointer;
    width: 100%;
    white-space: nowrap;
    transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    ${t?`background: linear-gradient(135deg, var(--rsdh-accent, #2c6cff) 0%, color-mix(in srgb, var(--rsdh-accent, #2c6cff) 80%, black) 100%);
         color: white;
         border: none;
         box-shadow: 0 2px 8px rgba(0,0,0,0.2);`:`background: rgba(255,255,255,0.08);
         color: #f5f5f5;
         border: 1px solid rgba(255,255,255,0.1);
         box-shadow: none;`}
  `,r.addEventListener("mouseenter",()=>{r.style.transform="translateY(-1px)",t?r.style.boxShadow="0 4px 16px rgba(0,0,0,0.3), 0 0 20px color-mix(in srgb, var(--rsdh-accent, #2c6cff) 40%, transparent)":(r.style.background="rgba(255,255,255,0.12)",r.style.boxShadow="0 4px 12px rgba(0,0,0,0.2)")}),r.addEventListener("mouseleave",()=>{r.style.transform="translateY(0)",t?r.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)":(r.style.background="rgba(255,255,255,0.08)",r.style.boxShadow="none")}),r.addEventListener("mousedown",()=>{r.style.transform="translateY(0)"}),r}function il(){const e=document.createElement("div");return e.id="rsdh-modal-actions",e.style.cssText=`
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-top: 14px;
    padding: 14px 16px 0 16px;
    border-top: 1px solid color-mix(in srgb, var(--rsdh-accent, #2c6cff) 30%, rgba(255,255,255,0.1));
  `,e}function ll(e){const r=Array.from(e.querySelectorAll("button,div,[role='button']")).find(n=>{const s=(n.innerText||n.textContent||"").trim();return/^(submit|update)$/i.test(s)});return r?r.parentElement||r:null}async function Vs(e){ut("Capturing...");const t=gi({includeDebug:lt()});if(al(t),Ws(JSON.stringify(t,null,2)),!t||t.ok!==!0){const c=t?.error||"Could not capture modal.";ut(c),ct(c);return}if(e==="copy_prompt"){const c=Ns(t);GM_setClipboard(c),ut("Copied prompt to clipboard."),Zt("Copied prompt to clipboard!");return}const r=S(Qr,"1")!=="0",n=S(Vt,"1")!=="0",s=S(Xt,"1")!=="0",o=r?"Asking AI + Web...":"Asking AI...";ut(o),$s(o);const l=Ls(t,{webHint:r,toolHint:n,searchHint:s}),a=await ol({prompt:l,web:r,payload:t});Ws(a.jsonText),ut("AI response received."),Zt("AI response received!")}function cl(){const e=()=>{const r=wt();if(!r||r.querySelector("#rsdh-modal-actions"))return;const n=il(),s=Js(" Copy Prompt"),o=Js(" Ask AI",!0);s.addEventListener("click",()=>Vs("copy_prompt").catch(a=>{const c=String(a?.message||a);ut(c),ct(c)})),o.addEventListener("click",()=>Vs("ask_ai").catch(a=>{const c=String(a?.message||a);ut(c),ct(c)})),n.appendChild(s),n.appendChild(o);const l=ll(r);l&&l.parentElement?l.parentElement.insertBefore(n,l.nextSibling):r.appendChild(n)};e(),new MutationObserver(()=>e()).observe(document.documentElement,{childList:!0,subtree:!0})}const Xs="rsdh_openrouter_models_cache",ul=1440*60*1e3,wr=["google/gemini-2.5-flash","google/gemini-2.5-pro","google/gemini-2.0-flash-001","anthropic/claude-sonnet-4","anthropic/claude-3.5-sonnet","anthropic/claude-3.5-haiku","openai/gpt-4o","openai/gpt-4o-mini","openai/gpt-4-turbo","openai/o1","openai/o1-mini","meta-llama/llama-3.3-70b-instruct","deepseek/deepseek-chat-v3-0324","mistralai/mistral-large","qwen/qwen-2.5-72b-instruct"];function Zs(){try{const e=localStorage.getItem(Xs);if(!e)return null;const t=JSON.parse(e);return Date.now()-t.timestamp>ul?null:t}catch{return null}}function dl(e){try{const t={models:e,timestamp:Date.now()};localStorage.setItem(Xs,JSON.stringify(t))}catch{}}async function fl(){const e=Zs();if(e&&e.models.length>0)return e.models;try{if(typeof GM_xmlhttpRequest!="function")return wr;const t=await new Promise((r,n)=>{GM_xmlhttpRequest({method:"GET",url:"https://openrouter.ai/api/v1/models",headers:{"Content-Type":"application/json"},timeout:1e4,onload:s=>{try{const o=s?.responseText?JSON.parse(s.responseText):null;r(o)}catch{n(new Error("Failed to parse models response"))}},onerror:()=>n(new Error("Network error")),ontimeout:()=>n(new Error("Request timed out"))})});if(t?.data&&Array.isArray(t.data)){const r=t.data.map(n=>n.id).filter(n=>n&&!n.includes(":free")&&!n.includes(":extended")).sort((n,s)=>{const o=["google/","anthropic/","openai/","meta-llama/","deepseek/","mistralai/"],l=o.findIndex(c=>n.startsWith(c)),a=o.findIndex(c=>s.startsWith(c));return l!==-1&&a===-1?-1:a!==-1&&l===-1?1:l!==-1&&a!==-1?l-a:n.localeCompare(s)});if(r.length>0)return dl(r),r}return wr}catch{return wr}}function pl(){return Zs()?.models||wr}const Qs="rsdh_svelte_ui_state";function un(){try{const e=localStorage.getItem(Qs);if(!e)return{tab:"context",hidden:!1};const t=JSON.parse(e),r=String(t?.tab||"context");return{tab:r==="settings"?"settings":r==="results"?"results":r==="debug"?"debug":"context",hidden:!!t?.hidden}}catch{return{tab:"context",hidden:!1}}}function dn(e){const r={...un(),...e};try{localStorage.setItem(Qs,JSON.stringify(r))}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-ui-state",{detail:r}))}catch{}}var hl=Y('<button style="background: rgba(245, 158, 11, 0.15); border-color: rgba(245, 158, 11, 0.3);"> Debug</button>'),ml=Y('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),vl=Y("<div><!></div>"),gl=Y(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">No Data Captured</h3> <p class="empty-description">Open a draft modal on the site, then use the Capture button to collect
          player and contest data.</p> <div class="empty-hint"> Look for "Draft" or "Update" buttons</div></div>`),bl=Y('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),_l=Y("<div><!></div>"),yl=Y(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">No AI Results Yet</h3> <p class="empty-description">Capture a draft modal first, then use "Ask AI" from the modal to get
          lineup recommendations.</p> <div class="empty-hint"> AI will analyze your roster and suggest optimal picks</div></div>`),xl=Y('<img alt="" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--rsdh-accent);"/>'),wl=Y('<div style="width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center;"></div>'),Sl=Y('<div style="font-weight: 600; color: rgba(255,255,255,0.9);"> </div>'),kl=Y('<div class="sub" style="margin-top: 8px; color: rgba(245,158,11,0.9);"> </div>'),El=Y('<div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;"><!> <div><!> <div class="sub"> </div></div></div> <div style="display: flex; gap: 8px; flex-wrap: wrap;"><button style="font-size: 11px;"> Update</button> <button class="secondary" style="font-size: 11px;">Unlink</button></div> <!>',1),Al=Y('<div class="sub" style="margin-top: 8px; color: rgba(245,158,11,0.9);"> </div>'),Tl=Y('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(245,158,11,0.08); border-radius: 6px; border-left: 2px solid rgba(245,158,11,0.4);">Link your RealSports account to enable usage tracking.</div> <button> Link Account</button> <!>',1),Cl=Y('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(255,200,0,0.08); border-radius: 6px; border-left: 2px solid rgba(255,200,0,0.4);">Your API key is stored locally and never shared.</div> <label class="sub" for="or-key">API Key</label> <input id="or-key" style="width:100%; margin-bottom:8px;" type="password" placeholder="sk-or-..."/>',1),Pl=Y("<option> </option>"),Rl=Y('<div style="margin-top:8px; margin-left: 28px;"><label class="sub" for="or-web"> </label> <input id="or-web" style="width:100%;" type="range" min="1" max="5" step="1"/></div>'),Ol=Y('<label class="sub" for="or-key">Your OpenRouter API Key</label> <input id="or-key" style="width:100%; margin-bottom:8px;" type="password" placeholder="sk-or-..."/> <div class="sub" style="color: rgba(245,158,11,0.8);"> Your key is stored locally. You will be billed directly.</div>',1),Ml=Y(`<div><div class="card" style="border-left: 3px solid rgba(245, 158, 11, 0.6);"><div class="h"> Last Request Summary</div> <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px;"><div style="padding: 10px; background: rgba(255,255,255,0.04); border-radius: 8px;"><div style="font-size: 11px; color: rgba(255,255,255,0.5); margin-bottom: 4px;"> Capture</div> <div><!></div></div> <div style="padding: 10px; background: rgba(255,255,255,0.04); border-radius: 8px;"><div style="font-size: 11px; color: rgba(255,255,255,0.5); margin-bottom: 4px;"> Web Search</div> <div><!></div></div> <div style="padding: 10px; background: rgba(255,255,255,0.04); border-radius: 8px;"><div style="font-size: 11px; color: rgba(255,255,255,0.5); margin-bottom: 4px;"> Tool Calls</div> <div><!></div></div> <div style="padding: 10px; background: rgba(255,255,255,0.04); border-radius: 8px;"><div style="font-size: 11px; color: rgba(255,255,255,0.5); margin-bottom: 4px;"> AI Response</div> <div><!></div></div></div></div> <div class="card" style="background: rgba(255,255,255,0.04);"><label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer;"><input type="checkbox"/> <span><strong>Force Profile Tool (test)</strong><br/><span class="sub">Makes AI call <code>get_player_profile_stats</code> once to verify
              tool tracing.</span></span></label> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 10px;"><input type="checkbox"/> <span><strong>Force Search Tool (test)</strong><br/><span class="sub">Makes AI call <code>search_draft_players</code> once to verify tool
              tracing.</span></span></label></div> <div class="card"><div class="h" style="margin-bottom: 12px;"> Raw Data</div> <details class="details"><summary> Raw Capture Data</summary> <textarea placeholder="Raw JSON / text..."></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details> <details class="details" style="margin-top:8px;"><summary> Web Sources</summary> <textarea readonly=""></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details> <details class="details" style="margin-top:8px;"><summary> Tool Call Trace</summary> <textarea readonly=""></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details> <details class="details" style="margin-top:8px;"><summary> AI Response JSON</summary> <textarea readonly="" placeholder="No AI response yet."></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details> <details class="details" style="margin-top:8px;"><summary> Prompts (Chat + Structured)</summary> <div class="sub" style="margin-bottom: 6px;">Chat Prompt:</div> <textarea readonly="" placeholder="Capture a draft modal to see the prompt here." style="min-height: 80px;"></textarea> <div class="sub" style="margin: 8px 0 6px 0;">Structured Prompt:</div> <textarea readonly="" placeholder="Use Ask AI to see the structured prompt here." style="min-height: 80px;"></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy Structured</button></details></div></div>`),Il=Y('<div class="panel"><div class="header"><div class="title"><span style="margin-right: 6px;"></span> Draft Helper</div> <button class="secondary"><span style="font-size: 14px;"></span></button></div> <div class="tabs"><button>Context</button> <button>Results</button> <button>Settings</button> <!></div> <div><!></div> <div><!></div> <div><div class="card"><div class="h"><span style="opacity: 0.6; margin-right: 6px;"></span>Account</div> <!></div> <div class="card"><div class="h"><span style="opacity: 0.6; margin-right: 6px;"></span>OpenRouter API</div> <!> <label class="sub" for="or-model">Model</label> <input id="or-model" style="width:100%; margin-bottom:8px;" type="text" list="model-list" placeholder="Start typing to search..."/> <datalist id="model-list"></datalist> <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 12px;"><div><label class="sub" for="or-temp"> </label> <input id="or-temp" style="width:100%;" type="range" min="0" max="2" step="0.1"/></div> <div><label class="sub" for="or-max">Max tokens</label> <input id="or-max" style="width:100%;" type="text"/></div></div> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Web Search</strong><br/><span class="sub">Search the web for current player news and updates</span></span></label> <!> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Player Profile Lookup</strong><br/><span class="sub">Allow AI to look up detailed player stats from their profile</span></span></label> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Draft Player Search</strong><br/><span class="sub">Allow AI to search for players not in the initial ~50 shown</span></span></label></div> <div class="card"><details class="details" style="margin: -12px -14px; padding: 12px 14px;"><summary> Advanced</summary> <div style="margin-top: 12px;"><label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-bottom: 12px;"><input type="checkbox"/> <span><strong>Use my own API key</strong><br/><span class="sub">Bypass hosted proxy and call OpenRouter directly</span></span></label> <!> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Debug Mode</strong><br/><span class="sub">Show Debug tab with raw data and developer tools</span></span></label></div></details></div> <div style="display:flex; gap:8px; margin-top:14px;"><button style="display:flex; align-items:center; justify-content:center; gap:6px;"><span></span> Save Settings</button></div></div> <!></div>');function Nl(e,t){On(t,!1);let r=N("context"),n=N(""),s="",o=N(""),l=N(!1),a=N(""),c=N(""),i=N(""),d=N(""),u=N(""),f=N(""),h="",m=N(""),x=N(!1),w=N(""),L=N(at),R=N(br),fe=N(String(_r)),z=N(Kt),pe=!0,ie=!0,G=N(!1),re=N(!1),Ae=N(!1),dt=N(!0),Le=N(!0),We=N(!0),H=N(null),he=N("");async function Qt(){if(b(he,"Navigating to profile..."),!await Ei()){b(he,"Could not find profile button. Are you on realsports.io?"),ct("Profile button not found");return}await new Promise(A=>setTimeout(A,800));const y=Ai();y?(xi(y),b(H,y),b(he,""),Zt(`Linked as @${y.username}`)):(b(he,"Could not find profile. Make sure you're logged in."),ct("Profile not found"))}function fn(){wi(),b(H,null),$s("Account unlinked")}let er=N(pl());function Te(v){v==="debug"&&!p(x)&&(v="context"),b(r,v),dn({tab:v})}La(()=>{const v=un();b(x,lt()),b(r,v.tab==="debug"&&!p(x)?"context":v.tab),s=bi(),b(n,s),Be(),b(w,String(S(Kr,"")||"")),b(L,String(S(Wr,at)||at)),b(R,parseFloat(String(S(Jr,br)))||br),b(fe,String(S(Vr,_r))),b(z,parseInt(String(S(Xr,Kt)),10)||Kt),pe=String(S(vr,!0))==="1"||S(vr,!0)===!0,ie=String(S(gr,!0))==="1"||S(gr,!0)===!0,b(G,String(S(Wt,"0"))==="1"||S(Wt,"0")===!0),b(re,String(S(Jt,"0"))==="1"||S(Jt,"0")===!0),b(Ae,String(S(it,"0"))==="1"||S(it,"0")===!0),b(dt,S(Vt,"1")!=="0"),b(Le,S(Qr,"1")!=="0"),b(We,S(Xt,"1")!=="0"),b(H,rn()),fl().then(U=>{b(er,U)});const y=U=>{};document.addEventListener("click",y,!0);const A=U=>{const P=U.detail;if(P?.raw){try{const $=JSON.parse(P.raw);if($?.ok===!0){b(n,P.raw),s=P.raw;try{b(i,_i(P.raw))}catch{b(i,"")}try{b(d,yi(P.raw))}catch{b(d,"")}Be(),b(r,"context");return}if($&&Array.isArray($.lineup)&&Array.isArray($.bets)){b(c,P.raw);try{const le=JSON.parse(localStorage.getItem(Zr)||"[]");b(u,Array.isArray(le)?le.join(`
`):String(le))}catch{b(u,"")}try{b(f,String(localStorage.getItem(Ps)||""))}catch{b(f,"")}try{h=String(localStorage.getItem(xr)||"")}catch{h=""}b(m,Gs($,p(u)?p(u).split(`
`):[])),b(r,"results");return}}catch{}b(n,P.raw),Be(),b(r,"context")}},B=()=>{try{h=String(localStorage.getItem(xr)||"")}catch{h=""}};return window.addEventListener("rsdh-output",A),window.addEventListener("rsdh-debug-events",B),()=>{document.removeEventListener("click",y,!0),window.removeEventListener("rsdh-output",A),window.removeEventListener("rsdh-debug-events",B)}});function Be(){const v=(p(n)||"").trim();if(!v){b(o,'<div class="card"><div class="h">Output</div><div class="sub">Capture a draft modal or run Ask AI.</div></div>');return}try{const y=JSON.parse(v);if(y&&y.ok===!0){b(o,Xi(y));return}if(y&&Array.isArray(y.lineup)&&Array.isArray(y.bets)){let A=[];try{A=JSON.parse(localStorage.getItem(Zr)||"[]")||[]}catch{}b(o,Gs(y,A));return}}catch{}b(o,`<div class="card"><div class="h">Output</div><pre class="code-output">${v.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</pre></div>`)}function De(v){try{GM_setClipboard(v),Zt("Copied to clipboard!")}catch(y){const A=`Copy failed: ${String(y?.message||y)}`;ct(A)}}function At(){const v=parseInt(p(fe),10);if(isNaN(v)||v<1){b(fe,"1"),ct("Max tokens must be at least 1");return}p(w).trim()&&p(w).trim()!=="********"&&de(Kr,p(w).trim()),de(Wr,(p(L)||at).trim()),de(Jr,String(p(R))),de(Vr,String(v)),de(Xr,String(p(z))),de(vr,pe?"1":"0"),de(gr,ie?"1":"0"),de(Wt,p(G)?"1":"0"),de(Jt,p(re)?"1":"0"),de(it,p(Ae)?"1":"0"),de(Vt,p(dt)?"1":"0"),de(Qr,p(Le)?"1":"0"),de(Xt,p(We)?"1":"0"),si(p(x)),!p(x)&&p(r)==="debug"&&Te("context"),Zt("Settings saved!")}Wa();var Tt=Il(),Je=_(Tt),tr=g(_(Je),2),rr=g(Je,2),Ct=_(rr),nr=g(Ct,2),k=g(nr,2),pn=g(k,2);{var F=v=>{var y=hl();se(()=>je(y,1,`tab secondary ${p(r)==="debug"?"active":""}`)),te("click",y,()=>Te("debug")),M(v,y)};j(pn,v=>{p(x)&&v(F)})}var hn=g(rr,2),$l=_(hn);{var ql=v=>{var y=ml(),A=g(_(y),2),B=_(A);se(()=>Ee(B,p(a))),M(v,y)},Yl=v=>{var y=bs(),A=bt(y);{var B=P=>{var $=vl(),le=_($);ys(le,()=>p(o)),M(P,$)},U=P=>{var $=gl();M(P,$)};j(A,P=>{p(o)?P(B):P(U,!1)},!0)}M(v,y)};j($l,v=>{p(l)?v(ql):v(Yl,!1)})}var mn=g(hn,2),Hl=_(mn);{var Ul=v=>{var y=bl(),A=g(_(y),2),B=_(A);se(()=>Ee(B,p(a))),M(v,y)},zl=v=>{var y=bs(),A=bt(y);{var B=P=>{var $=_l(),le=_($);ys(le,()=>p(m)),M(P,$)},U=P=>{var $=yl();M(P,$)};j(A,P=>{p(m)?P(B):P(U,!1)},!0)}M(v,y)};j(Hl,v=>{p(l)?v(Ul):v(zl,!1)})}var vn=g(mn,2),to=_(vn),Gl=g(_(to),2);{var jl=v=>{var y=El(),A=bt(y),B=_(A);{var U=Z=>{var _e=xl();se(()=>ja(_e,"src",p(H).avatarUrl)),M(Z,_e)},P=Z=>{var _e=wl();M(Z,_e)};j(B,Z=>{p(H).avatarUrl?Z(U):Z(P,!1)})}var $=g(B,2),le=_($);{var gn=Z=>{var _e=Sl(),sr=_(_e);se(()=>Ee(sr,p(H).displayName)),M(Z,_e)};j(le,Z=>{p(H).displayName&&p(H).displayName!==p(H).username&&Z(gn)})}var Sr=g(le,2),kr=_(Sr),Er=g(A,2),Ar=_(Er),bn=g(Ar,2),Tr=g(Er,2);{var Cr=Z=>{var _e=kl(),sr=_(_e);se(()=>Ee(sr,p(he))),M(Z,_e)};j(Tr,Z=>{p(he)&&Z(Cr)})}se(()=>Ee(kr,`@${p(H).username??""}`)),te("click",Ar,Qt),te("click",bn,fn),M(v,y)},Kl=v=>{var y=Tl(),A=g(bt(y),2),B=g(A,2);{var U=P=>{var $=Al(),le=_($);se(()=>Ee(le,p(he))),M(P,$)};j(B,P=>{p(he)&&P(U)})}te("click",A,Qt),M(v,y)};j(Gl,v=>{p(H)?v(jl):v(Kl,!1)})}var ro=g(to,2),no=g(_(ro),2);{var Wl=v=>{var y=Cl(),A=g(bt(y),4);st(A,()=>p(w),B=>b(w,B)),M(v,y)};j(no,v=>{yr||v(Wl)})}var so=g(no,4),oo=g(so,2);$a(oo,5,()=>p(er),Da,(v,y)=>{var A=Pl(),B=_(A),U={};se(()=>{Ee(B,p(y)),U!==(U=p(y))&&(A.value=(A.__value=p(y))??"")}),M(v,A)});var ao=g(oo,2),io=_(ao),lo=_(io),Jl=_(lo),Vl=g(lo,2),Xl=g(io,2),Zl=g(_(Xl),2),co=g(ao,2),Ql=_(co),uo=g(co,2);{var ec=v=>{var y=Rl(),A=_(y),B=_(A),U=g(A,2);se(()=>Ee(B,`Max results: ${p(z)??""}`)),st(U,()=>p(z),P=>b(z,P)),M(v,y)};j(uo,v=>{p(Le)&&v(ec)})}var fo=g(uo,2),tc=_(fo),rc=g(fo,2),nc=_(rc),po=g(ro,2),sc=_(po),oc=g(_(sc),2),ho=_(oc),ac=_(ho),mo=g(ho,2);{var ic=v=>{var y=Ol(),A=g(bt(y),2);st(A,()=>p(w),B=>b(w,B)),M(v,y)};j(mo,v=>{p(Ae)&&v(ic)})}var lc=g(mo,2),cc=_(lc),uc=g(po,2),dc=_(uc),fc=g(vn,2);{var pc=v=>{var y=Ml(),A=_(y),B=g(_(A),2),U=_(B),P=g(_(U),2),$=_(P);{var le=T=>{var Q=ze(" Data captured");M(T,Q)},gn=T=>{var Q=ze(" No capture yet");M(T,Q)};j($,T=>{p(n)?T(le):T(gn,!1)})}var Sr=g(U,2),kr=g(_(Sr),2),Er=_(kr);{var Ar=T=>{var Q=ze();se(yn=>Ee(Q,` ${yn??""} sources
                found`),[()=>p(u).split(`
`).filter(yn=>yn.trim()).length]),M(T,Q)},bn=T=>{var Q=ze(" Not used");M(T,Q)};j(Er,T=>{p(u)?T(Ar):T(bn,!1)})}var Tr=g(Sr,2),Cr=g(_(Tr),2),Z=_(Cr);{var _e=T=>{var Q=ze(" Profile lookup used");M(T,Q)},sr=T=>{var Q=ze(" No tools called");M(T,Q)};j(Z,T=>{p(f)&&p(f).includes("tool_call")?T(_e):T(sr,!1)})}var hc=g(Tr,2),vo=g(_(hc),2),mc=_(vo);{var vc=T=>{var Q=ze(" Response received");M(T,Q)},gc=T=>{var Q=ze(" No response yet");M(T,Q)};j(mc,T=>{p(c)?T(vc):T(gc,!1)})}var go=g(A,2),bo=_(go),bc=_(bo),_c=g(bo,2),yc=_(_c),xc=g(go,2),_o=g(_(xc),2),_n=g(_(_o),2),wc=g(_n,2),yo=g(_o,2),xo=g(_(yo),2),Sc=g(xo,2),wo=g(yo,2),So=g(_(wo),2),kc=g(So,2),ko=g(wo,2),Eo=g(_(ko),2),Ec=g(Eo,2),Ac=g(ko,2),Ao=g(_(Ac),4),To=g(Ao,4),Tc=g(To,2);se(T=>{je(y,1,`view ${p(r)==="debug"?"":"hidden"}`),Gt(P,`font-size: 13px; color: ${p(n)?"rgba(34,197,94,0.9)":"rgba(255,255,255,0.4)"};`),Gt(kr,`font-size: 13px; color: ${p(u)?"rgba(34,197,94,0.9)":"rgba(255,255,255,0.4)"};`),Gt(Cr,`font-size: 13px; color: ${T??""};`),Gt(vo,`font-size: 13px; color: ${p(c)?"rgba(34,197,94,0.9)":"rgba(255,255,255,0.4)"};`),jt(xo,p(u)||"(No web sources)"),jt(So,p(f)||"(No tool calls)"),jt(Eo,p(c)),jt(Ao,p(i)),jt(To,p(d))},[()=>p(f)&&p(f).includes("tool_call")?"rgba(34,197,94,0.9)":"rgba(255,255,255,0.4)"]),ot(bc,()=>p(G),T=>b(G,T)),ot(yc,()=>p(re),T=>b(re,T)),st(_n,()=>p(n),T=>b(n,T)),te("input",_n,Be),te("click",wc,()=>De(p(n))),te("click",Sc,()=>De(p(u))),te("click",kc,()=>De(p(f))),te("click",Ec,()=>De(p(c))),te("click",Tc,()=>De(p(d))),M(v,y)};j(fc,v=>{p(x)&&v(pc)})}se(()=>{Gt(rr,`grid-template-columns: ${p(x)?"1fr 1fr 1fr 1fr":"1fr 1fr 1fr"};`),je(Ct,1,`tab secondary ${p(r)==="context"?"active":""}`),je(nr,1,`tab secondary ${p(r)==="results"?"active":""}`),je(k,1,`tab secondary ${p(r)==="settings"?"active":""}`),je(hn,1,`view ${p(r)==="context"?"":"hidden"}`),je(mn,1,`view ${p(r)==="results"?"":"hidden"}`),je(vn,1,`view ${p(r)==="settings"?"":"hidden"}`),Ee(Jl,`Temperature: ${p(R)??""}`)}),te("click",tr,()=>dn({hidden:!0})),te("click",Ct,()=>Te("context")),te("click",nr,()=>Te("results")),te("click",k,()=>Te("settings")),st(so,()=>p(L),v=>b(L,v)),st(Vl,()=>p(R),v=>b(R,v)),st(Zl,()=>p(fe),v=>b(fe,v)),ot(Ql,()=>p(Le),v=>b(Le,v)),ot(tc,()=>p(dt),v=>b(dt,v)),ot(nc,()=>p(We),v=>b(We,v)),ot(ac,()=>p(Ae),v=>b(Ae,v)),ot(cc,()=>p(x),v=>b(x,v)),te("click",dc,At),M(e,Tt),Mn()}function Ll(){const e="rsdh-svelte-root";let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,document.documentElement.appendChild(t)),t}function Bl(e){const t="rsdh-svelte-handle";let r=e.getElementById(t);return r||(r=document.createElement("button"),r.id=t,r.className="fab",r.type="button",r.title="Open Draft Helper",r.setAttribute("aria-label","Open Draft Helper"),r.innerHTML=`
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 2l1.2 4.3L17.5 8l-4.3 1.2L12 13.5l-1.2-4.3L6.5 8l4.3-1.7L12 2Z" fill="currentColor" opacity="0.95"/>
        <path d="M19 11l.8 2.8L22.6 15l-2.8.8L19 18.6l-.8-2.8L15.4 15l2.8-1.2L19 11Z" fill="currentColor" opacity="0.85"/>
      </svg>
    `,r.addEventListener("click",()=>dn({hidden:!1})),e.appendChild(r)),r}function eo(e,t,r){e.style.display=r?"none":"",t.style.display=r?"":"none"}function Dl(e){const t=()=>{const r=Ci();r&&e.style.setProperty("--rsdh-accent",r)};t();try{setInterval(t,5e3)}catch{}}function Fl(){const e=Ll(),t=e.shadowRoot??e.attachShadow({mode:"open"}),r="rsdh-style";if(!t.getElementById(r)){const a=document.createElement("style");a.id=r,a.textContent=Co,t.appendChild(a)}const n=Bl(t),s="app";let o=t.getElementById(s);o||(o=document.createElement("div"),o.id=s,t.appendChild(o)),Oa(Nl,{target:o});const l=un();eo(o,n,!!l.hidden),window.addEventListener("rsdh-ui-state",a=>{const c=a.detail;c&&typeof c.hidden=="boolean"&&eo(o,n,c.hidden)}),Dl(e)}Fl(),cl()})();
