// ==UserScript==
// @name         RealSports Draft Helper
// @namespace    local.realsports.drafthelper
// @version      0.9.95
// @description  RealSports Draft Helper (Svelte + TypeScript)
// @homepageURL  https://github.com/itsreverence/real-helper
// @supportURL   https://github.com/itsreverence/real-helper/issues
// @downloadURL  https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @updateURL    https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @match        https://realsports.io/*
// @run-at       document-idle
// @grant        GM_setClipboard
// @grant        GM_xmlhttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @connect      openrouter.ai
// @connect      realsports.io
// ==/UserScript==

(function(){"use strict";const Wo='@import"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap";:host,#app{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*,*:before,*:after{box-sizing:border-box}:host{--rsdh-accent: #2c6cff;--rsdh-accent-light: color-mix(in srgb, var(--rsdh-accent) 70%, white);--rsdh-accent-dark: color-mix(in srgb, var(--rsdh-accent) 80%, black);--rsdh-accent-glow: color-mix(in srgb, var(--rsdh-accent) 40%, transparent);--rsdh-accent-subtle: color-mix(in srgb, var(--rsdh-accent) 15%, transparent);--rsdh-glass: rgba(255, 255, 255, .03);--rsdh-glass-border: rgba(255, 255, 255, .08);--rsdh-transition-fast: .15s ease;--rsdh-transition: .25s ease}.panel{position:fixed;right:12px;top:12px;bottom:12px;width:380px;max-width:calc(100vw - 24px);z-index:2147483647;background:linear-gradient(135deg,#19191ef7,#0f0f12fa);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);color:#f5f5f5;border:1px solid var(--rsdh-glass-border);border-radius:16px;box-shadow:0 25px 50px -12px #0009,0 0 0 1px var(--rsdh-accent-glow),inset 0 1px #ffffff0d;display:flex;flex-direction:column;overflow:hidden}.header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px 12px;background:linear-gradient(180deg,rgba(255,255,255,.04) 0%,transparent 100%);border-bottom:1px solid var(--rsdh-glass-border)}.title{font-weight:800;font-size:14px;letter-spacing:-.02em;background:linear-gradient(135deg,#fff,#fffc);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.tabs{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:12px 16px 14px;background:#0003;border-bottom:1px solid var(--rsdh-glass-border)}.view{flex:1;min-height:0;overflow:auto;padding:16px;box-sizing:border-box;animation:fadeIn .2s ease}@keyframes fadeIn{0%{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}.actions{display:grid;grid-template-columns:1fr 1fr;gap:8px}.span2{grid-column:1 / -1}.split{position:relative;display:flex;gap:6px}.split>button:first-child{flex:1 1 auto}.splitCaret{flex:0 0 auto;width:42px;padding-left:0;padding-right:0}.menu{position:absolute;right:0;top:calc(100% + 8px);width:220px;z-index:2147483647;background:#141419fa;backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid var(--rsdh-glass-border);border-radius:12px;box-shadow:0 20px 40px #00000080,0 0 0 1px var(--rsdh-accent-glow);padding:8px;display:grid;gap:4px;animation:menuAppear .15s ease}@keyframes menuAppear{0%{opacity:0;transform:translateY(-8px) scale(.96)}to{opacity:1;transform:translateY(0) scale(1)}}.menuItem{text-align:left;background:#ffffff0f;border-radius:8px}.menuItem:hover{background:var(--rsdh-accent-subtle);color:var(--rsdh-accent-light)}button{background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);color:#fff;border:0;border-radius:10px;padding:10px 14px;font-weight:700;font-size:12px;letter-spacing:-.01em;cursor:pointer;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:transform var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast),background var(--rsdh-transition-fast);box-shadow:0 2px 8px #0003}button:hover{transform:translateY(-1px);box-shadow:0 4px 16px #0000004d,0 0 20px var(--rsdh-accent-glow)}button:active{transform:translateY(0);box-shadow:0 1px 4px #0003}button.secondary{background:#ffffff14;box-shadow:none;border:1px solid rgba(255,255,255,.08)}button.secondary:hover{background:#ffffff1f;border-color:#ffffff26;box-shadow:0 4px 12px #0003}button.tab{background:#ffffff0f;border:1px solid transparent;box-shadow:none}button.tab:hover{background:#ffffff1a;box-shadow:none}button.tab.active{background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);border-color:transparent;box-shadow:0 2px 12px var(--rsdh-accent-glow),inset 0 1px #ffffff1a}textarea{width:100%;min-height:140px;resize:none;background:#0006;color:#eaeaea;border:1px solid var(--rsdh-glass-border);border-radius:10px;padding:12px;font-family:SF Mono,Fira Code,Consolas,monospace;font-size:11px;line-height:1.5;box-sizing:border-box;transition:border-color var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}textarea:focus{outline:none;border-color:var(--rsdh-accent);box-shadow:0 0 0 3px var(--rsdh-accent-glow)}textarea::placeholder{color:#ffffff59}.status{margin-top:12px;padding:8px 12px;font-size:11px;font-weight:500;color:#ffffffbf;background:#ffffff08;border-radius:8px;border-left:3px solid var(--rsdh-accent);transition:all var(--rsdh-transition-fast)}.card{border:1px solid var(--rsdh-glass-border);background:linear-gradient(135deg,var(--rsdh-glass) 0%,transparent 100%);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);border-radius:12px;padding:14px;margin-bottom:12px;transition:border-color var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}.card:hover{border-color:#ffffff1f;box-shadow:0 4px 20px #00000026}.h{font-weight:800;font-size:13px;margin-bottom:8px;letter-spacing:-.01em;color:#fff}.sub{font-size:11px;color:#fff9;line-height:1.45}.muted{color:#ffffff73}.table{width:100%;border-collapse:collapse;font-size:11px}.table th,.table td{text-align:left;padding:8px 10px;border-bottom:1px solid var(--rsdh-glass-border);vertical-align:top}.table thead th{color:var(--rsdh-accent-light);font-weight:700;text-transform:uppercase;font-size:10px;letter-spacing:.04em}.table tbody tr:hover{background:#ffffff05}.table tbody tr:last-child td{border-bottom:none}.list{display:grid;gap:8px;margin-top:10px}.row{display:flex;gap:10px;align-items:baseline;justify-content:space-between;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.04)}.row:last-child{border-bottom:none}.rowLeft{flex:1;min-width:0}.rowRight{flex:0 0 auto}.pill{display:inline-block;padding:3px 8px;border-radius:999px;border:1px solid var(--rsdh-accent-glow);background:linear-gradient(135deg,var(--rsdh-accent-subtle) 0%,transparent 100%);font-size:10px;font-weight:600;color:var(--rsdh-accent-light)}.link{color:var(--rsdh-accent-light);text-decoration:none;transition:color var(--rsdh-transition-fast)}.link:hover{color:#fff;text-decoration:underline}.code-output{margin:0;white-space:pre-wrap;font-family:SF Mono,Fira Code,Consolas,monospace;font-size:11px;line-height:1.5;color:#ffffffd9;background:#0003;padding:10px;border-radius:8px;overflow-x:auto}.bet-item{padding:10px 0;border-bottom:1px solid var(--rsdh-glass-border)}.bet-item:last-child{border-bottom:none}.bet-header{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.bet-tier{font-weight:700;color:#fff}.bet-rec{font-size:10px;font-weight:700;padding:3px 8px;border-radius:4px}.bet-rec.yes{background:#22c55e33;color:#22c55e}.bet-rec.no{background:#ef444433;color:#ef4444}.bet-reason{margin-top:6px;font-size:11px;color:#ffffffa6;line-height:1.4;word-wrap:break-word;overflow-wrap:break-word}.details summary{cursor:pointer;color:#fff9;font-size:11px;font-weight:600;user-select:none;padding:8px 0;transition:color var(--rsdh-transition-fast)}.details summary:hover{color:#ffffffd9}.details[open] summary{margin-bottom:8px}input[type=text],input[type=password]{width:100%;max-width:100%;background:#00000059;color:#eaeaea;border:1px solid var(--rsdh-glass-border);border-radius:8px;padding:10px 12px;font-size:12px;font-family:inherit;transition:border-color var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}input[type=text]:focus,input[type=password]:focus{outline:none;border-color:var(--rsdh-accent);box-shadow:0 0 0 3px var(--rsdh-accent-glow)}input[type=text]::placeholder,input[type=password]::placeholder{color:#ffffff4d}input[type=checkbox]{width:16px;height:16px;accent-color:var(--rsdh-accent);cursor:pointer}input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:6px;background:#ffffff1a;border-radius:3px;cursor:pointer;margin-top:6px}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);cursor:pointer;box-shadow:0 2px 6px #0000004d;transition:transform .15s ease}input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.15)}input[type=range]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;border:none;background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);cursor:pointer;box-shadow:0 2px 6px #0000004d}.hidden{display:none}.fab{position:fixed;right:20px;bottom:20px;width:56px;height:56px;z-index:2147483647;border-radius:999px;border:1px solid rgba(255,255,255,.1);background:radial-gradient(circle at 30% 30%,color-mix(in srgb,var(--rsdh-accent) 50%,white) 0%,transparent 50%),radial-gradient(circle at 70% 70%,var(--rsdh-accent-dark) 0%,transparent 60%),linear-gradient(135deg,#19191ef2,#0f0f12fa);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);box-shadow:0 8px 32px #0006,0 0 0 1px var(--rsdh-accent-glow),inset 0 1px #ffffff1a;color:#fff;cursor:pointer;display:grid;place-items:center;transition:transform var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}.fab:hover{transform:translateY(-2px) scale(1.04);box-shadow:0 12px 40px #00000080,0 0 30px var(--rsdh-accent-glow),inset 0 1px #ffffff26}.fab:active{transform:translateY(0) scale(.98)}.view::-webkit-scrollbar{width:6px}.view::-webkit-scrollbar-track{background:transparent}.view::-webkit-scrollbar-thumb{background:#ffffff26;border-radius:3px}.view::-webkit-scrollbar-thumb:hover{background:#ffffff40}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;gap:16px}.spinner{width:40px;height:40px;border:3px solid rgba(255,255,255,.1);border-top-color:var(--rsdh-accent);border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.loading-text{font-size:13px;font-weight:600;color:#ffffffb3;animation:pulse 1.5s ease-in-out infinite}@keyframes pulse{0%,to{opacity:.7}50%{opacity:1}}.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:48px 24px;gap:16px}.empty-icon{font-size:48px;opacity:.6;filter:grayscale(20%)}.empty-title{font-size:15px;font-weight:700;color:#ffffffe6;margin:0}.empty-description{font-size:12px;color:#ffffff8c;max-width:280px;line-height:1.5;margin:0}.empty-hint{display:inline-flex;align-items:center;gap:6px;margin-top:8px;padding:8px 14px;background:var(--rsdh-accent-subtle);border:1px solid var(--rsdh-accent-glow);border-radius:8px;font-size:11px;font-weight:600;color:var(--rsdh-accent-light)}.timeline-step{margin-left:8px;padding-left:16px;border-left:2px solid rgba(255,255,255,.1);margin-bottom:4px}.timeline-step:last-of-type{border-left-color:transparent}.timeline-step[open]{border-left-color:var(--rsdh-accent);margin-bottom:12px}.timeline-summary{display:flex;align-items:center;gap:8px;cursor:pointer;padding:8px 0;list-style:none;user-select:none;transition:color var(--rsdh-transition-fast)}.timeline-summary::-webkit-details-marker{display:none}.timeline-summary:hover{color:#fffffff2}.timeline-icon{display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;border-radius:50%;background:#ffffff14;font-size:11px;color:#ffffff80;flex-shrink:0}.timeline-icon.success{background:#22c55e33;color:#22c55e}.timeline-title{font-weight:600;font-size:12px;color:#ffffffd9}.timeline-status{margin-left:auto;font-size:11px;color:#ffffff80;font-weight:500}.timeline-content{padding:8px 0 12px 28px;animation:fadeIn .15s ease}';typeof window<"u"&&((window.__svelte??={}).v??=new Set).add("5");let Fr=!1,Vo=!1;function Xo(){Fr=!0}Xo();const Zo=1,Qo=2,Fa=4,ei=8,ti=16,ri=1,ni=2,xe=Symbol(),ai="http://www.w3.org/1999/xhtml",Bn=!1;var Dn=Array.isArray,si=Array.prototype.indexOf,mn=Array.from,oi=Object.defineProperty,$r=Object.getOwnPropertyDescriptor,$a=Object.getOwnPropertyDescriptors,ii=Object.prototype,li=Array.prototype,Fn=Object.getPrototypeOf,qa=Object.isExtensible;function ci(e){return e()}function $n(e){for(var t=0;t<e.length;t++)e[t]()}function za(){var e,t,r=new Promise((n,a)=>{e=n,t=a});return{promise:r,resolve:e,reject:t}}const ge=2,qn=4,vn=8,di=1<<24,bt=16,yt=32,Kt=64,gn=128,at=512,we=1024,Ne=2048,ct=4096,qe=8192,Mt=16384,zn=32768,gr=65536,Ha=1<<17,Ya=1<<18,_r=1<<19,Ua=1<<20,xt=1<<25,Jt=32768,Hn=1<<21,Yn=1<<22,It=1<<23,Wt=Symbol("$state"),br=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ui(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function fi(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function pi(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function hi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function mi(e){throw new Error("https://svelte.dev/e/effect_orphan")}function vi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function gi(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function _i(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function bi(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function yi(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}function xi(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function wi(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Ga(e){return e===this.v}function Si(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ja(e){return!Si(e,this.v)}let ie=null;function yr(e){ie=e}function Ka(e,t=!1,r){ie={p:ie,i:!1,c:null,e:null,s:e,x:null,l:Fr&&!t?{s:null,u:null,$:[]}:null}}function Ja(e){var t=ie,r=t.e;if(r!==null){t.e=null;for(var n of r)ps(n)}return t.i=!0,ie=t.p,{}}function qr(){return!Fr||ie!==null&&ie.l===null}let Vt=[];function Wa(){var e=Vt;Vt=[],$n(e)}function zr(e){if(Vt.length===0&&!Yr){var t=Vt;queueMicrotask(()=>{t===Vt&&Wa()})}Vt.push(e)}function ki(){for(;Vt.length>0;)Wa()}function Va(e){var t=U;if(t===null)return q.f|=It,e;if((t.f&zn)===0){if((t.f&gn)===0)throw e;t.b.error(e)}else xr(e,t)}function xr(e,t){for(;t!==null;){if((t.f&gn)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e}const _n=new Set;let z=null,Hr=null,We=null,Ve=[],bn=null,Un=!1,Yr=!1;class dt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#l=null;#s=new Set;#a=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#r>0}process(t){Ve=[],Hr=null,this.apply();var r={parent:null,effect:null,effects:[],render_effects:[]};for(const n of t)this.#o(n,r);this.is_fork||this.#d(),this.is_deferred()?(this.#i(r.effects),this.#i(r.render_effects)):(Hr=this,z=null,Za(r.render_effects),Za(r.effects),Hr=null,this.#l?.resolve()),We=null}#o(t,r){t.f^=we;for(var n=t.first;n!==null;){var a=n.f,s=(a&(yt|Kt))!==0,i=s&&(a&we)!==0,l=i||(a&qe)!==0||this.skipped_effects.has(n);if((n.f&gn)!==0&&n.b?.is_pending()&&(r={parent:r,effect:n,effects:[],render_effects:[]}),!l&&n.fn!==null){s?n.f^=we:(a&qn)!==0?r.effects.push(n):Wr(n)&&((n.f&bt)!==0&&this.#s.add(n),Vr(n));var c=n.first;if(c!==null){n=c;continue}}var o=n.parent;for(n=n.next;n===null&&o!==null;)o===r.effect&&(this.#i(r.effects),this.#i(r.render_effects),r=r.parent),n=o.next,o=o.parent}}#i(t){for(const r of t)(r.f&Ne)!==0?this.#s.add(r):(r.f&ct)!==0&&this.#a.add(r),this.#c(r.deps),Se(r,we)}#c(t){if(t!==null)for(const r of t)(r.f&ge)===0||(r.f&Jt)===0||(r.f^=Jt,this.#c(r.deps))}capture(t,r){this.previous.has(t)||this.previous.set(t,r),(t.f&It)===0&&(this.current.set(t,t.v),We?.set(t,t.v))}activate(){z=this,this.apply()}deactivate(){z===this&&(z=null,We=null)}flush(){if(this.activate(),Ve.length>0){if(Xa(),z!==null&&z!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#d(){if(this.#r===0){for(const t of this.#e)t();this.#e.clear()}this.#n===0&&this.#u()}#u(){if(_n.size>1){this.previous.clear();var t=We,r=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const s of _n){if(s===this){r=!1;continue}const i=[];for(const[c,o]of this.current){if(s.current.has(c))if(r&&o!==s.current.get(c))s.current.set(c,o);else continue;i.push(c)}if(i.length===0)continue;const l=[...s.current.keys()].filter(c=>!this.current.has(c));if(l.length>0){var a=Ve;Ve=[];const c=new Set,o=new Map;for(const u of i)Qa(u,l,c,o);if(Ve.length>0){z=s,s.apply();for(const u of Ve)s.#o(u,n);s.deactivate()}Ve=a}}z=null,We=t}this.committed=!0,_n.delete(this)}increment(t){this.#n+=1,t&&(this.#r+=1)}decrement(t){this.#n-=1,t&&(this.#r-=1),this.revive()}revive(){for(const t of this.#s)this.#a.delete(t),Se(t,Ne),Xt(t);for(const t of this.#a)Se(t,ct),Xt(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=za()).promise}static ensure(){if(z===null){const t=z=new dt;_n.add(z),Yr||dt.enqueue(()=>{z===t&&t.flush()})}return z}static enqueue(t){zr(t)}apply(){}}function Ai(e){var t=Yr;Yr=!0;try{for(var r;;){if(ki(),Ve.length===0&&(z?.flush(),Ve.length===0))return bn=null,r;Xa()}}finally{Yr=t}}function Xa(){var e=tr;Un=!0;var t=null;try{var r=0;for(wn(!0);Ve.length>0;){var n=dt.ensure();if(r++>1e3){var a,s;Ei()}n.process(Ve),Lt.clear()}}finally{Un=!1,wn(e),bn=null}}function Ei(){try{vi()}catch(e){xr(e,bn)}}let wt=null;function Za(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var n=e[r++];if((n.f&(Mt|qe))===0&&Wr(n)&&(wt=new Set,Vr(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?gs(n):n.fn=null),wt?.size>0)){Lt.clear();for(const a of wt){if((a.f&(Mt|qe))!==0)continue;const s=[a];let i=a.parent;for(;i!==null;)wt.has(i)&&(wt.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const c=s[l];(c.f&(Mt|qe))===0&&Vr(c)}}wt.clear()}}wt=null}}function Qa(e,t,r,n){if(!r.has(e)&&(r.add(e),e.reactions!==null))for(const a of e.reactions){const s=a.f;(s&ge)!==0?Qa(a,t,r,n):(s&(Yn|bt))!==0&&(s&Ne)===0&&es(a,t,n)&&(Se(a,Ne),Xt(a))}}function es(e,t,r){const n=r.get(e);if(n!==void 0)return n;if(e.deps!==null)for(const a of e.deps){if(t.includes(a))return!0;if((a.f&ge)!==0&&es(a,t,r))return r.set(a,!0),!0}return r.set(e,!1),!1}function Xt(e){for(var t=bn=e;t.parent!==null;){t=t.parent;var r=t.f;if(Un&&t===U&&(r&bt)!==0&&(r&Ya)===0)return;if((r&(Kt|yt))!==0){if((r&we)===0)return;t.f^=we}}Ve.push(t)}function Ti(e){let t=0,r=Zt(0),n;return()=>{Kr()&&(d(r),Xn(()=>(t===0&&(n=kr(()=>e(()=>Ur(r)))),t+=1,()=>{zr(()=>{t-=1,t===0&&(n?.(),n=void 0,Ur(r))})})))}}var Ci=gr|_r|gn;function Pi(e,t,r){new Ri(e,t,r)}class Ri{parent;#e=!1;#t;#n=null;#r;#l;#s;#a=null;#o=null;#i=null;#c=null;#d=null;#u=0;#f=0;#h=!1;#p=null;#b=Ti(()=>(this.#p=Zt(this.#u),()=>{this.#p=null}));constructor(t,r,n){this.#t=t,this.#r=r,this.#l=n,this.parent=U.b,this.#e=!!this.#r.pending,this.#s=Zn(()=>{U.b=this;{var a=this.#g();try{this.#a=Xe(()=>n(a))}catch(s){this.error(s)}this.#f>0?this.#v():this.#e=!1}return()=>{this.#d?.remove()}},Ci)}#y(){try{this.#a=Xe(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#x(){const t=this.#r.pending;t&&(this.#o=Xe(()=>t(this.#t)),dt.enqueue(()=>{var r=this.#g();this.#a=this.#m(()=>(dt.ensure(),Xe(()=>this.#l(r)))),this.#f>0?this.#v():(er(this.#o,()=>{this.#o=null}),this.#e=!1)}))}#g(){var t=this.#t;return this.#e&&(this.#d=kt(),this.#t.before(this.#d),t=this.#d),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(t){var r=U,n=q,a=ie;pt(this.#s),Ie(this.#s),yr(this.#s.ctx);try{return t()}catch(s){return Va(s),null}finally{pt(r),Ie(n),yr(a)}}#v(){const t=this.#r.pending;this.#a!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#d),ys(this.#a,this.#c)),this.#o===null&&(this.#o=Xe(()=>t(this.#t)))}#_(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(t);return}this.#f+=t,this.#f===0&&(this.#e=!1,this.#o&&er(this.#o,()=>{this.#o=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#_(t),this.#u+=t,this.#p&&Qt(this.#p,this.#u)}get_effect_pending(){return this.#b(),d(this.#p)}error(t){var r=this.#r.onerror;let n=this.#r.failed;if(this.#h||!r&&!n)throw t;this.#a&&(Me(this.#a),this.#a=null),this.#o&&(Me(this.#o),this.#o=null),this.#i&&(Me(this.#i),this.#i=null);var a=!1,s=!1;const i=()=>{if(a){wi();return}a=!0,s&&yi(),dt.ensure(),this.#u=0,this.#i!==null&&er(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#h=!1,Xe(()=>this.#l(this.#t)))),this.#f>0?this.#v():this.#e=!1};var l=q;try{Ie(null),s=!0,r?.(t,i),s=!1}catch(c){xr(c,this.#s&&this.#s.parent)}finally{Ie(l)}n&&zr(()=>{this.#i=this.#m(()=>{dt.ensure(),this.#h=!0;try{return Xe(()=>{n(this.#t,()=>t,()=>i)})}catch(c){return xr(c,this.#s.parent),null}finally{this.#h=!1}})})}}function Oi(e,t,r,n){const a=qr()?Gn:St;if(r.length===0&&e.length===0){n(t.map(a));return}var s=z,i=U,l=Ni();function c(){Promise.all(r.map(o=>Mi(o))).then(o=>{l();try{n([...t.map(a),...o])}catch(u){(i.f&Mt)===0&&xr(u,i)}s?.deactivate(),yn()}).catch(o=>{xr(o,i)})}e.length>0?Promise.all(e).then(()=>{l();try{return c()}finally{s?.deactivate(),yn()}}):c()}function Ni(){var e=U,t=q,r=ie,n=z;return function(s=!0){pt(e),Ie(t),yr(r),s&&n?.activate()}}function yn(){pt(null),Ie(null),yr(null)}function Gn(e){var t=ge|Ne,r=q!==null&&(q.f&ge)!==0?q:null;return U!==null&&(U.f|=_r),{ctx:ie,deps:null,effects:null,equals:Ga,f:t,fn:e,reactions:null,rv:0,v:xe,wv:0,parent:r??U,ac:null}}function Mi(e,t){let r=U;r===null&&fi();var n=r.b,a=void 0,s=Zt(xe),i=!q,l=new Map;return Ui(()=>{var c=za();a=c.promise;try{Promise.resolve(e()).then(c.resolve,c.reject).then(()=>{o===z&&o.committed&&o.deactivate(),yn()})}catch(p){c.reject(p),yn()}var o=z;if(i){var u=!n.is_pending();n.update_pending_count(1),o.increment(u),l.get(o)?.reject(br),l.delete(o),l.set(o,c)}const f=(p,v=void 0)=>{if(o.activate(),v)v!==br&&(s.f|=It,Qt(s,v));else{(s.f&It)!==0&&(s.f^=It),Qt(s,p);for(const[x,E]of l){if(l.delete(x),x===o)break;E.reject(br)}}i&&(n.update_pending_count(-1),o.decrement(u))};c.promise.then(f,p=>f(null,p||"unknown"))}),Wn(()=>{for(const c of l.values())c.reject(br)}),new Promise(c=>{function o(u){function f(){u===a?c(s):o(a)}u.then(f,f)}o(a)})}function St(e){const t=Gn(e);return t.equals=ja,t}function ts(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)Me(t[r])}}function Ii(e){for(var t=e.parent;t!==null;){if((t.f&ge)===0)return(t.f&Mt)===0?t:null;t=t.parent}return null}function jn(e){var t,r=U;pt(Ii(e));try{e.f&=~Jt,ts(e),t=Es(e)}finally{pt(r)}return t}function rs(e){var t=jn(e);if(e.equals(t)||(z?.is_fork||(e.v=t),e.wv=ks()),!Sr)if(We!==null)(Kr()||z?.is_fork)&&We.set(e,t);else{var r=(e.f&at)===0?ct:we;Se(e,r)}}let Kn=new Set;const Lt=new Map;let ns=!1;function Zt(e,t){var r={f:0,v:e,reactions:null,equals:Ga,rv:0,wv:0};return r}function Bt(e,t){const r=Zt(e);return Ji(r),r}function G(e,t=!1,r=!0){const n=Zt(e);return t||(n.equals=ja),Fr&&r&&ie!==null&&ie.l!==null&&(ie.l.s??=[]).push(n),n}function k(e,t,r=!1){q!==null&&(!ft||(q.f&Ha)!==0)&&qr()&&(q.f&(ge|bt|Yn|Ha))!==0&&!At?.includes(e)&&bi();let n=r?Gr(t):t;return Qt(e,n)}function Qt(e,t){if(!e.equals(t)){var r=e.v;Sr?Lt.set(e,t):Lt.set(e,r),e.v=t;var n=dt.ensure();n.capture(e,r),(e.f&ge)!==0&&((e.f&Ne)!==0&&jn(e),Se(e,(e.f&at)!==0?we:ct)),e.wv=ks(),as(e,Ne),qr()&&U!==null&&(U.f&we)!==0&&(U.f&(yt|Kt))===0&&(Ze===null?Wi([e]):Ze.push(e)),!n.is_fork&&Kn.size>0&&!ns&&Li()}return t}function Li(){ns=!1;var e=tr;wn(!0);const t=Array.from(Kn);try{for(const r of t)(r.f&we)!==0&&Se(r,ct),Wr(r)&&Vr(r)}finally{wn(e)}Kn.clear()}function Ur(e){k(e,e.v+1)}function as(e,t){var r=e.reactions;if(r!==null)for(var n=qr(),a=r.length,s=0;s<a;s++){var i=r[s],l=i.f;if(!(!n&&i===U)){var c=(l&Ne)===0;if(c&&Se(i,t),(l&ge)!==0){var o=i;We?.delete(o),(l&Jt)===0&&(l&at&&(i.f|=Jt),as(o,ct))}else c&&((l&bt)!==0&&wt!==null&&wt.add(i),Xt(i))}}}function Gr(e){if(typeof e!="object"||e===null||Wt in e)return e;const t=Fn(e);if(t!==ii&&t!==li)return e;var r=new Map,n=Dn(e),a=Bt(0),s=rr,i=l=>{if(rr===s)return l();var c=q,o=rr;Ie(null),Ss(s);var u=l();return Ie(c),Ss(o),u};return n&&r.set("length",Bt(e.length)),new Proxy(e,{defineProperty(l,c,o){(!("value"in o)||o.configurable===!1||o.enumerable===!1||o.writable===!1)&&gi();var u=r.get(c);return u===void 0?u=i(()=>{var f=Bt(o.value);return r.set(c,f),f}):k(u,o.value,!0),!0},deleteProperty(l,c){var o=r.get(c);if(o===void 0){if(c in l){const u=i(()=>Bt(xe));r.set(c,u),Ur(a)}}else k(o,xe),Ur(a);return!0},get(l,c,o){if(c===Wt)return e;var u=r.get(c),f=c in l;if(u===void 0&&(!f||$r(l,c)?.writable)&&(u=i(()=>{var v=Gr(f?l[c]:xe),x=Bt(v);return x}),r.set(c,u)),u!==void 0){var p=d(u);return p===xe?void 0:p}return Reflect.get(l,c,o)},getOwnPropertyDescriptor(l,c){var o=Reflect.getOwnPropertyDescriptor(l,c);if(o&&"value"in o){var u=r.get(c);u&&(o.value=d(u))}else if(o===void 0){var f=r.get(c),p=f?.v;if(f!==void 0&&p!==xe)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return o},has(l,c){if(c===Wt)return!0;var o=r.get(c),u=o!==void 0&&o.v!==xe||Reflect.has(l,c);if(o!==void 0||U!==null&&(!u||$r(l,c)?.writable)){o===void 0&&(o=i(()=>{var p=u?Gr(l[c]):xe,v=Bt(p);return v}),r.set(c,o));var f=d(o);if(f===xe)return!1}return u},set(l,c,o,u){var f=r.get(c),p=c in l;if(n&&c==="length")for(var v=o;v<f.v;v+=1){var x=r.get(v+"");x!==void 0?k(x,xe):v in l&&(x=i(()=>Bt(xe)),r.set(v+"",x))}if(f===void 0)(!p||$r(l,c)?.writable)&&(f=i(()=>Bt(void 0)),k(f,Gr(o)),r.set(c,f));else{p=f.v!==xe;var E=i(()=>Gr(o));k(f,E)}var b=Reflect.getOwnPropertyDescriptor(l,c);if(b?.set&&b.set.call(u,o),!p){if(n&&typeof c=="string"){var T=r.get("length"),I=Number(c);Number.isInteger(I)&&I>=T.v&&k(T,I+1)}Ur(a)}return!0},ownKeys(l){d(a);var c=Reflect.ownKeys(l).filter(f=>{var p=r.get(f);return p===void 0||p.v!==xe});for(var[o,u]of r)u.v!==xe&&!(o in l)&&c.push(o);return c},setPrototypeOf(){_i()}})}function ss(e){try{if(e!==null&&typeof e=="object"&&Wt in e)return e[Wt]}catch{}return e}function Bi(e,t){return Object.is(ss(e),ss(t))}var os,is,ls,cs;function Di(){if(os===void 0){os=window,is=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;ls=$r(t,"firstChild").get,cs=$r(t,"nextSibling").get,qa(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),qa(r)&&(r.__t=void 0)}}function kt(e=""){return document.createTextNode(e)}function Dt(e){return ls.call(e)}function jr(e){return cs.call(e)}function h(e,t){return Dt(e)}function ae(e,t=!1){{var r=Dt(e);return r instanceof Comment&&r.data===""?jr(r):r}}function m(e,t=1,r=!1){let n=e;for(;t--;)n=jr(n);return n}function Fi(e){e.textContent=""}function ds(){return!1}let us=!1;function $i(){us||(us=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function xn(e){var t=q,r=U;Ie(null),pt(null);try{return e()}finally{Ie(t),pt(r)}}function Jn(e,t,r,n=r){e.addEventListener(t,()=>xn(r));const a=e.__on_r;a?e.__on_r=()=>{a(),n(!0)}:e.__on_r=()=>n(!0),$i()}function fs(e){U===null&&(q===null&&mi(),hi()),Sr&&pi()}function qi(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function ut(e,t,r){var n=U;n!==null&&(n.f&qe)!==0&&(e|=qe);var a={ctx:ie,deps:null,nodes:null,f:e|Ne|at,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Vr(a),a.f|=zn}catch(l){throw Me(a),l}else t!==null&&Xt(a);var s=a;if(r&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&_r)===0&&(s=s.first,(e&bt)!==0&&(e&gr)!==0&&s!==null&&(s.f|=gr)),s!==null&&(s.parent=n,n!==null&&qi(s,n),q!==null&&(q.f&ge)!==0&&(e&Kt)===0)){var i=q;(i.effects??=[]).push(s)}return a}function Kr(){return q!==null&&!ft}function Wn(e){const t=ut(vn,null,!1);return Se(t,we),t.teardown=e,t}function Vn(e){fs();var t=U.f,r=!q&&(t&yt)!==0&&(t&zn)===0;if(r){var n=ie;(n.e??=[]).push(e)}else return ps(e)}function ps(e){return ut(qn|Ua,e,!1)}function zi(e){return fs(),ut(vn|Ua,e,!0)}function Hi(e){dt.ensure();const t=ut(Kt|_r,e,!0);return(r={})=>new Promise(n=>{r.outro?er(t,()=>{Me(t),n(void 0)}):(Me(t),n(void 0))})}function Yi(e){return ut(qn,e,!1)}function Ui(e){return ut(Yn|_r,e,!0)}function Xn(e,t=0){return ut(vn|t,e,!0)}function R(e,t=[],r=[],n=[]){Oi(n,t,r,a=>{ut(vn,()=>e(...a.map(d)),!0)})}function Zn(e,t=0){var r=ut(bt|t,e,!0);return r}function Xe(e){return ut(yt|_r,e,!0)}function hs(e){var t=e.teardown;if(t!==null){const r=Sr,n=q;xs(!0),Ie(null);try{t.call(null)}finally{xs(r),Ie(n)}}}function ms(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const a=r.ac;a!==null&&xn(()=>{a.abort(br)});var n=r.next;(r.f&Kt)!==0?r.parent=null:Me(r,t),r=n}}function Gi(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&yt)===0&&Me(t),t=r}}function Me(e,t=!0){var r=!1;(t||(e.f&Ya)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(vs(e.nodes.start,e.nodes.end),r=!0),ms(e,t&&!r),Sn(e,0),Se(e,Mt);var n=e.nodes&&e.nodes.t;if(n!==null)for(const s of n)s.stop();hs(e);var a=e.parent;a!==null&&a.first!==null&&gs(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function vs(e,t){for(;e!==null;){var r=e===t?null:jr(e);e.remove(),e=r}}function gs(e){var t=e.parent,r=e.prev,n=e.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function er(e,t,r=!0){var n=[];_s(e,n,!0);var a=()=>{r&&Me(e),t&&t()},s=n.length;if(s>0){var i=()=>--s||a();for(var l of n)l.out(i)}else a()}function _s(e,t,r){if((e.f&qe)===0){e.f^=qe;var n=e.nodes&&e.nodes.t;if(n!==null)for(const l of n)(l.is_global||r)&&t.push(l);for(var a=e.first;a!==null;){var s=a.next,i=(a.f&gr)!==0||(a.f&yt)!==0&&(e.f&bt)!==0;_s(a,t,i?r:!1),a=s}}}function Qn(e){bs(e,!0)}function bs(e,t){if((e.f&qe)!==0){e.f^=qe,(e.f&we)===0&&(Se(e,Ne),Xt(e));for(var r=e.first;r!==null;){var n=r.next,a=(r.f&gr)!==0||(r.f&yt)!==0;bs(r,a?t:!1),r=n}var s=e.nodes&&e.nodes.t;if(s!==null)for(const i of s)(i.is_global||t)&&i.in()}}function ys(e,t){if(e.nodes)for(var r=e.nodes.start,n=e.nodes.end;r!==null;){var a=r===n?null:jr(r);t.append(r),r=a}}let wr=null;function ji(e){var t=wr;try{if(wr=new Set,kr(e),t!==null)for(var r of wr)t.add(r);return wr}finally{wr=t}}function Ki(e){for(var t of ji(e))Qt(t,t.v)}let tr=!1;function wn(e){tr=e}let Sr=!1;function xs(e){Sr=e}let q=null,ft=!1;function Ie(e){q=e}let U=null;function pt(e){U=e}let At=null;function Ji(e){q!==null&&(At===null?At=[e]:At.push(e))}let Ce=null,ze=0,Ze=null;function Wi(e){Ze=e}let ws=1,Jr=0,rr=Jr;function Ss(e){rr=e}function ks(){return++ws}function Wr(e){var t=e.f;if((t&Ne)!==0)return!0;if(t&ge&&(e.f&=~Jt),(t&ct)!==0){var r=e.deps;if(r!==null)for(var n=r.length,a=0;a<n;a++){var s=r[a];if(Wr(s)&&rs(s),s.wv>e.wv)return!0}(t&at)!==0&&We===null&&Se(e,we)}return!1}function As(e,t,r=!0){var n=e.reactions;if(n!==null&&!At?.includes(e))for(var a=0;a<n.length;a++){var s=n[a];(s.f&ge)!==0?As(s,t,!1):t===s&&(r?Se(s,Ne):(s.f&we)!==0&&Se(s,ct),Xt(s))}}function Es(e){var t=Ce,r=ze,n=Ze,a=q,s=At,i=ie,l=ft,c=rr,o=e.f;Ce=null,ze=0,Ze=null,q=(o&(yt|Kt))===0?e:null,At=null,yr(e.ctx),ft=!1,rr=++Jr,e.ac!==null&&(xn(()=>{e.ac.abort(br)}),e.ac=null);try{e.f|=Hn;var u=e.fn,f=u(),p=e.deps;if(Ce!==null){var v;if(Sn(e,ze),p!==null&&ze>0)for(p.length=ze+Ce.length,v=0;v<Ce.length;v++)p[ze+v]=Ce[v];else e.deps=p=Ce;if(Kr()&&(e.f&at)!==0)for(v=ze;v<p.length;v++)(p[v].reactions??=[]).push(e)}else p!==null&&ze<p.length&&(Sn(e,ze),p.length=ze);if(qr()&&Ze!==null&&!ft&&p!==null&&(e.f&(ge|ct|Ne))===0)for(v=0;v<Ze.length;v++)As(Ze[v],e);return a!==null&&a!==e&&(Jr++,Ze!==null&&(n===null?n=Ze:n.push(...Ze))),(e.f&It)!==0&&(e.f^=It),f}catch(x){return Va(x)}finally{e.f^=Hn,Ce=t,ze=r,Ze=n,q=a,At=s,yr(i),ft=l,rr=c}}function Vi(e,t){let r=t.reactions;if(r!==null){var n=si.call(r,e);if(n!==-1){var a=r.length-1;a===0?r=t.reactions=null:(r[n]=r[a],r.pop())}}r===null&&(t.f&ge)!==0&&(Ce===null||!Ce.includes(t))&&(Se(t,ct),(t.f&at)!==0&&(t.f^=at,t.f&=~Jt),ts(t),Sn(t,0))}function Sn(e,t){var r=e.deps;if(r!==null)for(var n=t;n<r.length;n++)Vi(e,r[n])}function Vr(e){var t=e.f;if((t&Mt)===0){Se(e,we);var r=U,n=tr;U=e,tr=!0;try{(t&(bt|di))!==0?Gi(e):ms(e),hs(e);var a=Es(e);e.teardown=typeof a=="function"?a:null,e.wv=ws;var s;Bn&&Vo&&(e.f&Ne)!==0&&e.deps}finally{tr=n,U=r}}}async function Xi(){await Promise.resolve(),Ai()}function d(e){var t=e.f,r=(t&ge)!==0;if(wr?.add(e),q!==null&&!ft){var n=U!==null&&(U.f&Mt)!==0;if(!n&&!At?.includes(e)){var a=q.deps;if((q.f&Hn)!==0)e.rv<Jr&&(e.rv=Jr,Ce===null&&a!==null&&a[ze]===e?ze++:Ce===null?Ce=[e]:Ce.includes(e)||Ce.push(e));else{(q.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[q]:s.includes(q)||s.push(q)}}}if(Sr){if(Lt.has(e))return Lt.get(e);if(r){var i=e,l=i.v;return((i.f&we)===0&&i.reactions!==null||Cs(i))&&(l=jn(i)),Lt.set(i,l),l}}else r&&(!We?.has(e)||z?.is_fork&&!Kr())&&(i=e,Wr(i)&&rs(i),tr&&Kr()&&(i.f&at)===0&&Ts(i));if(We?.has(e))return We.get(e);if((e.f&It)!==0)throw e.v;return e.v}function Ts(e){if(e.deps!==null){e.f^=at;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&ge)!==0&&(t.f&at)===0&&Ts(t)}}function Cs(e){if(e.v===xe)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Lt.has(t)||(t.f&ge)!==0&&Cs(t))return!0;return!1}function kr(e){var t=ft;try{return ft=!0,e()}finally{ft=t}}const Zi=-7169;function Se(e,t){e.f=e.f&Zi|t}function Qi(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Wt in e)ea(e);else if(!Array.isArray(e))for(let t in e){const r=e[t];typeof r=="object"&&r&&Wt in r&&ea(r)}}}function ea(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{ea(e[n],t)}catch{}const r=Fn(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=$a(r);for(let a in n){const s=n[a].get;if(s)try{s.call(e)}catch{}}}}}const el=new Set,Ps=new Set;function tl(e,t,r,n={}){function a(s){if(n.capture||Xr.call(t,s),!s.cancelBubble)return xn(()=>r?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?zr(()=>{t.addEventListener(e,a,n)}):t.addEventListener(e,a,n),a}function Pe(e,t,r,n,a){var s={capture:n,passive:a},i=tl(e,t,r,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Wn(()=>{t.removeEventListener(e,i,s)})}let Rs=null;function Xr(e){var t=this,r=t.ownerDocument,n=e.type,a=e.composedPath?.()||[],s=a[0]||e.target;Rs=e;var i=0,l=Rs===e&&e.__root;if(l){var c=a.indexOf(l);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var o=a.indexOf(t);if(o===-1)return;c<=o&&(i=c)}if(s=a[i]||e.target,s!==t){oi(e,"currentTarget",{configurable:!0,get(){return s||r}});var u=q,f=U;Ie(null),pt(null);try{for(var p,v=[];s!==null;){var x=s.assignedSlot||s.parentNode||s.host||null;try{var E=s["__"+n];E!=null&&(!s.disabled||e.target===s)&&E.call(s,e)}catch(b){p?v.push(b):p=b}if(e.cancelBubble||x===t||x===null)break;s=x}if(p){for(let b of v)queueMicrotask(()=>{throw b});throw p}}finally{e.__root=t,delete e.currentTarget,Ie(u),pt(f)}}}function Os(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Zr(e,t){var r=U;r.nodes===null&&(r.nodes={start:e,end:t,a:null,t:null})}function w(e,t){var r=(t&ri)!==0,n=(t&ni)!==0,a,s=!e.startsWith("<!>");return()=>{a===void 0&&(a=Os(s?e:"<!>"+e),r||(a=Dt(a)));var i=n||is?document.importNode(a,!0):a.cloneNode(!0);if(r){var l=Dt(i),c=i.lastChild;Zr(l,c)}else Zr(i,i);return i}}function He(e=""){{var t=kt(e+"");return Zr(t,t),t}}function Et(){var e=document.createDocumentFragment(),t=document.createComment(""),r=kt();return e.append(t,r),Zr(t,r),e}function _(e,t){e!==null&&e.before(t)}const rl=["touchstart","touchmove"];function nl(e){return rl.includes(e)}function A(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function al(e,t){return sl(e,t)}const Ar=new Map;function sl(e,{target:t,anchor:r,props:n={},events:a,context:s,intro:i=!0}){Di();var l=new Set,c=f=>{for(var p=0;p<f.length;p++){var v=f[p];if(!l.has(v)){l.add(v);var x=nl(v);t.addEventListener(v,Xr,{passive:x});var E=Ar.get(v);E===void 0?(document.addEventListener(v,Xr,{passive:x}),Ar.set(v,1)):Ar.set(v,E+1)}}};c(mn(el)),Ps.add(c);var o=void 0,u=Hi(()=>{var f=r??t.appendChild(kt());return Pi(f,{pending:()=>{}},p=>{if(s){Ka({});var v=ie;v.c=s}a&&(n.$$events=a),o=e(p,n)||{},s&&Ja()}),()=>{for(var p of l){t.removeEventListener(p,Xr);var v=Ar.get(p);--v===0?(document.removeEventListener(p,Xr),Ar.delete(p)):Ar.set(p,v)}Ps.delete(c),f!==r&&f.parentNode?.removeChild(f)}});return ol.set(o,u),o}let ol=new WeakMap;class il{anchor;#e=new Map;#t=new Map;#n=new Map;#r=new Set;#l=!0;constructor(t,r=!0){this.anchor=t,this.#l=r}#s=()=>{var t=z;if(this.#e.has(t)){var r=this.#e.get(t),n=this.#t.get(r);if(n)Qn(n),this.#r.delete(r);else{var a=this.#n.get(r);a&&(this.#t.set(r,a.effect),this.#n.delete(r),a.fragment.lastChild.remove(),this.anchor.before(a.fragment),n=a.effect)}for(const[s,i]of this.#e){if(this.#e.delete(s),s===t)break;const l=this.#n.get(i);l&&(Me(l.effect),this.#n.delete(i))}for(const[s,i]of this.#t){if(s===r||this.#r.has(s))continue;const l=()=>{if(Array.from(this.#e.values()).includes(s)){var o=document.createDocumentFragment();ys(i,o),o.append(kt()),this.#n.set(s,{effect:i,fragment:o})}else Me(i);this.#r.delete(s),this.#t.delete(s)};this.#l||!n?(this.#r.add(s),er(i,l,!1)):l()}}};#a=t=>{this.#e.delete(t);const r=Array.from(this.#e.values());for(const[n,a]of this.#n)r.includes(n)||(Me(a.effect),this.#n.delete(n))};ensure(t,r){var n=z,a=ds();if(r&&!this.#t.has(t)&&!this.#n.has(t))if(a){var s=document.createDocumentFragment(),i=kt();s.append(i),this.#n.set(t,{effect:Xe(()=>r(i)),fragment:s})}else this.#t.set(t,Xe(()=>r(this.anchor)));if(this.#e.set(n,t),a){for(const[l,c]of this.#t)l===t?n.skipped_effects.delete(c):n.skipped_effects.add(c);for(const[l,c]of this.#n)l===t?n.skipped_effects.delete(c.effect):n.skipped_effects.add(c.effect);n.oncommit(this.#s),n.ondiscard(this.#a)}else this.#s()}}function ll(e){ie===null&&ui(),Fr&&ie.l!==null?cl(ie).m.push(e):Vn(()=>{const t=kr(e);if(typeof t=="function")return t})}function cl(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}function P(e,t,r=!1){var n=new il(e),a=r?gr:0;function s(i,l){n.ensure(i,l)}Zn(()=>{var i=!1;t((l,c=!0)=>{i=!0,s(c,l)}),i||s(!1,null)},a)}function Ft(e,t){return t}function dl(e,t,r){for(var n=[],a=t.length,s,i=t.length,l=0;l<a;l++){let f=t[l];er(f,()=>{if(s){if(s.pending.delete(f),s.done.add(f),s.pending.size===0){var p=e.outrogroups;ta(mn(s.done)),p.delete(s),p.size===0&&(e.outrogroups=null)}}else i-=1},!1)}if(i===0){var c=n.length===0&&r!==null;if(c){var o=r,u=o.parentNode;Fi(u),u.append(o),e.items.clear()}ta(t,!c)}else s={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(s)}function ta(e,t=!0){for(var r=0;r<e.length;r++)Me(e[r],t)}var Ns;function $t(e,t,r,n,a,s=null){var i=e,l=new Map,c=(t&Fa)!==0;if(c){var o=e;i=o.appendChild(kt())}var u=null,f=St(()=>{var T=r();return Dn(T)?T:T==null?[]:mn(T)}),p,v=!0;function x(){b.fallback=u,ul(b,p,i,t,n),u!==null&&(p.length===0?(u.f&xt)===0?Qn(u):(u.f^=xt,Qr(u,null,i)):er(u,()=>{u=null}))}var E=Zn(()=>{p=d(f);for(var T=p.length,I=new Set,F=z,H=ds(),Z=0;Z<T;Z+=1){var j=p[Z],Y=n(j,Z),te=v?null:l.get(Y);te?(te.v&&Qt(te.v,j),te.i&&Qt(te.i,Z),H&&F.skipped_effects.delete(te.e)):(te=fl(l,v?i:Ns??=kt(),j,Y,Z,a,t,r),v||(te.e.f|=xt),l.set(Y,te)),I.add(Y)}if(T===0&&s&&!u&&(v?u=Xe(()=>s(i)):(u=Xe(()=>s(Ns??=kt())),u.f|=xt)),!v)if(H){for(const[ke,_e]of l)I.has(ke)||F.skipped_effects.add(_e.e);F.oncommit(x),F.ondiscard(()=>{})}else x();d(f)}),b={effect:E,items:l,outrogroups:null,fallback:u};v=!1}function ul(e,t,r,n,a){var s=(n&ei)!==0,i=t.length,l=e.items,c=e.effect.first,o,u=null,f,p=[],v=[],x,E,b,T;if(s)for(T=0;T<i;T+=1)x=t[T],E=a(x,T),b=l.get(E).e,(b.f&xt)===0&&(b.nodes?.a?.measure(),(f??=new Set).add(b));for(T=0;T<i;T+=1){if(x=t[T],E=a(x,T),b=l.get(E).e,e.outrogroups!==null)for(const _e of e.outrogroups)_e.pending.delete(b),_e.done.delete(b);if((b.f&xt)!==0)if(b.f^=xt,b===c)Qr(b,null,r);else{var I=u?u.next:c;b===e.effect.last&&(e.effect.last=b.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),qt(e,u,b),qt(e,b,I),Qr(b,I,r),u=b,p=[],v=[],c=u.next;continue}if((b.f&qe)!==0&&(Qn(b),s&&(b.nodes?.a?.unfix(),(f??=new Set).delete(b))),b!==c){if(o!==void 0&&o.has(b)){if(p.length<v.length){var F=v[0],H;u=F.prev;var Z=p[0],j=p[p.length-1];for(H=0;H<p.length;H+=1)Qr(p[H],F,r);for(H=0;H<v.length;H+=1)o.delete(v[H]);qt(e,Z.prev,j.next),qt(e,u,Z),qt(e,j,F),c=F,u=j,T-=1,p=[],v=[]}else o.delete(b),Qr(b,c,r),qt(e,b.prev,b.next),qt(e,b,u===null?e.effect.first:u.next),qt(e,u,b),u=b;continue}for(p=[],v=[];c!==null&&c!==b;)(o??=new Set).add(c),v.push(c),c=c.next;if(c===null)continue}(b.f&xt)===0&&p.push(b),u=b,c=b.next}if(e.outrogroups!==null){for(const _e of e.outrogroups)_e.pending.size===0&&(ta(mn(_e.done)),e.outrogroups?.delete(_e));e.outrogroups.size===0&&(e.outrogroups=null)}if(c!==null||o!==void 0){var Y=[];if(o!==void 0)for(b of o)(b.f&qe)===0&&Y.push(b);for(;c!==null;)(c.f&qe)===0&&c!==e.fallback&&Y.push(c),c=c.next;var te=Y.length;if(te>0){var ke=(n&Fa)!==0&&i===0?r:null;if(s){for(T=0;T<te;T+=1)Y[T].nodes?.a?.measure();for(T=0;T<te;T+=1)Y[T].nodes?.a?.fix()}dl(e,Y,ke)}}s&&zr(()=>{if(f!==void 0)for(b of f)b.nodes?.a?.apply()})}function fl(e,t,r,n,a,s,i,l){var c=(i&Zo)!==0?(i&ti)===0?G(r,!1,!1):Zt(r):null,o=(i&Qo)!==0?Zt(a):null;return{v:c,i:o,e:Xe(()=>(s(t,c??r,o??a,l),()=>{e.delete(n)}))}}function Qr(e,t,r){if(e.nodes)for(var n=e.nodes.start,a=e.nodes.end,s=t&&(t.f&xt)===0?t.nodes.start:r;n!==null;){var i=jr(n);if(s.before(n),n===a)return;n=i}}function qt(e,t,r){t===null?e.effect.first=r:t.next=r,r===null?e.effect.last=t:r.prev=t}function Ms(e,t,r=!1,n=!1,a=!1){var s=e,i="";R(()=>{var l=U;if(i!==(i=t()??"")&&(l.nodes!==null&&(vs(l.nodes.start,l.nodes.end),l.nodes=null),i!=="")){var c=i+"";r?c=`<svg>${c}</svg>`:n&&(c=`<math>${c}</math>`);var o=Os(c);if((r||n)&&(o=Dt(o)),Zr(Dt(o),o.lastChild),r||n)for(;Dt(o);)s.before(Dt(o));else s.before(o)}})}function pl(e,t,r){var n=e==null?"":""+e;return n===""?null:n}function hl(e,t){return e==null?null:String(e)}function Qe(e,t,r,n,a,s){var i=e.__className;if(i!==r||i===void 0){var l=pl(r);l==null?e.removeAttribute("class"):e.className=l,e.__className=r}return s}function en(e,t,r,n){var a=e.__style;if(a!==t){var s=hl(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return n}function Is(e,t,r=!1){if(e.multiple){if(t==null)return;if(!Dn(t))return xi();for(var n of e.options)n.selected=t.includes(tn(n));return}for(n of e.options){var a=tn(n);if(Bi(a,t)){n.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function ml(e){var t=new MutationObserver(()=>{Is(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Wn(()=>{t.disconnect()})}function vl(e,t,r=t){var n=new WeakSet,a=!0;Jn(e,"change",s=>{var i=s?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(i),tn);else{var c=e.querySelector(i)??e.querySelector("option:not([disabled])");l=c&&tn(c)}r(l),z!==null&&n.add(z)}),Yi(()=>{var s=t();if(e===document.activeElement){var i=Hr??z;if(n.has(i))return}if(Is(e,s,a),a&&s===void 0){var l=e.querySelector(":checked");l!==null&&(s=tn(l),r(s))}e.__value=s,a=!1}),ml(e)}function tn(e){return"__value"in e?e.__value:e.value}const gl=Symbol("is custom element"),_l=Symbol("is html");function nr(e,t){var r=Ls(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function bl(e,t,r,n){var a=Ls(e);a[t]!==(a[t]=r)&&(r==null?e.removeAttribute(t):typeof r!="string"&&yl(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function Ls(e){return e.__attributes??={[gl]:e.nodeName.includes("-"),[_l]:e.namespaceURI===ai}}var Bs=new Map;function yl(e){var t=e.getAttribute("is")||e.nodeName,r=Bs.get(t);if(r)return r;Bs.set(t,r=[]);for(var n,a=e,s=Element.prototype;s!==a;){n=$a(a);for(var i in n)n[i].set&&r.push(i);a=Fn(a)}return r}function Er(e,t,r=t){var n=new WeakSet;Jn(e,"input",async a=>{var s=a?e.defaultValue:e.value;if(s=ra(e)?na(s):s,r(s),z!==null&&n.add(z),await Xi(),s!==(s=t())){var i=e.selectionStart,l=e.selectionEnd,c=e.value.length;if(e.value=s??"",l!==null){var o=e.value.length;i===l&&l===c&&o>c?(e.selectionStart=o,e.selectionEnd=o):(e.selectionStart=i,e.selectionEnd=Math.min(l,o))}}}),kr(t)==null&&e.value&&(r(ra(e)?na(e.value):e.value),z!==null&&n.add(z)),Xn(()=>{var a=t();if(e===document.activeElement){var s=Hr??z;if(n.has(s))return}ra(e)&&a===na(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function ar(e,t,r=t){Jn(e,"change",n=>{var a=n?e.defaultChecked:e.checked;r(a)}),kr(t)==null&&r(e.checked),Xn(()=>{var n=t();e.checked=!!n})}function ra(e){var t=e.type;return t==="number"||t==="range"}function na(e){return e===""?null:+e}function xl(e=!1){const t=ie,r=t.l.u;if(!r)return;let n=()=>Qi(t.s);if(e){let a=0,s={};const i=Gn(()=>{let l=!1;const c=t.s;for(const o in c)c[o]!==s[o]&&(s[o]=c[o],l=!0);return l&&a++,a});n=()=>d(i)}r.b.length&&zi(()=>{Ds(t,n),$n(r.b)}),Vn(()=>{const a=kr(()=>r.m.map(ci));return()=>{for(const s of a)typeof s=="function"&&s()}}),r.a.length&&Vn(()=>{Ds(t,n),$n(r.a)})}function Ds(e,t){if(e.l.s)for(const r of e.l.s)d(r);t()}function et(e,t=document){return Array.from(t.querySelectorAll(e))}function ee(e){const t=e;return String(t&&(t.innerText||t.textContent)||"").trim()}const wl=["Select 5 players","Press two player","Press two players","to swap"],Fs=/(\d+(?:\.\d+)?)x\b/gi,Sl=/^\+(\d+(?:\.\d+)?)x\b/i,kl=200,$s=["NFL","NHL","NBA","MLB","CFB","CBB","FC","WNBA"],qs="rsdh_accent_rgb",aa="rsdh_openrouter_api_key",sa="rsdh_openrouter_model",oa="rsdh_openrouter_temp",ia="rsdh_openrouter_max_tokens",la="rsdh_openrouter_web_max_results",kn="rsdh_openrouter_structured_json",An="rsdh_openrouter_response_healing",sr="google/gemini-2.5-flash",En=.2,Tn=1e3,rn=2,Al=!0,El=!0,Tl="https://openrouter.ai/api/v1/chat/completions",zs="https://rsdh-proxy.cloudflare-okay454.workers.dev",Cl="H8UIBeO5C9BJ8Ze8WUXb+Y+x4wuNp2K+Lz+HwVdanBk=",Cn=!!zs,Hs="rsdh_last_payload",ca="rsdh_last_ai_sources",Pl="rsdh_last_ai_json",Ys="rsdh_last_tool_trace",Pn="rsdh_last_debug_events",Rl="rsdh_last_messages",nn="rsdh_force_tool_call",an="rsdh_force_search_tool",or="rsdh_bypass_proxy",sn="rsdh_enable_profile_tool",da="rsdh_enable_web_search",on="rsdh_enable_search_tool",ua="rsdh_lineup_strategy";function N(e,t){try{if(typeof GM_getValue=="function")return GM_getValue(e,t)}catch{}try{const r=localStorage.getItem(e);return r??t}catch{return t}}function Le(e,t){try{if(typeof GM_setValue=="function"){GM_setValue(e,t);return}}catch{}try{localStorage.setItem(e,String(t))}catch{}}function ir(){try{return localStorage.getItem("rsdh_debug_mode")==="1"}catch{return!1}}function Ol(e){try{localStorage.setItem("rsdh_debug_mode",e?"1":"0")}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-debug-mode",{detail:{on:e}}))}catch{}}function Tr(e){const r=String(e||"").match(/rgba?\(\s*(\d+)[,\s]+(\d+)[,\s]+(\d+)/i);return r?{r:parseInt(r[1],10),g:parseInt(r[2],10),b:parseInt(r[3],10)}:null}function Nl(e){return(.2126*e.r+.7152*e.g+.0722*e.b)/255}function fa(e,t){const r=e.r-t.r,n=e.g-t.g,a=e.b-t.b;return Math.sqrt(r*r+n*n+a*a)}function Ml(e){const t=Math.max(e.r,e.g,e.b),r=Math.min(e.r,e.g,e.b);return(t-r)/255}function Us(e){const t=String(e||"").toLowerCase();return t==="transparent"||t.includes("rgba(")&&t.endsWith(", 0)")||t.includes(",0)")}function Il(){const e=Math.max(240,window.innerHeight*.6),t=et("div,nav,aside").map(r=>{try{const n=r.getBoundingClientRect();return n.width<40||n.width>95||n.height<e||n.left>40||n.top>80?null:{el:r,area:n.width*n.height}}catch{return null}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function Ll(){function e(){try{const i=localStorage.getItem(qs);if(!i)return null;const l=JSON.parse(i);return!l||typeof l.r!="number"||typeof l.g!="number"||typeof l.b!="number"?null:{r:l.r,g:l.g,b:l.b}}catch{return null}}function t(i){try{localStorage.setItem(qs,JSON.stringify(i))}catch{}}const r=Il()||document,n=r===document?null:(()=>{try{const i=r.getBoundingClientRect();return{top:i.top,height:i.height}}catch{return null}})(),a=et("div,button,a,span",r).map(i=>{try{const l=i.getBoundingClientRect();if(l.width<16||l.width>80||l.height<16||l.height>80||l.width/l.height<.7||l.width/l.height>1.3)return null;const c=getComputedStyle(i),o=parseFloat(c.borderWidth||"0"),u=parseFloat(c.outlineWidth||"0");if((Number.isNaN(o)||o<=0)&&(Number.isNaN(u)||u<=0))return null;const f=Tr(c.borderColor)||Tr(c.outlineColor);if(!f)return null;const p=Ml(f);if(p<.1)return null;let v=1;n&&(v=(l.top-n.top)/Math.max(1,n.height)>.4?1.4:.8);const x=Math.min(l.width,l.height)>=20?1.1:1,E=(p*3+(o>=2?.2:0))*v*x;return{rgb:f,score:E}}catch{return null}}).filter(Boolean);if(a.length===0){const i=e();return i?{rgb:i,source:"cache",scope:r===document?"document":"sidebar"}:null}a.sort((i,l)=>l.score-i.score);const s=a[0];return t(s.rgb),{rgb:s.rgb,source:"borderColor",scope:r===document?"document":"sidebar"}}function Gs(){const t=et("div,nav,header").filter(o=>{const u=ee(o);return u?$s.filter(p=>u.includes(p)).length>=4:!1})[0]||null;if(!t)return{sport:null,method:"not_found"};const r=$s.filter(o=>ee(t).includes(o)),n=et("a,button,[role='tab'],[role='button'],div,span",t).map(o=>({el:o,t:ee(o)})).filter(o=>r.includes(o.t));function a(o){const u=o.getAttribute("aria-selected"),f=o.getAttribute("aria-current");if(u==="true"||f&&f!=="false"||o.getAttribute("data-active")==="true"||o.getAttribute("data-state")==="active")return!0;const p=(o.className||"").toString().toLowerCase();return!!(p.includes("active")||p.includes("selected")||p.includes("current"))}const s=n.find(o=>a(o.el));if(s)return{sport:String(s.t),method:"navbar_active_attr"};const i=Ll();if(i?.rgb&&n.length>0){const o=n.map(u=>{let f=1/0;try{const p=getComputedStyle(u.el),v=Tr(p.color),x=Tr(p.borderBottomColor),E=Tr(p.borderColor);v&&(f=Math.min(f,fa(i.rgb,v))),x&&!Us(p.borderBottomColor)&&(f=Math.min(f,fa(i.rgb,x))),E&&!Us(p.borderColor)&&(f=Math.min(f,fa(i.rgb,E)))}catch{}return{sport:String(u.t),dist:f}}).sort((u,f)=>u.dist-f.dist);if(o.length>0&&o[0].dist<60)return{sport:o[0].sport,method:"navbar_theme_accent",accent:i}}if(n.length>0){const o=n.map(u=>{let f=0;try{const p=getComputedStyle(u.el),v=parseInt(p.fontWeight,10);!Number.isNaN(v)&&v>=600&&(f+=2);const x=parseFloat(p.opacity);!Number.isNaN(x)&&x>=.95&&(f+=1),(p.textDecorationLine||"").includes("underline")&&(f+=2);const E=parseFloat(p.borderBottomWidth);!Number.isNaN(E)&&E>0&&(p.borderBottomStyle||"")!=="none"&&(f+=2);const b=Tr(p.color);b&&(f+=Nl(b))}catch{}return{sport:String(u.t),score:f}}).sort((u,f)=>f.score-u.score);if(o.length===1)return{sport:o[0].sport,method:"navbar_style_single"};if(o.length>=2&&o[0].score-o[1].score>=1)return{sport:o[0].sport,method:"navbar_style_score"}}const l=location.href.toUpperCase(),c=r.find(o=>l.includes("/"+o+"/")||l.endsWith("/"+o)||l.includes("SPORT="+o));return c?{sport:String(c),method:"url_hint"}:{sport:null,method:"navbar_no_active"}}function Bl(){const e=[],t=et('div[tabindex="0"]').filter(r=>{const n=(r.textContent||"").trim();if(!n||/\+\d+\.?\d*x/i.test(n))return!1;const a=/\d{1,2}:\d{2}\s*(AM|PM)/i.test(n),s=/\bFinal\b/i.test(n);return a||s});for(const r of t)try{const n=Array.from(r.querySelectorAll('div[dir="auto"]')),a=ee(r),s=/\bFinal\b/i.test(a),i=/\d{1,2}:\d{2}\s*(AM|PM)/i.test(a);let l="",c="",o=null,u=null,f=null,p=null;const v=/^\d{1,2}-\d{1,2}(-\d{1,2})?$/,x=/^\d{1,2}$/,E=/^(\d{1,2}|:|AM|PM|\d{2}\s*(AM|PM)|Final)$/i,b=[],T=[],I=[],F=[];for(const Z of n){const j=(Z.textContent||"").trim();j&&(v.test(j)?F.push(j):x.test(j)&&s?T.push(j):E.test(j)?b.push(j):j.length>2&&j.length<25&&!j.includes("%")&&/^[A-Za-z\s]+$/.test(j)&&I.push(j))}I.length>=2?(l=I[0],c=I[1]):I.length===1&&(l=I[0]),s&&T.length>=2?f=`${T[0]}-${T[1]}`:F.length>=2?(o=F[0],u=F[1]):F.length===1&&(o=F[0]),b.length>0&&!s&&(p=b.join("").replace(/\s+/g," ").trim(),p||(p=b.filter(Z=>Z!==":").join(":").replace("::",":")),p=p.replace(/\d+$/,"").trim());let H="upcoming";s?H="finished":p&&(H="upcoming"),l&&c&&e.push({team1:l,team1_record:o,team2:c,team2_record:u,time:p,status:H,score:f})}catch{}return e}function Dl(){const e=/^(\d+)\s+(NFL|NHL|NBA|MLB|CFB|CBB|FC|WNBA)\s+entr(?:y|ies)\s+remaining\s+today$/i,t=et("div");for(const r of t){const a=(r.textContent||"").trim().match(e);if(a)return{isGameDraft:!0,entriesRemaining:parseInt(a[1],10),sport:a[2].toUpperCase()}}return{isGameDraft:!1,entriesRemaining:null,sport:null}}function Fl(){const e=new Set(["games","game","nfl","nba","nhl","mlb","cfb","cbb","wnba","fc","ufc","golf","final","live","upcoming","finished","draft","update","submit","cancel","close","settings","home","profile","menu","pm","am"]),t=et("div").filter(T=>{const I=T.getAttribute("style")||"",F=I.includes("background-color: rgb(0, 0, 0)")||I.includes("background-color:rgb(0,0,0)"),H=I.includes("border-bottom")||I.includes("border-color");if(!F||!H||Array.from(T.querySelectorAll('div[tabindex="0"]')).filter(Y=>{const te=Y.querySelectorAll("img");return Array.from(te).some(ke=>(ke.getAttribute("src")||"").includes("media.realapp.com/assets/teams"))}).length!==2)return!1;const j=(T.textContent||"").trim();return!/\+\d+\.?\d*x/i.test(j)});if(t.length===0)return null;const r=t[0],n=Array.from(r.querySelectorAll('div[tabindex="0"]')).filter(T=>{const I=T.querySelectorAll("img");return Array.from(I).some(F=>(F.getAttribute("src")||"").includes("media.realapp.com/assets/teams"))}).slice(0,2),a=/^\d{1,2}-\d{1,2}(-\d{1,2})?$/,s=/^\d{1,3}$/;function i(T){const I=Array.from(T.querySelectorAll('div[dir="auto"]'));let F="",H=null,Z=null;for(const j of I){const Y=(j.textContent||"").trim();if(!Y)continue;const te=Y.toLowerCase();e.has(te)||(a.test(Y)?H=Y:s.test(Y)?Z=parseInt(Y,10):Y.length>=3&&Y.length<=25&&/^[A-Za-z]+$/.test(Y)&&(F=Y))}return{name:F,record:H,score:Z}}const l=n.length>=1?i(n[0]):{name:"",record:null,score:null},c=n.length>=2?i(n[1]):{name:"",record:null,score:null};if(!l.name&&!c.name)return null;let o=null,u=null,f=!1;const v=(r.textContent||"").match(/\d{1,2}:\d{2}\s*(AM|PM)/i);v&&(o=v[0]);const x=new Set(n.flatMap(T=>Array.from(T.querySelectorAll('div[dir="auto"]')))),E=Array.from(r.querySelectorAll('div[dir="auto"]'));for(const T of E){if(x.has(T))continue;const I=(T.textContent||"").trim();I.toLowerCase()==="final"?f=!0:/^[A-Z]{2,4}\s+by\s+\d+(\.\d+)?$/i.test(I)&&(u=I)}let b="upcoming";return f||l.score!==null&&c.score!==null?b="finished":o&&(b="upcoming"),{team1:l.name,team1_record:l.record,team1_score:l.score,team2:c.name,team2_record:c.record,team2_score:c.score,time:o,spread:u,status:b}}function lr(){const e=document.querySelector("#rsdh-modal-actions");if(e){let r=e;for(let n=0;n<18&&r;n++){if((ee(r).match(/\d+(?:\.\d+)?x\b/gi)||[]).length>=3)return r;r=r.parentElement}return e.parentElement}const t=et('div[tabindex="0"]');for(const r of t){const n=ee(r);if(!n)continue;const a=/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n),s=(n.match(/\d+(?:\.\d+)?x\b/gi)||[]).length;if(a&&s>=3)return r}for(const r of t){const n=ee(r);if(n&&/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n))return r}return null}function $l(e,t=[]){let r=-1;for(const n of t){const a=e.indexOf(n);a!==-1&&(r===-1||a<r)&&(r=a)}return r===-1?e:e.slice(0,r)}function ql(e,t=[]){let r=-1;for(const a of t){const s=e.indexOf(a);s!==-1&&(r===-1||s<r)&&(r=s)}if(r===-1)return"";const n=e.indexOf(`
`,r);return n===-1?"":e.slice(n+1)}function js(e,t=[],r=null){e=$l(e,t);const n=[];Fs.lastIndex=0;let a;for(;(a=Fs.exec(e))!==null;)a.index>0&&e[a.index-1]==="+"||n.push({idx:a.index,end:a.index+a[0].length,mult:parseFloat(a[1])});const s=[];for(let i=0;i<n.length&&!(typeof r=="number"&&s.length>=r);i++){const l=n[i],c=n[i+1];let o=e.slice(l.end,c?c.idx:e.length).trim();for(const p of t){const v=o.indexOf(p);v!==-1&&(o=o.slice(0,v).trim())}o=o.split(`
`)[0].trim(),o.length>80&&(o=o.slice(0,80).trim());let u=o||null,f=!1;u&&u.toLowerCase()==="empty"&&(u=null,f=!0),s.push({multiplier:l.mult,selection:u,is_empty:f})}return s}function zl(e){const t=ql(e,["Press two player","Press two players"]);if(!t)return[];const r=t.split(`
`).map(i=>(i||"").trim()).filter(Boolean),n=[];let a=null;function s(){a&&(a.name&&!/%$/.test(a.name.trim())&&n.push(a),a=null)}for(const i of r){if(/^(submit|update|cancel|close|done)$/i.test(i)){s();break}if(/^(draft lineup)$/i.test(i)||/^\d+%$/.test(i))continue;const l=i.match(Sl);if(l){const f=parseFloat(l[1]);a?a.boost_x=f:n.length>0&&n[n.length-1].boost_x==null&&(n[n.length-1].boost_x=f),a&&s();continue}const c=i.split("").map(f=>f.trim()).filter(Boolean),o=c[0]||i,u=c.length>1?c.slice(1).join("  "):null;a&&s(),a={name:o,status:u,boost_x:null}}return s(),n}function Ks(e){const t=/\+(\d+(?:\.\d+)?)x\b/i,r=et("div[tabindex='0'],div[tabindex='-1'],[role='button'],button,a",e).filter(s=>{const i=ee(s);if(!i)return!1;const l=s.getBoundingClientRect();return l.width>120&&l.height>=28?t.test(i)?!0:!(s.querySelector("img")!==null)||i.includes("Submit")||i.includes("Update")||i.includes("Draft")?!1:/[a-zA-Z]{2,}/.test(i)&&i.length<100:!1}).slice(0,400),n=new Set,a=[];for(const s of r){const i=ee(s),l=i.match(t);let c=null;l&&(c=parseFloat(l[1]),Number.isFinite(c)||(c=null));const u=(l?i.slice(0,i.toLowerCase().lastIndexOf(l[0].toLowerCase())).trim():i.trim()).split("").map(T=>T.trim()).filter(Boolean),f=u[0]||"";if(!f)continue;const p=u.length>1?u.slice(1).join("  "):null,v=f.toLowerCase();if(n.has(v))continue;let x=null;const E=s.querySelector("a[href]")||s.parentElement?.querySelector("a[href]")||s.closest("a[href]");if(E?.getAttribute("href")&&(x=E.getAttribute("href")),!x){const T=s.querySelector("svg")||s.parentElement?.querySelector("svg"),I=T?T.closest("a[href]"):null;I?.getAttribute("href")&&(x=I.getAttribute("href"))}const b=x?new URL(x,location.href).toString():null;a.push({name:f,status:p,boost_x:c,profile_url:b}),n.add(v)}return a}function Hl(){const e=et("div,button").filter(n=>{const a=ee(n);return a.includes("Draft")&&/\bUpdate\b/i.test(a)&&/\bx\b/i.test(a)}),t=new Set,r=[];for(const n of e){const a=ee(n);!a||t.has(a)||(t.add(a),r.push(n))}return r.slice(0,10)}function Yl(){function e(n){try{n.scrollIntoView({block:"center",inline:"center"})}catch{}try{n.focus()}catch{}let a=0,s=0;try{const i=n.getBoundingClientRect();a=Math.max(1,Math.floor(i.left+i.width/2)),s=Math.max(1,Math.floor(i.top+i.height/2))}catch{}try{const i=window.PointerEvent;typeof i=="function"&&(n.dispatchEvent(new i("pointerdown",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:a,clientY:s})),n.dispatchEvent(new i("pointerup",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:a,clientY:s})))}catch{}try{n.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:a,clientY:s}))}catch{}try{n.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:a,clientY:s}))}catch{}try{n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:a,clientY:s}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.click()}catch{}}const t=document.querySelector("#realrootcontents")||document,r=et("div[tabindex='0'],button,[role='button'],a,span",t).map(n=>{const a=ee(n);if(!a||!/^(draft|update)$/i.test(a.trim()))return null;const s=n.getBoundingClientRect();if(!(s.width>=60&&s.width<=500&&s.height>=20&&s.height<=80))return null;const i=s.top>=0&&s.top<=window.innerHeight?1.5:1,l=s.width*i;return{el:n,score:l,text:a.trim()}}).filter(Boolean);return r.length===0?!1:(r.sort((n,a)=>a.score-n.score),e(r[0].el),!0)}async function Ul(e){const t=e.timeoutMs,r=Date.now();function n(){return document.querySelector("#rsdh-modal-actions")?!0:!!lr()}function a(){const l=document.querySelector("#realrootcontents")||document,c=et("div[tabindex='0'],button,[role='button'],a,span",l).map(o=>{const u=ee(o);if(!u||!/^(draft|update)$/i.test(u.trim()))return null;const f=o.getBoundingClientRect();return f.width>=60&&f.width<=500&&f.height>=20&&f.height<=80?{el:o,width:f.width}:null}).filter(Boolean);return c.length===0?null:(c.sort((o,u)=>u.width-o.width),c[0].el)}function s(l){try{const c=l.getBoundingClientRect(),o=Math.floor(c.left+c.width/2),u=Math.floor(c.top+c.height/2),f=document.elementFromPoint(o,u);return f===l||!!f&&l.contains(f)}catch{return!0}}for(;Date.now()-r<t;){if(n())return{clicked:!1,opened:!0};const l=a();if(l&&s(l))break;await new Promise(c=>setTimeout(c,200))}let i=!1;for(let l=0;l<3&&Date.now()-r<t;l++){if(n())return{clicked:i,opened:!0};const c=a();if(!c){await new Promise(u=>setTimeout(u,250));continue}try{i=Yl()||i}catch{}if(!n()){const u=c.parentElement;if(u){try{u.scrollIntoView({block:"center"})}catch{}try{u.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0}))}catch{}}}if(await new Promise(u=>{const f=Date.now()+2200,p=()=>{if(n())return u(!0);if(Date.now()>f)return u(!1);setTimeout(p,100)};p()}))return{clicked:i,opened:!0};await new Promise(u=>setTimeout(u,350))}return{clicked:i,opened:n()}}function Gl(e){const t=ee(e),r=["Update",...wl],n=js(t,r);return{text:t.slice(0,500),slots:n}}function jl(e={}){const t=typeof e.includeDebug=="boolean"?e.includeDebug:ir(),r=Gs(),n=lr();if(!n){const E=Hl().map(Gl).filter(b=>b.slots.length>0);return E.length===0?{ok:!1,error:"Draft modal not found. Click the site's Draft/Update button to open the Draft Lineup modal, then click Capture again.",url:location.href,sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{}}:{ok:!0,mode:"tile",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{},drafts:E}}const a=ee(n),s=a.match(/Select\s+(\d+)\s+players/i),i=s?parseInt(s[1],10):null,c=js(a,["Press two player","Press two players"],i),o=Ks(n),u=o.length>0?o:zl(a),f=Dl(),p=f.isGameDraft?"game":"league";let v=[],x;return f.isGameDraft?x=Fl()??void 0:v=Bl(),{ok:!0,mode:"modal",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,draft_type:p,...f.isGameDraft?{game_entries_remaining:f.entriesRemaining}:{},...x?{game_matchup:x}:{},...t?{sport_detection:r}:{},...t?{modal_text_sample:a.slice(0,400)}:{},expected_slots:i,slots:c,player_pool_count:u.length,player_pool:u,...v.length>0?{games:v}:{}}}function Js(e){let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]);const r=(t||[]).map((v,x)=>{const E=v.selection?`selected="${v.selection}"`:"selected=<empty>";return`- slot ${x+1}: multiplier=${v.multiplier}x, ${E}`}).join(`
`),n=Array.isArray(e?.player_pool)?e.player_pool:[],a=n.slice(0,kl),s=a.map(v=>{const x=v.status?` (${v.status})`:"",E=typeof v.boost_x=="number"?` +${v.boost_x}x`:"";return`- ${v.name}${x}${E}`}).join(`
`),i=n.length>a.length?`NOTE: player pool truncated to first ${a.length} of ${n.length} for prompt size. For the full list, re-capture and inspect the payload in Debug Mode.`:`Player pool items: ${n.length}.`,l=typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:Array.isArray(t)?t.length:5,c=e?.draft_type||"league",o=e?.game_matchup,u=Array.isArray(e?.games)?e.games:[];let f=[];if(c==="game"&&o){const v=o.team1+(o.team1_record?` (${o.team1_record})`:""),x=o.team2+(o.team2_record?` (${o.team2_record})`:"");let E="";o.status==="finished"&&o.team1_score!==null&&o.team2_score!==null?E=`Final: ${o.team1} ${o.team1_score} - ${o.team2} ${o.team2_score}`:o.time?E=`Game time: ${o.time}`:o.status==="live"&&(E="Game in progress"),f=["### Game Draft (Single Matchup)","This is a GAME DRAFT for a specific matchup, not a league-wide draft.",`Matchup: ${v} vs ${x}`,...E?[E]:[],...o.spread?[`Spread: ${o.spread}`]:[],...typeof e?.game_entries_remaining=="number"?[`Entries remaining today: ${e.game_entries_remaining}`]:[],"All players in the pool are from these two teams ONLY.",""]}else u.length>0&&(f=["### Today's Games","The following games are scheduled. Players from these teams will be playing:",u.map(x=>{let E="";return x.status==="finished"&&x.score?E=` (Final: ${x.score})`:x.time?E=` @ ${x.time}`:x.status==="finished"&&(E=" (Final)"),`- ${x.team1} vs ${x.team2}${E}`}).join(`
`),""]);return{context:["You are helping build an optimal Draft Lineup.","","### Context (captured from realsports.io UI)",`URL: ${e?.url||"<unknown>"}`,`Captured At: ${e?.captured_at||"<unknown>"}`,`Capture Mode: ${e?.mode||"<unknown>"}`,`Sport: ${e?.sport||"<unknown>"}`,`Draft Type: ${c==="game"?"Game (single matchup)":"League (all games)"}`,"",...f,"### Rules / how scoring multipliers work",`- You must select EXACTLY ${l} unique players.`,"- Each lineup slot has a slot multiplier (e.g. 2.0x, 1.8x, 1.6x...).","- Each player also has a boost shown as +Bx (e.g. +0.9x).","- ASSUME boosts are additive with the slot multiplier:","  effective_multiplier = slot_multiplier + player_boost_x","  example: slot 2.0x + player +0.9x => effective 2.9x","- Goal: assign the best combination of players to slots to maximize expected Real score.","","### Betting payouts (Rax)","- Entry fee is ALWAYS 100 Rax for any bet tier.","- If lineup finishes Top 50%: payout 170 Rax (profit +70).","- If lineup finishes Top 20%: payout 350 Rax (profit +250).","- If lineup finishes Top 10%: payout 700 Rax (profit +600).","","Slots (higher multiplier = bigger boost):",r||"- <no slots found>","","Available player pool (with their +boost values shown in the UI):",s||"- <no pool detected>",i,"","### Task","Choose exactly the required number of players from the pool and assign them to slots.","Important: All players in the pool are from teams playing today. Focus on their status (Active/Questionable/Out) rather than checking team schedules.","Prefer players who are Active. Be cautious with Questionable players. Never pick Out/Inactive players.","Explain briefly why each player goes into each slot.","Also provide bet recommendations for: Top 50%, Top 20%, Top 10.",""].join(`
`),expectedSlots:l}}function Ws(e){const{context:t,expectedSlots:r}=Js(e);return[t,"### Output format (human-readable)","Reply in plain English with these sections:","1) Lineup (final)",`- List exactly ${r} slots in order (slot 1..${r}), showing: player, slot multiplier, player boost, and effective multiplier.`,"2) Why this lineup","- 13 bullets summarizing the approach.","3) Slot-by-slot rationale","- Short note per slot explaining the assignment.","4) Bets","- Recommendations for Top 50%, Top 20%, Top 10 (recommend yes/no + confidence + one sentence reason).","","Do NOT include JSON. Keep it readable and actionable."].join(`
`)}function Vs(e,t){const{context:r}=Js(e),n=t?.webHint?"If web search is available, use it ONLY to verify time-sensitive info like injury status, starters, scratches, minutes restrictions, and recent news.":null,a=t?.toolHint?["","### Player Profile Lookup Tool","You have access to `get_player_profile_stats` - use it to fetch detailed stats for any player when:","- Boost values alone aren't enough to decide between players","- You need recent performance data (game logs, rankings, trends)","- A player's floor/ceiling matters for the decision","Call it with the player's name exactly as shown in the pool. The tool will scrape their profile and return stats.",""].join(`
`):"If you need player projections/stats beyond the boost values, DO NOT ask the user generic follow-up questions. Instead, request player profile stats using the tool for specific players you want to evaluate.",s=t?.searchHint?["","### Draft Player Search Tool","The initial player pool shows up to ~50 players, but more may be available.","You have access to `search_draft_players` - use it to search for specific players by name if they aren't in the current pool.","- Search by player name or partial name (e.g. 'McDavid', 'Ovi', 'Connor')","- Note: only searches by player name, NOT by position or team","- Useful when a player you're looking for isn't in the visible list",""].join(`
`):"";let i="";const l=t?.strategy||"balanced";return l==="safe"?i=["","### Lineup Strategy: SAFE","The user has requested a SAFE, consistent lineup. Prioritize:","- Players with high floor and consistent production","- Established stars with predictable output","- Lower variance, reliable performers","- Avoid boom-or-bust picks",""].join(`
`):l==="risky"&&(i=["","### Lineup Strategy: RISKY (High Upside)","The user wants a RISKY, high-ceiling lineup. Prioritize:","- Players with explosive potential who can outperform their boost","- Boom-or-bust picks with high upside","- Hot streaks, favorable matchups, breakout candidates","- Accept lower floor for higher ceiling",""].join(`
`)),[r,n?`
${n}
`:"",a,s,i,"Return data that matches the provided JSON schema exactly."].join(`
`).trim()}function Kl(){try{return localStorage.getItem(Hs)||""}catch{return""}}function Jl(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));return Ws(t)}function Wl(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));const r=N(sn,"1")!=="0",n=N(on,"1")!=="0";return Vs(t,{toolHint:r,searchHint:n})}const pa="rsdh_user_identity";function ha(){try{const e=localStorage.getItem(pa);if(!e)return null;const t=JSON.parse(e);return t?.username&&t?.displayName?t:null}catch{return null}}function Vl(e){localStorage.setItem(pa,JSON.stringify(e))}function Xl(){localStorage.removeItem(pa)}function Zl(){const e=window.location.href;return e==="https://realsports.io/"||e==="https://realsports.io"||e.startsWith("https://realsports.io/?")||e.startsWith("https://realsports.io/#")}function Ql(){const e=Array.from(document.querySelectorAll("img"));for(const t of e)if((t.getAttribute("src")||"").includes("media.realapp.com/assets/user/")){const n=t.closest('[tabindex="0"]');if(n)return n}return null}async function ec(){const e=Ql();return e?(e.click(),await new Promise(t=>setTimeout(t,500)),!0):!1}function tc(){if(!Zl())return null;const e=Array.from(document.querySelectorAll("div"));let t=null,r=null;for(const c of e){const o=c.textContent?.trim()||"";if(o.startsWith("@")&&o.length>1&&o.length<30&&!o.includes(" ")&&c.closest('[style*="padding-top"]')?.textContent?.includes("Karma")){t=c;break}}if(!t)return null;const n=t.parentElement;if(n){const c=n.parentElement?.parentElement;if(c){const o=Array.from(c.querySelectorAll("div"));for(const u of o){const f=u.textContent?.trim()||"";if(f&&!f.startsWith("@")&&!f.includes("@")&&f.length>1&&f.length<50&&u!==t&&!f.includes("Karma")&&!f.includes("Rax")&&u.childElementCount===0){r=u;break}}}}const a=t.textContent?.trim().replace(/^@/,"")||"",s=r?.textContent?.trim()||a;let i,l=t;for(let c=0;c<10&&l&&!i;c++)if(l=l.parentElement,l){const o=Array.from(l.querySelectorAll("img"));for(const u of o){const f=u.getAttribute("src")||"";if(f.includes("media.realapp.com/assets/user/")){i=f.replace(/\/(xsmall|small)\//,"/large/");break}}}return a?{username:a,displayName:s,avatarUrl:i,linkedAt:new Date().toISOString()}:null}function rc(e){return e?`rgb(${e.r}, ${e.g}, ${e.b})`:null}function nc(){try{const t=Gs()?.accent?.rgb;return rc(t||null)}catch{return null}}const Xs="rsdh-debug-highlight-",ac=999999;function Zs(e,t,r="rgba(4, 131, 215, 0.4)"){if(!e||!ir())return null;const n=Xs+Date.now(),a=e.getBoundingClientRect(),s=document.createElement("div");s.id=n,s.style.cssText=`
    position: fixed;
    top: ${a.top}px;
    left: ${a.left}px;
    width: ${a.width}px;
    height: ${a.height}px;
    background: ${r};
    border: 2px solid ${r.replace(/[\d.]+\)$/,"0.9)")};
    border-radius: 4px;
    z-index: ${ac};
    pointer-events: none;
    transition: opacity 0.3s ease;
  `;const i=document.createElement("div");return i.style.cssText=`
    position: absolute;
    bottom: 100%;
    left: 0;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    padding: 4px 8px;
    font-size: 12px;
    font-family: system-ui, sans-serif;
    border-radius: 4px;
    white-space: nowrap;
    margin-bottom: 4px;
  `,i.textContent=t,s.appendChild(i),document.body.appendChild(s),n}function Qs(e){if(e)try{document.getElementById(e)?.remove()}catch{}}function sc(){try{document.querySelectorAll(`[id^="${Xs}"]`).forEach(e=>e.remove())}catch{}}function Cr(e,t){const r=t?.timeoutMs??8e3,n=t?.intervalMs??100,a=Date.now();return new Promise(s=>{const i=()=>{if(e())return s(!0);if(Date.now()-a>r)return s(!1);setTimeout(i,n)};i()})}function oc(e){try{e.focus()}catch{}let t=0,r=0;try{const n=e.getBoundingClientRect();t=Math.max(1,Math.floor(n.left+n.width/2)),r=Math.max(1,Math.floor(n.top+n.height/2))}catch{}try{const n=window.PointerEvent;typeof n=="function"&&(e.dispatchEvent(new n("pointerdown",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})),e.dispatchEvent(new n("pointerup",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})))}catch{}try{e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.click()}catch{}}function ic(e,t=6e3){try{const r=JSON.stringify(e);return r?r.length<=t?e:{_truncated:!0,_len:r.length}:null}catch{return{_unserializable:!0}}}function lc(){try{const e=String(localStorage.getItem(Pn)||"");if(!e.trim())return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function cc(e){try{localStorage.setItem(Pn,JSON.stringify(e.slice(-250)))}catch{}}function M(e,t,r){if(!ir())return;const n={t:new Date().toISOString(),kind:e,scope:r?.scope,msg:String(t||""),data:ic(r?.data)},a=lc();a.push(n),cc(a);try{window.dispatchEvent(new CustomEvent("rsdh-debug-event",{detail:n})),window.dispatchEvent(new CustomEvent("rsdh-debug-events",{detail:{events:a.slice(-250)}}))}catch{}}let zt=null;function dc(){return zt&&document.body.contains(zt)||(zt=document.createElement("div"),zt.id="rsdh-toast-container",zt.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 2147483647;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: flex-start;
    pointer-events: none;
  `,document.body.appendChild(zt)),zt}function ma(e,t="info",r=3e3){const n=dc(),a=document.createElement("div");if(a.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
    font-size: 13px;
    font-weight: 600;
    padding: 12px 20px;
    border-radius: 10px;
    color: white;
    pointer-events: auto;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    animation: toastIn 0.25s ease;
    max-width: 320px;
    text-align: center;
    ${t==="success"?"background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); border: 1px solid rgba(34, 197, 94, 0.3);":t==="error"?"background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); border: 1px solid rgba(239, 68, 68, 0.3);":"background: linear-gradient(135deg, #2c6cff 0%, #1d4ed8 100%); border: 1px solid rgba(44, 108, 255, 0.3);"}
  `,a.textContent=e,!document.getElementById("rsdh-toast-styles")){const s=document.createElement("style");s.id="rsdh-toast-styles",s.textContent=`
      @keyframes toastIn {
        from { opacity: 0; transform: translateY(20px) scale(0.95); }
        to { opacity: 1; transform: translateY(0) scale(1); }
      }
      @keyframes toastOut {
        from { opacity: 1; transform: translateY(0) scale(1); }
        to { opacity: 0; transform: translateY(-10px) scale(0.95); }
      }
    `,document.head.appendChild(s)}n.appendChild(a),setTimeout(()=>{a.style.animation="toastOut 0.2s ease forwards",setTimeout(()=>{a.remove()},200)},r)}const ln=(e,t)=>ma(e,"success",t),cr=(e,t)=>ma(e,"error",t),eo=(e,t)=>ma(e,"info",t);function va(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div, span, button"));let r=null,n=null,a=null;for(const s of t){const i=ee(s).trim().toLowerCase(),l=s.getBoundingClientRect();if(!(l.width<=20||l.width>200||l.height<=10||l.height>60)){if(i==="feed"){r=s;const c=window.getComputedStyle(s);(s.className.includes("r-1q142lx")||c.borderBottomColor==="rgb(4, 131, 215)"||c.color==="rgb(4, 131, 215)"||s.getAttribute("aria-selected")==="true")&&(a="feed")}else if(i==="plays"){n=s;const c=window.getComputedStyle(s);(s.className.includes("r-1q142lx")||c.borderBottomColor==="rgb(4, 131, 215)"||c.color==="rgb(4, 131, 215)"||s.getAttribute("aria-selected")==="true")&&(a="plays")}}}if(a===null&&(r||n)){const s=ee(e).toLowerCase();/\d+(?:\.\d+)?\s*fps\s+\d/.test(s)&&/vs\s+[A-Z]{2,4}|@\s+[A-Z]{2,4}/i.test(s)?a="feed":/\d+-\d+\s+P\d+\s+\d{1,2}:\d{2}/i.test(s)&&(a="plays")}return{feedBtn:r,playsBtn:n,activeTab:a}}async function uc(){const{feedBtn:e,activeTab:t}=va();if(M("info",`Toggle to Feed: activeTab=${t}, feedBtn=${e?"found":"not found"}`,{scope:"scrape"}),t==="feed")return!0;if(!e)return!1;M("step","Clicking Feed button with humanActivate",{scope:"scrape"}),oc(e);const r=await Cr(()=>va().activeTab==="feed",{timeoutMs:4e3});return M("info",`Feed tab switch result: ${r}`,{scope:"scrape"}),r}function fc(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div,header")).map(r=>{const n=ee(r);if(!n||!n.includes("Player"))return null;const a=r.getBoundingClientRect();return a.top<-5||a.top>80||a.height<32||a.height>90?null:{el:r,area:a.width*a.height}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function pc(){const e=fc();if(!e)return!1;const r=Array.from(e.querySelectorAll("button,[role='button'],a,div[tabindex='0']")).map(n=>{const a=n.getBoundingClientRect();if(a.width<=0||a.height<=0||a.width>80||a.height>80)return null;const s=Math.max(0,120-a.left),i=n.querySelector("svg")?20:0,l=ee(n).toLowerCase(),c=(n.getAttribute("aria-label")||"").toLowerCase(),o=l.includes("back")||c.includes("back")?30:0;return{el:n,score:s+i+o}}).filter(Boolean);if(r.length===0)return!1;r.sort((n,a)=>a.score-n.score);try{return r[0].el.click(),!0}catch{return!1}}const hc={code:"NHL",name:"National Hockey League",stats:[{code:"G",name:"Goals",aliases:["goal","goals","g"],isPrimary:!0},{code:"A",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"PTS",name:"Points",aliases:["pt","pts","points"],isPrimary:!0},{code:"SOG",name:"Shots on Goal",aliases:["sog","shot","shots"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"HIT",name:"Hits",aliases:["hit","hits"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]},{code:"PIM",name:"Penalty Minutes",aliases:["pim","penalty"]},{code:"FOW",name:"Faceoff Wins",aliases:["fow","fo","faceoff"]},{code:"FO%",name:"Faceoff Percentage",aliases:["fo%","fopct"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"GA",name:"Goals Against",aliases:["ga","goalsagainst"]},{code:"SV%",name:"Save Percentage",aliases:["sv%","savepct"]},{code:"GAA",name:"Goals Against Average",aliases:["gaa"]},{code:"SO",name:"Shutouts",aliases:["so","shutout","shutouts"]},{code:"GP",name:"Games Played",aliases:["gp","games"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"OTL",name:"Overtime Losses",aliases:["otl","ot loss"]},{code:"TOI",name:"Time on Ice",aliases:["toi"]},{code:"GVA",name:"Giveaways",aliases:["gva","gwa","giveaway","giveaways"]},{code:"TKA",name:"Takeaways",aliases:["tka","takeaway","takeaways"]},{code:"PPG",name:"Power Play Goals",aliases:["ppg","pp goal"]},{code:"SHG",name:"Short Handed Goals",aliases:["shg","sh goal"]}],periods:{pattern:/P[1-3]|OT\d?|SO/i,labels:["P1","P2","P3","OT","SO"],hasClock:!0,timePattern:/:?\d{1,2}(?::\d{2})?/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["G","A","PTS","SOG","BLK"]},ga={code:"NBA",name:"National Basketball Association",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"FGM",name:"Field Goals Made",aliases:["fgm","fg"]},{code:"FGA",name:"Field Goals Attempted",aliases:["fga"]},{code:"3PM",name:"3-Pointers Made",aliases:["3pm","3pt","three","threes"],isPrimary:!0},{code:"3PA",name:"3-Pointers Attempted",aliases:["3pa"]},{code:"FTM",name:"Free Throws Made",aliases:["ftm","ft"]},{code:"FTA",name:"Free Throws Attempted",aliases:["fta"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"],isPrimary:!0},{code:"OREB",name:"Offensive Rebounds",aliases:["oreb","or"]},{code:"DREB",name:"Defensive Rebounds",aliases:["dreb","dr"]},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"],isPrimary:!0},{code:"BLK",name:"Blocks",aliases:["blk","block","blocks"],isPrimary:!0},{code:"MIN",name:"Minutes",aliases:["min","mins","minutes"]},{code:"PF",name:"Personal Fouls",aliases:["pf","foul","fouls"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","REB","AST","STL","BLK","3PM"]},to={code:"NFL",name:"National Football League",stats:[{code:"PASS_YD",name:"Passing Yards",aliases:["pass yd","pass yds","passing","pass"],isPrimary:!0},{code:"PASS_TD",name:"Passing Touchdowns",aliases:["pass td","pass tds","ptd"]},{code:"INT",name:"Interceptions Thrown",aliases:["int","ints","interception"]},{code:"CMP",name:"Completions",aliases:["cmp","comp","completions"]},{code:"ATT",name:"Pass Attempts",aliases:["att","attempts"]},{code:"RUSH_YD",name:"Rushing Yards",aliases:["rush yd","rush yds","rushing","rush"],isPrimary:!0},{code:"RUSH_TD",name:"Rushing Touchdowns",aliases:["rush td","rush tds","rtd"]},{code:"CAR",name:"Carries",aliases:["car","carry","carries"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception","receptions"],isPrimary:!0},{code:"REC_YD",name:"Receiving Yards",aliases:["rec yd","rec yds","receiving"]},{code:"REC_TD",name:"Receiving Touchdowns",aliases:["rec td","rec tds"]},{code:"TGT",name:"Targets",aliases:["tgt","target","targets"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown","touchdowns"],isPrimary:!0},{code:"YD",name:"Total Yards",aliases:["yd","yds","yards"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"XP",name:"Extra Points",aliases:["xp","pat","extra point"]},{code:"SACK",name:"Sacks",aliases:["sack","sacks","sk"]},{code:"TKL",name:"Tackles",aliases:["tkl","tackle","tackles"]},{code:"FF",name:"Forced Fumbles",aliases:["ff","forced fumble"]},{code:"FR",name:"Fumble Recoveries",aliases:["fr","fumble recovery"]},{code:"DEF_INT",name:"Defensive Interceptions",aliases:["def int","pick"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PASS_YD","RUSH_YD","REC","TD"]},mc={code:"MLB",name:"Major League Baseball",stats:[{code:"H",name:"Hits",aliases:["h","hit","hits"],isPrimary:!0},{code:"HR",name:"Home Runs",aliases:["hr","hrs","homer","homers","home run"],isPrimary:!0},{code:"RBI",name:"Runs Batted In",aliases:["rbi","rbis"],isPrimary:!0},{code:"R",name:"Runs",aliases:["r","run","runs"],isPrimary:!0},{code:"SB",name:"Stolen Bases",aliases:["sb","stolen","steal","steals"]},{code:"BB",name:"Walks",aliases:["bb","walk","walks"]},{code:"K",name:"Strikeouts",aliases:["k","so","strikeout","strikeouts"]},{code:"AB",name:"At Bats",aliases:["ab","at bat","at bats"]},{code:"2B",name:"Doubles",aliases:["2b","double","doubles"]},{code:"3B",name:"Triples",aliases:["3b","triple","triples"]},{code:"AVG",name:"Batting Average",aliases:["avg","average"]},{code:"IP",name:"Innings Pitched",aliases:["ip","innings"]},{code:"ER",name:"Earned Runs",aliases:["er","earned run","earned runs"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"ERA",name:"Earned Run Average",aliases:["era"]},{code:"WHIP",name:"Walks+Hits per IP",aliases:["whip"]},{code:"QS",name:"Quality Starts",aliases:["qs","quality start"]}],periods:{pattern:/(?:Top|Bot|T|B)\s*\d+|Inning\s*\d+|\d+(?:st|nd|rd|th)/i,labels:["1st","2nd","3rd","4th","5th","6th","7th","8th","9th","Extra"],hasClock:!1},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["H","HR","RBI","R","SB"]},_a={code:"NFL",name:"Generic Sport",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"]},{code:"G",name:"Goals",aliases:["goal","goals","g"]},{code:"SOG",name:"Shots",aliases:["sog","shot","shots"]},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"3PM",name:"3-Pointers",aliases:["3pm","3pt","three","threes"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown"]},{code:"YD",name:"Yards",aliases:["yd","yds","yards"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception"]},{code:"BIRDIE",name:"Birdies",aliases:["birdie","birdies"]},{code:"PAR",name:"Pars",aliases:["par","pars"]},{code:"BOGEY",name:"Bogeys",aliases:["bogey","bogeys"]},{code:"EAGLE",name:"Eagles",aliases:["eagle","eagles"]},{code:"KO",name:"Knockouts",aliases:["ko","knockout","knockouts"]},{code:"SUB",name:"Submissions",aliases:["sub","submission","submissions"]},{code:"TKD",name:"Takedowns",aliases:["tkd","takedown","takedowns"]},{code:"STR",name:"Strikes",aliases:["str","strike","strikes"]},{code:"GLS",name:"Goals",aliases:["gls","goal","goals"]},{code:"SHT",name:"Shots",aliases:["sht","shot","shots"]},{code:"SOT",name:"Shots on Target",aliases:["sot"]},{code:"CRN",name:"Corners",aliases:["crn","corner","corners"]}],periods:{pattern:/(?:P[1-3]|Q[1-4]|H[1-2]|OT\d?|SO|R\d+|RD\s*\d+)/i,labels:["1","2","3","4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","G","TD","REC"]};function vc(e,t){return{..._a,code:e,name:t}}const gc={NHL:hc,NBA:ga,NFL:to,MLB:mc,CFB:{...to,code:"CFB",name:"College Football"},CBB:{...ga,code:"CBB",name:"College Basketball"},WNBA:{...ga,code:"WNBA",name:"Women's NBA"},FC:vc("FC","Football Club / Soccer")};function _c(e){if(!e)return _a;const t=e.toUpperCase().trim();return gc[t]||_a}function ba(e){return(e||"").trim().toLowerCase()}function bc(e){const t=(e||"").trim(),r=t.split("").map(s=>s.trim()).filter(Boolean),n=r[0]||t,a=r.slice(1).join("  ");return{name:n,rest:a}}function ro(e,t){const r=ba(t);if(!r)return null;const n=/\+(\d+(?:\.\d+)?)x\b/i,a=Array.from(e.querySelectorAll("div[tabindex='0'],[role='button'],button")).map(s=>{const i=ee(s);if(!i||!n.test(i))return null;const{name:l}=bc(i),c=s.getBoundingClientRect();if(c.width<=140||c.height<28)return null;const o=(ba(l)===r?1e3:ba(l).includes(r)?100:0)+Math.min(200,Math.round(c.width));return o<=0?null:{el:s,score:o,rect:c,name:l}}).filter(Boolean);return a.length===0?null:(a.sort((s,i)=>i.score-s.score),a[0].el)}function no(e){const a=Array.from(e.querySelectorAll("a[href],a,button,div[tabindex='0'],[role='button']")).filter(l=>!!l.querySelector("svg")).map(l=>({el:l,r:l.getBoundingClientRect()})).filter(l=>l.r.width>8&&l.r.width<=28&&l.r.height>8&&l.r.height<=28);if(a.length===0)return null;a.sort((l,c)=>c.r.left-l.r.left);const s=a[0].el;return(s instanceof HTMLAnchorElement?s:null)||s.querySelector("a[href]")||s.closest("a[href]")||s}async function yc(e){const t=lr();if(!t)return M("warn","No modal found for profile URL discovery",{scope:"profile"}),null;M("step",`Finding player row: ${e}`,{scope:"profile"});const r=ro(t,e);if(!r)return M("warn","Player row not found",{scope:"profile"}),null;const n=no(r);if(!n)return M("warn","Profile icon button not found",{scope:"profile"}),null;const a=n instanceof HTMLAnchorElement?n:n.closest("a[href]");if(a?.getAttribute("href")){const s=new URL(String(a.getAttribute("href")),location.href).toString();return M("info","Got profile URL from href",{scope:"profile",data:{url:s}}),s}return M("info","No href on icon, will click to navigate",{scope:"profile"}),"__CLICK_TO_NAVIGATE__"}function xc(e){const t=e.querySelector("#realrootcontents")||e.querySelector("#realweb")||e.body,n=Array.from(t.querySelectorAll("div,section,header,article")).slice(0,2e3).map(a=>{const s=(ee(a)||"").replace(/\s+/g," ").trim();if(!s||s.length<40||s.length>320)return null;const i=s.toUpperCase();let l=0;return i.includes("7-DAY")&&(l+=4),i.includes("30-DAY")&&(l+=4),i.includes("SEASON")&&(l+=3),i.includes("CARD")&&(l+=2),s.includes("")&&(l+=2),/#\d+/.test(s)&&(l+=1),/\b\d+(st|nd|rd|th)\b/i.test(s)&&(l+=2),l<6?null:{t:s,score:l}}).filter(Boolean);return n.length===0?null:(n.sort((a,s)=>s.score-a.score),n[0].t)}function wc(e){const t={},r=e.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/gi);if(r)for(const a of r){const s=a.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/i);if(s){const i=parseInt(s[1],10),l=s[3]||"overall";t[`rank_${l.toLowerCase().replace("-","_")}`]=i}}const n=e.match(/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)\s*\s*([A-Z]+)\s*\s*#(\d+)/);return n&&(t.team=n[1],t.position=n[2],t.number=parseInt(n[3],10)),t}function Sc(e){const t=e.replace(/\s+/g," "),r=/([A-Z]+(?:%||\+\/-)?)\s+(-?\d+(?:\.\d+)?(?::\d+)?)\s+(\d+)(?:st|nd|rd|th)\b/gi,n=[];let a;for(;(a=r.exec(t))!==null;)n.push({stat:a[1],value:a[2],rank:parseInt(a[3],10)});return n.length>0?{entries:n}:null}function ao(e){const t=e.replace(/\s+/g," ");let r=[];const n=t.match(/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps[^A-Z]*/gi);if(n&&(r=n.map(a=>a.trim().slice(0,200)).filter(a=>a.length>20).slice(0,15)),r.length===0){const a=e.split(/\n/).map(s=>s.trim()).filter(Boolean);for(const s of a)if((/\d+(?:\.\d+)?\s*fps/i.test(s)||/\d+(?:\.\d+)?\s*@\s*[A-Z]{2,4}/i.test(s))&&(r.push(s.slice(0,200)),r.length>=15))break}return r.length>0?{entries:r}:null}function so(e){const t=e.replace(/\s+/g," "),r=[],n=/([A-Z]\.[\s]*[\w'-]+)\s*\s*(\d+(?:\.\d+)?)\s*fps\s+([\d.]+)?/gi;let a;const s=[];for(;(a=n.exec(t))!==null&&(s.push({player:a[1].trim(),fps:parseFloat(a[2]),multiplier:a[3]?parseFloat(a[3]):null,startIdx:a.index,endIdx:a.index+a[0].length}),!(s.length>=30)););for(let i=0;i<s.length;i++){const l=s[i],c=s[i+1]?.startIdx??t.length,o=t.slice(l.endIdx,c).trim(),u=o.match(/(\d+\s+(?:hours?|days?|weeks?|months?)\s+ago|yesterday|today)/i),f=o.match(/(vs|@)\s*([A-Z]{2,4})\s*([WL])?/i);let p=o;u?p=o.slice(0,u.index).trim():f&&(p=o.slice(0,f.index).trim()),p=p.replace(/\s+\d+\s*$/,"").trim(),r.push({player:l.player,fps:l.fps,multiplier:l.multiplier,stats:p.slice(0,100),date:u?.[1]||"",opponent:f?.[2]||"",result:f?.[3]||""})}return r}async function kc(e,t,r=null){_c(r),M("step","Scraping profile from current DOM",{scope:"scrape"});const n=xc(document),a=n?wc(n):null,s=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,i=ee(s),l=Sc(i),{activeTab:c}=va();M("info",`Initial tab: ${c||"unknown"}`,{scope:"scrape"});let o=[],u=null;if(c==="plays"){if(M("step","Switching to Feed tab",{scope:"scrape"}),await uc()){await Cr(()=>{const x=ee(s).replace(/\s+/g," ");return/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(x)},{timeoutMs:3e3,intervalMs:100});const v=ee(s);o=so(v),u=ao(v)}}else o=so(i),u=ao(i);M("info",`Feed extraction: ${o.length} entries`,{scope:"scrape"});const f={player_name:e,profile_url:t,title:document.title||"",header_text:n,header_parsed:a,season_summary:l,recent_performances:u,feed_entries:o,active_tab:c,raw_text_length:i.length};return M("info","Scrape complete",{scope:"scrape",data:{header:!!n,season_summary:l?.entries?.length??0,recent_performances:u?.entries?.length??0,feed_entries:o.length,active_tab:c}}),f}async function Ac(e){const t=location.href,r=e.profile_url==="__CLICK_TO_NAVIGATE__";M("step","Starting profile scrape flow",{scope:"flow",data:{player_name:e.player_name,profile_url:r?"(will click icon)":e.profile_url,return_to_draft:e.return_to_draft}});const n=lr();M("info",`Draft modal at start: ${n?"found":"not found"}`,{scope:"flow"}),M("step","Navigating to profile page",{scope:"flow"});const a=n?ro(n,e.player_name):null,s=a?no(a):null;let i=null,l=null;if(a&&ir()&&(i=Zs(a,`Player: ${e.player_name}`,"rgba(0, 161, 99, 0.3)")),s&&ir()&&(l=Zs(s,"Profile Icon","rgba(4, 131, 215, 0.5)")),r||s)s?(M("step","Clicking profile icon",{scope:"flow"}),s.click()):M("warn","Could not find icon button to click",{scope:"flow"});else if(e.profile_url&&!r){M("step","Using pushState to navigate",{scope:"flow"});try{const v=new URL(e.profile_url,location.href);history.pushState({},"",v.pathname+v.search+v.hash),window.dispatchEvent(new PopStateEvent("popstate"))}catch(v){M("warn","pushState failed",{scope:"flow",data:{error:String(v)}})}}Qs(i),Qs(l),M("step","Waiting for profile page to load",{scope:"flow"});const c=await Cr(()=>location.href!==t,{timeoutMs:6e3,intervalMs:100});M("info",`Navigation result: ${c?"URL changed":"URL unchanged"}`,{scope:"flow",data:{prevUrl:t,currentUrl:location.href}}),c&&(M("step","Waiting for profile content to render",{scope:"flow"}),await Cr(()=>{const v=document.querySelector("#realrootcontents")||document.body,x=ee(v),E=/[A-Z]\.\s*[\w'-]+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(x),b=/PTS\s+\d+\s+\d+/i.test(x)||/GOAL\s+\d+/i.test(x);return E||b},{timeoutMs:1e4,intervalMs:100}));const o=c?location.href:e.profile_url,u=await kc(e.player_name,o,e.sport||null);let f=!1,p=!1;if(e.return_to_draft&&c){M("step","Going back to home page",{scope:"flow"});try{history.back()}catch{}if(f=await Cr(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}),f||(M("step","Clicking back button in nav",{scope:"flow"}),pc()&&(f=await Cr(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}))),M("info",`Returned to home: ${f}`,{scope:"flow",data:{currentUrl:location.href}}),f)if(M("step","Reopening draft modal",{scope:"flow"}),await new Promise(v=>setTimeout(v,500)),lr())p=!0,M("info","Modal already open",{scope:"flow"});else{const v=await Ul({timeoutMs:8e3});p=v.opened,M("info",`Modal reopen attempt: clicked=${v.clicked}, opened=${v.opened}`,{scope:"flow"})}}return sc(),{...u,return_to_draft:e.return_to_draft,returned_to_draft:f,modal_reopened:p,prev_url:t,navigated_to_profile:c,modal_was_open:!!n}}function me(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function ya(e){const t=typeof e=="number"&&!Number.isNaN(e)?e:null;return t==null?"":`${(Math.round(t*100)/100).toString()}x`}function Ec(e){if(!e||e.ok!==!0)return`<div class="card"><div class="h">Nothing captured</div><div class="sub">${me(e?.error||"Open a draft modal and click Capture.")}</div></div>`;let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]);const r=typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:t.length,n=e?.sport||"",a=e?.mode||"",s=Array.isArray(e?.player_pool)?e.player_pool:[],i=(t||[]).map((o,u)=>{const f=o?.selection?me(o.selection):"<span class='muted'>Empty</span>",p=ya(o?.multiplier);return`<tr><td>${u+1}</td><td>${p}</td><td>${f}</td></tr>`}).join(""),l=s.slice(0,40).map(o=>{const u=me(o?.name||""),f=o?.status?`<span class="muted">(${me(o.status)})</span>`:"",p=typeof o?.boost_x=="number"?`<span class="pill">+${me(o.boost_x)}x</span>`:"";return`<div class="row"><div class="rowLeft">${u} ${f}</div><div class="rowRight">${p}</div></div>`}).join(""),c=s.length>40?`<div class="sub">Showing 40 of ${s.length} players.</div>`:`<div class="sub">Players: ${s.length}.</div>`;return`
    <div class="card">
      <div class="h">Capture</div>
      <div class="sub">Sport: <b>${me(n)}</b>  Mode: <b>${me(a)}</b>  Slots: <b>${me(r)}</b></div>
    </div>
    <div class="card">
      <div class="h">Slots</div>
      <table class="table">
        <thead><tr><th>#</th><th>Multiplier</th><th>Selection</th></tr></thead>
        <tbody>${i||"<tr><td colspan='3' class='muted'>No slots found.</td></tr>"}</tbody>
      </table>
    </div>
    <div class="card">
      <div class="h">Player pool</div>
      ${c}
      <div class="list">${l||"<div class='muted'>No pool detected.</div>"}</div>
    </div>
  `.trim()}function oo(e,t=[]){const r=Array.isArray(e?.lineup)?e.lineup:[],n=Array.isArray(e?.bets)?e.bets:[],a=Array.isArray(e?.assumptions)?e.assumptions:[],s=Array.isArray(e?.questions)?e.questions:[],i=r.map(o=>{const u=me(o?.slot_index),f=me(o?.player||""),p=ya(o?.slot_multiplier),v=typeof o?.player_boost_x=="number"?`+${me(o.player_boost_x)}x`:"+0x",x=ya(o?.effective_multiplier);return`<tr><td>${u}</td><td>${f}</td><td>${p}</td><td>${v}</td><td><b>${x}</b></td></tr>`}).join(""),l=n.map(o=>{const u=me(o?.tier||""),f=o?.recommend?"YES":"NO",p=o?.recommend?"yes":"no",v=me(o?.confidence||""),x=me(o?.reason||"");return`<div class="bet-item"><div class="bet-header"><span class="bet-tier">${u}</span><span class="bet-rec ${p}">${f}</span><span class="muted">(${v})</span></div><div class="bet-reason">${x}</div></div>`}).join(""),c=(t||[]).slice(0,8).map(o=>`<div class="row"><a class="link" href="${me(o)}" target="_blank" rel="noreferrer">${me(o)}</a></div>`).join("");return`
    <div class="card"><div class="h">AI result</div><div class="sub">Structured JSON parsed successfully.</div></div>
    <div class="card">
      <div class="h">Lineup</div>
      <table class="table">
        <thead><tr><th>Slot</th><th>Player</th><th>Slot</th><th>Boost</th><th>Effective</th></tr></thead>
        <tbody>${i||"<tr><td colspan='5' class='muted'>No lineup returned.</td></tr>"}</tbody>
      </table>
    </div>
    <div class="card"><div class="h">Bets</div><div class="list">${l||"<div class='muted'>No bets returned.</div>"}</div></div>
    ${s.length?`<div class="card"><div class="h">Questions</div><div class="list">${s.map(o=>`<div class="row">${me(o)}</div>`).join("")}</div></div>`:""}
    ${a.length?`<div class="card"><div class="h">Assumptions</div><div class="list">${a.map(o=>`<div class="row">${me(o)}</div>`).join("")}</div></div>`:""}
    ${c?`<div class="card"><div class="h">Sources</div><div class="list">${c}</div></div>`:""}
  `.trim()}function Tc(){const e=String(N(aa,"")||"").trim(),t=String(N(sa,sr)||sr).trim()||sr,r=N(oa,En),n=N(ia,Tn),a=N(la,rn),s=N(kn,Al),i=N(An,El),l=Math.max(0,Math.min(2,parseFloat(String(r)))),c=Math.max(64,Math.min(4e3,parseInt(String(n),10)||Tn)),o=Math.max(1,Math.min(5,parseInt(String(a),10)||rn)),u=String(s)==="1"||s===!0,f=String(i)==="1"||i===!0;return{apiKey:e,model:t,temperature:l,max_tokens:c,web_max_results:o,structured:u,response_healing:f}}function Cc({method:e,url:t,headers:r,bodyObj:n,timeoutMs:a=6e4}){return new Promise((s,i)=>{const l=n==null?null:JSON.stringify(n);if(typeof GM_xmlhttpRequest!="function"){i(new Error("GM_xmlhttpRequest is not available (check grants)."));return}GM_xmlhttpRequest({method:e,url:t,headers:{"Content-Type":"application/json",...r||{}},data:l??void 0,timeout:a,onload:c=>{try{const o=c?.responseText||"",u=o?JSON.parse(o):null;c.status>=200&&c.status<300?s(u):i(new Error(u?.error?.message||u?.message||`HTTP ${c.status}`))}catch(o){i(o)}},onerror:()=>i(new Error("Network error.")),ontimeout:()=>i(new Error("Request timed out."))})})}function Pc(){return{type:"object",additionalProperties:!1,properties:{lineup:{type:"array",items:{type:"object",additionalProperties:!1,properties:{slot_index:{type:"number"},slot_multiplier:{type:"number"},player:{type:"string"},player_boost_x:{type:["number","null"]},effective_multiplier:{type:"number"}},required:["slot_index","slot_multiplier","player","player_boost_x","effective_multiplier"]}},bets:{type:"array",items:{type:"object",additionalProperties:!1,properties:{tier:{type:"string",enum:["top50","top20","top10"]},recommend:{type:"boolean"},confidence:{type:"string",enum:["low","medium","high"]},reason:{type:"string"}},required:["tier","recommend","confidence","reason"]}},assumptions:{type:"array",items:{type:"string"}},questions:{type:"array",items:{type:"string"}}},required:["lineup","bets","assumptions","questions"]}}function io(e){const r=(Array.isArray(e?.annotations)?e.annotations:[]).filter(n=>n&&n.type==="url_citation"&&n.url_citation&&n.url_citation.url).map(n=>n.url_citation.url).slice(0,25);return Array.from(new Set(r))}function Rc(e){return String(e?.message||e||"").toLowerCase().includes("no endpoints found")}function Pr(){return new Date().toISOString()}function Rr(e){try{localStorage.setItem(Ys,JSON.stringify(e,null,2))}catch{}}async function lo(e,t){let r=null;for(const n of e)try{return{res:await Cc({method:"POST",url:t.url,headers:t.headers,bodyObj:n.body,timeoutMs:t.timeoutMs}),usedLabel:n.label}}catch(a){if(r=a,!Rc(a))throw a}throw r||new Error("OpenRouter request failed.")}function Oc(){return{type:"function",function:{name:"get_player_profile_stats",description:"Fetch and summarize a player's RealSports profile page (rankings, prior performances, recent game logs). Clicks the player's profile icon in the draft modal, scrapes their stats, then returns to the draft. Use when deciding between players beyond boost values.",parameters:{type:"object",additionalProperties:!1,properties:{player_name:{type:"string",description:"Player name exactly as shown in the draft modal."}},required:["player_name"]}}}}function Nc(){return{type:"function",function:{name:"search_draft_players",description:"Search the draft modal for players by name. The initial pool shows up to ~50 players, but many more may be available. Use this to find specific players by name (full or partial) that might not appear in the initial list. Returns matching players with boost values. Note: only searches by player name, not position or team.",parameters:{type:"object",additionalProperties:!1,properties:{query:{type:"string",description:"Player name or partial name to search for (e.g. 'McDavid', 'Connor', 'Ovi')."}},required:["query"]}}}}async function Mc(e,t,r){if(e==="get_player_profile_stats"){const n=String(t?.player_name||"").trim();if(!n)return{error:"missing_player_name"};M("step",`Tool call: get_player_profile_stats(${n})`,{scope:"tool"}),M("step","Discovering profile URL via click",{scope:"tool"});const a=await yc(n);if(!a)return{error:"player_not_found",player_name:n,hint:"Could not find this player in the draft modal. Make sure the draft modal is open and the player is visible in the list."};M("step","Scraping profile",{scope:"tool",data:{profile_url:a}});const s=r.payload?.sport||null,i=await Ac({player_name:n,profile_url:a,return_to_draft:!0,sport:s});return M("info","Tool result ready",{scope:"tool",data:{scraped_via:i?.scraped_via,navigated_to_profile:i?.navigated_to_profile}}),{...i,discovery:"click",mode:"live_dom"}}if(e==="search_draft_players"){const n=String(t?.query||"").trim();if(!n)return{error:"missing_query"};M("step",`Tool call: search_draft_players(${n})`,{scope:"tool"});const a=lr();if(!a)return M("warn","Draft modal not found for search",{scope:"tool"}),{error:"no_draft_modal",message:"Draft modal not found. Make sure the draft modal is open."};M("info","Found draft modal",{scope:"tool"});const s=a.querySelector('input[placeholder*="Search"]')||a.querySelector('input[placeholder*="search"]')||document.querySelector('input[placeholder*="Search"]');if(!s)return M("warn","Search input not found in modal",{scope:"tool"}),{error:"no_search_input",message:"Search input not found in modal"};M("step","Found search input, entering query...",{scope:"tool"}),s.value="",s.focus();const i=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value")?.set;i?i.call(s,n):s.value=n,s.dispatchEvent(new Event("input",{bubbles:!0})),s.dispatchEvent(new Event("change",{bubbles:!0})),await new Promise(o=>setTimeout(o,800)),M("step","Scraping filtered player pool...",{scope:"tool"});const l=Ks(a);M("info",`Found ${l.length} players matching '${n}'`,{scope:"tool"}),i?i.call(s,""):s.value="",s.dispatchEvent(new Event("input",{bubbles:!0})),s.dispatchEvent(new Event("change",{bubbles:!0}));const c=l.map(o=>({name:o.name,boost:o.boost_x!==null&&o.boost_x!==void 0?`+${o.boost_x}x`:null,status:o.status,profile_url:o.profile_url||null}));return{query:n,players_found:c.length,players:c}}return{error:"unknown_tool",toolName:e}}async function Ic(e){const t=Tc(),r=String(N(or,"0"))==="1"||N(or,"0")===!0;if((!Cn||r)&&!t.apiKey)throw new Error("Missing OpenRouter API key.");if(Cn&&!r&&!ha()?.username)throw new Error("Please link your account in Settings before using Ask AI.");const s=String(N(nn,"0"))==="1"||N(nn,"0")===!0,i=String(N(an,"0"))==="1"||N(an,"0")===!0;let l=e.prompt;s?l=["DEBUG TOOL TEST: You MUST call the tool `get_player_profile_stats` exactly once before producing the final JSON schema answer.","Pick ONE player from the available pool (prefer a high-boost or a close decision).","IMPORTANT: Call the tool with return_to_draft=true so you can read dynamic Feed/Plays content, then come back to the draft.","After you receive the tool result, continue normally and return the final JSON schema output.","",e.prompt].join(`
`):i&&(l=["DEBUG TOOL TEST: You MUST call the tool `search_draft_players` exactly once before producing the final JSON schema answer.","Search for a player by name (e.g. 'McDavid', 'Crosby', 'Ovi') to find additional players that may not be in the initial list.","Note: This search only works with player names, not positions or teams.","After you receive the search results, continue normally and return the final JSON schema output.","",e.prompt].join(`
`));const c=[{t:Pr(),kind:"start",model:t.model,web:!!e.web}];Rr(c);const o=N(sn,"1")!=="0",u=N(on,"1")!=="0",f=e.payload?.player_pool_count??e.payload?.player_pool?.length??0,p=u&&f>=50,v=[...o?[Oc()]:[],...p?[Nc()]:[]],x=s?{type:"function",function:{name:"get_player_profile_stats"}}:i?{type:"function",function:{name:"search_draft_players"}}:"auto",E=String(N(or,"0"))==="1"||N(or,"0")===!0,b=Cn&&!E,T=b?{"X-RSDH-Auth":Cl,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"}:{Authorization:`Bearer ${t.apiKey}`,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"};if(b){const st=ha();st?.username&&(T["X-RSDH-User"]=st.username,st.displayName&&(T["X-RSDH-DisplayName"]=st.displayName))}const I=b?zs:Tl,F=[];e.web&&F.push({id:"web",engine:"exa",max_results:t.web_max_results}),t.response_healing&&F.push({id:"response-healing"});const H=[],Z=[{role:"user",content:l}],j=6;let Y=[];for(let st=0;st<j;st++){const Or={model:t.model,messages:Z,temperature:t.temperature,max_tokens:t.max_tokens,tools:v},cn=[{label:"tools+tool_choice+parallel+provider",body:{...Or,tool_choice:x,parallel_tool_calls:!1,provider:{require_parameters:!0},plugins:H}},{label:"tools+tool_choice+provider",body:{...Or,tool_choice:x,provider:{require_parameters:!0},plugins:H}},{label:"tools+tool_choice",body:{...Or,tool_choice:x,plugins:H}},{label:"tools-only",body:{...Or,plugins:H}}],{res:pr,usedLabel:Nr}=await lo(cn,{url:I,headers:T,timeoutMs:9e4});Nr!==cn[0].label&&(c.push({t:Pr(),kind:"routing_fallback",stage:"tool_loop",label:Nr}),Rr(c));const mt=pr?.choices?.[0]?.message;Y=io(mt);const Mr=Array.isArray(mt?.tool_calls)?mt.tool_calls:null;if(!Mr||Mr.length===0)break;Z.push({role:"assistant",content:mt?.content??null,tool_calls:Mr});for(const Ir of Mr.slice(0,3)){const Ht=Ir?.function?.name,dn=Ir?.function?.arguments;let vt={};try{vt=dn?JSON.parse(dn):{}}catch{vt={_raw:dn}}const hr=String(Ir?.id||"");c.push({t:Pr(),kind:"tool_call",name:String(Ht||""),id:hr,args:vt}),Rr(c);const un=performance.now(),Lr=await Mc(String(Ht||""),vt,{payload:e.payload}),Sa=Math.round(performance.now()-un),O=Lr,fn=!O?.error,Q={};Ht==="get_player_profile_stats"&&(Q.player_name=O?.player_name||vt?.player_name,Q.profile_url=O?.profile_url||null,Q.discovery=O?.discovery||null,Q.mode=O?.mode||"live_dom",Q.returned_to_draft=typeof O?.returned_to_draft=="boolean"?O.returned_to_draft:null,Q.modal_reopened=typeof O?.modal_reopened=="boolean"?O.modal_reopened:null,Q.navigated_to_profile=typeof O?.navigated_to_profile=="boolean"?O.navigated_to_profile:null,Q.modal_was_open=typeof O?.modal_was_open=="boolean"?O.modal_was_open:null,Q.header=!!O?.header_text,Q.season_summary=O?.season_summary?.entries?O.season_summary.entries.length:null,Q.recent_performances=O?.recent_performances?.entries?O.recent_performances.entries.length:null,Q.feed_entries=Array.isArray(O?.feed_entries)?O.feed_entries.length:null,Q.lines=Array.isArray(O?.interesting_lines)?O.interesting_lines.length:null,Q.tables=Array.isArray(O?.tables)?O.tables.length:null,Q.embedded_json=Array.isArray(O?.embedded_json)?O.embedded_json.length:null,Q.facts=Array.isArray(O?.facts)?O.facts.length:null,Q.recent_log=Array.isArray(O?.recent_log)?O.recent_log.length:null,O?.error&&(Q.error=O.error),Q.scraped_data={header_text:O?.header_text||null,season_summary:O?.season_summary||null,recent_performances:O?.recent_performances||null,feed_entries:O?.feed_entries||[]}),Ht==="search_draft_players"&&(Q.query=O?.query||vt?.query||null,Q.players_found=typeof O?.players_found=="number"?O.players_found:0,Array.isArray(O?.players)&&O.players.length>0&&(Q.sample_players=O.players.slice(0,5).map(ka=>ka.name)),O?.error&&(Q.error=O.error)),c.push({t:Pr(),kind:"tool_result",name:String(Ht||""),id:hr,ok:fn,ms:Sa,summary:Q}),Rr(c),Z.push({role:"tool",tool_call_id:hr,content:JSON.stringify(Lr)})}}const te={type:"json_schema",json_schema:{name:"draft_lineup",strict:!0,schema:Pc()}},ke={model:t.model,messages:Z,temperature:t.temperature,max_tokens:t.max_tokens,response_format:te},_e=[{label:"final+tools+tool_choice+provider+plugins",body:{...ke,tools:v,tool_choice:"none",provider:{require_parameters:!0},plugins:F}},{label:"final+tools+tool_choice",body:{...ke,tools:v,tool_choice:"none",plugins:[]}},{label:"final+schema+plugins",body:{...ke,plugins:F}},{label:"final+schema-only",body:{...ke}}],{res:ur,usedLabel:fr}=await lo(_e,{url:I,headers:T,timeoutMs:9e4});fr!==_e[0].label&&(c.push({t:Pr(),kind:"routing_fallback",stage:"final",label:fr}),Rr(c));const ht=ur?.choices?.[0]?.message,Re=ht?.content;if(!Re)throw new Error("No content returned.");try{localStorage.setItem(Pl,Re)}catch{}const tt=io(ht);try{localStorage.setItem(ca,JSON.stringify(tt,null,2))}catch{}try{localStorage.setItem(Rl,JSON.stringify(Z,null,2))}catch{}return c.push({t:Pr(),kind:"done"}),Rr(c),{jsonText:Re,sources:tt.length?tt:Y||[]}}function Lc(e){try{localStorage.setItem(Hs,JSON.stringify(e,null,2))}catch{}}function co(e){try{window.dispatchEvent(new CustomEvent("rsdh-output",{detail:{raw:e}}))}catch{}}function dr(e){try{window.dispatchEvent(new CustomEvent("rsdh-status",{detail:{text:e}}))}catch{}}function uo(e,t=!1){const r=document.createElement("button");return r.type="button",r.textContent=e,r.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: -0.01em;
    padding: 10px 14px;
    border-radius: 10px;
    cursor: pointer;
    width: 100%;
    white-space: nowrap;
    transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    ${t?`background: linear-gradient(135deg, var(--rsdh-accent, #2c6cff) 0%, color-mix(in srgb, var(--rsdh-accent, #2c6cff) 80%, black) 100%);
         color: white;
         border: none;
         box-shadow: 0 2px 8px rgba(0,0,0,0.2);`:`background: rgba(255,255,255,0.08);
         color: #f5f5f5;
         border: 1px solid rgba(255,255,255,0.1);
         box-shadow: none;`}
  `,r.addEventListener("mouseenter",()=>{r.style.transform="translateY(-1px)",t?r.style.boxShadow="0 4px 16px rgba(0,0,0,0.3), 0 0 20px color-mix(in srgb, var(--rsdh-accent, #2c6cff) 40%, transparent)":(r.style.background="rgba(255,255,255,0.12)",r.style.boxShadow="0 4px 12px rgba(0,0,0,0.2)")}),r.addEventListener("mouseleave",()=>{r.style.transform="translateY(0)",t?r.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)":(r.style.background="rgba(255,255,255,0.08)",r.style.boxShadow="none")}),r.addEventListener("mousedown",()=>{r.style.transform="translateY(0)"}),r}function Bc(){const e=document.createElement("div");return e.id="rsdh-modal-actions",e.style.cssText=`
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-top: 14px;
    padding: 14px 16px 0 16px;
    border-top: 1px solid color-mix(in srgb, var(--rsdh-accent, #2c6cff) 30%, rgba(255,255,255,0.1));
  `,e}function Dc(e){const r=Array.from(e.querySelectorAll("button,div,[role='button']")).find(n=>{const a=(n.innerText||n.textContent||"").trim();return/^(submit|update)$/i.test(a)});return r?r.parentElement||r:null}async function fo(e){dr("Capturing...");const t=jl({includeDebug:ir()});if(Lc(t),co(JSON.stringify(t,null,2)),!t||t.ok!==!0){const o=t?.error||"Could not capture modal.";dr(o),cr(o);return}if(e==="copy_prompt"){const o=Ws(t);GM_setClipboard(o),dr("Copied prompt to clipboard."),ln("Copied prompt to clipboard!");return}const r=N(da,"1")!=="0",n=N(sn,"1")!=="0",a=N(on,"1")!=="0",s=String(N(ua,"balanced")||"balanced"),i=r?"Asking AI + Web...":"Asking AI...";dr(i),eo(i);const l=Vs(t,{webHint:r,toolHint:n,searchHint:a,strategy:s}),c=await Ic({prompt:l,web:r,payload:t});co(c.jsonText),dr("AI response received."),ln("AI response received!")}function Fc(){const e=()=>{const r=lr();if(!r||r.querySelector("#rsdh-modal-actions"))return;const n=Bc(),a=uo(" Copy Prompt"),s=uo(" Ask AI",!0);a.addEventListener("click",()=>fo("copy_prompt").catch(l=>{const c=String(l?.message||l);dr(c),cr(c)})),s.addEventListener("click",()=>fo("ask_ai").catch(l=>{const c=String(l?.message||l);dr(c),cr(c)})),n.appendChild(a),n.appendChild(s);const i=Dc(r);i&&i.parentElement?i.parentElement.insertBefore(n,i.nextSibling):r.appendChild(n)};e(),new MutationObserver(()=>e()).observe(document.documentElement,{childList:!0,subtree:!0})}const po="rsdh_openrouter_models_cache",$c=1440*60*1e3,Rn=["google/gemini-2.5-flash","google/gemini-2.5-pro","google/gemini-2.0-flash-001","anthropic/claude-sonnet-4","anthropic/claude-3.5-sonnet","anthropic/claude-3.5-haiku","openai/gpt-4o","openai/gpt-4o-mini","openai/gpt-4-turbo","openai/o1","openai/o1-mini","meta-llama/llama-3.3-70b-instruct","deepseek/deepseek-chat-v3-0324","mistralai/mistral-large","qwen/qwen-2.5-72b-instruct"];function ho(){try{const e=localStorage.getItem(po);if(!e)return null;const t=JSON.parse(e);return Date.now()-t.timestamp>$c?null:t}catch{return null}}function qc(e){try{const t={models:e,timestamp:Date.now()};localStorage.setItem(po,JSON.stringify(t))}catch{}}async function zc(){const e=ho();if(e&&e.models.length>0)return e.models;try{if(typeof GM_xmlhttpRequest!="function")return Rn;const t=await new Promise((r,n)=>{GM_xmlhttpRequest({method:"GET",url:"https://openrouter.ai/api/v1/models",headers:{"Content-Type":"application/json"},timeout:1e4,onload:a=>{try{const s=a?.responseText?JSON.parse(a.responseText):null;r(s)}catch{n(new Error("Failed to parse models response"))}},onerror:()=>n(new Error("Network error")),ontimeout:()=>n(new Error("Request timed out"))})});if(t?.data&&Array.isArray(t.data)){const r=t.data.map(n=>n.id).filter(n=>n&&!n.includes(":free")&&!n.includes(":extended")).sort((n,a)=>{const s=["google/","anthropic/","openai/","meta-llama/","deepseek/","mistralai/"],i=s.findIndex(c=>n.startsWith(c)),l=s.findIndex(c=>a.startsWith(c));return i!==-1&&l===-1?-1:l!==-1&&i===-1?1:i!==-1&&l!==-1?i-l:n.localeCompare(a)});if(r.length>0)return qc(r),r}return Rn}catch{return Rn}}function Hc(){return ho()?.models||Rn}const mo="rsdh_svelte_ui_state";function xa(){try{const e=localStorage.getItem(mo);if(!e)return{tab:"context",hidden:!1};const t=JSON.parse(e),r=String(t?.tab||"context");return{tab:r==="settings"?"settings":r==="results"?"results":r==="debug"?"debug":"context",hidden:!!t?.hidden}}catch{return{tab:"context",hidden:!1}}}function wa(e){const r={...xa(),...e};try{localStorage.setItem(mo,JSON.stringify(r))}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-ui-state",{detail:r}))}catch{}}var Yc=w('<button style="background: rgba(245, 158, 11, 0.15); border-color: rgba(245, 158, 11, 0.3);"> Debug</button>'),Uc=w('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),Gc=w("<div><!></div>"),jc=w(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">No Data Captured</h3> <p class="empty-description">Open a draft modal on the site, then use the Capture button to collect
          player and contest data.</p> <div class="empty-hint"> Look for "Draft" or "Update" buttons</div></div>`),Kc=w('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),Jc=w("<div><!></div>"),Wc=w(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">No AI Results Yet</h3> <p class="empty-description">Capture a draft modal first, then use "Ask AI" from the modal to get
          lineup recommendations.</p> <div class="empty-hint"> AI will analyze your roster and suggest optimal picks</div></div>`),Vc=w('<img alt="" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--rsdh-accent);"/>'),Xc=w('<div style="width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center;"></div>'),Zc=w('<div style="font-weight: 600; color: rgba(255,255,255,0.9);"> </div>'),Qc=w('<div class="sub" style="margin-top: 8px; color: rgba(245,158,11,0.9);"> </div>'),ed=w('<div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;"><!> <div><!> <div class="sub"> </div></div></div> <div style="display: flex; gap: 8px; flex-wrap: wrap;"><button style="font-size: 11px;"> Update</button> <button class="secondary" style="font-size: 11px;">Unlink</button></div> <!>',1),td=w('<div class="sub" style="margin-top: 8px; color: rgba(245,158,11,0.9);"> </div>'),rd=w('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(245,158,11,0.08); border-radius: 6px; border-left: 2px solid rgba(245,158,11,0.4);">Link your RealSports account to enable usage tracking.</div> <button> Link Account</button> <!>',1),nd=w('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(255,200,0,0.08); border-radius: 6px; border-left: 2px solid rgba(255,200,0,0.4);">Your API key is stored locally and never shared.</div> <label class="sub" for="or-key">API Key</label> <input id="or-key" style="width:100%; margin-bottom:8px;" type="password" placeholder="sk-or-..."/>',1),ad=w("<option> </option>"),sd=w('<div style="margin-top:8px; margin-left: 28px;"><label class="sub" for="or-web"> </label> <input id="or-web" style="width:100%;" type="range" min="1" max="5" step="1"/></div>'),od=w('<label class="sub" for="or-key">Your OpenRouter API Key</label> <input id="or-key" style="width:100%; margin-bottom:8px;" type="password" placeholder="sk-or-..."/> <div class="sub" style="color: rgba(245,158,11,0.8);"> Your key is stored locally. You will be billed directly.</div>',1),id=w("<span> </span>"),ld=w("<span> </span>"),cd=w("<span> </span>"),dd=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),ud=w('<div style="display: flex; flex-wrap: wrap; gap: 16px; font-size: 13px; color: rgba(255,255,255,0.7);"><span><strong> </strong></span> <!> <span> </span> <span> </span> <!> <!></div> <div style="font-size: 11px; color: rgba(255,255,255,0.4); margin-top: 6px;"> </div>',1),fd=w('<div class="sub">Unable to parse payload</div>'),pd=w('<div class="sub">No capture yet. Open a draft modal and click Capture.</div>'),hd=w("&nbsp;|&nbsp; <strong>Draft:</strong> <span> </span>",1),md=w('&nbsp;|&nbsp; <span style="color: rgba(255,255,255,0.6);"> </span>',1),vd=w(' <span style="color: #22c55e;"> </span>',1),gd=w(' <span style="color: rgba(255,255,255,0.4);">Empty</span>',1),_d=w('<div style="padding: 2px 0; font-size: 11px;"> <span style="color: var(--rsdh-accent-light);"> </span> <!></div>'),bd=w('<div style="margin-left: 12px; margin-top: 4px;"></div>'),yd=w('<span class="sub">None detected</span>'),xd=w("<span> </span>"),wd=w('<div style="padding: 2px 0; font-size: 11px; display: flex; gap: 8px;"><span style="min-width: 140px;"> </span> <span style="color: var(--rsdh-accent-light); min-width: 50px;"> </span> <!></div>'),Sd=w('<div class="sub" style="margin-top: 4px;"> </div>'),kd=w('<div style="margin-left: 12px; margin-top: 4px; max-height: 120px; overflow-y: auto;"><!> <!></div>'),Ad=w('<span class="sub">None detected</span>'),Ed=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),Td=w('<span style="color: #22c55e; font-weight: 600;"> </span>'),Cd=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),Pd=w('<span style="color: #22c55e; font-weight: 600;"> </span>'),Rd=w('<div style="margin-bottom: 10px;"><strong> Game Matchup:</strong> <div style="margin-left: 12px; margin-top: 4px; font-size: 11px;"><div style="display: flex; gap: 8px; align-items: center;"><span> </span> <!> <!> <span style="color: rgba(255,255,255,0.4);">vs</span> <span> </span> <!> <!></div> <div style="margin-top: 4px; color: rgba(255,255,255,0.5);"><!> <!> <!></div></div></div>'),Od=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),Nd=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),Md=w('<div style="padding: 2px 0; font-size: 11px;"> <!></div>'),Id=w('<div class="sub"> </div>'),Ld=w('<div><strong> </strong> <div style="margin-left: 12px; margin-top: 4px;"><!> <!></div></div>'),Bd=w('<div style="font-size: 12px; color: rgba(255,255,255,0.75); line-height: 1.6;"><div style="margin-bottom: 10px;"><strong>Sport:</strong> <strong>Mode:</strong> <!> <!></div> <div style="margin-bottom: 10px;"><strong> </strong> <!></div> <div style="margin-bottom: 10px;"><strong> </strong> <!></div> <!> <!></div>'),Dd=w('<div class="sub">No data captured yet</div>'),Fd=w('<textarea readonly="" style="min-height: 100px; font-size: 10px; margin-top: 6px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy Chat</button>',1),$d=w('<div class="sub" style="margin-top: 6px;">Capture a draft modal to generate</div>'),qd=w('<textarea readonly="" style="min-height: 100px; font-size: 10px; margin-top: 6px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy Structured</button>',1),zd=w('<div class="sub" style="margin-top: 6px;">Use Ask AI to generate</div>'),Hd=w('<br/>Found: <span style="color: #22c55e;"> </span>',1),Yd=w("Query: <strong> </strong> <!>",1),Ud=w("<br/> ",1),Gd=w("Player: <strong> </strong> <!>",1),jd=w('<div style="background: rgba(255,255,255,0.04); border-radius: 8px; padding: 10px; border-left: 3px solid var(--rsdh-accent);"><div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;"><span style="font-weight: 600; font-size: 12px; color: var(--rsdh-accent-light);"> </span></div> <div style="font-size: 11px; color: rgba(255,255,255,0.7);"><!></div></div>'),Kd=w(`<div class="sub">Tool calls detected but couldn't parse details. Check Raw
                    Data.</div>`),Jd=w('<div style="display: flex; flex-direction: column; gap: 8px;"><!> <!></div>'),Wd=w('<div class="sub">No tools were called</div>'),Vd=w('<div style="padding: 3px 0; font-size: 11px; display: flex; gap: 8px; align-items: baseline;"><span style="color: var(--rsdh-accent-light); min-width: 20px;"> </span> <span style="min-width: 140px; font-weight: 500;"> </span> <span style="color: rgba(255,255,255,0.5); font-size: 10px;"> <span style="color: #22c55e;"> </span></span></div>'),Xd=w('<div style="margin-left: 12px; margin-top: 4px;"></div>'),Zd=w('<span class="sub">None</span>'),Qd=w('<div style="padding: 4px 0; font-size: 11px; display: flex; gap: 8px; align-items: baseline;"><span style="min-width: 70px; font-weight: 500;"> </span> <span> </span> <span style="color: rgba(255,255,255,0.5); font-size: 10px; flex: 1;"> </span></div>'),eu=w('<div style="margin-left: 12px; margin-top: 4px;"></div>'),tu=w('<span class="sub">None</span>'),ru=w('<div style="font-size: 12px; color: rgba(255,255,255,0.75); line-height: 1.6;"><div style="margin-bottom: 12px;"><strong> </strong> <!></div> <div><strong>Bet Recommendations:</strong> <!></div></div>'),nu=w('<div class="sub">No response yet</div>'),au=w('<div style="padding: 2px 0;"> </div>'),su=w('<details class="timeline-step"><summary class="timeline-summary"><span class="timeline-icon success"></span> <span class="timeline-title">Web Search</span> <span class="timeline-status"> </span></summary> <div class="timeline-content"><div style="font-size: 11px; color: rgba(255,255,255,0.6);"></div></div></details>'),ou=w(`<div><div class="card" style="border-left: 3px solid rgba(245, 158, 11, 0.6);"><div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;"><span style="font-size: 18px;"></span> <span style="font-weight: 600; color: rgba(255,255,255,0.95);">Request Summary</span></div> <!></div> <div class="card"><div class="h" style="margin-bottom: 12px;"> Request Timeline</div> <details class="timeline-step" open><summary class="timeline-summary"><span> </span> <span class="timeline-title">1. Capture</span> <span class="timeline-status"><!></span></summary> <div class="timeline-content"><!></div></details> <details class="timeline-step"><summary class="timeline-summary"><span> </span> <span class="timeline-title">2. Prompt Built</span> <span class="timeline-status"> </span></summary> <div class="timeline-content"><div style="font-size: 11px; color: rgba(255,255,255,0.5); margin-bottom: 8px;">Two prompts are generated: <strong>Chat</strong> (for copy/paste
              to chatbots) and <strong>Structured</strong> (for OpenRouter with tool
              hints).</div> <details class="details" style="margin-bottom: 8px;"><summary style="font-size: 11px;"> Chat Prompt (for copy/paste)</summary> <!></details> <details class="details" open><summary style="font-size: 11px;"> Structured Prompt (for OpenRouter/API)</summary> <!></details></div></details> <details class="timeline-step"><summary class="timeline-summary"><span> </span> <span class="timeline-title">3. Tool Calls</span> <span class="timeline-status"><!></span></summary> <div class="timeline-content"><!></div></details> <details class="timeline-step"><summary class="timeline-summary"><span> </span> <span class="timeline-title">4. AI Response</span> <span class="timeline-status"><!></span></summary> <div class="timeline-content"><!></div></details> <!></div> <div class="card" style="background: rgba(255,255,255,0.04);"><div class="h" style="margin-bottom: 8px; font-size: 12px;"> Dev Options</div> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer;"><input type="checkbox"/> <span><strong>Force Profile Tool</strong> <span class="sub"> Makes AI call get_player_profile_stats</span></span></label> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 8px;"><input type="checkbox"/> <span><strong>Force Search Tool</strong> <span class="sub"> Makes AI call search_draft_players</span></span></label></div> <div class="card"><details class="details"><summary style="font-size: 13px; font-weight: 600;"> Raw Data</summary> <div style="margin-top: 12px;"><details class="details" style="margin-bottom: 8px;"><summary style="font-size: 12px;">Capture JSON</summary> <textarea readonly="" style="min-height: 100px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy</button></details> <details class="details" style="margin-bottom: 8px;"><summary style="font-size: 12px;">Tool Trace</summary> <textarea readonly="" style="min-height: 100px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy</button></details> <details class="details" style="margin-bottom: 8px;"><summary style="font-size: 12px;">AI Response JSON</summary> <textarea readonly="" style="min-height: 100px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy</button></details> <details class="details"><summary style="font-size: 12px;">Prompts</summary> <div class="sub" style="margin: 6px 0 4px;">Chat Prompt:</div> <textarea readonly="" style="min-height: 60px;"></textarea> <div class="sub" style="margin: 8px 0 4px;">Structured Prompt:</div> <textarea readonly="" style="min-height: 60px;"></textarea></details></div></details></div></div>`),iu=w('<div class="panel"><div class="header"><div class="title"><span style="margin-right: 6px;"></span> Draft Helper</div> <button class="secondary"><span style="font-size: 14px;"></span></button></div> <div class="tabs"><button>Context</button> <button>Results</button> <button>Settings</button> <!></div> <div><!></div> <div><!></div> <div><div class="card"><div class="h"><span style="opacity: 0.6; margin-right: 6px;"></span>Account</div> <!></div> <div class="card"><div class="h"><span style="opacity: 0.6; margin-right: 6px;"></span>OpenRouter API</div> <!> <label class="sub" for="or-model">Model</label> <input id="or-model" style="width:100%; margin-bottom:8px;" type="text" list="model-list" placeholder="Start typing to search..."/> <datalist id="model-list"></datalist> <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 12px;"><div><label class="sub" for="or-temp"> </label> <input id="or-temp" style="width:100%;" type="range" min="0" max="2" step="0.1"/></div> <div><label class="sub" for="or-max">Max tokens</label> <input id="or-max" style="width:100%;" type="text"/></div></div> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Web Search</strong><br/><span class="sub">Search the web for current player news and updates</span></span></label> <!> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Player Profile Lookup</strong><br/><span class="sub">Allow AI to look up detailed player stats from their profile</span></span></label> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Draft Player Search</strong><br/><span class="sub">Allow AI to search for players not in the initial ~50 shown</span></span></label> <div style="margin-top: 16px;"><label class="sub" for="lineup-strategy">Lineup Strategy</label> <select id="lineup-strategy" style="width:100%; margin-top: 4px; padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.15); background: rgba(0,0,0,0.3); color: #fff; font-size: 13px;"><option> Safe - Consistent, high floor players</option><option> Balanced - Mix of floor and upside</option><option> Risky - Boom-or-bust, high ceiling</option></select> <div class="sub" style="margin-top: 4px;"><!></div></div></div> <div class="card"><details class="details" style="margin: -12px -14px; padding: 12px 14px;"><summary> Advanced</summary> <div style="margin-top: 12px;"><label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-bottom: 12px;"><input type="checkbox"/> <span><strong>Use my own API key</strong><br/><span class="sub">Bypass hosted proxy and call OpenRouter directly</span></span></label> <!> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Debug Mode</strong><br/><span class="sub">Show Debug tab with raw data and developer tools</span></span></label></div></details></div> <div style="display:flex; gap:8px; margin-top:14px;"><button style="display:flex; align-items:center; justify-content:center; gap:6px;"><span></span> Save Settings</button></div></div> <!></div>');function lu(e,t){Ka(t,!1);let r=G("context"),n=G(""),a=G(""),s=G(""),i=G(!1),l=G(""),c=G(""),o=G(""),u=G(""),f=G(""),p=G(""),v="",x=G(""),E=G(!1),b=G(""),T=G(sr),I=G(En),F=G(String(Tn)),H=G(rn),Z=!0,j=!0,Y=G(!1),te=G(!1),ke=G(!1),_e=G(!0),ur=G(!0),fr=G(!0),ht=G("balanced"),Re=G(null),tt=G("");async function st(){if(k(tt,"Navigating to profile..."),!await ec()){k(tt,"Could not find profile button. Are you on realsports.io?"),cr("Profile button not found");return}await new Promise(L=>setTimeout(L,800));const C=tc();C?(Vl(C),k(Re,C),k(tt,""),ln(`Linked as @${C.username}`)):(k(tt,"Could not find profile. Make sure you're logged in."),cr("Profile not found"))}function Or(){Xl(),k(Re,null),eo("Account unlinked")}let cn=G(Hc());function pr(y){y==="debug"&&!d(E)&&(y="context"),k(r,y),wa({tab:y})}ll(()=>{const y=xa();k(E,ir()),k(r,y.tab==="debug"&&!d(E)?"context":y.tab),k(a,Kl()),k(n,d(a)),Nr(),k(b,String(N(aa,"")||"")),k(T,String(N(sa,sr)||sr)),k(I,parseFloat(String(N(oa,En)))||En),k(F,String(N(ia,Tn))),k(H,parseInt(String(N(la,rn)),10)||rn),Z=String(N(kn,!0))==="1"||N(kn,!0)===!0,j=String(N(An,!0))==="1"||N(An,!0)===!0,k(Y,String(N(nn,"0"))==="1"||N(nn,"0")===!0),k(te,String(N(an,"0"))==="1"||N(an,"0")===!0),k(ke,String(N(or,"0"))==="1"||N(or,"0")===!0),k(_e,N(sn,"1")!=="0"),k(ur,N(da,"1")!=="0"),k(fr,N(on,"1")!=="0"),k(ht,String(N(ua,"balanced")||"balanced")),k(Re,ha()),zc().then(le=>{k(cn,le)});const C=le=>{};document.addEventListener("click",C,!0);const L=le=>{const B=le.detail;if(B?.raw){try{const W=JSON.parse(B.raw);if(W?.ok===!0){k(n,B.raw),k(a,B.raw),k(c,""),k(p,""),k(f,"");try{k(o,Jl(B.raw))}catch{k(o,"")}try{k(u,Wl(B.raw))}catch{k(u,"")}Nr(),k(r,"context");return}if(W&&Array.isArray(W.lineup)&&Array.isArray(W.bets)){k(c,B.raw);try{const Oe=JSON.parse(localStorage.getItem(ca)||"[]");k(f,Array.isArray(Oe)?Oe.join(`
`):String(Oe))}catch{k(f,"")}try{k(p,String(localStorage.getItem(Ys)||""))}catch{k(p,"")}try{v=String(localStorage.getItem(Pn)||"")}catch{v=""}k(x,oo(W,d(f)?d(f).split(`
`):[])),k(r,"results");return}}catch{}k(n,B.raw),Nr(),k(r,"context")}},J=()=>{try{v=String(localStorage.getItem(Pn)||"")}catch{v=""}};return window.addEventListener("rsdh-output",L),window.addEventListener("rsdh-debug-events",J),()=>{document.removeEventListener("click",C,!0),window.removeEventListener("rsdh-output",L),window.removeEventListener("rsdh-debug-events",J)}});function Nr(){const y=(d(n)||"").trim();if(!y){k(s,'<div class="card"><div class="h">Output</div><div class="sub">Capture a draft modal or run Ask AI.</div></div>');return}try{const C=JSON.parse(y);if(C&&C.ok===!0){k(s,Ec(C));return}if(C&&Array.isArray(C.lineup)&&Array.isArray(C.bets)){let L=[];try{L=JSON.parse(localStorage.getItem(ca)||"[]")||[]}catch{}k(s,oo(C,L));return}}catch{}k(s,`<div class="card"><div class="h">Output</div><pre class="code-output">${y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</pre></div>`)}function mt(y){try{GM_setClipboard(y),ln("Copied to clipboard!")}catch(C){const L=`Copy failed: ${String(C?.message||C)}`;cr(L)}}function Mr(){const y=parseInt(d(F),10);if(isNaN(y)||y<1){k(F,"1"),cr("Max tokens must be at least 1");return}d(b).trim()&&d(b).trim()!=="********"&&Le(aa,d(b).trim()),Le(sa,(d(T)||sr).trim()),Le(oa,String(d(I))),Le(ia,String(y)),Le(la,String(d(H))),Le(kn,Z?"1":"0"),Le(An,j?"1":"0"),Le(nn,d(Y)?"1":"0"),Le(an,d(te)?"1":"0"),Le(or,d(ke)?"1":"0"),Le(sn,d(_e)?"1":"0"),Le(da,d(ur)?"1":"0"),Le(on,d(fr)?"1":"0"),Ol(d(E)),!d(E)&&d(r)==="debug"&&pr("context"),ln("Settings saved!")}xl();var Ir=iu(),Ht=h(Ir),dn=m(h(Ht),2),vt=m(Ht,2),hr=h(vt),un=m(hr,2),Lr=m(un,2),Sa=m(Lr,2);{var O=y=>{var C=Yc();R(()=>Qe(C,1,`tab secondary ${d(r)==="debug"?"active":""}`)),Pe("click",C,()=>pr("debug")),_(y,C)};P(Sa,y=>{d(E)&&y(O)})}var fn=m(vt,2),Q=h(fn);{var ka=y=>{var C=Uc(),L=m(h(C),2),J=h(L);R(()=>A(J,d(l))),_(y,C)},pu=y=>{var C=Et(),L=ae(C);{var J=B=>{var W=Gc(),Oe=h(W);Ms(Oe,()=>d(s)),_(B,W)},le=B=>{var W=jc();_(B,W)};P(L,B=>{d(s)?B(J):B(le,!1)},!0)}_(y,C)};P(Q,y=>{d(i)?y(ka):y(pu,!1)})}var Aa=m(fn,2),hu=h(Aa);{var mu=y=>{var C=Kc(),L=m(h(C),2),J=h(L);R(()=>A(J,d(l))),_(y,C)},vu=y=>{var C=Et(),L=ae(C);{var J=B=>{var W=Jc(),Oe=h(W);Ms(Oe,()=>d(x)),_(B,W)},le=B=>{var W=Wc();_(B,W)};P(L,B=>{d(x)?B(J):B(le,!1)},!0)}_(y,C)};P(hu,y=>{d(i)?y(mu):y(vu,!1)})}var Ea=m(Aa,2),go=h(Ea),gu=m(h(go),2);{var _u=y=>{var C=ed(),L=ae(C),J=h(L);{var le=Ae=>{var rt=Vc();R(()=>bl(rt,"src",d(Re).avatarUrl)),_(Ae,rt)},B=Ae=>{var rt=Xc();_(Ae,rt)};P(J,Ae=>{d(Re).avatarUrl?Ae(le):Ae(B,!1)})}var W=m(J,2),Oe=h(W);{var Nn=Ae=>{var rt=Zc(),hn=h(rt);R(()=>A(hn,d(Re).displayName)),_(Ae,rt)};P(Oe,Ae=>{d(Re).displayName&&d(Re).displayName!==d(Re).username&&Ae(Nn)})}var pn=m(Oe,2),Pa=h(pn),Mn=m(L,2),In=h(Mn),Ra=m(In,2),Oa=m(Mn,2);{var Na=Ae=>{var rt=Qc(),hn=h(rt);R(()=>A(hn,d(tt))),_(Ae,rt)};P(Oa,Ae=>{d(tt)&&Ae(Na)})}R(()=>A(Pa,`@${d(Re).username??""}`)),Pe("click",In,st),Pe("click",Ra,Or),_(y,C)},bu=y=>{var C=rd(),L=m(ae(C),2),J=m(L,2);{var le=B=>{var W=td(),Oe=h(W);R(()=>A(Oe,d(tt))),_(B,W)};P(J,B=>{d(tt)&&B(le)})}Pe("click",L,st),_(y,C)};P(gu,y=>{d(Re)?y(_u):y(bu,!1)})}var _o=m(go,2),bo=m(h(_o),2);{var yu=y=>{var C=nd(),L=m(ae(C),4);Er(L,()=>d(b),J=>k(b,J)),_(y,C)};P(bo,y=>{Cn||y(yu)})}var yo=m(bo,4),xo=m(yo,2);$t(xo,5,()=>d(cn),Ft,(y,C)=>{var L=ad(),J=h(L),le={};R(()=>{A(J,d(C)),le!==(le=d(C))&&(L.value=(L.__value=d(C))??"")}),_(y,L)});var wo=m(xo,2),So=h(wo),ko=h(So),xu=h(ko),wu=m(ko,2),Su=m(So,2),ku=m(h(Su),2),Ao=m(wo,2),Au=h(Ao),Eo=m(Ao,2);{var Eu=y=>{var C=sd(),L=h(C),J=h(L),le=m(L,2);R(()=>A(J,`Max results: ${d(H)??""}`)),Er(le,()=>d(H),B=>k(H,B)),_(y,C)};P(Eo,y=>{d(ur)&&y(Eu)})}var To=m(Eo,2),Tu=h(To),Co=m(To,2),Cu=h(Co),Pu=m(Co,2),On=m(h(Pu),2);R(()=>{d(ht),Ki(()=>{})});var Ta=h(On);Ta.value=Ta.__value="safe";var Ca=m(Ta);Ca.value=Ca.__value="balanced";var Po=m(Ca);Po.value=Po.__value="risky";var Ru=m(On,2),Ou=h(Ru);{var Nu=y=>{var C=He("Prioritizes consistent performers for reliable results");_(y,C)},Mu=y=>{var C=Et(),L=ae(C);{var J=B=>{var W=He("Targets high upside players for ceiling plays");_(B,W)},le=B=>{var W=He("Default strategy balancing consistency and upside");_(B,W)};P(L,B=>{d(ht)==="risky"?B(J):B(le,!1)},!0)}_(y,C)};P(Ou,y=>{d(ht)==="safe"?y(Nu):y(Mu,!1)})}var Ro=m(_o,2),Iu=h(Ro),Lu=m(h(Iu),2),Oo=h(Lu),Bu=h(Oo),No=m(Oo,2);{var Du=y=>{var C=od(),L=m(ae(C),2);Er(L,()=>d(b),J=>k(b,J)),_(y,C)};P(No,y=>{d(ke)&&y(Du)})}var Fu=m(No,2),$u=h(Fu),qu=m(Ro,2),zu=h(qu),Hu=m(Ea,2);{var Yu=y=>{var C=ou(),L=h(C),J=m(h(L),2);{var le=S=>{const g=St(()=>(()=>{try{return JSON.parse(d(a))}catch{return null}})());var K=Et(),Be=ae(K);{var Tt=re=>{var D=ud(),ne=ae(D),fe=h(ne),gt=h(fe),Ct=h(gt),Yt=m(fe,2);{var mr=V=>{var ce=id(),be=h(ce);R(()=>{en(ce,`color: ${d(g).draft_type==="game"?"#f59e0b":"inherit"};`),A(be,d(g).draft_type==="game"?" Game Draft":" League Draft")}),_(V,ce)};P(Yt,V=>{d(g).draft_type&&V(mr)})}var Pt=m(Yt,2),Ut=h(Pt),Ue=m(Pt,2),se=h(Ue),pe=m(Ue,2);{var ot=V=>{var ce=ld(),be=h(ce);R(()=>A(be,` ${d(g).game_matchup.team1??""} vs ${d(g).game_matchup.team2??""}`)),_(V,ce)},de=V=>{var ce=Et(),be=ae(ce);{var it=Rt=>{var $=cd(),oe=h($);R(()=>A(oe,` ${d(g).games.length??""} games`)),_(Rt,$)};P(be,Rt=>{d(g).games?.length&&Rt(it)},!0)}_(V,ce)};P(pe,V=>{d(g).game_matchup?V(ot):V(de,!1)})}var ve=m(pe,2);{var he=V=>{var ce=dd(),be=h(ce);R(()=>A(be,`${d(g).game_entries_remaining??""} entries left`)),_(V,ce)};P(ve,V=>{typeof d(g).game_entries_remaining=="number"&&V(he)})}var Ee=m(ne,2),Ge=h(Ee);R(V=>{A(Ct,d(g).sport||"Unknown"),A(Ut,` ${(d(g).player_pool_count||d(g).player_pool?.length||"?")??""} players`),A(se,` ${(d(g).slots?.length||d(g).expected_slots||"?")??""} slots`),A(Ge,`Captured: ${V??""}`)},[()=>d(g).captured_at?new Date(d(g).captured_at).toLocaleTimeString():"Unknown"]),_(re,D)},Ye=re=>{var D=fd();_(re,D)};P(Be,re=>{d(g)?re(Tt):re(Ye,!1)})}_(S,K)},B=S=>{var g=pd();_(S,g)};P(J,S=>{d(a)?S(le):S(B,!1)})}var W=m(L,2),Oe=m(h(W),2),Nn=h(Oe),pn=h(Nn),Pa=h(pn),Mn=m(pn,4),In=h(Mn);{var Ra=S=>{const g=St(()=>(()=>{try{return JSON.parse(d(n))}catch{return null}})());var K=He();R(()=>A(K,`${(d(g)?.player_pool_count||d(g)?.player_pool?.length||"?")??""} players,
                ${(d(g)?.slots?.length||"?")??""} slots`)),_(S,K)},Oa=S=>{var g=He("Pending");_(S,g)};P(In,S=>{d(n)?S(Ra):S(Oa,!1)})}var Na=m(Nn,2),Ae=h(Na);{var rt=S=>{const g=St(()=>(()=>{try{return JSON.parse(d(n))}catch{return null}})());var K=Et(),Be=ae(K);{var Tt=Ye=>{var re=Bd(),D=h(re),ne=m(h(D)),fe=m(ne,2),gt=m(fe);{var Ct=$=>{var oe=hd(),De=m(ae(oe),3),Fe=h(De);R(()=>{en(De,`color: ${d(g).draft_type==="game"?"#f59e0b":"inherit"};`),A(Fe,d(g).draft_type==="game"?" Game":" League")}),_($,oe)};P(gt,$=>{d(g).draft_type&&$(Ct)})}var Yt=m(gt,2);{var mr=$=>{var oe=md(),De=m(ae(oe)),Fe=h(De);R(()=>A(Fe,`${d(g).game_entries_remaining??""} entries left`)),_($,oe)};P(Yt,$=>{typeof d(g).game_entries_remaining=="number"&&$(mr)})}var Pt=m(D,2),Ut=h(Pt),Ue=h(Ut),se=m(Ut,2);{var pe=$=>{var oe=bd();$t(oe,5,()=>d(g).slots,Ft,(De,Fe,Gt)=>{var je=_d(),ye=h(je);ye.nodeValue=`${Gt+1}. `;var lt=m(ye),Ke=h(lt),Te=m(lt,2);{var nt=Je=>{var _t=vd(),Ot=m(ae(_t)),$e=h(Ot);R(()=>A($e,d(Fe).selection)),_(Je,_t)},jt=Je=>{var _t=gd();_(Je,_t)};P(Te,Je=>{d(Fe).selection?Je(nt):Je(jt,!1)})}R(()=>A(Ke,`${d(Fe).multiplier??""}x`)),_(De,je)}),_($,oe)},ot=$=>{var oe=yd();_($,oe)};P(se,$=>{d(g).slots?.length?$(pe):$(ot,!1)})}var de=m(Pt,2),ve=h(de),he=h(ve),Ee=m(ve,2);{var Ge=$=>{var oe=kd(),De=h(oe);$t(De,1,()=>d(g).player_pool.slice(0,15),Ft,(je,ye)=>{var lt=wd(),Ke=h(lt),Te=h(Ke),nt=m(Ke,2),jt=h(nt),Je=m(nt,2);{var _t=Ot=>{var $e=xd(),Nt=h($e);R(()=>{en($e,`color: ${d(ye).status==="Out"?"#ef4444":"#f59e0b"}; font-size: 10px;`),A(Nt,d(ye).status)}),_(Ot,$e)};P(Je,Ot=>{d(ye).status&&d(ye).status!=="Active"&&Ot(_t)})}R(()=>{A(Te,d(ye).name),A(jt,`+${d(ye).boost_x??0??""}x`)}),_(je,lt)});var Fe=m(De,2);{var Gt=je=>{var ye=Sd(),lt=h(ye);R(()=>A(lt,`...and ${d(g).player_pool.length-15} more`)),_(je,ye)};P(Fe,je=>{d(g).player_pool.length>15&&je(Gt)})}_($,oe)},V=$=>{var oe=Ad();_($,oe)};P(Ee,$=>{d(g).player_pool?.length?$(Ge):$(V,!1)})}var ce=m(de,2);{var be=$=>{var oe=Rd(),De=m(h(oe),2),Fe=h(De),Gt=h(Fe),je=h(Gt),ye=m(Gt,2);{var lt=X=>{var ue=Ed(),vr=h(ue);R(()=>A(vr,`(${d(g).game_matchup.team1_record??""})`)),_(X,ue)};P(ye,X=>{d(g).game_matchup.team1_record&&X(lt)})}var Ke=m(ye,2);{var Te=X=>{var ue=Td(),vr=h(ue);R(()=>A(vr,d(g).game_matchup.team1_score)),_(X,ue)};P(Ke,X=>{d(g).game_matchup.team1_score!==null&&d(g).game_matchup.team1_score!==void 0&&X(Te)})}var nt=m(Ke,4),jt=h(nt),Je=m(nt,2);{var _t=X=>{var ue=Cd(),vr=h(ue);R(()=>A(vr,`(${d(g).game_matchup.team2_record??""})`)),_(X,ue)};P(Je,X=>{d(g).game_matchup.team2_record&&X(_t)})}var Ot=m(Je,2);{var $e=X=>{var ue=Pd(),vr=h(ue);R(()=>A(vr,d(g).game_matchup.team2_score)),_(X,ue)};P(Ot,X=>{d(g).game_matchup.team2_score!==null&&d(g).game_matchup.team2_score!==void 0&&X($e)})}var Nt=m(Fe,2),Br=h(Nt);{var Ba=X=>{var ue=He();R(()=>A(ue,`@ ${d(g).game_matchup.time??""}`)),_(X,ue)};P(Br,X=>{d(g).game_matchup.time&&X(Ba)})}var Dr=m(Br,2);{var Ln=X=>{var ue=He();R(()=>A(ue,` ${d(g).game_matchup.spread??""}`)),_(X,ue)};P(Dr,X=>{d(g).game_matchup.spread&&X(Ln)})}var Da=m(Dr,2);{var Mf=X=>{var ue=He();R(()=>A(ue,` ${d(g).game_matchup.status==="finished"?"Final":"Live"}`)),_(X,ue)};P(Da,X=>{d(g).game_matchup.status!=="upcoming"&&X(Mf)})}R(()=>{A(je,d(g).game_matchup.team1),A(jt,d(g).game_matchup.team2)}),_($,oe)};P(ce,$=>{d(g).game_matchup&&$(be)})}var it=m(ce,2);{var Rt=$=>{var oe=Ld(),De=h(oe),Fe=h(De),Gt=m(De,2),je=h(Gt);$t(je,1,()=>d(g).games.slice(0,6),Ft,(Ke,Te)=>{var nt=Md(),jt=h(nt),Je=m(jt);{var _t=$e=>{var Nt=Od(),Br=h(Nt);R(()=>A(Br,`@ ${d(Te).time??""}`)),_($e,Nt)},Ot=$e=>{var Nt=Et(),Br=ae(Nt);{var Ba=Dr=>{var Ln=Nd(),Da=h(Ln);R(()=>A(Da,`(Final${d(Te).score?`: ${d(Te).score}`:""})`)),_(Dr,Ln)};P(Br,Dr=>{d(Te).status==="finished"&&Dr(Ba)},!0)}_($e,Nt)};P(Je,$e=>{d(Te).time?$e(_t):$e(Ot,!1)})}R(()=>A(jt,`${d(Te).team1??""} vs ${d(Te).team2??""} `)),_(Ke,nt)});var ye=m(je,2);{var lt=Ke=>{var Te=Id(),nt=h(Te);R(()=>A(nt,`...and ${d(g).games.length-6} more`)),_(Ke,Te)};P(ye,Ke=>{d(g).games.length>6&&Ke(lt)})}R(()=>A(Fe,`Games (${d(g).games.length??""}):`)),_($,oe)};P(it,$=>{d(g).games?.length&&$(Rt)})}R(()=>{A(ne,` ${(d(g).sport||"Unknown")??""} (${(d(g).sport_detection_method||"unknown")??""}) | `),A(fe,` ${(d(g).mode||"unknown")??""} `),A(Ue,`Slots (${(d(g).slots?.length||0)??""}):`),A(he,`Player Pool (${(d(g).player_pool?.length||d(g).player_pool_count||0)??""}):`)}),_(Ye,re)};P(Be,Ye=>{d(g)&&Ye(Tt)})}_(S,K)},hn=S=>{var g=Dd();_(S,g)};P(Ae,S=>{d(n)?S(rt):S(hn,!1)})}var Mo=m(Oe,2),Io=h(Mo),Ma=h(Io),Uu=h(Ma),Gu=m(Ma,4),ju=h(Gu),Ku=m(Io,2),Lo=m(h(Ku),2),Ju=m(h(Lo),2);{var Wu=S=>{var g=Fd(),K=ae(g),Be=m(K,2);R(()=>nr(K,d(o))),Pe("click",Be,()=>mt(d(o))),_(S,g)},Vu=S=>{var g=$d();_(S,g)};P(Ju,S=>{d(o)?S(Wu):S(Vu,!1)})}var Xu=m(Lo,2),Zu=m(h(Xu),2);{var Qu=S=>{var g=qd(),K=ae(g),Be=m(K,2);R(()=>nr(K,d(u))),Pe("click",Be,()=>mt(d(u))),_(S,g)},ef=S=>{var g=zd();_(S,g)};P(Zu,S=>{d(u)?S(Qu):S(ef,!1)})}var Bo=m(Mo,2),Do=h(Bo),Ia=h(Do),tf=h(Ia),rf=m(Ia,4),nf=h(rf);{var af=S=>{const g=St(()=>(d(p).match(/tool_call/g)||[]).length);var K=He();R(()=>A(K,`${d(g)??""} call${d(g)!==1?"s":""}`)),_(S,K)},sf=S=>{var g=He("None");_(S,g)};P(nf,S=>{d(p)&&d(p).includes("tool_call")?S(af):S(sf,!1)})}var of=m(Do,2),lf=h(of);{var cf=S=>{const g=St(()=>(()=>{const re=[];try{const D=JSON.parse(d(p));if(Array.isArray(D))for(const ne of D)ne.kind==="tool_call"&&re.push({name:ne.name||"Unknown",args:ne.args||ne.arguments||{},result:ne.result||null})}catch{const D=d(p).split(`
`);for(const ne of D)if(ne.includes('"kind": "tool_call"')||ne.includes('"name":'))try{const fe=JSON.parse(ne);fe.name&&re.push({name:fe.name,args:fe.args||fe.arguments||{},result:fe.result})}catch{}}return re})());var K=Jd(),Be=h(K);$t(Be,1,()=>d(g),Ft,(re,D)=>{var ne=jd(),fe=h(ne),gt=h(fe),Ct=h(gt),Yt=m(fe,2),mr=h(Yt);{var Pt=Ue=>{var se=Yd(),pe=m(ae(se)),ot=h(pe),de=m(pe,2);{var ve=he=>{var Ee=Hd(),Ge=m(ae(Ee),2),V=h(Ge);R(()=>A(V,`${d(D).result?.players_found??d(D).result?.length??"?"??""} players`)),_(he,Ee)};P(de,he=>{d(D).result&&he(ve)})}R(()=>A(ot,`"${(d(D).args?.query||"N/A")??""}"`)),_(Ue,se)},Ut=Ue=>{var se=Et(),pe=ae(se);{var ot=ve=>{var he=Gd(),Ee=m(ae(he)),Ge=h(Ee),V=m(Ee,2);{var ce=be=>{var it=Ud(),Rt=m(ae(it));R(()=>A(Rt,`Team: ${(d(D).result.header.team||"N/A")??""} | Pos: ${(d(D).result.header.position||"N/A")??""}`)),_(be,it)};P(V,be=>{d(D).result?.header&&be(ce)})}R(()=>A(Ge,d(D).args?.player_name||"N/A")),_(ve,he)},de=ve=>{var he=He();R(Ee=>A(he,`Args: ${Ee??""}`),[()=>JSON.stringify(d(D).args).slice(0,100)]),_(ve,he)};P(pe,ve=>{d(D).name==="get_player_profile_stats"?ve(ot):ve(de,!1)},!0)}_(Ue,se)};P(mr,Ue=>{d(D).name==="search_draft_players"?Ue(Pt):Ue(Ut,!1)})}R(()=>A(Ct,`${d(D).name==="search_draft_players"?"":""}
                        ${d(D).name??""}`)),_(re,ne)});var Tt=m(Be,2);{var Ye=re=>{var D=Kd();_(re,D)};P(Tt,re=>{d(g).length===0&&re(Ye)})}_(S,K)},df=S=>{var g=Wd();_(S,g)};P(lf,S=>{d(p)&&d(p).includes("tool_call")?S(cf):S(df,!1)})}var Fo=m(Bo,2),$o=h(Fo),La=h($o),uf=h(La),ff=m(La,4),pf=h(ff);{var hf=S=>{const g=St(()=>(()=>{try{return JSON.parse(d(c))}catch{return null}})());var K=He();R(()=>A(K,`${(d(g)?.lineup?.length||"?")??""} players, ${(d(g)?.bets?.length||"?")??""} bets`)),_(S,K)},mf=S=>{var g=He("Pending");_(S,g)};P(pf,S=>{d(c)?S(hf):S(mf,!1)})}var vf=m($o,2),gf=h(vf);{var _f=S=>{const g=St(()=>(()=>{try{return JSON.parse(d(c))}catch{return null}})());var K=Et(),Be=ae(K);{var Tt=Ye=>{var re=ru(),D=h(re),ne=h(D),fe=h(ne),gt=m(ne,2);{var Ct=se=>{var pe=Xd();$t(pe,5,()=>d(g).lineup,Ft,(ot,de,ve)=>{var he=Vd(),Ee=h(he),Ge=h(Ee),V=m(Ee,2),ce=h(V),be=m(V,2),it=h(be),Rt=m(it),$=h(Rt);R(()=>{A(Ge,`S${d(de).slot_index??ve+1??""}`),A(ce,d(de).player||"N/A"),A(it,`${d(de).slot_multiplier??"?"??""}x slot + ${d(de).player_boost_x??0??""}x boost = `),A($,`${d(de).effective_multiplier??"?"??""}x`)}),_(ot,he)}),_(se,pe)},Yt=se=>{var pe=Zd();_(se,pe)};P(gt,se=>{d(g).lineup?.length?se(Ct):se(Yt,!1)})}var mr=m(D,2),Pt=m(h(mr),2);{var Ut=se=>{var pe=eu();$t(pe,5,()=>d(g).bets,Ft,(ot,de)=>{var ve=Qd(),he=h(ve),Ee=h(he),Ge=m(he,2),V=h(Ge),ce=m(Ge,2),be=h(ce);R(it=>{A(Ee,d(de).tier||"N/A"),en(Ge,`font-weight: 600; color: ${d(de).recommend?"#22c55e":"#ef4444"}; min-width: 30px;`),A(V,d(de).recommend?"YES":"NO"),A(be,`${it??""}${d(de).reason?.length>60?"...":""}`)},[()=>d(de).reason?.slice(0,60)||""]),_(ot,ve)}),_(se,pe)},Ue=se=>{var pe=tu();_(se,pe)};P(Pt,se=>{d(g).bets?.length?se(Ut):se(Ue,!1)})}R(()=>A(fe,`Lineup (${(d(g).lineup?.length||0)??""} players):`)),_(Ye,re)};P(Be,Ye=>{d(g)&&Ye(Tt)})}_(S,K)},bf=S=>{var g=nu();_(S,g)};P(gf,S=>{d(c)?S(_f):S(bf,!1)})}var yf=m(Fo,2);{var xf=S=>{var g=su(),K=h(g),Be=m(h(K),4),Tt=h(Be),Ye=m(K,2),re=h(Ye);$t(re,5,()=>d(f).split(`
`).filter(D=>D.trim()).slice(0,5),Ft,(D,ne)=>{var fe=au(),gt=h(fe);R(Ct=>A(gt,` ${Ct??""}${d(ne).length>60?"...":""}`),[()=>d(ne).slice(0,60)]),_(D,fe)}),R(D=>A(Tt,`${D??""} sources`),[()=>d(f).split(`
`).filter(D=>D.trim()).length]),_(S,g)};P(yf,S=>{d(f)&&S(xf)})}var qo=m(W,2),zo=m(h(qo),2),wf=h(zo),Sf=m(zo,2),kf=h(Sf),Af=m(qo,2),Ef=h(Af),Tf=m(h(Ef),2),Ho=h(Tf),Yo=m(h(Ho),2),Cf=m(Yo,2),Uo=m(Ho,2),Go=m(h(Uo),2),Pf=m(Go,2),jo=m(Uo,2),Ko=m(h(jo),2),Rf=m(Ko,2),Of=m(jo,2),Jo=m(h(Of),4),Nf=m(Jo,4);R((S,g)=>{Qe(C,1,`view ${d(r)==="debug"?"":"hidden"}`),Qe(pn,1,`timeline-icon ${d(n)?"success":""}`),A(Pa,d(n)?"":""),Qe(Ma,1,`timeline-icon ${d(u)?"success":""}`),A(Uu,d(u)?"":""),A(ju,d(u)?`${d(u).length} chars`:"Pending"),Qe(Ia,1,`timeline-icon ${S??""}`),A(tf,g),Qe(La,1,`timeline-icon ${d(c)?"success":""}`),A(uf,d(c)?"":""),nr(Yo,d(n)||"(No capture data)"),nr(Go,d(p)||"(No tool calls)"),nr(Ko,d(c)||"(No AI response)"),nr(Jo,d(o)||"(No chat prompt)"),nr(Nf,d(u)||"(No structured prompt)")},[()=>d(p)&&d(p).includes("tool_call")?"success":"",()=>d(p)&&d(p).includes("tool_call")?"":""]),ar(wf,()=>d(Y),S=>k(Y,S)),ar(kf,()=>d(te),S=>k(te,S)),Pe("click",Cf,()=>mt(d(n))),Pe("click",Pf,()=>mt(d(p))),Pe("click",Rf,()=>mt(d(c))),_(y,C)};P(Hu,y=>{d(E)&&y(Yu)})}R(()=>{en(vt,`grid-template-columns: ${d(E)?"1fr 1fr 1fr 1fr":"1fr 1fr 1fr"};`),Qe(hr,1,`tab secondary ${d(r)==="context"?"active":""}`),Qe(un,1,`tab secondary ${d(r)==="results"?"active":""}`),Qe(Lr,1,`tab secondary ${d(r)==="settings"?"active":""}`),Qe(fn,1,`view ${d(r)==="context"?"":"hidden"}`),Qe(Aa,1,`view ${d(r)==="results"?"":"hidden"}`),Qe(Ea,1,`view ${d(r)==="settings"?"":"hidden"}`),A(xu,`Temperature: ${d(I)??""}`)}),Pe("click",dn,()=>wa({hidden:!0})),Pe("click",hr,()=>pr("context")),Pe("click",un,()=>pr("results")),Pe("click",Lr,()=>pr("settings")),Er(yo,()=>d(T),y=>k(T,y)),Er(wu,()=>d(I),y=>k(I,y)),Er(ku,()=>d(F),y=>k(F,y)),ar(Au,()=>d(ur),y=>k(ur,y)),ar(Tu,()=>d(_e),y=>k(_e,y)),ar(Cu,()=>d(fr),y=>k(fr,y)),vl(On,()=>d(ht),y=>k(ht,y)),Pe("change",On,()=>Le(ua,d(ht))),ar(Bu,()=>d(ke),y=>k(ke,y)),ar($u,()=>d(E),y=>k(E,y)),Pe("click",zu,Mr),_(e,Ir),Ja()}function cu(){const e="rsdh-svelte-root";let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,document.documentElement.appendChild(t)),t}function du(e){const t="rsdh-svelte-handle";let r=e.getElementById(t);return r||(r=document.createElement("button"),r.id=t,r.className="fab",r.type="button",r.title="Open Draft Helper",r.setAttribute("aria-label","Open Draft Helper"),r.innerHTML=`
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 2l1.2 4.3L17.5 8l-4.3 1.2L12 13.5l-1.2-4.3L6.5 8l4.3-1.7L12 2Z" fill="currentColor" opacity="0.95"/>
        <path d="M19 11l.8 2.8L22.6 15l-2.8.8L19 18.6l-.8-2.8L15.4 15l2.8-1.2L19 11Z" fill="currentColor" opacity="0.85"/>
      </svg>
    `,r.addEventListener("click",()=>wa({hidden:!1})),e.appendChild(r)),r}function vo(e,t,r){e.style.display=r?"none":"",t.style.display=r?"":"none"}function uu(e){const t=()=>{const r=nc();r&&e.style.setProperty("--rsdh-accent",r)};t();try{setInterval(t,5e3)}catch{}}function fu(){const e=cu(),t=e.shadowRoot??e.attachShadow({mode:"open"}),r="rsdh-style";if(!t.getElementById(r)){const l=document.createElement("style");l.id=r,l.textContent=Wo,t.appendChild(l)}const n=du(t),a="app";let s=t.getElementById(a);s||(s=document.createElement("div"),s.id=a,t.appendChild(s)),al(lu,{target:s});const i=xa();vo(s,n,!!i.hidden),window.addEventListener("rsdh-ui-state",l=>{const c=l.detail;c&&typeof c.hidden=="boolean"&&vo(s,n,c.hidden)}),uu(e)}fu(),Fc()})();
