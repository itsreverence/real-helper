// ==UserScript==
// @name         RealSports Draft Helper
// @namespace    local.realsports.drafthelper
// @version      0.91.52
// @description  RealSports Draft Helper (Svelte + TypeScript)
// @homepageURL  https://github.com/itsreverence/real-helper
// @supportURL   https://github.com/itsreverence/real-helper/issues
// @downloadURL  https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @updateURL    https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @match        https://realsports.io/*
// @run-at       document-idle
// @grant        GM_setClipboard
// @grant        GM_xmlhttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @connect      openrouter.ai
// @connect      realsports.io
// ==/UserScript==

(function(){"use strict";const pi='@import"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&display=swap";:host,#app{font-family:Inter,ui-sans-serif,system-ui,-apple-system,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*,*:before,*:after{box-sizing:border-box}:host{--rsdh-bg: #0D0D12;--rsdh-panel-bg: rgba(18, 18, 26, .95);--rsdh-accent: #00E5FF;--rsdh-accent-green: #7CFF01;--rsdh-accent-red: #FF3D00;--rsdh-text: #F5F5F7;--rsdh-text-muted: #8E8E93;--rsdh-text-dim: #48484A;--rsdh-border: rgba(255, 255, 255, .08);--rsdh-border-accent: rgba(0, 229, 255, .3);--rsdh-glass: rgba(0, 0, 0, .4);--rsdh-ease-out: cubic-bezier(.34, 1.56, .64, 1);--rsdh-transition-fast: .12s ease;--rsdh-transition-base: .24s ease;--rsdh-transition-hero: .4s var(--rsdh-ease-out);--rsdh-shadow-lg: 0 24px 48px -12px rgba(0, 0, 0, .8);--rsdh-glow: 0 0 20px rgba(0, 229, 255, .2)}.texture-overlay{position:absolute;inset:0;pointer-events:none;opacity:.03;background-image:radial-gradient(circle at 2px 2px,white 1px,transparent 0);background-size:24px 24px}.panel{position:fixed;right:12px;top:12px;bottom:12px;width:440px;max-width:calc(100vw - 24px);z-index:2147483647;background:var(--rsdh-panel-bg);backdrop-filter:blur(32px) saturate(180%);-webkit-backdrop-filter:blur(32px) saturate(180%);color:var(--rsdh-text);border:1px solid var(--rsdh-border);border-radius:4px;box-shadow:var(--rsdh-shadow-lg);display:flex;flex-direction:column;overflow:hidden;animation:panelSlideIn var(--rsdh-transition-hero)}@keyframes panelSlideIn{0%{opacity:0;transform:translate(40px)}to{opacity:1;transform:translate(0)}}.header{display:flex;justify-content:space-between;align-items:center;padding:12px 20px;background:linear-gradient(90deg,rgba(0,229,255,.05) 0%,transparent 100%);border-bottom:1px solid var(--rsdh-border);position:relative}.title{font-weight:900;font-size:11px;text-transform:uppercase;letter-spacing:.15em;color:var(--rsdh-accent);display:flex;align-items:center;gap:8px}.title i{color:var(--rsdh-accent-green);font-style:normal}.ticker-container{background:#0000004d;height:32px;border-bottom:1px solid var(--rsdh-border);display:flex;align-items:center;overflow:hidden;font-size:10px;font-weight:700;text-transform:uppercase;position:relative}.ticker-label{background:var(--rsdh-accent);color:#000;padding:0 12px;height:100%;display:flex;align-items:center;flex-shrink:0;z-index:2;position:relative}.ticker-wrapper{flex:1;overflow:hidden;position:relative}.ticker-content{display:inline-flex;gap:12px;padding-left:20px;white-space:nowrap;animation:tickerScroll 25s linear infinite}@keyframes tickerScroll{0%{transform:translate(0)}to{transform:translate(-50%)}}.tabs{display:flex;padding:0 12px;gap:4px;background:#0003;border-bottom:1px solid var(--rsdh-border)}.tab{padding:14px 16px;background:transparent;border:none;border-bottom:2px solid transparent;color:var(--rsdh-text-muted);font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;cursor:pointer;transition:all var(--rsdh-transition-fast);width:auto;box-shadow:none}.tab:hover{color:var(--rsdh-text);background:#ffffff08;transform:none}.tab.active{color:var(--rsdh-accent);border-bottom-color:var(--rsdh-accent);background:linear-gradient(to top,rgba(0,229,255,.05),transparent)}.view{flex:1;min-height:0;overflow-y:auto;overflow-x:hidden;padding:24px}.view::-webkit-scrollbar{width:4px}.view::-webkit-scrollbar-track{background:transparent}.view::-webkit-scrollbar-thumb{background:var(--rsdh-text-dim);border-radius:2px}.card{background:#ffffff03;border:1px solid var(--rsdh-border);border-left:3px solid var(--rsdh-border);padding:16px;margin-bottom:16px;transition:all var(--rsdh-transition-base);position:relative;overflow:hidden}.card:hover{background:#ffffff08;border-color:var(--rsdh-border-accent);border-left-color:var(--rsdh-accent);transform:translate(4px)}.card:after{content:"";position:absolute;top:0;right:0;width:40px;height:40px;background:linear-gradient(45deg,transparent 50%,rgba(255,255,255,.02) 50%)}.h{font-weight:800;font-size:14px;text-transform:uppercase;letter-spacing:.05em;margin-bottom:12px;display:flex;justify-content:space-between;align-items:center}.sub{font-size:12px;line-height:1.6;color:var(--rsdh-text-muted)}.player-row{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--rsdh-border)}.player-rank{font-family:JetBrains Mono,monospace;font-size:10px;color:var(--rsdh-accent-green);font-weight:700}.player-info{flex:1}.player-name{font-weight:800;font-size:13px;color:#fff}.player-meta{font-size:10px;text-transform:uppercase;letter-spacing:.05em;color:var(--rsdh-text-dim)}.meter-container{height:4px;background:var(--rsdh-text-dim);border-radius:2px;margin-top:8px;overflow:hidden}.meter-fill{height:100%;background:linear-gradient(90deg,var(--rsdh-accent),var(--rsdh-accent-green));transition:width 1s var(--rsdh-ease-out)}button{background:#fff;color:#000;border:none;border-radius:2px;padding:12px 20px;font-weight:900;font-size:11px;text-transform:uppercase;letter-spacing:.1em;cursor:pointer;transition:all var(--rsdh-transition-fast);position:relative;overflow:hidden}button:hover{transform:translateY(-2px);box-shadow:0 4px 12px #fff3}button:active{transform:translateY(0)}button.secondary{background:transparent;color:var(--rsdh-text);border:1px solid var(--rsdh-border)}button.secondary:hover{background:#ffffff0d;border-color:var(--rsdh-text);box-shadow:none}button.accent{background:var(--rsdh-accent);color:#000}input[type=text],input[type=password],select{background:#0000004d;border:1px solid var(--rsdh-border);border-radius:2px;color:var(--rsdh-text);padding:10px 14px;font-size:12px;width:100%;transition:all var(--rsdh-transition-fast)}input:focus,select:focus{outline:none;border-color:var(--rsdh-accent);box-shadow:var(--rsdh-glow)}.status-pill{padding:2px 8px;border-radius:2px;font-size:9px;font-weight:900;text-transform:uppercase}.status-pulsing{animation:rsdh-pulse 2s infinite}@keyframes rsdh-pulse{0%{opacity:1}50%{opacity:.5}to{opacity:1}}.text-accent{color:var(--rsdh-accent)}.text-green{color:var(--rsdh-accent-green)}.text-red{color:var(--rsdh-accent-red)}.font-mono{font-family:JetBrains Mono,monospace}.flex-row{display:flex;align-items:center;gap:8px}.space-between{justify-content:space-between}.mt-12{margin-top:12px}.mb-12{margin-bottom:12px}.fab{border-radius:4px;background:var(--rsdh-bg);border:2px solid var(--rsdh-accent);color:var(--rsdh-accent);width:48px;height:48px;font-weight:900;box-shadow:0 8px 16px #00000080}.fab:hover{background:var(--rsdh-accent);color:#000;box-shadow:var(--rsdh-glow)}.spinner{width:24px;height:24px;border:2px solid var(--rsdh-text-dim);border-top-color:var(--rsdh-accent);border-radius:2px;animation:spin .6s linear infinite}.modal-overlay{background:#000000d9;backdrop-filter:blur(8px)}.modal-content{background:var(--rsdh-panel-bg);border:1px solid var(--rsdh-border);border-top:4px solid var(--rsdh-accent)}.hidden{display:none!important}';typeof window<"u"&&((window.__svelte??={}).v??=new Set).add("5");let tn=!1,mi=!1;function vi(){tn=!0}vi();const hi=1,gi=2,es=4,_i=8,yi=16,bi=1,xi=2,ke=Symbol(),wi="http://www.w3.org/1999/xhtml",Zn=!1;var Qn=Array.isArray,Si=Array.prototype.indexOf,Nn=Array.from,Ei=Object.defineProperty,rn=Object.getOwnPropertyDescriptor,ts=Object.getOwnPropertyDescriptors,Ai=Object.prototype,Ti=Array.prototype,ea=Object.getPrototypeOf,rs=Object.isExtensible;function ki(e){return e()}function ta(e){for(var t=0;t<e.length;t++)e[t]()}function ns(){var e,t,r=new Promise((n,s)=>{e=n,t=s});return{promise:r,resolve:e,reject:t}}const Ee=2,ra=4,In=8,Ci=1<<24,Mt=16,Lt=32,fr=64,Mn=128,ut=512,Ce=1024,De=2048,yt=4096,je=8192,Xt=16384,na=32768,Fr=65536,as=1<<17,ss=1<<18,$r=1<<19,os=1<<20,Dt=1<<25,pr=32768,aa=1<<21,sa=1<<22,Vt=1<<23,mr=Symbol("$state"),Pi=Symbol(""),Br=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Ri(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Oi(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ni(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ii(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Mi(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Li(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Di(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Fi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function $i(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Bi(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}function qi(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Gi(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function is(e){return e===this.v}function Ui(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ls(e){return!Ui(e,this.v)}let ue=null;function qr(e){ue=e}function cs(e,t=!1,r){ue={p:ue,i:!1,c:null,e:null,s:e,x:null,l:tn&&!t?{s:null,u:null,$:[]}:null}}function ds(e){var t=ue,r=t.e;if(r!==null){t.e=null;for(var n of r)Ps(n)}return t.i=!0,ue=t.p,{}}function nn(){return!tn||ue!==null&&ue.l===null}let vr=[];function us(){var e=vr;vr=[],ta(e)}function an(e){if(vr.length===0&&!on){var t=vr;queueMicrotask(()=>{t===vr&&us()})}vr.push(e)}function zi(){for(;vr.length>0;)us()}function fs(e){var t=X;if(t===null)return j.f|=Vt,e;if((t.f&na)===0){if((t.f&Mn)===0)throw e;t.b.error(e)}else Gr(e,t)}function Gr(e,t){for(;t!==null;){if((t.f&Mn)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e}const Ln=new Set;let J=null,sn=null,tt=null,rt=[],Dn=null,oa=!1,on=!1;class bt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#l=null;#s=new Set;#a=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#r>0}process(t){rt=[],sn=null,this.apply();var r={parent:null,effect:null,effects:[],render_effects:[]};for(const n of t)this.#o(n,r);this.is_fork||this.#d(),this.is_deferred()?(this.#i(r.effects),this.#i(r.render_effects)):(sn=this,J=null,ms(r.render_effects),ms(r.effects),sn=null,this.#l?.resolve()),tt=null}#o(t,r){t.f^=Ce;for(var n=t.first;n!==null;){var s=n.f,a=(s&(Lt|fr))!==0,i=a&&(s&Ce)!==0,c=i||(s&je)!==0||this.skipped_effects.has(n);if((n.f&Mn)!==0&&n.b?.is_pending()&&(r={parent:r,effect:n,effects:[],render_effects:[]}),!c&&n.fn!==null){a?n.f^=Ce:(s&ra)!==0?r.effects.push(n):pn(n)&&((n.f&Mt)!==0&&this.#s.add(n),mn(n));var l=n.first;if(l!==null){n=l;continue}}var d=n.parent;for(n=n.next;n===null&&d!==null;)d===r.effect&&(this.#i(r.effects),this.#i(r.render_effects),r=r.parent),n=d.next,d=d.parent}}#i(t){for(const r of t)(r.f&De)!==0?this.#s.add(r):(r.f&yt)!==0&&this.#a.add(r),this.#c(r.deps),Pe(r,Ce)}#c(t){if(t!==null)for(const r of t)(r.f&Ee)===0||(r.f&pr)===0||(r.f^=pr,this.#c(r.deps))}capture(t,r){this.previous.has(t)||this.previous.set(t,r),(t.f&Vt)===0&&(this.current.set(t,t.v),tt?.set(t,t.v))}activate(){J=this,this.apply()}deactivate(){J===this&&(J=null,tt=null)}flush(){if(this.activate(),rt.length>0){if(ps(),J!==null&&J!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#d(){if(this.#r===0){for(const t of this.#e)t();this.#e.clear()}this.#n===0&&this.#u()}#u(){if(Ln.size>1){this.previous.clear();var t=tt,r=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const a of Ln){if(a===this){r=!1;continue}const i=[];for(const[l,d]of this.current){if(a.current.has(l))if(r&&d!==a.current.get(l))a.current.set(l,d);else continue;i.push(l)}if(i.length===0)continue;const c=[...a.current.keys()].filter(l=>!this.current.has(l));if(c.length>0){var s=rt;rt=[];const l=new Set,d=new Map;for(const u of i)vs(u,c,l,d);if(rt.length>0){J=a,a.apply();for(const u of rt)a.#o(u,n);a.deactivate()}rt=s}}J=null,tt=t}this.committed=!0,Ln.delete(this)}increment(t){this.#n+=1,t&&(this.#r+=1)}decrement(t){this.#n-=1,t&&(this.#r-=1),this.revive()}revive(){for(const t of this.#s)this.#a.delete(t),Pe(t,De),hr(t);for(const t of this.#a)Pe(t,yt),hr(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=ns()).promise}static ensure(){if(J===null){const t=J=new bt;Ln.add(J),on||bt.enqueue(()=>{J===t&&t.flush()})}return J}static enqueue(t){an(t)}apply(){}}function Hi(e){var t=on;on=!0;try{for(var r;;){if(zi(),rt.length===0&&(J?.flush(),rt.length===0))return Dn=null,r;ps()}}finally{on=t}}function ps(){var e=br;oa=!0;var t=null;try{var r=0;for(Bn(!0);rt.length>0;){var n=bt.ensure();if(r++>1e3){var s,a;Yi()}n.process(rt),Zt.clear()}}finally{oa=!1,Bn(e),Dn=null}}function Yi(){try{Li()}catch(e){Gr(e,Dn)}}let Ft=null;function ms(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var n=e[r++];if((n.f&(Xt|je))===0&&pn(n)&&(Ft=new Set,mn(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?Is(n):n.fn=null),Ft?.size>0)){Zt.clear();for(const s of Ft){if((s.f&(Xt|je))!==0)continue;const a=[s];let i=s.parent;for(;i!==null;)Ft.has(i)&&(Ft.delete(i),a.push(i)),i=i.parent;for(let c=a.length-1;c>=0;c--){const l=a[c];(l.f&(Xt|je))===0&&mn(l)}}Ft.clear()}}Ft=null}}function vs(e,t,r,n){if(!r.has(e)&&(r.add(e),e.reactions!==null))for(const s of e.reactions){const a=s.f;(a&Ee)!==0?vs(s,t,r,n):(a&(sa|Mt))!==0&&(a&De)===0&&hs(s,t,n)&&(Pe(s,De),hr(s))}}function hs(e,t,r){const n=r.get(e);if(n!==void 0)return n;if(e.deps!==null)for(const s of e.deps){if(t.includes(s))return!0;if((s.f&Ee)!==0&&hs(s,t,r))return r.set(s,!0),!0}return r.set(e,!1),!1}function hr(e){for(var t=Dn=e;t.parent!==null;){t=t.parent;var r=t.f;if(oa&&t===X&&(r&Mt)!==0&&(r&ss)===0)return;if((r&(fr|Lt))!==0){if((r&Ce)===0)return;t.f^=Ce}}rt.push(t)}function ji(e){let t=0,r=gr(0),n;return()=>{un()&&(o(r),pa(()=>(t===0&&(n=Hr(()=>e(()=>ln(r)))),t+=1,()=>{an(()=>{t-=1,t===0&&(n?.(),n=void 0,ln(r))})})))}}var Ji=Fr|$r|Mn;function Ki(e,t,r){new Wi(e,t,r)}class Wi{parent;#e=!1;#t;#n=null;#r;#l;#s;#a=null;#o=null;#i=null;#c=null;#d=null;#u=0;#f=0;#m=!1;#p=null;#y=ji(()=>(this.#p=gr(this.#u),()=>{this.#p=null}));constructor(t,r,n){this.#t=t,this.#r=r,this.#l=n,this.parent=X.b,this.#e=!!this.#r.pending,this.#s=ma(()=>{X.b=this;{var s=this.#g();try{this.#a=nt(()=>n(s))}catch(a){this.error(a)}this.#f>0?this.#h():this.#e=!1}return()=>{this.#d?.remove()}},Ji)}#b(){try{this.#a=nt(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#x(){const t=this.#r.pending;t&&(this.#o=nt(()=>t(this.#t)),bt.enqueue(()=>{var r=this.#g();this.#a=this.#v(()=>(bt.ensure(),nt(()=>this.#l(r)))),this.#f>0?this.#h():(yr(this.#o,()=>{this.#o=null}),this.#e=!1)}))}#g(){var t=this.#t;return this.#e&&(this.#d=$t(),this.#t.before(this.#d),t=this.#d),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#v(t){var r=X,n=j,s=ue;St(this.#s),$e(this.#s),qr(this.#s.ctx);try{return t()}catch(a){return fs(a),null}finally{St(r),$e(n),qr(s)}}#h(){const t=this.#r.pending;this.#a!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#d),Ds(this.#a,this.#c)),this.#o===null&&(this.#o=nt(()=>t(this.#t)))}#_(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(t);return}this.#f+=t,this.#f===0&&(this.#e=!1,this.#o&&yr(this.#o,()=>{this.#o=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#_(t),this.#u+=t,this.#p&&_r(this.#p,this.#u)}get_effect_pending(){return this.#y(),o(this.#p)}error(t){var r=this.#r.onerror;let n=this.#r.failed;if(this.#m||!r&&!n)throw t;this.#a&&(Fe(this.#a),this.#a=null),this.#o&&(Fe(this.#o),this.#o=null),this.#i&&(Fe(this.#i),this.#i=null);var s=!1,a=!1;const i=()=>{if(s){Gi();return}s=!0,a&&Bi(),bt.ensure(),this.#u=0,this.#i!==null&&yr(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#v(()=>(this.#m=!1,nt(()=>this.#l(this.#t)))),this.#f>0?this.#h():this.#e=!1};var c=j;try{$e(null),a=!0,r?.(t,i),a=!1}catch(l){Gr(l,this.#s&&this.#s.parent)}finally{$e(c)}n&&an(()=>{this.#i=this.#v(()=>{bt.ensure(),this.#m=!0;try{return nt(()=>{n(this.#t,()=>t,()=>i)})}catch(l){return Gr(l,this.#s.parent),null}finally{this.#m=!1}})})}}function Xi(e,t,r,n){const s=nn()?ia:Ne;if(r.length===0&&e.length===0){n(t.map(s));return}var a=J,i=X,c=Vi();function l(){Promise.all(r.map(d=>Zi(d))).then(d=>{c();try{n([...t.map(s),...d])}catch(u){(i.f&Xt)===0&&Gr(u,i)}a?.deactivate(),Fn()}).catch(d=>{Gr(d,i)})}e.length>0?Promise.all(e).then(()=>{c();try{return l()}finally{a?.deactivate(),Fn()}}):l()}function Vi(){var e=X,t=j,r=ue,n=J;return function(a=!0){St(e),$e(t),qr(r),a&&n?.activate()}}function Fn(){St(null),$e(null),qr(null)}function ia(e){var t=Ee|De,r=j!==null&&(j.f&Ee)!==0?j:null;return X!==null&&(X.f|=$r),{ctx:ue,deps:null,effects:null,equals:is,f:t,fn:e,reactions:null,rv:0,v:ke,wv:0,parent:r??X,ac:null}}function Zi(e,t){let r=X;r===null&&Oi();var n=r.b,s=void 0,a=gr(ke),i=!j,c=new Map;return cl(()=>{var l=ns();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{d===J&&d.committed&&d.deactivate(),Fn()})}catch(m){l.reject(m),Fn()}var d=J;if(i){var u=!n.is_pending();n.update_pending_count(1),d.increment(u),c.get(d)?.reject(Br),c.delete(d),c.set(d,l)}const f=(m,h=void 0)=>{if(d.activate(),h)h!==Br&&(a.f|=Vt,_r(a,h));else{(a.f&Vt)!==0&&(a.f^=Vt),_r(a,m);for(const[k,S]of c){if(c.delete(k),k===d)break;S.reject(Br)}}i&&(n.update_pending_count(-1),d.decrement(u))};l.promise.then(f,m=>f(null,m||"unknown"))}),ua(()=>{for(const l of c.values())l.reject(Br)}),new Promise(l=>{function d(u){function f(){u===s?l(a):d(s)}u.then(f,f)}d(s)})}function Ne(e){const t=ia(e);return t.equals=ls,t}function gs(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)Fe(t[r])}}function Qi(e){for(var t=e.parent;t!==null;){if((t.f&Ee)===0)return(t.f&Xt)===0?t:null;t=t.parent}return null}function la(e){var t,r=X;St(Qi(e));try{e.f&=~pr,gs(e),t=zs(e)}finally{St(r)}return t}function _s(e){var t=la(e);if(e.equals(t)||(J?.is_fork||(e.v=t),e.wv=Gs()),!zr)if(tt!==null)(un()||J?.is_fork)&&tt.set(e,t);else{var r=(e.f&ut)===0?yt:Ce;Pe(e,r)}}let ca=new Set;const Zt=new Map;let ys=!1;function gr(e,t){var r={f:0,v:e,reactions:null,equals:is,rv:0,wv:0};return r}function Qt(e,t){const r=gr(e);return fl(r),r}function Z(e,t=!1,r=!0){const n=gr(e);return t||(n.equals=ls),tn&&r&&ue!==null&&ue.l!==null&&(ue.l.s??=[]).push(n),n}function A(e,t,r=!1){j!==null&&(!wt||(j.f&as)!==0)&&nn()&&(j.f&(Ee|Mt|sa|as))!==0&&!Bt?.includes(e)&&$i();let n=r?cn(t):t;return _r(e,n)}function _r(e,t){if(!e.equals(t)){var r=e.v;zr?Zt.set(e,t):Zt.set(e,r),e.v=t;var n=bt.ensure();n.capture(e,r),(e.f&Ee)!==0&&((e.f&De)!==0&&la(e),Pe(e,(e.f&ut)!==0?Ce:yt)),e.wv=Gs(),bs(e,De),nn()&&X!==null&&(X.f&Ce)!==0&&(X.f&(Lt|fr))===0&&(at===null?pl([e]):at.push(e)),!n.is_fork&&ca.size>0&&!ys&&el()}return t}function el(){ys=!1;var e=br;Bn(!0);const t=Array.from(ca);try{for(const r of t)(r.f&Ce)!==0&&Pe(r,yt),pn(r)&&mn(r)}finally{Bn(e)}ca.clear()}function ln(e){A(e,e.v+1)}function bs(e,t){var r=e.reactions;if(r!==null)for(var n=nn(),s=r.length,a=0;a<s;a++){var i=r[a],c=i.f;if(!(!n&&i===X)){var l=(c&De)===0;if(l&&Pe(i,t),(c&Ee)!==0){var d=i;tt?.delete(d),(c&pr)===0&&(c&ut&&(i.f|=pr),bs(d,yt))}else l&&((c&Mt)!==0&&Ft!==null&&Ft.add(i),hr(i))}}}function cn(e){if(typeof e!="object"||e===null||mr in e)return e;const t=ea(e);if(t!==Ai&&t!==Ti)return e;var r=new Map,n=Qn(e),s=Qt(0),a=xr,i=c=>{if(xr===a)return c();var l=j,d=xr;$e(null),qs(a);var u=c();return $e(l),qs(d),u};return n&&r.set("length",Qt(e.length)),new Proxy(e,{defineProperty(c,l,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Di();var u=r.get(l);return u===void 0?u=i(()=>{var f=Qt(d.value);return r.set(l,f),f}):A(u,d.value,!0),!0},deleteProperty(c,l){var d=r.get(l);if(d===void 0){if(l in c){const u=i(()=>Qt(ke));r.set(l,u),ln(s)}}else A(d,ke),ln(s);return!0},get(c,l,d){if(l===mr)return e;var u=r.get(l),f=l in c;if(u===void 0&&(!f||rn(c,l)?.writable)&&(u=i(()=>{var h=cn(f?c[l]:ke),k=Qt(h);return k}),r.set(l,u)),u!==void 0){var m=o(u);return m===ke?void 0:m}return Reflect.get(c,l,d)},getOwnPropertyDescriptor(c,l){var d=Reflect.getOwnPropertyDescriptor(c,l);if(d&&"value"in d){var u=r.get(l);u&&(d.value=o(u))}else if(d===void 0){var f=r.get(l),m=f?.v;if(f!==void 0&&m!==ke)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return d},has(c,l){if(l===mr)return!0;var d=r.get(l),u=d!==void 0&&d.v!==ke||Reflect.has(c,l);if(d!==void 0||X!==null&&(!u||rn(c,l)?.writable)){d===void 0&&(d=i(()=>{var m=u?cn(c[l]):ke,h=Qt(m);return h}),r.set(l,d));var f=o(d);if(f===ke)return!1}return u},set(c,l,d,u){var f=r.get(l),m=l in c;if(n&&l==="length")for(var h=d;h<f.v;h+=1){var k=r.get(h+"");k!==void 0?A(k,ke):h in c&&(k=i(()=>Qt(ke)),r.set(h+"",k))}if(f===void 0)(!m||rn(c,l)?.writable)&&(f=i(()=>Qt(void 0)),A(f,cn(d)),r.set(l,f));else{m=f.v!==ke;var S=i(()=>cn(d));A(f,S)}var b=Reflect.getOwnPropertyDescriptor(c,l);if(b?.set&&b.set.call(u,d),!m){if(n&&typeof l=="string"){var x=r.get("length"),R=Number(l);Number.isInteger(R)&&R>=x.v&&A(x,R+1)}ln(s)}return!0},ownKeys(c){o(s);var l=Reflect.ownKeys(c).filter(f=>{var m=r.get(f);return m===void 0||m.v!==ke});for(var[d,u]of r)u.v!==ke&&!(d in c)&&l.push(d);return l},setPrototypeOf(){Fi()}})}function xs(e){try{if(e!==null&&typeof e=="object"&&mr in e)return e[mr]}catch{}return e}function tl(e,t){return Object.is(xs(e),xs(t))}var ws,Ss,Es,As;function rl(){if(ws===void 0){ws=window,Ss=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;Es=rn(t,"firstChild").get,As=rn(t,"nextSibling").get,rs(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),rs(r)&&(r.__t=void 0)}}function $t(e=""){return document.createTextNode(e)}function er(e){return Es.call(e)}function dn(e){return As.call(e)}function p(e,t){return er(e)}function te(e,t=!1){{var r=er(e);return r instanceof Comment&&r.data===""?dn(r):r}}function v(e,t=1,r=!1){let n=e;for(;t--;)n=dn(n);return n}function nl(e){e.textContent=""}function Ts(){return!1}let ks=!1;function al(){ks||(ks=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function $n(e){var t=j,r=X;$e(null),St(null);try{return e()}finally{$e(t),St(r)}}function da(e,t,r,n=r){e.addEventListener(t,()=>$n(r));const s=e.__on_r;s?e.__on_r=()=>{s(),n(!0)}:e.__on_r=()=>n(!0),al()}function Cs(e){X===null&&(j===null&&Mi(),Ii()),zr&&Ni()}function sl(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function xt(e,t,r){var n=X;n!==null&&(n.f&je)!==0&&(e|=je);var s={ctx:ue,deps:null,nodes:null,f:e|De|ut,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{mn(s),s.f|=na}catch(c){throw Fe(s),c}else t!==null&&hr(s);var a=s;if(r&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&$r)===0&&(a=a.first,(e&Mt)!==0&&(e&Fr)!==0&&a!==null&&(a.f|=Fr)),a!==null&&(a.parent=n,n!==null&&sl(a,n),j!==null&&(j.f&Ee)!==0&&(e&fr)===0)){var i=j;(i.effects??=[]).push(a)}return s}function un(){return j!==null&&!wt}function ua(e){const t=xt(In,null,!1);return Pe(t,Ce),t.teardown=e,t}function fa(e){Cs();var t=X.f,r=!j&&(t&Lt)!==0&&(t&na)===0;if(r){var n=ue;(n.e??=[]).push(e)}else return Ps(e)}function Ps(e){return xt(ra|os,e,!1)}function ol(e){return Cs(),xt(In|os,e,!0)}function il(e){bt.ensure();const t=xt(fr|$r,e,!0);return(r={})=>new Promise(n=>{r.outro?yr(t,()=>{Fe(t),n(void 0)}):(Fe(t),n(void 0))})}function ll(e){return xt(ra,e,!1)}function cl(e){return xt(sa|$r,e,!0)}function pa(e,t=0){return xt(In|t,e,!0)}function O(e,t=[],r=[],n=[]){Xi(n,t,r,s=>{xt(In,()=>e(...s.map(o)),!0)})}function ma(e,t=0){var r=xt(Mt|t,e,!0);return r}function nt(e){return xt(Lt|$r,e,!0)}function Rs(e){var t=e.teardown;if(t!==null){const r=zr,n=j;$s(!0),$e(null);try{t.call(null)}finally{$s(r),$e(n)}}}function Os(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const s=r.ac;s!==null&&$n(()=>{s.abort(Br)});var n=r.next;(r.f&fr)!==0?r.parent=null:Fe(r,t),r=n}}function dl(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&Lt)===0&&Fe(t),t=r}}function Fe(e,t=!0){var r=!1;(t||(e.f&ss)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Ns(e.nodes.start,e.nodes.end),r=!0),Os(e,t&&!r),qn(e,0),Pe(e,Xt);var n=e.nodes&&e.nodes.t;if(n!==null)for(const a of n)a.stop();Rs(e);var s=e.parent;s!==null&&s.first!==null&&Is(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Ns(e,t){for(;e!==null;){var r=e===t?null:dn(e);e.remove(),e=r}}function Is(e){var t=e.parent,r=e.prev,n=e.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function yr(e,t,r=!0){var n=[];Ms(e,n,!0);var s=()=>{r&&Fe(e),t&&t()},a=n.length;if(a>0){var i=()=>--a||s();for(var c of n)c.out(i)}else s()}function Ms(e,t,r){if((e.f&je)===0){e.f^=je;var n=e.nodes&&e.nodes.t;if(n!==null)for(const c of n)(c.is_global||r)&&t.push(c);for(var s=e.first;s!==null;){var a=s.next,i=(s.f&Fr)!==0||(s.f&Lt)!==0&&(e.f&Mt)!==0;Ms(s,t,i?r:!1),s=a}}}function va(e){Ls(e,!0)}function Ls(e,t){if((e.f&je)!==0){e.f^=je,(e.f&Ce)===0&&(Pe(e,De),hr(e));for(var r=e.first;r!==null;){var n=r.next,s=(r.f&Fr)!==0||(r.f&Lt)!==0;Ls(r,s?t:!1),r=n}var a=e.nodes&&e.nodes.t;if(a!==null)for(const i of a)(i.is_global||t)&&i.in()}}function Ds(e,t){if(e.nodes)for(var r=e.nodes.start,n=e.nodes.end;r!==null;){var s=r===n?null:dn(r);t.append(r),r=s}}let Ur=null;function ul(e){var t=Ur;try{if(Ur=new Set,Hr(e),t!==null)for(var r of Ur)t.add(r);return Ur}finally{Ur=t}}function Fs(e){for(var t of ul(e))_r(t,t.v)}let br=!1;function Bn(e){br=e}let zr=!1;function $s(e){zr=e}let j=null,wt=!1;function $e(e){j=e}let X=null;function St(e){X=e}let Bt=null;function fl(e){j!==null&&(Bt===null?Bt=[e]:Bt.push(e))}let Ie=null,Je=0,at=null;function pl(e){at=e}let Bs=1,fn=0,xr=fn;function qs(e){xr=e}function Gs(){return++Bs}function pn(e){var t=e.f;if((t&De)!==0)return!0;if(t&Ee&&(e.f&=~pr),(t&yt)!==0){var r=e.deps;if(r!==null)for(var n=r.length,s=0;s<n;s++){var a=r[s];if(pn(a)&&_s(a),a.wv>e.wv)return!0}(t&ut)!==0&&tt===null&&Pe(e,Ce)}return!1}function Us(e,t,r=!0){var n=e.reactions;if(n!==null&&!Bt?.includes(e))for(var s=0;s<n.length;s++){var a=n[s];(a.f&Ee)!==0?Us(a,t,!1):t===a&&(r?Pe(a,De):(a.f&Ce)!==0&&Pe(a,yt),hr(a))}}function zs(e){var t=Ie,r=Je,n=at,s=j,a=Bt,i=ue,c=wt,l=xr,d=e.f;Ie=null,Je=0,at=null,j=(d&(Lt|fr))===0?e:null,Bt=null,qr(e.ctx),wt=!1,xr=++fn,e.ac!==null&&($n(()=>{e.ac.abort(Br)}),e.ac=null);try{e.f|=aa;var u=e.fn,f=u(),m=e.deps;if(Ie!==null){var h;if(qn(e,Je),m!==null&&Je>0)for(m.length=Je+Ie.length,h=0;h<Ie.length;h++)m[Je+h]=Ie[h];else e.deps=m=Ie;if(un()&&(e.f&ut)!==0)for(h=Je;h<m.length;h++)(m[h].reactions??=[]).push(e)}else m!==null&&Je<m.length&&(qn(e,Je),m.length=Je);if(nn()&&at!==null&&!wt&&m!==null&&(e.f&(Ee|yt|De))===0)for(h=0;h<at.length;h++)Us(at[h],e);return s!==null&&s!==e&&(fn++,at!==null&&(n===null?n=at:n.push(...at))),(e.f&Vt)!==0&&(e.f^=Vt),f}catch(k){return fs(k)}finally{e.f^=aa,Ie=t,Je=r,at=n,j=s,Bt=a,qr(i),wt=c,xr=l}}function ml(e,t){let r=t.reactions;if(r!==null){var n=Si.call(r,e);if(n!==-1){var s=r.length-1;s===0?r=t.reactions=null:(r[n]=r[s],r.pop())}}r===null&&(t.f&Ee)!==0&&(Ie===null||!Ie.includes(t))&&(Pe(t,yt),(t.f&ut)!==0&&(t.f^=ut,t.f&=~pr),gs(t),qn(t,0))}function qn(e,t){var r=e.deps;if(r!==null)for(var n=t;n<r.length;n++)ml(e,r[n])}function mn(e){var t=e.f;if((t&Xt)===0){Pe(e,Ce);var r=X,n=br;X=e,br=!0;try{(t&(Mt|Ci))!==0?dl(e):Os(e),Rs(e);var s=zs(e);e.teardown=typeof s=="function"?s:null,e.wv=Bs;var a;Zn&&mi&&(e.f&De)!==0&&e.deps}finally{br=n,X=r}}}async function vl(){await Promise.resolve(),Hi()}function o(e){var t=e.f,r=(t&Ee)!==0;if(Ur?.add(e),j!==null&&!wt){var n=X!==null&&(X.f&Xt)!==0;if(!n&&!Bt?.includes(e)){var s=j.deps;if((j.f&aa)!==0)e.rv<fn&&(e.rv=fn,Ie===null&&s!==null&&s[Je]===e?Je++:Ie===null?Ie=[e]:Ie.includes(e)||Ie.push(e));else{(j.deps??=[]).push(e);var a=e.reactions;a===null?e.reactions=[j]:a.includes(j)||a.push(j)}}}if(zr){if(Zt.has(e))return Zt.get(e);if(r){var i=e,c=i.v;return((i.f&Ce)===0&&i.reactions!==null||Ys(i))&&(c=la(i)),Zt.set(i,c),c}}else r&&(!tt?.has(e)||J?.is_fork&&!un())&&(i=e,pn(i)&&_s(i),br&&un()&&(i.f&ut)===0&&Hs(i));if(tt?.has(e))return tt.get(e);if((e.f&Vt)!==0)throw e.v;return e.v}function Hs(e){if(e.deps!==null){e.f^=ut;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&Ee)!==0&&(t.f&ut)===0&&Hs(t)}}function Ys(e){if(e.v===ke)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Zt.has(t)||(t.f&Ee)!==0&&Ys(t))return!0;return!1}function Hr(e){var t=wt;try{return wt=!0,e()}finally{wt=t}}const hl=-7169;function Pe(e,t){e.f=e.f&hl|t}function gl(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(mr in e)ha(e);else if(!Array.isArray(e))for(let t in e){const r=e[t];typeof r=="object"&&r&&mr in r&&ha(r)}}}function ha(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{ha(e[n],t)}catch{}const r=ea(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=ts(r);for(let s in n){const a=n[s].get;if(a)try{a.call(e)}catch{}}}}}const _l=new Set,js=new Set;function yl(e,t,r,n={}){function s(a){if(n.capture||vn.call(t,a),!a.cancelBubble)return $n(()=>r?.call(this,a))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?an(()=>{t.addEventListener(e,s,n)}):t.addEventListener(e,s,n),s}function de(e,t,r,n,s){var a={capture:n,passive:s},i=yl(e,t,r,a);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&ua(()=>{t.removeEventListener(e,i,a)})}let Js=null;function vn(e){var t=this,r=t.ownerDocument,n=e.type,s=e.composedPath?.()||[],a=s[0]||e.target;Js=e;var i=0,c=Js===e&&e.__root;if(c){var l=s.indexOf(c);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var d=s.indexOf(t);if(d===-1)return;l<=d&&(i=l)}if(a=s[i]||e.target,a!==t){Ei(e,"currentTarget",{configurable:!0,get(){return a||r}});var u=j,f=X;$e(null),St(null);try{for(var m,h=[];a!==null;){var k=a.assignedSlot||a.parentNode||a.host||null;try{var S=a["__"+n];S!=null&&(!a.disabled||e.target===a)&&S.call(a,e)}catch(b){m?h.push(b):m=b}if(e.cancelBubble||k===t||k===null)break;a=k}if(m){for(let b of h)queueMicrotask(()=>{throw b});throw m}}finally{e.__root=t,delete e.currentTarget,$e(u),St(f)}}}function Ks(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function hn(e,t){var r=X;r.nodes===null&&(r.nodes={start:e,end:t,a:null,t:null})}function w(e,t){var r=(t&bi)!==0,n=(t&xi)!==0,s,a=!e.startsWith("<!>");return()=>{s===void 0&&(s=Ks(a?e:"<!>"+e),r||(s=er(s)));var i=n||Ss?document.importNode(s,!0):s.cloneNode(!0);if(r){var c=er(i),l=i.lastChild;hn(c,l)}else hn(i,i);return i}}function Me(e=""){{var t=$t(e+"");return hn(t,t),t}}function Et(){var e=document.createDocumentFragment(),t=document.createComment(""),r=$t();return e.append(t,r),hn(t,r),e}function y(e,t){e!==null&&e.before(t)}const bl=["touchstart","touchmove"];function xl(e){return bl.includes(e)}function T(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function wl(e,t){return Sl(e,t)}const Yr=new Map;function Sl(e,{target:t,anchor:r,props:n={},events:s,context:a,intro:i=!0}){rl();var c=new Set,l=f=>{for(var m=0;m<f.length;m++){var h=f[m];if(!c.has(h)){c.add(h);var k=xl(h);t.addEventListener(h,vn,{passive:k});var S=Yr.get(h);S===void 0?(document.addEventListener(h,vn,{passive:k}),Yr.set(h,1)):Yr.set(h,S+1)}}};l(Nn(_l)),js.add(l);var d=void 0,u=il(()=>{var f=r??t.appendChild($t());return Ki(f,{pending:()=>{}},m=>{if(a){cs({});var h=ue;h.c=a}s&&(n.$$events=s),d=e(m,n)||{},a&&ds()}),()=>{for(var m of c){t.removeEventListener(m,vn);var h=Yr.get(m);--h===0?(document.removeEventListener(m,vn),Yr.delete(m)):Yr.set(m,h)}js.delete(l),f!==r&&f.parentNode?.removeChild(f)}});return El.set(d,u),d}let El=new WeakMap;class Al{anchor;#e=new Map;#t=new Map;#n=new Map;#r=new Set;#l=!0;constructor(t,r=!0){this.anchor=t,this.#l=r}#s=()=>{var t=J;if(this.#e.has(t)){var r=this.#e.get(t),n=this.#t.get(r);if(n)va(n),this.#r.delete(r);else{var s=this.#n.get(r);s&&(this.#t.set(r,s.effect),this.#n.delete(r),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),n=s.effect)}for(const[a,i]of this.#e){if(this.#e.delete(a),a===t)break;const c=this.#n.get(i);c&&(Fe(c.effect),this.#n.delete(i))}for(const[a,i]of this.#t){if(a===r||this.#r.has(a))continue;const c=()=>{if(Array.from(this.#e.values()).includes(a)){var d=document.createDocumentFragment();Ds(i,d),d.append($t()),this.#n.set(a,{effect:i,fragment:d})}else Fe(i);this.#r.delete(a),this.#t.delete(a)};this.#l||!n?(this.#r.add(a),yr(i,c,!1)):c()}}};#a=t=>{this.#e.delete(t);const r=Array.from(this.#e.values());for(const[n,s]of this.#n)r.includes(n)||(Fe(s.effect),this.#n.delete(n))};ensure(t,r){var n=J,s=Ts();if(r&&!this.#t.has(t)&&!this.#n.has(t))if(s){var a=document.createDocumentFragment(),i=$t();a.append(i),this.#n.set(t,{effect:nt(()=>r(i)),fragment:a})}else this.#t.set(t,nt(()=>r(this.anchor)));if(this.#e.set(n,t),s){for(const[c,l]of this.#t)c===t?n.skipped_effects.delete(l):n.skipped_effects.add(l);for(const[c,l]of this.#n)c===t?n.skipped_effects.delete(l.effect):n.skipped_effects.add(l.effect);n.oncommit(this.#s),n.ondiscard(this.#a)}else this.#s()}}function Tl(e){ue===null&&Ri(),tn&&ue.l!==null?kl(ue).m.push(e):fa(()=>{const t=Hr(e);if(typeof t=="function")return t})}function kl(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}function C(e,t,r=!1){var n=new Al(e),s=r?Fr:0;function a(i,c){n.ensure(i,c)}ma(()=>{var i=!1;t((c,l=!0)=>{i=!0,a(l,c)}),i||a(!1,null)},s)}function At(e,t){return t}function Cl(e,t,r){for(var n=[],s=t.length,a,i=t.length,c=0;c<s;c++){let f=t[c];yr(f,()=>{if(a){if(a.pending.delete(f),a.done.add(f),a.pending.size===0){var m=e.outrogroups;ga(Nn(a.done)),m.delete(a),m.size===0&&(e.outrogroups=null)}}else i-=1},!1)}if(i===0){var l=n.length===0&&r!==null;if(l){var d=r,u=d.parentNode;nl(u),u.append(d),e.items.clear()}ga(t,!l)}else a={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(a)}function ga(e,t=!0){for(var r=0;r<e.length;r++)Fe(e[r],t)}var Ws;function Tt(e,t,r,n,s,a=null){var i=e,c=new Map,l=(t&es)!==0;if(l){var d=e;i=d.appendChild($t())}var u=null,f=Ne(()=>{var x=r();return Qn(x)?x:x==null?[]:Nn(x)}),m,h=!0;function k(){b.fallback=u,Pl(b,m,i,t,n),u!==null&&(m.length===0?(u.f&Dt)===0?va(u):(u.f^=Dt,gn(u,null,i)):yr(u,()=>{u=null}))}var S=ma(()=>{m=o(f);for(var x=m.length,R=new Set,N=J,L=Ts(),U=0;U<x;U+=1){var Y=m[U],D=n(Y,U),I=h?null:c.get(D);I?(I.v&&_r(I.v,Y),I.i&&_r(I.i,U),L&&N.skipped_effects.delete(I.e)):(I=Rl(c,h?i:Ws??=$t(),Y,D,U,s,t,r),h||(I.e.f|=Dt),c.set(D,I)),R.add(D)}if(x===0&&a&&!u&&(h?u=nt(()=>a(i)):(u=nt(()=>a(Ws??=$t())),u.f|=Dt)),!h)if(L){for(const[ot,le]of c)R.has(ot)||N.skipped_effects.add(le.e);N.oncommit(k),N.ondiscard(()=>{})}else k();o(f)}),b={effect:S,items:c,outrogroups:null,fallback:u};h=!1}function Pl(e,t,r,n,s){var a=(n&_i)!==0,i=t.length,c=e.items,l=e.effect.first,d,u=null,f,m=[],h=[],k,S,b,x;if(a)for(x=0;x<i;x+=1)k=t[x],S=s(k,x),b=c.get(S).e,(b.f&Dt)===0&&(b.nodes?.a?.measure(),(f??=new Set).add(b));for(x=0;x<i;x+=1){if(k=t[x],S=s(k,x),b=c.get(S).e,e.outrogroups!==null)for(const le of e.outrogroups)le.pending.delete(b),le.done.delete(b);if((b.f&Dt)!==0)if(b.f^=Dt,b===l)gn(b,null,r);else{var R=u?u.next:l;b===e.effect.last&&(e.effect.last=b.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),tr(e,u,b),tr(e,b,R),gn(b,R,r),u=b,m=[],h=[],l=u.next;continue}if((b.f&je)!==0&&(va(b),a&&(b.nodes?.a?.unfix(),(f??=new Set).delete(b))),b!==l){if(d!==void 0&&d.has(b)){if(m.length<h.length){var N=h[0],L;u=N.prev;var U=m[0],Y=m[m.length-1];for(L=0;L<m.length;L+=1)gn(m[L],N,r);for(L=0;L<h.length;L+=1)d.delete(h[L]);tr(e,U.prev,Y.next),tr(e,u,U),tr(e,Y,N),l=N,u=Y,x-=1,m=[],h=[]}else d.delete(b),gn(b,l,r),tr(e,b.prev,b.next),tr(e,b,u===null?e.effect.first:u.next),tr(e,u,b),u=b;continue}for(m=[],h=[];l!==null&&l!==b;)(d??=new Set).add(l),h.push(l),l=l.next;if(l===null)continue}(b.f&Dt)===0&&m.push(b),u=b,l=b.next}if(e.outrogroups!==null){for(const le of e.outrogroups)le.pending.size===0&&(ga(Nn(le.done)),e.outrogroups?.delete(le));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||d!==void 0){var D=[];if(d!==void 0)for(b of d)(b.f&je)===0&&D.push(b);for(;l!==null;)(l.f&je)===0&&l!==e.fallback&&D.push(l),l=l.next;var I=D.length;if(I>0){var ot=(n&es)!==0&&i===0?r:null;if(a){for(x=0;x<I;x+=1)D[x].nodes?.a?.measure();for(x=0;x<I;x+=1)D[x].nodes?.a?.fix()}Cl(e,D,ot)}}a&&an(()=>{if(f!==void 0)for(b of f)b.nodes?.a?.apply()})}function Rl(e,t,r,n,s,a,i,c){var l=(i&hi)!==0?(i&yi)===0?Z(r,!1,!1):gr(r):null,d=(i&gi)!==0?gr(s):null;return{v:l,i:d,e:nt(()=>(a(t,l??r,d??s,c),()=>{e.delete(n)}))}}function gn(e,t,r){if(e.nodes)for(var n=e.nodes.start,s=e.nodes.end,a=t&&(t.f&Dt)===0?t.nodes.start:r;n!==null;){var i=dn(n);if(a.before(n),n===s)return;n=i}}function tr(e,t,r){t===null?e.effect.first=r:t.next=r,r===null?e.effect.last=t:r.prev=t}function Xs(e,t,r=!1,n=!1,s=!1){var a=e,i="";O(()=>{var c=X;if(i!==(i=t()??"")&&(c.nodes!==null&&(Ns(c.nodes.start,c.nodes.end),c.nodes=null),i!=="")){var l=i+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var d=Ks(l);if((r||n)&&(d=er(d)),hn(er(d),d.lastChild),r||n)for(;er(d);)a.before(er(d));else a.before(d)}})}function Ol(e,t,r){var n=e==null?"":""+e;return n===""?null:n}function Nl(e,t){return e==null?null:String(e)}function st(e,t,r,n,s,a){var i=e.__className;if(i!==r||i===void 0){var c=Ol(r);c==null?e.removeAttribute("class"):e.className=c,e.__className=r}return a}function kt(e,t,r,n){var s=e.__style;if(s!==t){var a=Nl(t);a==null?e.removeAttribute("style"):e.style.cssText=a,e.__style=t}return n}function Vs(e,t,r=!1){if(e.multiple){if(t==null)return;if(!Qn(t))return qi();for(var n of e.options)n.selected=t.includes(_n(n));return}for(n of e.options){var s=_n(n);if(tl(s,t)){n.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function Il(e){var t=new MutationObserver(()=>{Vs(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ua(()=>{t.disconnect()})}function Zs(e,t,r=t){var n=new WeakSet,s=!0;da(e,"change",a=>{var i=a?"[selected]":":checked",c;if(e.multiple)c=[].map.call(e.querySelectorAll(i),_n);else{var l=e.querySelector(i)??e.querySelector("option:not([disabled])");c=l&&_n(l)}r(c),J!==null&&n.add(J)}),ll(()=>{var a=t();if(e===document.activeElement){var i=sn??J;if(n.has(i))return}if(Vs(e,a,s),s&&a===void 0){var c=e.querySelector(":checked");c!==null&&(a=_n(c),r(a))}e.__value=a,s=!1}),Il(e)}function _n(e){return"__value"in e?e.__value:e.value}const Ml=Symbol("is custom element"),Ll=Symbol("is html");function ft(e,t){var r=_a(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function Qs(e,t){var r=_a(e);r.checked!==(r.checked=t??void 0)&&(e.checked=t)}function eo(e,t,r,n){var s=_a(e);s[t]!==(s[t]=r)&&(t==="loading"&&(e[Pi]=r),r==null?e.removeAttribute(t):typeof r!="string"&&Dl(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function _a(e){return e.__attributes??={[Ml]:e.nodeName.includes("-"),[Ll]:e.namespaceURI===wi}}var to=new Map;function Dl(e){var t=e.getAttribute("is")||e.nodeName,r=to.get(t);if(r)return r;to.set(t,r=[]);for(var n,s=e,a=Element.prototype;a!==s;){n=ts(s);for(var i in n)n[i].set&&r.push(i);s=ea(s)}return r}function ro(e,t,r=t){var n=new WeakSet;da(e,"input",async s=>{var a=s?e.defaultValue:e.value;if(a=ya(e)?ba(a):a,r(a),J!==null&&n.add(J),await vl(),a!==(a=t())){var i=e.selectionStart,c=e.selectionEnd,l=e.value.length;if(e.value=a??"",c!==null){var d=e.value.length;i===c&&c===l&&d>l?(e.selectionStart=d,e.selectionEnd=d):(e.selectionStart=i,e.selectionEnd=Math.min(c,d))}}}),Hr(t)==null&&e.value&&(r(ya(e)?ba(e.value):e.value),J!==null&&n.add(J)),pa(()=>{var s=t();if(e===document.activeElement){var a=sn??J;if(n.has(a))return}ya(e)&&s===ba(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function Gn(e,t,r=t){da(e,"change",n=>{var s=n?e.defaultChecked:e.checked;r(s)}),Hr(t)==null&&r(e.checked),pa(()=>{var n=t();e.checked=!!n})}function ya(e){var t=e.type;return t==="number"||t==="range"}function ba(e){return e===""?null:+e}function Fl(e=!1){const t=ue,r=t.l.u;if(!r)return;let n=()=>gl(t.s);if(e){let s=0,a={};const i=ia(()=>{let c=!1;const l=t.s;for(const d in l)l[d]!==a[d]&&(a[d]=l[d],c=!0);return c&&s++,s});n=()=>o(i)}r.b.length&&ol(()=>{no(t,n),ta(r.b)}),fa(()=>{const s=Hr(()=>r.m.map(ki));return()=>{for(const a of s)typeof a=="function"&&a()}}),r.a.length&&fa(()=>{no(t,n),ta(r.a)})}function no(e,t){if(e.l.s)for(const r of e.l.s)o(r);t()}function pt(e,t=document){return Array.from(t.querySelectorAll(e))}function ne(e){const t=e;return String(t&&(t.innerText||t.textContent)||"").trim()}const $l=["Select 5 players","Press two player","Press two players","to swap"],ao=/(\d+(?:\.\d+)?)x\b/gi,Bl=/^\+(\d+(?:\.\d+)?)x\b/i,ql=200,so=["NFL","NHL","NBA","MLB","CFB","CBB","FC","WNBA"],oo="rsdh_accent_rgb",xa="rsdh_openrouter_api_key",wa="rsdh_openrouter_model",Sa="rsdh_openrouter_temp",Ea="rsdh_openrouter_max_tokens",Aa="rsdh_openrouter_web_max_results",Un="rsdh_openrouter_structured_json",zn="rsdh_openrouter_response_healing",wr="google/gemini-2.5-flash",Hn=.2,Yn=1e3,yn=2,Gl=!0,Ul=!0,zl="https://openrouter.ai/api/v1/chat/completions",jn="https://rsdh-proxy.cloudflare-okay454.workers.dev",Hl="H8UIBeO5C9BJ8Ze8WUXb+Y+x4wuNp2K+Lz+HwVdanBk=",bn=!!jn,io="rsdh_last_payload",Ta="rsdh_last_ai_sources",Yl="rsdh_last_ai_json",lo="rsdh_last_tool_trace",Jn="rsdh_last_debug_events",jl="rsdh_last_messages",Sr="rsdh_force_tool_call",Er="rsdh_force_search_tool",Ar="rsdh_bypass_proxy",xn="rsdh_enable_profile_tool",ka="rsdh_enable_web_search",wn="rsdh_enable_search_tool",Ca="rsdh_lineup_strategy";function F(e,t){try{if(typeof GM_getValue=="function")return GM_getValue(e,t)}catch{}try{const r=localStorage.getItem(e);return r??t}catch{return t}}function ye(e,t){try{if(typeof GM_setValue=="function"){GM_setValue(e,t);return}}catch{}try{localStorage.setItem(e,String(t))}catch{}}function Tr(){try{return localStorage.getItem("rsdh_debug_mode")==="1"}catch{return!1}}function Jl(e){try{localStorage.setItem("rsdh_debug_mode",e?"1":"0")}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-debug-mode",{detail:{on:e}}))}catch{}}class Kl{strategyType="league";detect(){return{type:"league",confidence:.5,evidence:["default_draft_type"]}}scrapeGameData(){return{games:fo()}}buildPayloadFields(){return{draft_type:"league"}}}class Wl{strategyType="game";detection;constructor(t){this.detection=t}detect(){return this.detection}scrapeGameData(){return{gameMatchup:nc()??void 0}}buildPayloadFields(){const t={draft_type:"game"};return this.detection.entriesRemaining!==null&&this.detection.entriesRemaining!==void 0&&(t.game_entries_remaining=this.detection.entriesRemaining),t}}function Xl(){const e=[];let t=0,r=0;const n=/^(\d+)\s+(NFL|NHL|NBA|MLB|CFB|CBB|FC|WNBA)\s+entr(?:y|ies)\s+remaining\s+today$/i,s=typeof document<"u"?Array.from(document.querySelectorAll("div")):[];for(const a of s){const c=(a.textContent||"").trim().match(n);if(c)return t+=3,e.push(`entries_text:"${c[0]}"`),{type:"game",confidence:1,evidence:e,sport:c[2].toUpperCase(),entriesRemaining:parseInt(c[1],10)}}if(typeof document<"u"){const a=Array.from(document.querySelectorAll("svg"));for(const i of a){const c=Array.from(i.querySelectorAll("path"));for(const l of c)if((l.getAttribute("d")||"").startsWith("M53.21 467"))return t+=2,e.push("clear_button_svg_detected"),{type:"game",confidence:.9,evidence:e,sport:null,entriesRemaining:null}}}if(typeof location<"u"){const a=location.href.toLowerCase();(a.includes("/game/")||a.includes("game_id=")||a.includes("matchup="))&&(t+=1,e.push("game_url_pattern")),(a.includes("/nfl")||a.includes("/nba")||a.includes("/nhl")||a.includes("/mlb"))&&(r+=1,e.push("sport_url_pattern"))}if(typeof document<"u"){const a=fo();a.length>=2?(r+=1,e.push(`multiple_games_in_sidebar:${a.length}`)):a.length===1&&e.push(`single_game_in_sidebar:${a.length}`)}return t>r?{type:"game",confidence:Math.min(.8,t/3),evidence:e,sport:null,entriesRemaining:null}:{type:"league",confidence:Math.min(.7,r/2),evidence:e}}class Vl{createStrategy(t){switch(t.type){case"game":return new Wl(t);case"league":default:return new Kl}}autoDetect(){const t=Xl();return this.createStrategy(t)}}let Pa=null;function Zl(){return Pa||(Pa=new Vl),Pa}function jr(e){const r=String(e||"").match(/rgba?\(\s*(\d+)[,\s]+(\d+)[,\s]+(\d+)/i);return r?{r:parseInt(r[1],10),g:parseInt(r[2],10),b:parseInt(r[3],10)}:null}function Ql(e){return(.2126*e.r+.7152*e.g+.0722*e.b)/255}function Ra(e,t){const r=e.r-t.r,n=e.g-t.g,s=e.b-t.b;return Math.sqrt(r*r+n*n+s*s)}function ec(e){const t=Math.max(e.r,e.g,e.b),r=Math.min(e.r,e.g,e.b);return(t-r)/255}function co(e){const t=String(e||"").toLowerCase();return t==="transparent"||t.includes("rgba(")&&t.endsWith(", 0)")||t.includes(",0)")}function tc(){const e=Math.max(240,window.innerHeight*.6),t=pt("div,nav,aside").map(r=>{try{const n=r.getBoundingClientRect();return n.width<40||n.width>95||n.height<e||n.left>40||n.top>80?null:{el:r,area:n.width*n.height}}catch{return null}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function rc(){function e(){try{const i=localStorage.getItem(oo);if(!i)return null;const c=JSON.parse(i);return!c||typeof c.r!="number"||typeof c.g!="number"||typeof c.b!="number"?null:{r:c.r,g:c.g,b:c.b}}catch{return null}}function t(i){try{localStorage.setItem(oo,JSON.stringify(i))}catch{}}const r=tc()||document,n=r===document?null:(()=>{try{const i=r.getBoundingClientRect();return{top:i.top,height:i.height}}catch{return null}})(),s=pt("div,button,a,span",r).map(i=>{try{const c=i.getBoundingClientRect();if(c.width<16||c.width>80||c.height<16||c.height>80||c.width/c.height<.7||c.width/c.height>1.3)return null;const l=getComputedStyle(i),d=parseFloat(l.borderWidth||"0"),u=parseFloat(l.outlineWidth||"0");if((Number.isNaN(d)||d<=0)&&(Number.isNaN(u)||u<=0))return null;const f=jr(l.borderColor)||jr(l.outlineColor);if(!f)return null;const m=ec(f);if(m<.1)return null;let h=1;n&&(h=(c.top-n.top)/Math.max(1,n.height)>.4?1.4:.8);const k=Math.min(c.width,c.height)>=20?1.1:1,S=(m*3+(d>=2?.2:0))*h*k;return{rgb:f,score:S}}catch{return null}}).filter(Boolean);if(s.length===0){const i=e();return i?{rgb:i,source:"cache",scope:r===document?"document":"sidebar"}:null}s.sort((i,c)=>c.score-i.score);const a=s[0];return t(a.rgb),{rgb:a.rgb,source:"borderColor",scope:r===document?"document":"sidebar"}}function uo(){const t=pt("div,nav,header").filter(d=>{const u=ne(d);return u?so.filter(m=>u.includes(m)).length>=4:!1})[0]||null;if(!t)return{sport:null,method:"not_found"};const r=so.filter(d=>ne(t).includes(d)),n=pt("a,button,[role='tab'],[role='button'],div,span",t).map(d=>({el:d,t:ne(d)})).filter(d=>r.includes(d.t));function s(d){const u=d.getAttribute("aria-selected"),f=d.getAttribute("aria-current");if(u==="true"||f&&f!=="false"||d.getAttribute("data-active")==="true"||d.getAttribute("data-state")==="active")return!0;const m=(d.className||"").toString().toLowerCase();return!!(m.includes("active")||m.includes("selected")||m.includes("current"))}const a=n.find(d=>s(d.el));if(a)return{sport:String(a.t),method:"navbar_active_attr"};const i=rc();if(i?.rgb&&n.length>0){const d=n.map(u=>{let f=1/0;try{const m=getComputedStyle(u.el),h=jr(m.color),k=jr(m.borderBottomColor),S=jr(m.borderColor);h&&(f=Math.min(f,Ra(i.rgb,h))),k&&!co(m.borderBottomColor)&&(f=Math.min(f,Ra(i.rgb,k))),S&&!co(m.borderColor)&&(f=Math.min(f,Ra(i.rgb,S)))}catch{}return{sport:String(u.t),dist:f}}).sort((u,f)=>u.dist-f.dist);if(d.length>0&&d[0].dist<60)return{sport:d[0].sport,method:"navbar_theme_accent",accent:i}}if(n.length>0){const d=n.map(u=>{let f=0;try{const m=getComputedStyle(u.el),h=parseInt(m.fontWeight,10);!Number.isNaN(h)&&h>=600&&(f+=2);const k=parseFloat(m.opacity);!Number.isNaN(k)&&k>=.95&&(f+=1),(m.textDecorationLine||"").includes("underline")&&(f+=2);const S=parseFloat(m.borderBottomWidth);!Number.isNaN(S)&&S>0&&(m.borderBottomStyle||"")!=="none"&&(f+=2);const b=jr(m.color);b&&(f+=Ql(b))}catch{}return{sport:String(u.t),score:f}}).sort((u,f)=>f.score-u.score);if(d.length===1)return{sport:d[0].sport,method:"navbar_style_single"};if(d.length>=2&&d[0].score-d[1].score>=1)return{sport:d[0].sport,method:"navbar_style_score"}}const c=location.href.toUpperCase(),l=r.find(d=>c.includes("/"+d+"/")||c.endsWith("/"+d)||c.includes("SPORT="+d));return l?{sport:String(l),method:"url_hint"}:{sport:null,method:"navbar_no_active"}}function fo(){const e=[],t=pt('div[tabindex="0"]').filter(r=>{const n=(r.textContent||"").trim();if(!n||/\+\d+\.?\d*x/i.test(n))return!1;const s=/\d{1,2}:\d{2}\s*(AM|PM)/i.test(n),a=/\bFinal\b/i.test(n);return s||a});for(const r of t)try{const n=Array.from(r.querySelectorAll('div[dir="auto"]')),s=ne(r),a=/\bFinal\b/i.test(s),i=/\d{1,2}:\d{2}\s*(AM|PM)/i.test(s);let c="",l="",d=null,u=null,f=null,m=null;const h=/^\d{1,2}-\d{1,2}(-\d{1,2})?$/,k=/^\d{1,2}$/,S=/^(\d{1,2}|:|AM|PM|\d{2}\s*(AM|PM)|Final)$/i,b=[],x=[],R=[],N=[];for(const U of n){const Y=(U.textContent||"").trim();Y&&(h.test(Y)?N.push(Y):k.test(Y)&&a?x.push(Y):S.test(Y)?b.push(Y):Y.length>2&&Y.length<25&&!Y.includes("%")&&/^[A-Za-z\s]+$/.test(Y)&&R.push(Y))}R.length>=2?(c=R[0],l=R[1]):R.length===1&&(c=R[0]),a&&x.length>=2?f=`${x[0]}-${x[1]}`:N.length>=2?(d=N[0],u=N[1]):N.length===1&&(d=N[0]),b.length>0&&!a&&(m=b.join("").replace(/\s+/g," ").trim(),m||(m=b.filter(U=>U!==":").join(":").replace("::",":")),m=m.replace(/\d+$/,"").trim());let L="upcoming";a?L="finished":m&&(L="upcoming"),c&&l&&e.push({team1:c,team1_record:d,team2:l,team2_record:u,time:m,status:L,score:f})}catch{}return e}function nc(){const e=new Set(["games","game","nfl","nba","nhl","mlb","cfb","cbb","wnba","fc","ufc","golf","final","live","upcoming","finished","draft","update","submit","cancel","close","settings","home","profile","menu","pm","am"]),t=pt("div").filter(x=>{const R=x.getAttribute("style")||"",N=R.includes("background-color: rgb(0, 0, 0)")||R.includes("background-color:rgb(0,0,0)"),L=R.includes("border-bottom")||R.includes("border-color");if(!N||!L||Array.from(x.querySelectorAll('div[tabindex="0"]')).filter(D=>{const I=D.querySelectorAll("img");return Array.from(I).some(ot=>(ot.getAttribute("src")||"").includes("media.realapp.com/assets/teams"))}).length!==2)return!1;const Y=(x.textContent||"").trim();return!/\+\d+\.?\d*x/i.test(Y)});if(t.length===0)return null;const r=t[0],n=Array.from(r.querySelectorAll('div[tabindex="0"]')).filter(x=>{const R=x.querySelectorAll("img");return Array.from(R).some(N=>(N.getAttribute("src")||"").includes("media.realapp.com/assets/teams"))}).slice(0,2),s=/^\d{1,2}-\d{1,2}(-\d{1,2})?$/,a=/^\d{1,3}$/;function i(x){const R=Array.from(x.querySelectorAll('div[dir="auto"]'));let N="",L=null,U=null;for(const Y of R){const D=(Y.textContent||"").trim();if(!D)continue;const I=D.toLowerCase();e.has(I)||(s.test(D)?L=D:a.test(D)?U=parseInt(D,10):D.length>=3&&D.length<=25&&/^[A-Za-z]+$/.test(D)&&(N=D))}return{name:N,record:L,score:U}}const c=n.length>=1?i(n[0]):{name:"",record:null,score:null},l=n.length>=2?i(n[1]):{name:"",record:null,score:null};if(!c.name&&!l.name)return null;let d=null,u=null,f=!1;const h=(r.textContent||"").match(/\d{1,2}:\d{2}\s*(AM|PM)/i);h&&(d=h[0]);const k=new Set(n.flatMap(x=>Array.from(x.querySelectorAll('div[dir="auto"]')))),S=Array.from(r.querySelectorAll('div[dir="auto"]'));for(const x of S){if(k.has(x))continue;const R=(x.textContent||"").trim();R.toLowerCase()==="final"?f=!0:/^[A-Z]{2,4}\s+by\s+\d+(\.\d+)?$/i.test(R)&&(u=R)}let b="upcoming";return f||c.score!==null&&l.score!==null?b="finished":d&&(b="upcoming"),{team1:c.name,team1_record:c.record,team1_score:c.score,team2:l.name,team2_record:l.record,team2_score:l.score,time:d,spread:u,status:b}}function kr(){const e=document.querySelector("#rsdh-modal-actions");if(e){let r=e;for(let n=0;n<18&&r;n++){if((ne(r).match(/\d+(?:\.\d+)?x\b/gi)||[]).length>=3)return r;r=r.parentElement}return e.parentElement}const t=pt('div[tabindex="0"]');for(const r of t){const n=ne(r);if(!n)continue;const s=/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n),a=(n.match(/\d+(?:\.\d+)?x\b/gi)||[]).length;if(s&&a>=3)return r}for(const r of t){const n=ne(r);if(n&&/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n))return r}return null}function ac(e,t=[]){let r=-1;for(const n of t){const s=e.indexOf(n);s!==-1&&(r===-1||s<r)&&(r=s)}return r===-1?e:e.slice(0,r)}function sc(e,t=[]){let r=-1;for(const s of t){const a=e.indexOf(s);a!==-1&&(r===-1||a<r)&&(r=a)}if(r===-1)return"";const n=e.indexOf(`
`,r);return n===-1?"":e.slice(n+1)}function po(e,t=[],r=null){e=ac(e,t);const n=[];ao.lastIndex=0;let s;for(;(s=ao.exec(e))!==null;)s.index>0&&e[s.index-1]==="+"||n.push({idx:s.index,end:s.index+s[0].length,mult:parseFloat(s[1])});const a=[];for(let i=0;i<n.length&&!(typeof r=="number"&&a.length>=r);i++){const c=n[i],l=n[i+1];let d=e.slice(c.end,l?l.idx:e.length).trim();for(const m of t){const h=d.indexOf(m);h!==-1&&(d=d.slice(0,h).trim())}d=d.split(`
`)[0].trim(),d.length>80&&(d=d.slice(0,80).trim());let u=d||null,f=!1;u&&u.toLowerCase()==="empty"&&(u=null,f=!0),a.push({multiplier:c.mult,selection:u,is_empty:f})}return a}function oc(e){const t=sc(e,["Press two player","Press two players"]);if(!t)return[];const r=t.split(`
`).map(i=>(i||"").trim()).filter(Boolean),n=[];let s=null;function a(){s&&(s.name&&!/%$/.test(s.name.trim())&&n.push(s),s=null)}for(const i of r){if(/^(submit|update|cancel|close|done)$/i.test(i)){a();break}if(/^(draft lineup)$/i.test(i)||/^\d+%$/.test(i))continue;const c=i.match(Bl);if(c){const f=parseFloat(c[1]);s?s.boost_x=f:n.length>0&&n[n.length-1].boost_x==null&&(n[n.length-1].boost_x=f),s&&a();continue}const l=i.split("").map(f=>f.trim()).filter(Boolean),d=l[0]||i,u=l.length>1?l.slice(1).join("  "):null;s&&a(),s={name:d,status:u,boost_x:null}}return a(),n}function mo(e){const t=/\+(\d+(?:\.\d+)?)x\b/i,r=pt("div[tabindex='0'],div[tabindex='-1'],[role='button'],button,a",e).filter(a=>{const i=ne(a);if(!i)return!1;const c=a.getBoundingClientRect();return c.width>120&&c.height>=28?t.test(i)?!0:!(a.querySelector("img")!==null)||i.includes("Submit")||i.includes("Update")||i.includes("Draft")?!1:/[a-zA-Z]{2,}/.test(i)&&i.length<100:!1}).slice(0,400),n=new Set,s=[];for(const a of r){const i=ne(a),c=i.match(t);let l=null;c&&(l=parseFloat(c[1]),Number.isFinite(l)||(l=null));const u=(c?i.slice(0,i.toLowerCase().lastIndexOf(c[0].toLowerCase())).trim():i.trim()).split("").map(x=>x.trim()).filter(Boolean),f=u[0]||"";if(!f)continue;const m=u.length>1?u.slice(1).join("  "):null,h=f.toLowerCase();if(n.has(h))continue;let k=null;const S=a.querySelector("a[href]")||a.parentElement?.querySelector("a[href]")||a.closest("a[href]");if(S?.getAttribute("href")&&(k=S.getAttribute("href")),!k){const x=a.querySelector("svg")||a.parentElement?.querySelector("svg"),R=x?x.closest("a[href]"):null;R?.getAttribute("href")&&(k=R.getAttribute("href"))}const b=k?new URL(k,location.href).toString():null;s.push({name:f,status:m,boost_x:l,profile_url:b}),n.add(h)}return s}function ic(){const e=pt("div,button").filter(n=>{const s=ne(n);return s.includes("Draft")&&/\bUpdate\b/i.test(s)&&/\bx\b/i.test(s)}),t=new Set,r=[];for(const n of e){const s=ne(n);!s||t.has(s)||(t.add(s),r.push(n))}return r.slice(0,10)}function lc(){function e(n){try{n.scrollIntoView({block:"center",inline:"center"})}catch{}try{n.focus()}catch{}let s=0,a=0;try{const i=n.getBoundingClientRect();s=Math.max(1,Math.floor(i.left+i.width/2)),a=Math.max(1,Math.floor(i.top+i.height/2))}catch{}try{const i=window.PointerEvent;typeof i=="function"&&(n.dispatchEvent(new i("pointerdown",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:s,clientY:a})),n.dispatchEvent(new i("pointerup",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:s,clientY:a})))}catch{}try{n.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:a}))}catch{}try{n.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:a}))}catch{}try{n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:a}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.click()}catch{}}const t=document.querySelector("#realrootcontents")||document,r=pt("div[tabindex='0'],button,[role='button'],a,span",t).map(n=>{const s=ne(n);if(!s||!/^(draft|update)$/i.test(s.trim()))return null;const a=n.getBoundingClientRect();if(!(a.width>=60&&a.width<=500&&a.height>=20&&a.height<=80))return null;const i=a.top>=0&&a.top<=window.innerHeight?1.5:1,c=a.width*i;return{el:n,score:c,text:s.trim()}}).filter(Boolean);return r.length===0?!1:(r.sort((n,s)=>s.score-n.score),e(r[0].el),!0)}async function cc(e){const t=e.timeoutMs,r=Date.now();function n(){return document.querySelector("#rsdh-modal-actions")?!0:!!kr()}function s(){const c=document.querySelector("#realrootcontents")||document,l=pt("div[tabindex='0'],button,[role='button'],a,span",c).map(d=>{const u=ne(d);if(!u||!/^(draft|update)$/i.test(u.trim()))return null;const f=d.getBoundingClientRect();return f.width>=60&&f.width<=500&&f.height>=20&&f.height<=80?{el:d,width:f.width}:null}).filter(Boolean);return l.length===0?null:(l.sort((d,u)=>u.width-d.width),l[0].el)}function a(c){try{const l=c.getBoundingClientRect(),d=Math.floor(l.left+l.width/2),u=Math.floor(l.top+l.height/2),f=document.elementFromPoint(d,u);return f===c||!!f&&c.contains(f)}catch{return!0}}for(;Date.now()-r<t;){if(n())return{clicked:!1,opened:!0};const c=s();if(c&&a(c))break;await new Promise(l=>setTimeout(l,200))}let i=!1;for(let c=0;c<3&&Date.now()-r<t;c++){if(n())return{clicked:i,opened:!0};const l=s();if(!l){await new Promise(u=>setTimeout(u,250));continue}try{i=lc()||i}catch{}if(!n()){const u=l.parentElement;if(u){try{u.scrollIntoView({block:"center"})}catch{}try{u.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0}))}catch{}}}if(await new Promise(u=>{const f=Date.now()+2200,m=()=>{if(n())return u(!0);if(Date.now()>f)return u(!1);setTimeout(m,100)};m()}))return{clicked:i,opened:!0};await new Promise(u=>setTimeout(u,350))}return{clicked:i,opened:n()}}function dc(e){const t=ne(e),r=["Update",...$l],n=po(t,r);return{text:t.slice(0,500),slots:n}}function uc(e={}){const t=typeof e.includeDebug=="boolean"?e.includeDebug:Tr(),r=uo(),n=kr();if(!n){const b=ic().map(dc).filter(x=>x.slots.length>0);return b.length===0?{ok:!1,error:"Draft modal not found. Click the site's Draft/Update button to open the Draft Lineup modal, then click Capture again.",url:location.href,sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{}}:{ok:!0,mode:"tile",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{},drafts:b}}const s=ne(n),a=s.match(/Select\s+(\d+)\s+players/i),i=a?parseInt(a[1],10):null,l=po(s,["Press two player","Press two players"],i),d=mo(n),u=d.length>0?d:oc(s),m=Zl().autoDetect(),h=m.detect(),k=m.scrapeGameData(),S=m.buildPayloadFields();return{ok:!0,mode:"modal",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,...S,...k.games?.length?{games:k.games}:{},...k.gameMatchup?{game_matchup:k.gameMatchup}:{},...t?{sport_detection:r}:{},...t?{modal_text_sample:s.slice(0,400)}:{},...t?{draft_detection:{type:h.type,confidence:h.confidence,evidence:h.evidence}}:{},expected_slots:i,slots:l,player_pool_count:u.length,player_pool:u}}const fc=[2,1.8,1.6,1.4,1.2];function pc(e){if(!e)return{injuryStatus:"",projections:""};const t=/\b(Active|Questionable|Doubtful|Out|Inactive|IR|COVID|Probable)\b/i,r=e.match(t);if(r){const n=r[0],s=e.replace(t,"").replace(/^[\s,]+|[\s,]+$/g,"").trim();return{injuryStatus:n,projections:s}}return{injuryStatus:"",projections:e}}function vo(e){let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]);const r=Array.isArray(e?.player_pool)?e.player_pool:[],n=(t||[]).map((x,R)=>{const N=fc[R]??x.multiplier;if(x.selection){const L=x.selection.toLowerCase(),U=r.find(I=>I?.name?.toLowerCase()===L),Y=U&&typeof U.boost_x=="number"?U.boost_x:0,D=N+Y;return`- slot ${R+1}: slot_mult=${N}x + player_boost=+${Y}x = effective=${D}x, selected="${x.selection}"`}else return`- slot ${R+1}: slot_mult=${N}x, selected=<empty>`}).join(`
`),s=r.slice(0,ql),a=e?.draft_type||"league",i=s.map(x=>{const{injuryStatus:R,projections:N}=pc(x.status),L=typeof x.boost_x=="number"?` +${x.boost_x}x`:"";if(a==="game"){const U=R?` (${R})`:"",Y=N?` | Proj: ${N}`:"";return`- ${x.name}${U}${Y}${L}`}else{const U=R?` (${R})`:"";return`- ${x.name}${U}${L}`}}).join(`
`),c=r.length>s.length?`NOTE: player pool truncated to first ${s.length} of ${r.length} for prompt size. For the full list, re-capture and inspect the payload in Debug Mode.`:`Player pool items: ${r.length}.`,l=typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:Array.isArray(t)?t.length:5,d=e?.game_matchup,u=Array.isArray(e?.games)?e.games:[];let f=[];if(a==="game"&&d){const x=d.team1+(d.team1_record?` (${d.team1_record})`:""),R=d.team2+(d.team2_record?` (${d.team2_record})`:"");let N="";d.status==="finished"&&d.team1_score!==null&&d.team2_score!==null?N=`Final: ${d.team1} ${d.team1_score} - ${d.team2} ${d.team2_score}`:d.time?N=`Game time: ${d.time}`:d.status==="live"&&(N="Game in progress"),f=["### Game Draft (Single Matchup)","This is a GAME DRAFT for a specific matchup, not a league-wide draft.",`Matchup: ${x} vs ${R}`,...N?[N]:[],...d.spread?[`Spread: ${d.spread}`]:[],...typeof e?.game_entries_remaining=="number"?[`Entries remaining today: ${e.game_entries_remaining}`]:[],"All players in the pool are from these two teams ONLY.",""]}else u.length>0&&(f=["### Today's Games","The following games are scheduled. Players from these teams will be playing:",u.map(R=>{let N="";return R.status==="finished"&&R.score?N=` (Final: ${R.score})`:R.time?N=` @ ${R.time}`:R.status==="finished"&&(N=" (Final)"),`- ${R.team1} vs ${R.team2}${N}`}).join(`
`),""]);const m=a!=="game"?["### Betting payouts (Rax)","- Entry fee is ALWAYS 100 Rax for any bet tier.","- If lineup finishes Top 50%: payout 170 Rax (profit +70).","- If lineup finishes Top 20%: payout 350 Rax (profit +250).","- If lineup finishes Top 10%: payout 700 Rax (profit +600).",""]:[],h=a!=="game"?"Also provide bet recommendations for: Top 50%, Top 20%, Top 10.":"",k=a==="game"?["### How Scoring Works",`- You must select EXACTLY ${l} unique players.`,"- Each lineup slot has a slot multiplier (e.g. 2.0x, 1.8x, 1.6x...).","- Game drafts do NOT have player boosts - only slot multipliers apply.","","### Scoring Formula","  lineup_score = SUM( player_real_points  slot_multiplier )","","- Goal: maximize total lineup_score.","- Slot multipliers amplify whatever the player actually scores in the game.","- Example: 20 real points  2.0x = 40 Draft points.",""]:["### How Scoring Works",`- You must select EXACTLY ${l} unique players.`,"- Each lineup slot has a slot multiplier (e.g. 2.0x, 1.8x, 1.6x...).","- Each player also has a boost shown as +Bx (e.g. +0.9x).","- Multipliers are additive: effective_multiplier = slot_multiplier + player_boost_x","  Example: slot 2.0x + player +0.9x => effective 2.9x","","### Scoring Formula","  lineup_score = SUM( player_real_points  effective_multiplier )","","- Goal: maximize total lineup_score.","- Multipliers amplify whatever the player actually scores that day.","- Example: 5 real points  3.0x = 15 Draft points; 20 real points  2.0x = 40 Draft points.",""],S=a==="game"?"Available player pool:":"Available player pool (with their +boost values shown in the UI):";return{context:["You are helping build an optimal Draft Lineup.","","### Context (captured from realsports.io UI)",`URL: ${e?.url||"<unknown>"}`,`Captured At: ${e?.captured_at||"<unknown>"}`,`Capture Mode: ${e?.mode||"<unknown>"}`,`Sport: ${e?.sport||"<unknown>"}`,`Draft Type: ${a==="game"?"Game (single matchup)":"League (all games)"}`,"",...f,...k,...m,"Current slots:",n||"- <no slots found>","",S,i||"- <no pool detected>",c,"","### Task","Choose exactly the required number of players from the pool and assign them to slots.","Player status meanings: Active = confirmed playing, Questionable = may or may not play, Out/Inactive = will not play.","Explain briefly why each player goes into each slot.",h,""].join(`
`),expectedSlots:l,draftType:a}}function ho(e){const{context:t,expectedSlots:r,draftType:n}=vo(e),s=n!=="game"?["4) Bets","- Recommendations for Top 50%, Top 20%, Top 10 (recommend yes/no + confidence + one sentence reason)."]:[],a=n==="game"?`- List exactly ${r} slots in order (slot 1..${r}), showing: player and slot multiplier.`:`- List exactly ${r} slots in order (slot 1..${r}), showing: player, slot multiplier, player boost, and effective multiplier.`;return[t,"### Output format (human-readable)","Reply in plain English with these sections:","1) Lineup (final)",a,"2) Why this lineup","- 13 bullets summarizing the approach.","3) Slot-by-slot rationale","- Short note per slot explaining the assignment.",...s,"","Do NOT include JSON. Keep it readable and actionable."].join(`
`)}function go(e,t){const{context:r}=vo(e),n=t?.webHint?"Web search is available for: player props/betting lines (over/unders), etc.":null,s=t?.toolHint?["","### Available Tool: Player Profile Lookup","`get_player_profile_stats` - fetches detailed stats for any player.","Returns: recent performance data, game logs, rankings, trends.","Usage: call with player name exactly as shown in the pool.",""].join(`
`):"",a=t?.searchHint?["","### Available Tool: Draft Player Search","`search_draft_players` - searches for players by name in the full draft pool.","The visible player pool shows ~50 players, but more may be available.","Usage: search by player name or partial name (e.g. 'McDavid', 'Connor').",""].join(`
`):"";let i="";const c=t?.strategy||"balanced";return c==="safe"?i=["","### User Strategy Preference: SAFE","The user prefers a conservative, low-variance lineup.","Characteristics they value: consistency, high floor, predictable output, established performers.",""].join(`
`):c==="balanced"?i=["","### User Strategy Preference: BALANCED","The user wants a balanced approach - weighing both upside potential and consistency.",""].join(`
`):c==="risky"&&(i=["","### User Strategy Preference: RISKY","The user prefers a high-upside, high-variance lineup.","Characteristics they value: explosive potential, breakout candidates, higher ceiling even if floor is lower.",""].join(`
`)),[r,n?`
${n}
`:"",s,a,i,"Return data that matches the provided JSON schema exactly."].join(`
`).trim()}function mc(){try{return localStorage.getItem(io)||""}catch{return""}}function vc(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));return ho(t)}function hc(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));const r=F(xn,"1")!=="0",n=F(wn,"1")!=="0";return go(t,{toolHint:r,searchHint:n})}const Oa="rsdh_user_identity";function Na(){try{const e=localStorage.getItem(Oa);if(!e)return null;const t=JSON.parse(e);return t?.username&&t?.displayName?t:null}catch{return null}}function gc(e){localStorage.setItem(Oa,JSON.stringify(e))}function _c(){localStorage.removeItem(Oa)}function yc(){const e=window.location.href;return e==="https://realsports.io/"||e==="https://realsports.io"||e.startsWith("https://realsports.io/?")||e.startsWith("https://realsports.io/#")}function bc(){const e=Array.from(document.querySelectorAll("img"));for(const t of e)if((t.getAttribute("src")||"").includes("media.realapp.com/assets/user/")){const n=t.closest('[tabindex="0"]');if(n)return n}return null}async function xc(){const e=bc();return e?(e.click(),await new Promise(t=>setTimeout(t,500)),!0):!1}function wc(){if(!yc())return null;const e=Array.from(document.querySelectorAll("div"));let t=null,r=null;for(const l of e){const d=l.textContent?.trim()||"";if(d.startsWith("@")&&d.length>1&&d.length<30&&!d.includes(" ")&&l.closest('[style*="padding-top"]')?.textContent?.includes("Karma")){t=l;break}}if(!t)return null;const n=t.parentElement;if(n){const l=n.parentElement?.parentElement;if(l){const d=Array.from(l.querySelectorAll("div"));for(const u of d){const f=u.textContent?.trim()||"";if(f&&!f.startsWith("@")&&!f.includes("@")&&f.length>1&&f.length<50&&u!==t&&!f.includes("Karma")&&!f.includes("Rax")&&u.childElementCount===0){r=u;break}}}}const s=t.textContent?.trim().replace(/^@/,"")||"",a=r?.textContent?.trim()||s;let i,c=t;for(let l=0;l<10&&c&&!i;l++)if(c=c.parentElement,c){const d=Array.from(c.querySelectorAll("img"));for(const u of d){const f=u.getAttribute("src")||"";if(f.includes("media.realapp.com/assets/user/")){i=f.replace(/\/(xsmall|small)\//,"/large/");break}}}return s?{username:s,displayName:a,avatarUrl:i,linkedAt:new Date().toISOString()}:null}function Sc(e){return e?`rgb(${e.r}, ${e.g}, ${e.b})`:null}function Ec(){try{const t=uo()?.accent?.rgb;return Sc(t||null)}catch{return null}}const _o="rsdh-debug-highlight-",Ac=999999;function yo(e,t,r="rgba(4, 131, 215, 0.4)"){if(!e||!Tr())return null;const n=_o+Date.now(),s=e.getBoundingClientRect(),a=document.createElement("div");a.id=n,a.style.cssText=`
    position: fixed;
    top: ${s.top}px;
    left: ${s.left}px;
    width: ${s.width}px;
    height: ${s.height}px;
    background: ${r};
    border: 2px solid ${r.replace(/[\d.]+\)$/,"0.9)")};
    border-radius: 4px;
    z-index: ${Ac};
    pointer-events: none;
    transition: opacity 0.3s ease;
  `;const i=document.createElement("div");return i.style.cssText=`
    position: absolute;
    bottom: 100%;
    left: 0;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    padding: 4px 8px;
    font-size: 12px;
    font-family: system-ui, sans-serif;
    border-radius: 4px;
    white-space: nowrap;
    margin-bottom: 4px;
  `,i.textContent=t,a.appendChild(i),document.body.appendChild(a),n}function bo(e){if(e)try{document.getElementById(e)?.remove()}catch{}}function Tc(){try{document.querySelectorAll(`[id^="${_o}"]`).forEach(e=>e.remove())}catch{}}function Jr(e,t){const r=t?.timeoutMs??8e3,n=t?.intervalMs??100,s=Date.now();return new Promise(a=>{const i=()=>{if(e())return a(!0);if(Date.now()-s>r)return a(!1);setTimeout(i,n)};i()})}function kc(e){try{e.focus()}catch{}let t=0,r=0;try{const n=e.getBoundingClientRect();t=Math.max(1,Math.floor(n.left+n.width/2)),r=Math.max(1,Math.floor(n.top+n.height/2))}catch{}try{const n=window.PointerEvent;typeof n=="function"&&(e.dispatchEvent(new n("pointerdown",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})),e.dispatchEvent(new n("pointerup",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})))}catch{}try{e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.click()}catch{}}function Cc(e,t=6e3){try{const r=JSON.stringify(e);return r?r.length<=t?e:{_truncated:!0,_len:r.length}:null}catch{return{_unserializable:!0}}}function Pc(){try{const e=String(localStorage.getItem(Jn)||"");if(!e.trim())return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function Rc(e){try{localStorage.setItem(Jn,JSON.stringify(e.slice(-250)))}catch{}}function B(e,t,r){if(!Tr())return;const n={t:new Date().toISOString(),kind:e,scope:r?.scope,msg:String(t||""),data:Cc(r?.data)},s=Pc();s.push(n),Rc(s);try{window.dispatchEvent(new CustomEvent("rsdh-debug-event",{detail:n})),window.dispatchEvent(new CustomEvent("rsdh-debug-events",{detail:{events:s.slice(-250)}}))}catch{}}let rr=null;function Oc(){return rr&&document.body.contains(rr)||(rr=document.createElement("div"),rr.id="rsdh-toast-container",rr.style.cssText=`
    position: fixed;
    bottom: 40px;
    left: 40px;
    z-index: 2147483647;
    display: flex;
    flex-direction: column;
    gap: 12px;
    align-items: flex-start;
    pointer-events: none;
  `,document.body.appendChild(rr)),rr}function Ia(e,t="info",r=3e3){const n=Oc(),s=document.createElement("div"),i={success:"#7CFF01",error:"#FF3D00",info:"#00E5FF"}[t];s.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
    font-size: 11px;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    padding: 14px 20px;
    border-radius: 2px;
    color: white;
    background: #0D0D12;
    border-left: 4px solid ${i};
    pointer-events: auto;
    box-shadow: 0 12px 32px rgba(0,0,0,0.8), 0 0 10px ${i}20;
    animation: broadcastToastIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    max-width: 320px;
    position: relative;
    overflow: hidden;
  `;const c=document.createElement("div");c.style.cssText=`
    position: absolute;
    inset: 0;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
    background-size: 100% 2px, 3px 100%;
    pointer-events: none;
  `,s.appendChild(c);const l=document.createTextNode(e);if(s.appendChild(l),!document.getElementById("rsdh-toast-styles")){const d=document.createElement("style");d.id="rsdh-toast-styles",d.textContent=`
      @keyframes broadcastToastIn {
        from { opacity: 0; transform: translateX(-40px); }
        to { opacity: 1; transform: translateX(0); }
      }
      @keyframes broadcastToastOut {
        from { opacity: 1; transform: scale(1); }
        to { opacity: 0; transform: scale(0.9) translateX(-20px); }
      }
    `,document.head.appendChild(d)}n.appendChild(s),setTimeout(()=>{s.style.animation="broadcastToastOut 0.2s ease forwards",setTimeout(()=>{s.remove()},200)},r)}const Sn=(e,t)=>Ia(e,"success",t),Cr=(e,t)=>Ia(e,"error",t),xo=(e,t)=>Ia(e,"info",t);function Ma(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div, span, button"));let r=null,n=null,s=null;for(const a of t){const i=ne(a).trim().toLowerCase(),c=a.getBoundingClientRect();if(!(c.width<=20||c.width>200||c.height<=10||c.height>60)){if(i==="feed"){r=a;const l=window.getComputedStyle(a);(a.className.includes("r-1q142lx")||l.borderBottomColor==="rgb(4, 131, 215)"||l.color==="rgb(4, 131, 215)"||a.getAttribute("aria-selected")==="true")&&(s="feed")}else if(i==="plays"){n=a;const l=window.getComputedStyle(a);(a.className.includes("r-1q142lx")||l.borderBottomColor==="rgb(4, 131, 215)"||l.color==="rgb(4, 131, 215)"||a.getAttribute("aria-selected")==="true")&&(s="plays")}}}if(s===null&&(r||n)){const a=ne(e).toLowerCase();/\d+(?:\.\d+)?\s*fps\s+\d/.test(a)&&/vs\s+[A-Z]{2,4}|@\s+[A-Z]{2,4}/i.test(a)?s="feed":/\d+-\d+\s+P\d+\s+\d{1,2}:\d{2}/i.test(a)&&(s="plays")}return{feedBtn:r,playsBtn:n,activeTab:s}}async function Nc(){const{feedBtn:e,activeTab:t}=Ma();if(B("info",`Toggle to Feed: activeTab=${t}, feedBtn=${e?"found":"not found"}`,{scope:"scrape"}),t==="feed")return!0;if(!e)return!1;B("step","Clicking Feed button with humanActivate",{scope:"scrape"}),kc(e);const r=await Jr(()=>Ma().activeTab==="feed",{timeoutMs:4e3});return B("info",`Feed tab switch result: ${r}`,{scope:"scrape"}),r}function Ic(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div,header")).map(r=>{const n=ne(r);if(!n||!n.includes("Player"))return null;const s=r.getBoundingClientRect();return s.top<-5||s.top>80||s.height<32||s.height>90?null:{el:r,area:s.width*s.height}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function Mc(){const e=Ic();if(!e)return!1;const r=Array.from(e.querySelectorAll("button,[role='button'],a,div[tabindex='0']")).map(n=>{const s=n.getBoundingClientRect();if(s.width<=0||s.height<=0||s.width>80||s.height>80)return null;const a=Math.max(0,120-s.left),i=n.querySelector("svg")?20:0,c=ne(n).toLowerCase(),l=(n.getAttribute("aria-label")||"").toLowerCase(),d=c.includes("back")||l.includes("back")?30:0;return{el:n,score:a+i+d}}).filter(Boolean);if(r.length===0)return!1;r.sort((n,s)=>s.score-n.score);try{return r[0].el.click(),!0}catch{return!1}}const Lc={code:"NHL",name:"National Hockey League",stats:[{code:"G",name:"Goals",aliases:["goal","goals","g"],isPrimary:!0},{code:"A",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"PTS",name:"Points",aliases:["pt","pts","points"],isPrimary:!0},{code:"SOG",name:"Shots on Goal",aliases:["sog","shot","shots"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"HIT",name:"Hits",aliases:["hit","hits"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]},{code:"PIM",name:"Penalty Minutes",aliases:["pim","penalty"]},{code:"FOW",name:"Faceoff Wins",aliases:["fow","fo","faceoff"]},{code:"FO%",name:"Faceoff Percentage",aliases:["fo%","fopct"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"GA",name:"Goals Against",aliases:["ga","goalsagainst"]},{code:"SV%",name:"Save Percentage",aliases:["sv%","savepct"]},{code:"GAA",name:"Goals Against Average",aliases:["gaa"]},{code:"SO",name:"Shutouts",aliases:["so","shutout","shutouts"]},{code:"GP",name:"Games Played",aliases:["gp","games"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"OTL",name:"Overtime Losses",aliases:["otl","ot loss"]},{code:"TOI",name:"Time on Ice",aliases:["toi"]},{code:"GVA",name:"Giveaways",aliases:["gva","gwa","giveaway","giveaways"]},{code:"TKA",name:"Takeaways",aliases:["tka","takeaway","takeaways"]},{code:"PPG",name:"Power Play Goals",aliases:["ppg","pp goal"]},{code:"SHG",name:"Short Handed Goals",aliases:["shg","sh goal"]}],periods:{pattern:/P[1-3]|OT\d?|SO/i,labels:["P1","P2","P3","OT","SO"],hasClock:!0,timePattern:/:?\d{1,2}(?::\d{2})?/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["G","A","PTS","SOG","BLK"]},La={code:"NBA",name:"National Basketball Association",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"FGM",name:"Field Goals Made",aliases:["fgm","fg"]},{code:"FGA",name:"Field Goals Attempted",aliases:["fga"]},{code:"3PM",name:"3-Pointers Made",aliases:["3pm","3pt","three","threes"],isPrimary:!0},{code:"3PA",name:"3-Pointers Attempted",aliases:["3pa"]},{code:"FTM",name:"Free Throws Made",aliases:["ftm","ft"]},{code:"FTA",name:"Free Throws Attempted",aliases:["fta"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"],isPrimary:!0},{code:"OREB",name:"Offensive Rebounds",aliases:["oreb","or"]},{code:"DREB",name:"Defensive Rebounds",aliases:["dreb","dr"]},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"],isPrimary:!0},{code:"BLK",name:"Blocks",aliases:["blk","block","blocks"],isPrimary:!0},{code:"MIN",name:"Minutes",aliases:["min","mins","minutes"]},{code:"PF",name:"Personal Fouls",aliases:["pf","foul","fouls"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","REB","AST","STL","BLK","3PM"]},wo={code:"NFL",name:"National Football League",stats:[{code:"PASS_YD",name:"Passing Yards",aliases:["pass yd","pass yds","passing","pass"],isPrimary:!0},{code:"PASS_TD",name:"Passing Touchdowns",aliases:["pass td","pass tds","ptd"]},{code:"INT",name:"Interceptions Thrown",aliases:["int","ints","interception"]},{code:"CMP",name:"Completions",aliases:["cmp","comp","completions"]},{code:"ATT",name:"Pass Attempts",aliases:["att","attempts"]},{code:"RUSH_YD",name:"Rushing Yards",aliases:["rush yd","rush yds","rushing","rush"],isPrimary:!0},{code:"RUSH_TD",name:"Rushing Touchdowns",aliases:["rush td","rush tds","rtd"]},{code:"CAR",name:"Carries",aliases:["car","carry","carries"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception","receptions"],isPrimary:!0},{code:"REC_YD",name:"Receiving Yards",aliases:["rec yd","rec yds","receiving"]},{code:"REC_TD",name:"Receiving Touchdowns",aliases:["rec td","rec tds"]},{code:"TGT",name:"Targets",aliases:["tgt","target","targets"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown","touchdowns"],isPrimary:!0},{code:"YD",name:"Total Yards",aliases:["yd","yds","yards"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"XP",name:"Extra Points",aliases:["xp","pat","extra point"]},{code:"SACK",name:"Sacks",aliases:["sack","sacks","sk"]},{code:"TKL",name:"Tackles",aliases:["tkl","tackle","tackles"]},{code:"FF",name:"Forced Fumbles",aliases:["ff","forced fumble"]},{code:"FR",name:"Fumble Recoveries",aliases:["fr","fumble recovery"]},{code:"DEF_INT",name:"Defensive Interceptions",aliases:["def int","pick"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PASS_YD","RUSH_YD","REC","TD"]},Dc={code:"MLB",name:"Major League Baseball",stats:[{code:"H",name:"Hits",aliases:["h","hit","hits"],isPrimary:!0},{code:"HR",name:"Home Runs",aliases:["hr","hrs","homer","homers","home run"],isPrimary:!0},{code:"RBI",name:"Runs Batted In",aliases:["rbi","rbis"],isPrimary:!0},{code:"R",name:"Runs",aliases:["r","run","runs"],isPrimary:!0},{code:"SB",name:"Stolen Bases",aliases:["sb","stolen","steal","steals"]},{code:"BB",name:"Walks",aliases:["bb","walk","walks"]},{code:"K",name:"Strikeouts",aliases:["k","so","strikeout","strikeouts"]},{code:"AB",name:"At Bats",aliases:["ab","at bat","at bats"]},{code:"2B",name:"Doubles",aliases:["2b","double","doubles"]},{code:"3B",name:"Triples",aliases:["3b","triple","triples"]},{code:"AVG",name:"Batting Average",aliases:["avg","average"]},{code:"IP",name:"Innings Pitched",aliases:["ip","innings"]},{code:"ER",name:"Earned Runs",aliases:["er","earned run","earned runs"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"ERA",name:"Earned Run Average",aliases:["era"]},{code:"WHIP",name:"Walks+Hits per IP",aliases:["whip"]},{code:"QS",name:"Quality Starts",aliases:["qs","quality start"]}],periods:{pattern:/(?:Top|Bot|T|B)\s*\d+|Inning\s*\d+|\d+(?:st|nd|rd|th)/i,labels:["1st","2nd","3rd","4th","5th","6th","7th","8th","9th","Extra"],hasClock:!1},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["H","HR","RBI","R","SB"]},Da={code:"NFL",name:"Generic Sport",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"]},{code:"G",name:"Goals",aliases:["goal","goals","g"]},{code:"SOG",name:"Shots",aliases:["sog","shot","shots"]},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"3PM",name:"3-Pointers",aliases:["3pm","3pt","three","threes"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown"]},{code:"YD",name:"Yards",aliases:["yd","yds","yards"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception"]},{code:"BIRDIE",name:"Birdies",aliases:["birdie","birdies"]},{code:"PAR",name:"Pars",aliases:["par","pars"]},{code:"BOGEY",name:"Bogeys",aliases:["bogey","bogeys"]},{code:"EAGLE",name:"Eagles",aliases:["eagle","eagles"]},{code:"KO",name:"Knockouts",aliases:["ko","knockout","knockouts"]},{code:"SUB",name:"Submissions",aliases:["sub","submission","submissions"]},{code:"TKD",name:"Takedowns",aliases:["tkd","takedown","takedowns"]},{code:"STR",name:"Strikes",aliases:["str","strike","strikes"]},{code:"GLS",name:"Goals",aliases:["gls","goal","goals"]},{code:"SHT",name:"Shots",aliases:["sht","shot","shots"]},{code:"SOT",name:"Shots on Target",aliases:["sot"]},{code:"CRN",name:"Corners",aliases:["crn","corner","corners"]}],periods:{pattern:/(?:P[1-3]|Q[1-4]|H[1-2]|OT\d?|SO|R\d+|RD\s*\d+)/i,labels:["1","2","3","4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","G","TD","REC"]};function Fc(e,t){return{...Da,code:e,name:t}}const $c={NHL:Lc,NBA:La,NFL:wo,MLB:Dc,CFB:{...wo,code:"CFB",name:"College Football"},CBB:{...La,code:"CBB",name:"College Basketball"},WNBA:{...La,code:"WNBA",name:"Women's NBA"},FC:Fc("FC","Football Club / Soccer")};function Bc(e){if(!e)return Da;const t=e.toUpperCase().trim();return $c[t]||Da}function Fa(e){return(e||"").trim().toLowerCase()}function qc(e){const t=(e||"").trim(),r=t.split("").map(a=>a.trim()).filter(Boolean),n=r[0]||t,s=r.slice(1).join("  ");return{name:n,rest:s}}function So(e,t){const r=Fa(t);if(!r)return null;const n=/\+(\d+(?:\.\d+)?)x\b/i,s=Array.from(e.querySelectorAll("div[tabindex='0'],[role='button'],button")).map(a=>{const i=ne(a);if(!i||!n.test(i))return null;const{name:c}=qc(i),l=a.getBoundingClientRect();if(l.width<=140||l.height<28)return null;const d=(Fa(c)===r?1e3:Fa(c).includes(r)?100:0)+Math.min(200,Math.round(l.width));return d<=0?null:{el:a,score:d,rect:l,name:c}}).filter(Boolean);return s.length===0?null:(s.sort((a,i)=>i.score-a.score),s[0].el)}function Eo(e){const s=Array.from(e.querySelectorAll("a[href],a,button,div[tabindex='0'],[role='button']")).filter(c=>!!c.querySelector("svg")).map(c=>({el:c,r:c.getBoundingClientRect()})).filter(c=>c.r.width>8&&c.r.width<=28&&c.r.height>8&&c.r.height<=28);if(s.length===0)return null;s.sort((c,l)=>l.r.left-c.r.left);const a=s[0].el;return(a instanceof HTMLAnchorElement?a:null)||a.querySelector("a[href]")||a.closest("a[href]")||a}async function Gc(e){const t=kr();if(!t)return B("warn","No modal found for profile URL discovery",{scope:"profile"}),null;B("step",`Finding player row: ${e}`,{scope:"profile"});const r=So(t,e);if(!r)return B("warn","Player row not found",{scope:"profile"}),null;const n=Eo(r);if(!n)return B("warn","Profile icon button not found",{scope:"profile"}),null;const s=n instanceof HTMLAnchorElement?n:n.closest("a[href]");if(s?.getAttribute("href")){const a=new URL(String(s.getAttribute("href")),location.href).toString();return B("info","Got profile URL from href",{scope:"profile",data:{url:a}}),a}return B("info","No href on icon, will click to navigate",{scope:"profile"}),"__CLICK_TO_NAVIGATE__"}function Uc(e){const t=e.querySelector("#realrootcontents")||e.querySelector("#realweb")||e.body,n=Array.from(t.querySelectorAll("div,section,header,article")).slice(0,2e3).map(s=>{const a=(ne(s)||"").replace(/\s+/g," ").trim();if(!a||a.length<40||a.length>320)return null;const i=a.toUpperCase();let c=0;return i.includes("7-DAY")&&(c+=4),i.includes("30-DAY")&&(c+=4),i.includes("SEASON")&&(c+=3),i.includes("CARD")&&(c+=2),a.includes("")&&(c+=2),/#\d+/.test(a)&&(c+=1),/\b\d+(st|nd|rd|th)\b/i.test(a)&&(c+=2),c<6?null:{t:a,score:c}}).filter(Boolean);return n.length===0?null:(n.sort((s,a)=>a.score-s.score),n[0].t)}function zc(e){const t={},r=e.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/gi);if(r)for(const s of r){const a=s.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/i);if(a){const i=parseInt(a[1],10),c=a[3]||"overall";t[`rank_${c.toLowerCase().replace("-","_")}`]=i}}const n=e.match(/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)\s*\s*([A-Z]+)\s*\s*#(\d+)/);return n&&(t.team=n[1],t.position=n[2],t.number=parseInt(n[3],10)),t}function Hc(e){const t=e.replace(/\s+/g," "),r=/([A-Z]+(?:%||\+\/-)?)\s+(-?\d+(?:\.\d+)?(?::\d+)?)\s+(\d+)(?:st|nd|rd|th)\b/gi,n=[];let s;for(;(s=r.exec(t))!==null;)n.push({stat:s[1],value:s[2],rank:parseInt(s[3],10)});return n.length>0?{entries:n}:null}function Ao(e){const t=e.replace(/\s+/g," ");let r=[];const n=t.match(/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps[^A-Z]*/gi);if(n&&(r=n.map(s=>s.trim().slice(0,200)).filter(s=>s.length>20).slice(0,15)),r.length===0){const s=e.split(/\n/).map(a=>a.trim()).filter(Boolean);for(const a of s)if((/\d+(?:\.\d+)?\s*fps/i.test(a)||/\d+(?:\.\d+)?\s*@\s*[A-Z]{2,4}/i.test(a))&&(r.push(a.slice(0,200)),r.length>=15))break}return r.length>0?{entries:r}:null}function To(e){const t=e.replace(/\s+/g," "),r=[],n=/([A-Z]\.[\s]*[\w'-]+)\s*\s*(\d+(?:\.\d+)?)\s*fps\s+([\d.]+)?/gi;let s;const a=[];for(;(s=n.exec(t))!==null&&(a.push({player:s[1].trim(),fps:parseFloat(s[2]),multiplier:s[3]?parseFloat(s[3]):null,startIdx:s.index,endIdx:s.index+s[0].length}),!(a.length>=30)););for(let i=0;i<a.length;i++){const c=a[i],l=a[i+1]?.startIdx??t.length,d=t.slice(c.endIdx,l).trim(),u=d.match(/(\d+\s+(?:hours?|days?|weeks?|months?)\s+ago|yesterday|today)/i),f=d.match(/(vs|@)\s*([A-Z]{2,4})\s*([WL])?/i);let m=d;u?m=d.slice(0,u.index).trim():f&&(m=d.slice(0,f.index).trim()),m=m.replace(/\s+\d+\s*$/,"").trim(),r.push({player:c.player,fps:c.fps,multiplier:c.multiplier,stats:m.slice(0,100),date:u?.[1]||"",opponent:f?.[2]||"",result:f?.[3]||""})}return r}async function Yc(e,t,r=null){Bc(r),B("step","Scraping profile from current DOM",{scope:"scrape"});const n=Uc(document),s=n?zc(n):null,a=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,i=ne(a),c=Hc(i),{activeTab:l}=Ma();B("info",`Initial tab: ${l||"unknown"}`,{scope:"scrape"});let d=[],u=null;if(l==="plays"){if(B("step","Switching to Feed tab",{scope:"scrape"}),await Nc()){await Jr(()=>{const k=ne(a).replace(/\s+/g," ");return/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(k)},{timeoutMs:3e3,intervalMs:100});const h=ne(a);d=To(h),u=Ao(h)}}else d=To(i),u=Ao(i);B("info",`Feed extraction: ${d.length} entries`,{scope:"scrape"});const f={player_name:e,profile_url:t,title:document.title||"",header_text:n,header_parsed:s,season_summary:c,recent_performances:u,feed_entries:d,active_tab:l,raw_text_length:i.length};return B("info","Scrape complete",{scope:"scrape",data:{header:!!n,season_summary:c?.entries?.length??0,recent_performances:u?.entries?.length??0,feed_entries:d.length,active_tab:l}}),f}async function jc(e){const t=location.href,r=e.profile_url==="__CLICK_TO_NAVIGATE__";B("step","Starting profile scrape flow",{scope:"flow",data:{player_name:e.player_name,profile_url:r?"(will click icon)":e.profile_url,return_to_draft:e.return_to_draft}});const n=kr();B("info",`Draft modal at start: ${n?"found":"not found"}`,{scope:"flow"}),B("step","Navigating to profile page",{scope:"flow"});const s=n?So(n,e.player_name):null,a=s?Eo(s):null;let i=null,c=null;if(s&&Tr()&&(i=yo(s,`Player: ${e.player_name}`,"rgba(0, 161, 99, 0.3)")),a&&Tr()&&(c=yo(a,"Profile Icon","rgba(4, 131, 215, 0.5)")),r||a)a?(B("step","Clicking profile icon",{scope:"flow"}),a.click()):B("warn","Could not find icon button to click",{scope:"flow"});else if(e.profile_url&&!r){B("step","Using pushState to navigate",{scope:"flow"});try{const h=new URL(e.profile_url,location.href);history.pushState({},"",h.pathname+h.search+h.hash),window.dispatchEvent(new PopStateEvent("popstate"))}catch(h){B("warn","pushState failed",{scope:"flow",data:{error:String(h)}})}}bo(i),bo(c),B("step","Waiting for profile page to load",{scope:"flow"});const l=await Jr(()=>location.href!==t,{timeoutMs:6e3,intervalMs:100});B("info",`Navigation result: ${l?"URL changed":"URL unchanged"}`,{scope:"flow",data:{prevUrl:t,currentUrl:location.href}}),l&&(B("step","Waiting for profile content to render",{scope:"flow"}),await Jr(()=>{const h=document.querySelector("#realrootcontents")||document.body,k=ne(h),S=/[A-Z]\.\s*[\w'-]+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(k),b=/PTS\s+\d+\s+\d+/i.test(k)||/GOAL\s+\d+/i.test(k);return S||b},{timeoutMs:1e4,intervalMs:100}));const d=l?location.href:e.profile_url,u=await Yc(e.player_name,d,e.sport||null);let f=!1,m=!1;if(e.return_to_draft&&l){B("step","Going back to home page",{scope:"flow"});try{history.back()}catch{}if(f=await Jr(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}),f||(B("step","Clicking back button in nav",{scope:"flow"}),Mc()&&(f=await Jr(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}))),B("info",`Returned to home: ${f}`,{scope:"flow",data:{currentUrl:location.href}}),f)if(B("step","Reopening draft modal",{scope:"flow"}),await new Promise(h=>setTimeout(h,500)),kr())m=!0,B("info","Modal already open",{scope:"flow"});else{const h=await cc({timeoutMs:8e3});m=h.opened,B("info",`Modal reopen attempt: clicked=${h.clicked}, opened=${h.opened}`,{scope:"flow"})}}return Tc(),{...u,return_to_draft:e.return_to_draft,returned_to_draft:f,modal_reopened:m,prev_url:t,navigated_to_profile:l,modal_was_open:!!n}}function Le(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function $a(e){const t=typeof e=="number"&&!Number.isNaN(e)?e:null;return t==null?"":`${t.toFixed(1)}X`}function Jc(e){if(!e||e.ok!==!0)return`
      <div class="card" style="border-left-color: var(--rsdh-accent-red);">
        <div class="h">SIGNAL INTERRUPTED</div>
        <div class="sub">${Le(e?.error||"Awaiting RealSports draft synchronization.")}</div>
      </div>
    `;let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]),typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:t.length;const r=e?.sport||"",n=Array.isArray(e?.player_pool)?e.player_pool:[],s=(t||[]).map((l,d)=>{const u=l?.selection?Le(l.selection):"<span style='opacity: 0.3;'>EMPTY_SLOT</span>",f=$a(l?.multiplier);return`
      <tr>
        <td style="padding: 8px 12px;"><span class="font-mono">${d+1}</span></td>
        <td style="padding: 8px 12px;"><span class="text-accent font-mono">${f}</span></td>
        <td style="padding: 8px 12px; font-weight: 700;">${u}</td>
      </tr>
    `}).join(""),a=n.map((l,d)=>{const u=Le(l?.name||""),f=l?.status?`<span class="status-pill" style="background: rgba(255,255,255,0.05); color: var(--rsdh-text-dim); margin-left: 8px;">${Le(l.status)}</span>`:"",m=typeof l?.boost_x=="number"&&l.boost_x!==0?`<span class="text-green font-mono">+${l.boost_x.toFixed(1)}X</span>`:"";return`
      <div class="player-row">
        <div class="player-rank">#${d+1}</div>
        <div class="player-info">
          <div class="player-name">${u}${f}</div>
          <div class="player-meta">${[l.team,l.position].filter(Boolean).join("  ")||""}</div>
        </div>
        <div class="player-stats">
          ${m}
        </div>
      </div>
    `}).join(""),i=e?.draft_type||"",c=i==="game"?"Game":i==="league"?"League":"";return`
    <div class="card">
      <div class="h">DRAFT INFO</div>
      <div class="sub">
        ${c?`<span class="text-accent">TYPE:</span> ${Le(c)} &nbsp;&nbsp; `:""}
        <span class="text-accent">SPORT:</span> ${Le(r)}
      </div>

    </div>
    
    <div class="card">
      <div class="h">ROSTER CONFIGURATION</div>
      <table class="table" style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr>
            <th style="text-align: left; padding: 8px 12px;">SLOT</th>
            <th style="text-align: left; padding: 8px 12px;">MULTIPLIER</th>
            <th style="text-align: left; padding: 8px 12px;">SELECTION</th>
          </tr>
        </thead>
        <tbody>
          ${s||"<tr><td colspan='3' style='text-align:center; padding: 24px; opacity: 0.3;'>NO SLOTS DETECTED</td></tr>"}
        </tbody>
      </table>
    </div>


    <div class="card" style="border-left-color: var(--rsdh-accent-green);">
      <div class="h">
        <span>PLAYERS</span>
        <span class="status-pill text-green status-pulsing">LIVE_POOL</span>
      </div>
      <div class="list">
        ${a||"<div style='text-align:center; padding: 24px; opacity: 0.3;'>POOL DATA UNAVAILABLE</div>"}
      </div>
    </div>
  `.trim()}function ko(e,t=[],r){const n=Array.isArray(e?.lineup)?e.lineup:[],s=Array.isArray(e?.bets)?e.bets:[],a=Array.isArray(e?.assumptions)?e.assumptions:[],i=Array.isArray(e?.questions)?e.questions:[],c=r==="game",l=n.map(S=>{const b=Le(S?.slot_index),x=Le(S?.player||""),R=$a(S?.slot_multiplier),N=typeof S?.player_boost_x=="number"?`+${Le(S.player_boost_x)}X`:"+0X",L=$a(S?.effective_multiplier);return c?`
      <tr>
        <td style="padding: 8px 12px;" class="font-mono">${b}</td>
        <td style="padding: 8px 12px; font-weight: 800;">${x}</td>
        <td style="padding: 8px 12px;"><span class="text-accent font-mono" style="font-weight: 900;">${R}</span></td>
      </tr>
    `:`
      <tr>
        <td style="padding: 8px 12px;" class="font-mono">${b}</td>
        <td style="padding: 8px 12px; font-weight: 800;">${x}</td>
        <td style="padding: 8px 12px;" class="font-mono">${R}</td>
        <td style="padding: 8px 12px;" class="text-green font-mono">${N}</td>
        <td style="padding: 8px 12px;"><span class="text-accent font-mono" style="font-weight: 900;">${L}</span></td>
      </tr>
    `}).join(""),d=r!=="game",u=d?s.map(S=>{const b=Le(S?.tier||""),x=S?.recommend?"OPTIMAL":"AVOID",R=S?.recommend?"":"text-red",N=S?.recommend?"var(--rsdh-accent-green)":"var(--rsdh-accent-red)",L=Math.min(100,Math.max(0,Number(S?.confidence)||0)),U=Le(S?.reason||"");return`
      <div class="card" style="border-left-color: ${N}; padding: 12px 16px;">
        <div class="h" style="margin-bottom: 4px;">
          <span style="font-size: 11px;">${b}</span>
          <span class="status-pill ${R}" style="background: ${N}20; color: ${N};">${x}</span>
        </div>
        <div class="sub" style="margin-bottom: 8px;">${U}</div>
        <div class="flex-row space-between">
          <span class="player-meta">CONFIDENCE SCORE</span>
          <span class="font-mono text-accent" style="font-size: 10px;">${L}%</span>
        </div>
        <div class="meter-container">
          <div class="meter-fill" style="width: ${L}%; background: ${N};"></div>
        </div>
      </div>
    `}).join(""):"",f=d?`
    <div class="h" style="padding-left: 4px; border-left: 3px solid var(--rsdh-accent); margin: 24px 0 12px 0;">BETTING INTEL</div>
    ${u||"<div class='card sub' style='text-align:center;'>NO INTELLIGENCE GATHERED</div>"}
`:"",m=(t||[]).slice(0,5).map(S=>`
    <div class="row">
      <a class="link font-mono" style="font-size: 10px; overflow: hidden; text-overflow: ellipsis;" href="${Le(S)}" target="_blank" rel="noreferrer">
        LINK: ${Le(S)}
      </a>
    </div>
  `).join("");return`
    <div class="card">
      <div class="h">OPTIMIZED LINEUP</div>
      <table class="table" style="width: 100%; border-collapse: collapse;">
        <thead>
          ${c?`<tr>
            <th style="text-align: left; padding: 8px 12px;">SLOT</th>
            <th style="text-align: left; padding: 8px 12px;">PLAYER</th>
            <th style="text-align: left; padding: 8px 12px;">MULT</th>
          </tr>`:`<tr>
            <th style="text-align: left; padding: 8px 12px;">SLOT</th>
            <th style="text-align: left; padding: 8px 12px;">PLAYER</th>
            <th style="text-align: left; padding: 8px 12px;">MULT</th>
            <th style="text-align: left; padding: 8px 12px;">BOOST</th>
            <th style="text-align: left; padding: 8px 12px;">EFF.</th>
          </tr>`}
        </thead>
        <tbody>
          ${l||`<tr><td colspan='${c?3:5}' style='text-align:center; padding: 24px; opacity: 0.3;'>ANALYSIS PENDING</td></tr>`}
        </tbody>
      </table>
    </div>


    ${f}

    ${i.length?`<div class="card"><div class="h">ANOMALIES DETECTED</div><div class="list">${i.map(S=>`<div class="row text-red">${Le(S)}</div>`).join("")}</div></div>`:""}
    ${a.length?`<div class="card"><div class="h">MODEL ASSUMPTIONS</div><div class="list">${a.map(S=>`<div class="row">${Le(S)}</div>`).join("")}</div></div>`:""}
    ${m?`<div class="card"><div class="h">INTELLIGENCE SOURCES</div><div class="list">${m}</div></div>`:""}
  `.trim()}function Kc(){const e=String(F(xa,"")||"").trim(),t=String(F(wa,wr)||wr).trim()||wr,r=F(Sa,Hn),n=F(Ea,Yn),s=F(Aa,yn),a=F(Un,Gl),i=F(zn,Ul),c=Math.max(0,Math.min(2,parseFloat(String(r)))),l=Math.max(64,Math.min(4e3,parseInt(String(n),10)||Yn)),d=Math.max(1,Math.min(5,parseInt(String(s),10)||yn)),u=String(a)==="1"||a===!0,f=String(i)==="1"||i===!0;return{apiKey:e,model:t,temperature:c,max_tokens:l,web_max_results:d,structured:u,response_healing:f}}function Wc({method:e,url:t,headers:r,bodyObj:n,timeoutMs:s=6e4}){return new Promise((a,i)=>{const c=n==null?null:JSON.stringify(n);if(typeof GM_xmlhttpRequest!="function"){i(new Error("GM_xmlhttpRequest is not available (check grants)."));return}GM_xmlhttpRequest({method:e,url:t,headers:{"Content-Type":"application/json",...r||{}},data:c??void 0,timeout:s,onload:l=>{try{const d=l?.responseText||"",u=d?JSON.parse(d):null;if(l.status>=200&&l.status<300)a(u);else{const f={status:l.status,error:u?.error,message:u?.message,metadata:u?.error?.metadata,provider_error:u?.error?.metadata?.provider_error,raw:d?.slice(0,2e3)};console.error("[OpenRouter API Error]",f);try{localStorage.setItem("RSDH_LAST_API_ERROR",JSON.stringify(f,null,2))}catch{}const m=u?.error?.metadata?.provider_error,h=u?.error?.code,k=u?.error?.type;let S=u?.error?.message||u?.message||`HTTP ${l.status}`;m&&(S+=` | Provider: ${typeof m=="string"?m:JSON.stringify(m)}`),h&&(S+=` [code: ${h}]`),k&&(S+=` [type: ${k}]`),i(new Error(S))}}catch(d){console.error("[OpenRouter Parse Error]",d,l?.responseText?.slice(0,500)),i(d)}},onerror:()=>i(new Error("Network error.")),ontimeout:()=>i(new Error("Request timed out."))})})}function Xc(){return{type:"object",additionalProperties:!1,properties:{lineup:{type:"array",items:{type:"object",additionalProperties:!1,properties:{slot_index:{type:"number"},slot_multiplier:{type:"number"},player:{type:"string"},player_boost_x:{type:["number","null"]},effective_multiplier:{type:"number"}},required:["slot_index","slot_multiplier","player","player_boost_x","effective_multiplier"]}},bets:{type:"array",items:{type:"object",additionalProperties:!1,properties:{tier:{type:"string",enum:["top50","top20","top10"]},recommend:{type:"boolean"},confidence:{type:"number",minimum:0,maximum:100},reason:{type:"string"}},required:["tier","recommend","confidence","reason"]}},assumptions:{type:"array",items:{type:"string"}},questions:{type:"array",items:{type:"string"}}},required:["lineup","bets","assumptions","questions"]}}function Co(e){const r=(Array.isArray(e?.annotations)?e.annotations:[]).filter(n=>n&&n.type==="url_citation"&&n.url_citation&&n.url_citation.url).map(n=>n.url_citation.url).slice(0,25);return Array.from(new Set(r))}function Vc(e){return String(e?.message||e||"").toLowerCase().includes("no endpoints found")}function Kr(){return new Date().toISOString()}function Wr(e){try{localStorage.setItem(lo,JSON.stringify(e,null,2))}catch{}}async function Po(e,t){let r=null;for(const n of e)try{return{res:await Wc({method:"POST",url:t.url,headers:t.headers,bodyObj:n.body,timeoutMs:t.timeoutMs}),usedLabel:n.label}}catch(s){if(r=s,!Vc(s))throw s}throw r||new Error("OpenRouter request failed.")}function Zc(){return{type:"function",function:{name:"get_player_profile_stats",description:"Fetch and summarize a player's RealSports profile page (rankings, prior performances, recent game logs). Clicks the player's profile icon in the draft modal, scrapes their stats, then returns to the draft. Use when deciding between players beyond boost values.",parameters:{type:"object",additionalProperties:!1,properties:{player_name:{type:"string",description:"Player name exactly as shown in the draft modal."}},required:["player_name"]}}}}function Qc(){return{type:"function",function:{name:"search_draft_players",description:"Search the draft modal for players by name. The initial pool shows up to ~50 players, but many more may be available. Use this to find specific players by name (full or partial) that might not appear in the initial list. Returns matching players with boost values. Note: only searches by player name, not position or team.",parameters:{type:"object",additionalProperties:!1,properties:{query:{type:"string",description:"Player name or partial name to search for (e.g. 'McDavid', 'Connor', 'Ovi')."}},required:["query"]}}}}async function ed(e,t,r){if(e==="get_player_profile_stats"){const n=String(t?.player_name||"").trim();if(!n)return{error:"missing_player_name"};B("step",`Tool call: get_player_profile_stats(${n})`,{scope:"tool"}),B("step","Discovering profile URL via click",{scope:"tool"});const s=await Gc(n);if(!s)return{error:"player_not_found",player_name:n,hint:"Could not find this player in the draft modal. Make sure the draft modal is open and the player is visible in the list."};B("step","Scraping profile",{scope:"tool",data:{profile_url:s}});const a=r.payload?.sport||null,i=await jc({player_name:n,profile_url:s,return_to_draft:!0,sport:a});return B("info","Tool result ready",{scope:"tool",data:{scraped_via:i?.scraped_via,navigated_to_profile:i?.navigated_to_profile}}),{...i,discovery:"click",mode:"live_dom"}}if(e==="search_draft_players"){const n=String(t?.query||"").trim();if(!n)return{error:"missing_query"};B("step",`Tool call: search_draft_players(${n})`,{scope:"tool"});const s=kr();if(!s)return B("warn","Draft modal not found for search",{scope:"tool"}),{error:"no_draft_modal",message:"Draft modal not found. Make sure the draft modal is open."};B("info","Found draft modal",{scope:"tool"});const a=s.querySelector('input[placeholder*="Search"]')||s.querySelector('input[placeholder*="search"]')||document.querySelector('input[placeholder*="Search"]');if(!a)return B("warn","Search input not found in modal",{scope:"tool"}),{error:"no_search_input",message:"Search input not found in modal"};B("step","Found search input, entering query...",{scope:"tool"}),a.value="",a.focus();const i=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value")?.set;i?i.call(a,n):a.value=n,a.dispatchEvent(new Event("input",{bubbles:!0})),a.dispatchEvent(new Event("change",{bubbles:!0})),await new Promise(d=>setTimeout(d,800)),B("step","Scraping filtered player pool...",{scope:"tool"});const c=mo(s);B("info",`Found ${c.length} players matching '${n}'`,{scope:"tool"}),i?i.call(a,""):a.value="",a.dispatchEvent(new Event("input",{bubbles:!0})),a.dispatchEvent(new Event("change",{bubbles:!0}));const l=c.map(d=>({name:d.name,boost:d.boost_x!==null&&d.boost_x!==void 0?`+${d.boost_x}x`:null,status:d.status,profile_url:d.profile_url||null}));return{query:n,players_found:l.length,players:l}}return{error:"unknown_tool",toolName:e}}async function td(e){const t=Kc(),r=String(F(Ar,"0"))==="1"||F(Ar,"0")===!0;if((!bn||r)&&!t.apiKey)throw new Error("Missing OpenRouter API key.");if(bn&&!r&&!Na()?.username)throw new Error("Please link your account in Settings before using Ask AI.");const a=String(F(Sr,"0"))==="1"||F(Sr,"0")===!0,i=String(F(Er,"0"))==="1"||F(Er,"0")===!0;let c=e.prompt;a?c=["DEBUG TOOL TEST: You MUST call the tool `get_player_profile_stats` exactly once before producing the final JSON schema answer.","Pick ONE player from the available pool (prefer a high-boost or a close decision).","IMPORTANT: Call the tool with return_to_draft=true so you can read dynamic Feed/Plays content, then come back to the draft.","After you receive the tool result, continue normally and return the final JSON schema output.","",e.prompt].join(`
`):i&&(c=["DEBUG TOOL TEST: You MUST call the tool `search_draft_players` exactly once before producing the final JSON schema answer.","Search for a player by name (e.g. 'McDavid', 'Crosby', 'Ovi') to find additional players that may not be in the initial list.","Note: This search only works with player names, not positions or teams.","After you receive the search results, continue normally and return the final JSON schema output.","",e.prompt].join(`
`));const l=[{t:Kr(),kind:"start",model:t.model,web:!!e.web}];Wr(l);const d=F(xn,"1")!=="0",u=F(wn,"1")!=="0",f=e.payload?.player_pool_count??e.payload?.player_pool?.length??0,m=u&&f>=50,h=[...d?[Zc()]:[],...m?[Qc()]:[]],k=a?{type:"function",function:{name:"get_player_profile_stats"}}:i?{type:"function",function:{name:"search_draft_players"}}:"auto",S=String(F(Ar,"0"))==="1"||F(Ar,"0")===!0,b=bn&&!S,x=b?{"X-RSDH-Auth":Hl,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"}:{Authorization:`Bearer ${t.apiKey}`,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"};if(b){const Ct=Na();Ct?.username&&(x["X-RSDH-User"]=Ct.username,Ct.displayName&&(x["X-RSDH-DisplayName"]=Ct.displayName))}const R=b?jn:zl,N=[];e.web&&N.push({id:"web",engine:"exa",max_results:t.web_max_results}),t.response_healing&&N.push({id:"response-healing"});const L=[],U=[{role:"user",content:c}],Y=6;let D=[];const I=t.model.toLowerCase().includes("gemini");for(let Ct=0;Ct<Y;Ct++){const Gt={model:t.model,messages:U,temperature:t.temperature,max_tokens:t.max_tokens,tools:h},nr=I?[{label:"gemini+tools+tool_choice",body:{...Gt,tool_choice:k,plugins:L}},{label:"gemini+tools-only",body:{...Gt,plugins:L}}]:[{label:"tools+tool_choice+parallel+provider",body:{...Gt,tool_choice:k,parallel_tool_calls:!1,provider:{require_parameters:!0},plugins:L}},{label:"tools+tool_choice+provider",body:{...Gt,tool_choice:k,provider:{require_parameters:!0},plugins:L}},{label:"tools+tool_choice",body:{...Gt,tool_choice:k,plugins:L}},{label:"tools-only",body:{...Gt,plugins:L}}],{res:En,usedLabel:ar}=await Po(nr,{url:R,headers:x,timeoutMs:9e4});ar!==nr[0].label&&(l.push({t:Kr(),kind:"routing_fallback",stage:"tool_loop",label:ar}),Wr(l));const Pt=En?.choices?.[0]?.message;D=Co(Pt);const Ut=Array.isArray(Pt?.tool_calls)?Pt.tool_calls:null;if(!Ut||Ut.length===0)break;console.log("[OpenRouter] Assistant message with tool calls:",JSON.stringify(Pt,null,2));try{localStorage.setItem("RSDH_LAST_ASSISTANT_MSG",JSON.stringify(Pt,null,2))}catch{}const Vr=new Set((Array.isArray(Pt?.reasoning_details)?Pt.reasoning_details:[]).map(Ae=>Ae?.id).filter(Boolean));let Zr;if(Vr.size>0){const Ae=Ut.filter(Rt=>Vr.has(Rt?.id));console.log(`[OpenRouter] Gemini reasoning_details present: ${Vr.size} entries, ${Ae.length} matched tool calls`),Zr=Ae.length>0?Ae:Ut.slice(0,1)}else Zr=Ut.slice(0,3);const An=new Set(Zr.map(Ae=>Ae?.id).filter(Boolean)),qe=JSON.parse(JSON.stringify(Pt));qe.role="assistant","content"in qe||(qe.content=null),Array.isArray(qe.tool_calls)&&(qe.tool_calls=qe.tool_calls.filter(Ae=>An.has(Ae?.id)),console.log(`[OpenRouter] Filtered assistant tool_calls to ${qe.tool_calls.length} (from ${Ut.length})`)),Array.isArray(qe.reasoning_details)&&(qe.reasoning_details=qe.reasoning_details.filter(Ae=>An.has(Ae?.id)),console.log(`[OpenRouter] Filtered reasoning_details to ${qe.reasoning_details.length}`)),U.push(qe);for(const Ae of Zr){const Rt=Ae?.function?.name,Tn=Ae?.function?.arguments;let sr={};try{sr=Tn?JSON.parse(Tn):{}}catch{sr={_raw:Tn}}const kn=String(Ae?.id||"");l.push({t:Kr(),kind:"tool_call",name:String(Rt||""),id:kn,args:sr}),Wr(l);const Ga=performance.now(),Cn=await ed(String(Rt||""),sr,{payload:e.payload}),Pn=Math.round(performance.now()-Ga),M=Cn,Rn=!M?.error,re={};Rt==="get_player_profile_stats"&&(re.player_name=M?.player_name||sr?.player_name,re.profile_url=M?.profile_url||null,re.discovery=M?.discovery||null,re.mode=M?.mode||"live_dom",re.returned_to_draft=typeof M?.returned_to_draft=="boolean"?M.returned_to_draft:null,re.modal_reopened=typeof M?.modal_reopened=="boolean"?M.modal_reopened:null,re.navigated_to_profile=typeof M?.navigated_to_profile=="boolean"?M.navigated_to_profile:null,re.modal_was_open=typeof M?.modal_was_open=="boolean"?M.modal_was_open:null,re.header=!!M?.header_text,re.season_summary=M?.season_summary?.entries?M.season_summary.entries.length:null,re.recent_performances=M?.recent_performances?.entries?M.recent_performances.entries.length:null,re.feed_entries=Array.isArray(M?.feed_entries)?M.feed_entries.length:null,re.lines=Array.isArray(M?.interesting_lines)?M.interesting_lines.length:null,re.tables=Array.isArray(M?.tables)?M.tables.length:null,re.embedded_json=Array.isArray(M?.embedded_json)?M.embedded_json.length:null,re.facts=Array.isArray(M?.facts)?M.facts.length:null,re.recent_log=Array.isArray(M?.recent_log)?M.recent_log.length:null,M?.error&&(re.error=M.error),re.scraped_data={header_text:M?.header_text||null,season_summary:M?.season_summary||null,recent_performances:M?.recent_performances||null,feed_entries:M?.feed_entries||[]}),Rt==="search_draft_players"&&(re.query=M?.query||sr?.query||null,re.players_found=typeof M?.players_found=="number"?M.players_found:0,Array.isArray(M?.players)&&M.players.length>0&&(re.sample_players=M.players.slice(0,5).map(Ua=>Ua.name)),M?.error&&(re.error=M.error)),l.push({t:Kr(),kind:"tool_result",name:String(Rt||""),id:kn,ok:Rn,ms:Pn,summary:re}),Wr(l),U.push({role:"tool",tool_call_id:kn,content:JSON.stringify(Cn)})}}console.log("[OpenRouter] Messages after tool loop:",JSON.stringify(U,null,2));try{localStorage.setItem("RSDH_LAST_MESSAGES_SENT",JSON.stringify(U,null,2))}catch{}const ot={type:"json_schema",json_schema:{name:"draft_lineup",strict:!0,schema:Xc()}},le={model:t.model,messages:U,temperature:t.temperature,max_tokens:t.max_tokens,response_format:ot},Rr=I?[{label:"gemini+final+tools+tool_choice",body:{...le,tools:h,tool_choice:"none",plugins:N}},{label:"gemini+final+schema+plugins",body:{...le,plugins:N}},{label:"gemini+final+schema-only",body:{...le}}]:[{label:"final+tools+tool_choice+provider+plugins",body:{...le,tools:h,tool_choice:"none",provider:{require_parameters:!0},plugins:N}},{label:"final+tools+tool_choice",body:{...le,tools:h,tool_choice:"none",plugins:[]}},{label:"final+schema+plugins",body:{...le,plugins:N}},{label:"final+schema-only",body:{...le}}],{res:qt,usedLabel:fe}=await Po(Rr,{url:R,headers:x,timeoutMs:9e4});fe!==Rr[0].label&&(l.push({t:Kr(),kind:"routing_fallback",stage:"final",label:fe}),Wr(l));const Be=qt?.choices?.[0]?.message,it=Be?.content;if(!it)throw new Error("No content returned.");try{localStorage.setItem(Yl,it)}catch{}const Xr=Co(Be);try{localStorage.setItem(Ta,JSON.stringify(Xr,null,2))}catch{}try{localStorage.setItem(jl,JSON.stringify(U,null,2))}catch{}return l.push({t:Kr(),kind:"done"}),Wr(l),{jsonText:it,sources:Xr.length?Xr:D||[]}}function rd(e){try{localStorage.setItem(io,JSON.stringify(e,null,2))}catch{}}function Ro(e){try{window.dispatchEvent(new CustomEvent("rsdh-output",{detail:{raw:e}}))}catch{}}function Pr(e){try{window.dispatchEvent(new CustomEvent("rsdh-status",{detail:{text:e}}))}catch{}}function Oo(e,t=!1){const r=document.createElement("button");return r.type="button",r.textContent=e.toUpperCase(),r.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
    font-size: 11px;
    font-weight: 900;
    letter-spacing: 0.1em;
    padding: 12px 16px;
    border-radius: 2px;
    cursor: pointer;
    width: 100%;
    white-space: nowrap;
    transition: all 0.15s ease;
    ${t?`background: #00E5FF;
         color: #000;
         border: none;
         box-shadow: 0 4px 12px rgba(0, 229, 255, 0.3);`:`background: rgba(13, 13, 18, 0.8);
         color: #F5F5F7;
         border: 1px solid rgba(255, 255, 255, 0.1);
         box-shadow: none;`}
  `,r.addEventListener("mouseenter",()=>{r.style.transform="translateY(-2px)",t?r.style.boxShadow="0 8px 24px rgba(0, 229, 255, 0.5), 0 0 15px rgba(0, 229, 255, 0.4)":(r.style.background="rgba(255, 255, 255, 0.05)",r.style.borderColor="rgba(255, 255, 255, 0.3)",r.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)")}),r.addEventListener("mouseleave",()=>{r.style.transform="translateY(0)",t?r.style.boxShadow="0 4px 12px rgba(0, 229, 255, 0.3)":(r.style.background="rgba(13, 13, 18, 0.8)",r.style.borderColor="rgba(255, 255, 255, 0.1)",r.style.boxShadow="none")}),r.addEventListener("mousedown",()=>{r.style.transform="translateY(1px)"}),r}function nd(){const e=document.createElement("div");e.id="rsdh-modal-actions",e.style.cssText=`
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-top: 16px;
    padding: 20px 20px 0 20px;
    background: rgba(13, 13, 18, 0.4);
    border-top: 2px solid rgba(0, 229, 255, 0.2);
    position: relative;
    backdrop-filter: blur(8px);
  `;const t=document.createElement("div");return t.textContent="AI COMMANDS ENABLED",t.style.cssText=`
    grid-column: 1 / -1;
    font-size: 9px;
    font-weight: 900;
    color: #00E5FF;
    letter-spacing: 0.15em;
    margin-bottom: -4px;
    opacity: 0.6;
  `,e.appendChild(t),e}function ad(e){const r=Array.from(e.querySelectorAll("button,div,[role='button']")).find(n=>{const s=(n.innerText||n.textContent||"").trim();return/^(submit|update)$/i.test(s)});return r?r.parentElement||r:null}async function No(e){Pr("Capturing...");const t=uc({includeDebug:Tr()});if(rd(t),Ro(JSON.stringify(t,null,2)),!t||t.ok!==!0){const d=t?.error||"SIGNAL LOST: COULD NOT CAPTURE MODAL.";Pr(d),Cr(d);return}if(e==="copy_prompt"){const d=ho(t);GM_setClipboard(d),Pr("PROMPT GATHERED. COPIED TO CLIPBOARD."),Sn("PROMPT GATHERED.");return}const r=F(ka,"1")!=="0",n=F(xn,"1")!=="0",s=F(wn,"1")!=="0",a=String(F(Ca,"balanced")||"balanced"),i=r?"INITIATING MULTI-SOURCE AI SCAN...":"INITIATING AI CORE SCAN...";Pr(i),xo(i);const c=go(t,{webHint:r,toolHint:n,searchHint:s,strategy:a}),l=await td({prompt:c,web:r,payload:t});Ro(l.jsonText),Pr("DATA SYNC COMPLETE. AI ANALYSIS READY."),Sn("SYNC COMPLETE.")}function sd(){const e=()=>{const r=kr();if(!r||r.querySelector("#rsdh-modal-actions"))return;const n=nd(),s=Oo("Copy Prompt"),a=Oo("Ask AI",!0);s.addEventListener("click",()=>No("copy_prompt").catch(c=>{const l=String(c?.message||c);Pr(l),Cr(l)})),a.addEventListener("click",()=>No("ask_ai").catch(c=>{const l=String(c?.message||c);Pr(l),Cr(l)})),n.appendChild(s),n.appendChild(a);const i=ad(r);i&&i.parentElement?i.parentElement.insertBefore(n,i.nextSibling):r.appendChild(n)};e(),new MutationObserver(()=>e()).observe(document.documentElement,{childList:!0,subtree:!0})}const Io="rsdh_openrouter_models_cache",od=1440*60*1e3,Kn=["google/gemini-2.5-flash","google/gemini-2.5-pro","google/gemini-2.0-flash-001","anthropic/claude-sonnet-4","anthropic/claude-3.5-sonnet","anthropic/claude-3.5-haiku","openai/gpt-4o","openai/gpt-4o-mini","openai/gpt-4-turbo","openai/o1","openai/o1-mini","meta-llama/llama-3.3-70b-instruct","deepseek/deepseek-chat-v3-0324","mistralai/mistral-large","qwen/qwen-2.5-72b-instruct"];function Mo(){try{const e=localStorage.getItem(Io);if(!e)return null;const t=JSON.parse(e);return Date.now()-t.timestamp>od?null:t}catch{return null}}function id(e){try{const t={models:e,timestamp:Date.now()};localStorage.setItem(Io,JSON.stringify(t))}catch{}}async function ld(){const e=Mo();if(e&&e.models.length>0)return e.models;try{if(typeof GM_xmlhttpRequest!="function")return Kn;const t=await new Promise((r,n)=>{GM_xmlhttpRequest({method:"GET",url:"https://openrouter.ai/api/v1/models",headers:{"Content-Type":"application/json"},timeout:1e4,onload:s=>{try{const a=s?.responseText?JSON.parse(s.responseText):null;r(a)}catch{n(new Error("Failed to parse models response"))}},onerror:()=>n(new Error("Network error")),ontimeout:()=>n(new Error("Request timed out"))})});if(t?.data&&Array.isArray(t.data)){const r=t.data.map(n=>n.id).filter(n=>n&&!n.includes(":free")&&!n.includes(":extended")).sort((n,s)=>{const a=["google/","anthropic/","openai/","meta-llama/","deepseek/","mistralai/"],i=a.findIndex(l=>n.startsWith(l)),c=a.findIndex(l=>s.startsWith(l));return i!==-1&&c===-1?-1:c!==-1&&i===-1?1:i!==-1&&c!==-1?i-c:n.localeCompare(s)});if(r.length>0)return id(r),r}return Kn}catch{return Kn}}function cd(){return Mo()?.models||Kn}const Lo="rsdh_svelte_ui_state";function Ba(){try{const e=localStorage.getItem(Lo);if(!e)return{tab:"context",hidden:!1};const t=JSON.parse(e),r=String(t?.tab||"context");return{tab:r==="settings"?"settings":r==="results"?"results":r==="debug"?"debug":"context",hidden:!!t?.hidden}}catch{return{tab:"context",hidden:!1}}}function qa(e){const r={...Ba(),...e};try{localStorage.setItem(Lo,JSON.stringify(r))}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-ui-state",{detail:r}))}catch{}}var dd=w('<div class="spinner"></div>'),ud=w('<span> <!></span> <span class="text-accent"></span>',1),fd=w('<span> <!></span> <span class="text-accent"></span>',1),pd=w('<div class="ticker-content"><!> <!></div>'),md=w('<div class="ticker-content" style="animation-duration: 15s;"><span>WAITING FOR DRAFT DATA...</span> <span class="text-accent"></span> <span>AI ANALYSIS READY...</span> <span class="text-accent"></span> <span>WAITING FOR DRAFT DATA...</span> <span class="text-accent"></span> <span>AI ANALYSIS READY...</span> <span class="text-accent"></span></div>'),vd=w('<button style="--rsdh-accent: #f59e0b;">Debug</button>'),hd=w('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),gd=w("<div><!></div>"),_d=w(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">NO SIGNAL DETECTED</h3> <p class="empty-description">Awaiting input from RealSports draft modal. Capture to initiate
          analysis.</p> <div class="empty-hint"><span class="text-accent">READY TO RECEIVE</span></div></div>`),yd=w('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),bd=w("<div><!></div>"),xd=w(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">AI CO-PILOT OFFLINE</h3> <p class="empty-description">Execute 'ASK AI' to generate real-time roster optimizations and fit
          scores.</p> <div class="empty-hint"><span class="text-green">SYSTEMS READY</span></div></div>`),wd=w('<img alt="" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--rsdh-accent);"/>'),Sd=w('<div style="width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center;"></div>'),Ed=w('<div style="font-weight: 600; color: rgba(255,255,255,0.9);"> </div>'),Ad=w('<div class="sub" style="margin-top: 8px; color: rgba(245,158,11,0.9);"> </div>'),Td=w('<div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;"><!> <div><!> <div class="sub"> </div></div></div> <div style="display: flex; gap: 8px; flex-wrap: wrap;"><button style="font-size: 11px;"> Update</button> <button class="secondary" style="font-size: 11px;">Unlink</button></div> <!>',1),kd=w('<div class="sub" style="margin-top: 8px; color: rgba(245,158,11,0.9);"> </div>'),Cd=w('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(245,158,11,0.08); border-radius: 6px; border-left: 2px solid rgba(245,158,11,0.4);">Link your RealSports account to enable usage tracking.</div> <button> Link Account</button> <!>',1),Pd=w('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(255,200,0,0.08); border-radius: 6px; border-left: 2px solid rgba(255,200,0,0.4);">Your API key is stored locally and never shared.</div> <label class="sub" for="or-key">API Key</label> <input id="or-key" style="width:100%; margin-bottom:8px;" type="password" placeholder="sk-or-..."/>',1),Rd=w("<option> </option>"),Od=w('<datalist id="model-list"></datalist>'),Nd=w('<div style="grid-column: span 2; padding: 8px; background: rgba(0,229,255,0.03); border: 1px dashed rgba(0,229,255,0.2); border-radius: 4px; text-align: center; margin-top: 4px;"><span class="sub" style="font-size: 9px; color: var(--rsdh-accent); opacity: 0.8;"> SETTINGS_LOADED_FROM_PROXY</span></div>'),Id=w('<div><label class="sub" for="or-web"> </label> <input id="or-web" style="width:100%;" type="range" min="1" max="5" step="1"/></div>'),Md=w('<label class="sub" for="or-key">Your OpenRouter API Key</label> <input id="or-key" style="width:100%; margin-bottom:8px;" type="password" placeholder="sk-or-..."/> <div class="sub" style="color: rgba(245,158,11,0.8);"> Your key is stored locally. You will be billed directly.</div>',1),Ld=w('<div style="margin-top: 8px;"><select style="width:100%; padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.15); background: rgba(0,0,0,0.3); color: #fff; font-size: 13px;"><option> Player Profile Lookup</option><option> Draft Player Search</option></select></div>'),Dd=w("<span> </span>"),Fd=w("<span> </span>"),$d=w("<span> </span>"),Bd=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),qd=w('<div style="display: flex; flex-wrap: wrap; gap: 16px; font-size: 13px; color: rgba(255,255,255,0.7);"><span><strong> </strong></span> <!> <span> </span> <!> <!></div> <div style="font-size: 11px; color: rgba(255,255,255,0.4); margin-top: 6px;"> </div>',1),Gd=w('<div class="sub">Unable to parse payload</div>'),Ud=w('<div class="sub">No capture yet. Open a draft modal and click Capture.</div>'),zd=w("&nbsp;|&nbsp; <strong>Draft:</strong> <span> </span>",1),Hd=w('&nbsp;|&nbsp; <span style="color: rgba(255,255,255,0.6);"> </span>',1),Yd=w(' <span style="color: #22c55e;"> </span>',1),jd=w(' <span style="color: rgba(255,255,255,0.4);">Empty</span>',1),Jd=w('<div style="padding: 2px 0; font-size: 11px;"> <span style="color: var(--rsdh-accent-light);"> </span> <!></div>'),Kd=w('<div style="margin-left: 12px; margin-top: 4px;"></div>'),Wd=w('<span class="sub">None detected</span>'),Xd=w("<span> </span>"),Vd=w('<span style="color: #9ca3af; font-size: 10px; padding: 1px 4px; border-radius: 3px; background: rgba(156,163,175,0.1);"> </span>'),Zd=w('<div style="padding: 2px 0; font-size: 11px; display: flex; gap: 8px; flex-wrap: wrap; align-items: center;"><span style="min-width: 140px;"> </span> <span style="color: var(--rsdh-accent-light); min-width: 50px;"> </span> <!> <!></div>'),Qd=w('<div class="sub" style="margin-top: 4px;"> </div>'),eu=w('<div style="margin-left: 12px; margin-top: 4px; max-height: 120px; overflow-y: auto;"><!> <!></div>'),tu=w('<span class="sub">None detected</span>'),ru=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),nu=w('<span style="color: #22c55e; font-weight: 600;"> </span>'),au=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),su=w('<span style="color: #22c55e; font-weight: 600;"> </span>'),ou=w('<div style="margin-bottom: 10px;"><strong> Game Matchup:</strong> <div style="margin-left: 12px; margin-top: 4px; font-size: 11px;"><div style="display: flex; gap: 8px; align-items: center;"><span> </span> <!> <!> <span style="color: rgba(255,255,255,0.4);">vs</span> <span> </span> <!> <!></div> <div style="margin-top: 4px; color: rgba(255,255,255,0.5);"><!> <!> <!></div></div></div>'),iu=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),lu=w('<span style="color: rgba(255,255,255,0.5);"> </span>'),cu=w('<div style="padding: 2px 0; font-size: 11px;"> <!></div>'),du=w('<div class="sub"> </div>'),uu=w('<div><strong> </strong> <div style="margin-left: 12px; margin-top: 4px;"><!> <!></div></div>'),fu=w('<div style="font-size: 12px; color: rgba(255,255,255,0.75); line-height: 1.6;"><div style="margin-bottom: 10px;"><strong>Sport:</strong> <strong>Mode:</strong> <!> <!></div> <div style="margin-bottom: 10px;"><strong> </strong> <!></div> <div style="margin-bottom: 10px;"><strong> </strong> <!></div> <!> <!></div>'),pu=w('<div class="sub">No data captured yet</div>'),mu=w('<textarea readonly="" style="min-height: 100px; font-size: 10px; margin-top: 6px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy Chat</button>',1),vu=w('<div class="sub" style="margin-top: 6px;">Capture a draft modal to generate</div>'),hu=w('<textarea readonly="" style="min-height: 100px; font-size: 10px; margin-top: 6px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy Structured</button>',1),gu=w('<div class="sub" style="margin-top: 6px;">Use Ask AI to generate</div>'),_u=w('<br/>Found: <span style="color: #22c55e;"> </span>',1),yu=w("Query: <strong> </strong> <!>",1),bu=w("<br/> ",1),xu=w("Player: <strong> </strong> <!>",1),wu=w('<div style="background: rgba(255,255,255,0.04); border-radius: 8px; padding: 10px; border-left: 3px solid var(--rsdh-accent);"><div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;"><span style="font-weight: 600; font-size: 12px; color: var(--rsdh-accent-light);"> </span></div> <div style="font-size: 11px; color: rgba(255,255,255,0.7);"><!></div></div>'),Su=w(`<div class="sub">Tool calls detected but couldn't parse details. Check Raw
                    Data.</div>`),Eu=w('<div style="display: flex; flex-direction: column; gap: 8px;"><!> <!></div>'),Au=w('<div class="sub">No tools were called</div>'),Tu=w('<div style="padding: 3px 0; font-size: 11px; display: flex; gap: 8px; align-items: baseline;"><span style="color: var(--rsdh-accent-light); min-width: 20px;"> </span> <span style="min-width: 140px; font-weight: 500;"> </span> <span style="color: rgba(255,255,255,0.5); font-size: 10px;"> <span style="color: #22c55e;"> </span></span></div>'),ku=w('<div style="margin-left: 12px; margin-top: 4px;"></div>'),Cu=w('<span class="sub">None</span>'),Pu=w('<div style="padding: 4px 0; font-size: 11px; display: flex; gap: 8px; align-items: baseline;"><span style="min-width: 70px; font-weight: 500;"> </span> <span> </span> <span style="color: rgba(255,255,255,0.5); font-size: 10px; flex: 1;"> </span></div>'),Ru=w('<div style="margin-left: 12px; margin-top: 4px;"></div>'),Ou=w('<span class="sub">None</span>'),Nu=w('<div style="font-size: 12px; color: rgba(255,255,255,0.75); line-height: 1.6;"><div style="margin-bottom: 12px;"><strong> </strong> <!></div> <div><strong>Bet Recommendations:</strong> <!></div></div>'),Iu=w('<div class="sub">No response yet</div>'),Mu=w('<div style="padding: 2px 0;"> </div>'),Lu=w('<details class="timeline-step"><summary class="timeline-summary"><span class="timeline-icon success"></span> <span class="timeline-title">Web Search</span> <span class="timeline-status"> </span></summary> <div class="timeline-content"><div style="font-size: 11px; color: rgba(255,255,255,0.6);"></div></div></details>'),Du=w(`<div><div class="card" style="border-left: 3px solid var(--rsdh-accent);"><div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;"><span style="font-size: 18px;"></span> <span style="font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em;">TELEMETRY SUMMARY</span></div> <!></div> <div class="card"><div class="h" style="margin-bottom: 12px;"> Request Timeline</div> <details class="timeline-step" open><summary class="timeline-summary"><span> </span> <span class="timeline-title">1. Capture</span> <span class="timeline-status"><!></span></summary> <div class="timeline-content"><!></div></details> <details class="timeline-step"><summary class="timeline-summary"><span> </span> <span class="timeline-title">2. Prompt Built</span> <span class="timeline-status"> </span></summary> <div class="timeline-content"><div style="font-size: 11px; color: rgba(255,255,255,0.5); margin-bottom: 8px;">Two prompts are generated: <strong>Chat</strong> (for copy/paste
              to chatbots) and <strong>Structured</strong> (for OpenRouter with tool
              hints).</div> <details class="details" style="margin-bottom: 8px;"><summary style="font-size: 11px;"> Chat Prompt (for copy/paste)</summary> <!></details> <details class="details" open><summary style="font-size: 11px;"> Structured Prompt (for OpenRouter/API)</summary> <!></details></div></details> <details class="timeline-step"><summary class="timeline-summary"><span> </span> <span class="timeline-title">3. Tool Calls</span> <span class="timeline-status"><!></span></summary> <div class="timeline-content"><!></div></details> <details class="timeline-step"><summary class="timeline-summary"><span> </span> <span class="timeline-title">4. AI Response</span> <span class="timeline-status"><!></span></summary> <div class="timeline-content"><!></div></details> <!></div> <div class="card"><details class="details"><summary style="font-size: 13px; font-weight: 600;"> Raw Data</summary> <div style="margin-top: 12px;"><details class="details" style="margin-bottom: 8px;"><summary style="font-size: 12px;">Capture JSON</summary> <textarea readonly="" style="min-height: 100px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy</button></details> <details class="details" style="margin-bottom: 8px;"><summary style="font-size: 12px;">Tool Trace</summary> <textarea readonly="" style="min-height: 100px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy</button></details> <details class="details" style="margin-bottom: 8px;"><summary style="font-size: 12px;">AI Response JSON</summary> <textarea readonly="" style="min-height: 100px;"></textarea> <button class="secondary" style="margin-top:4px; font-size:10px; padding:4px 8px;"> Copy</button></details> <details class="details"><summary style="font-size: 12px;">Prompts</summary> <div class="sub" style="margin: 6px 0 4px;">Chat Prompt:</div> <textarea readonly="" style="min-height: 60px;"></textarea> <div class="sub" style="margin: 8px 0 4px;">Structured Prompt:</div> <textarea readonly="" style="min-height: 60px;"></textarea></details></div></details></div></div>`),Fu=w('<div class="panel"><div class="texture-overlay"></div> <div class="header"><div class="title"><i></i> BROADCAST COMMAND CENTER</div> <div class="flex-row"><!> <button class="secondary" style="width: auto; padding: 6px 10px;">EXIT</button></div></div> <div class="ticker-container"><div class="ticker-label">LIVE FEED</div> <div class="ticker-wrapper"><!></div></div> <div class="tabs"><button>Context</button> <button>Results</button> <button>Settings</button> <!></div> <div><!></div> <div><!></div> <div><div class="card"><div class="h"><span>ACCOUNT IDENTITY</span></div> <!></div> <div class="card"><div class="h"><span>API ENDPOINT CONFIG</span></div> <!> <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 8px;"><div style="grid-column: span 2;"><label class="sub" for="or-model">Model</label> <input id="or-model" type="text" list="model-list"/> <!></div> <div><label class="sub" for="or-max">Max tokens</label> <input id="or-max" type="text"/></div> <div style="grid-column: span 2;"><label class="sub" for="or-temp"> </label> <input id="or-temp" type="range" min="0" max="2" step="0.1"/></div> <!></div> <label><input type="checkbox"/> <span><strong>Web Search</strong><br/><span class="sub">Search the web for current player news and updates</span></span></label> <!> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Player Profile Lookup</strong><br/><span class="sub">Allow AI to look up detailed player stats from their profile</span></span></label> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Draft Player Search</strong><br/><span class="sub">Allow AI to search for players not in the initial ~50 shown</span></span></label> <div style="margin-top: 16px;"><label class="sub" for="lineup-strategy">Lineup Strategy</label> <select id="lineup-strategy" style="width:100%; margin-top: 4px; padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.15); background: rgba(0,0,0,0.3); color: #fff; font-size: 13px;"><option> Safe - Consistent, high floor players</option><option> Balanced - Mix of floor and upside</option><option> Risky - Boom-or-bust, high ceiling</option></select> <div class="sub" style="margin-top: 4px;"><!></div></div></div> <div class="card"><details class="details" style="margin: -12px -14px; padding: 12px 14px;"><summary> Advanced</summary> <div style="margin-top: 12px;"><label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-bottom: 12px;"><input type="checkbox"/> <span><strong>Use my own API key</strong><br/><span class="sub">Bypass hosted proxy and call OpenRouter directly</span></span></label> <!> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Debug Mode</strong><br/><span class="sub">Show Debug tab with raw data and developer tools</span></span></label> <label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px;"><input type="checkbox"/> <span><strong>Force Tool Call</strong><br/><span class="sub">Make AI always use a specific tool before analyzing</span></span></label> <!></div></details></div> <div style="display:flex; gap:8px; margin-top:14px;"><button style="display:flex; align-items:center; justify-content:center; gap:6px;"><span></span> Save Settings</button></div></div> <!></div>');function $u(e,t){cs(t,!1);let r=Z("context"),n=Z(""),s=Z(""),a=Z(""),i=Z(!1),c=Z(""),l=Z(""),d=Z(""),u=Z(""),f=Z(""),m=Z(""),h="",k=Z(""),S=Z(!1),b=Z(""),x=Z(wr),R=Z(Hn),N=Z(String(Yn)),L=Z(yn),U=!0,Y=!0,D=Z("none"),I=Z(!1),ot=Z(!0),le=Z(!0),Rr=Z(!0),qt=Z("balanced"),fe=Z(null),Be=Z(null),it=Z("");async function Xr(){if(A(it,"Navigating to profile..."),!await xc()){A(it,"Could not find profile button. Are you on realsports.io?"),Cr("Profile button not found");return}await new Promise($=>setTimeout($,800));const E=wc();E?(gc(E),A(Be,E),A(it,""),Sn(`Linked as @${E.username}`)):(A(it,"Could not find profile. Make sure you're logged in."),Cr("Profile not found"))}function Ct(){_c(),A(Be,null),xo("Account unlinked")}let Gt=Z(cd());function nr(g){g==="debug"&&!o(S)&&(g="context"),A(r,g),qa({tab:g})}Tl(()=>{const g=Ba();A(S,Tr()),A(r,g.tab==="debug"&&!o(S)?"context":g.tab),A(s,mc()),A(n,o(s)),En(),A(b,String(F(xa,"")||"")),A(x,String(F(wa,wr)||wr)),A(R,parseFloat(String(F(Sa,Hn)))||Hn),A(N,String(F(Ea,Yn))),A(L,parseInt(String(F(Aa,yn)),10)||yn),U=String(F(Un,!0))==="1"||F(Un,!0)===!0,Y=String(F(zn,!0))==="1"||F(zn,!0)===!0;const E=String(F(Sr,"0"))==="1"||F(Sr,"0")===!0,$=String(F(Er,"0"))==="1"||F(Er,"0")===!0;A(D,E?"profile":$?"search":"none"),A(I,String(F(Ar,"0"))==="1"||F(Ar,"0")===!0),A(ot,F(xn,"1")!=="0"),A(le,F(ka,"1")!=="0"),A(Rr,F(wn,"1")!=="0"),A(qt,String(F(Ca,"balanced")||"balanced")),A(Be,Na()),ld().then(H=>{A(Gt,H)}),bn&&jn&&fetch(`${jn}/api/info`).then(H=>H.json()).then(H=>{A(fe,H)}).catch(()=>{});const z=H=>{};document.addEventListener("click",z,!0);const V=H=>{const ae=H.detail;if(ae?.raw){try{const Ge=JSON.parse(ae.raw);if(Ge?.ok===!0){A(n,ae.raw),A(s,ae.raw),A(l,""),A(m,""),A(f,"");try{A(d,vc(ae.raw))}catch{A(d,"")}try{A(u,hc(ae.raw))}catch{A(u,"")}En(),A(r,"context");return}if(Ge&&Array.isArray(Ge.lineup)&&Array.isArray(Ge.bets)){A(l,ae.raw);try{const Ot=JSON.parse(localStorage.getItem(Ta)||"[]");A(f,Array.isArray(Ot)?Ot.join(`
`):String(Ot))}catch{A(f,"")}try{A(m,String(localStorage.getItem(lo)||""))}catch{A(m,"")}try{h=String(localStorage.getItem(Jn)||"")}catch{h=""}let mt;try{mt=JSON.parse(o(s)||"{}")?.draft_type}catch{}A(k,ko(Ge,o(f)?o(f).split(`
`):[],mt)),A(r,"results");return}}catch{}A(n,ae.raw),En(),A(r,"context")}},q=()=>{try{h=String(localStorage.getItem(Jn)||"")}catch{h=""}};return window.addEventListener("rsdh-output",V),window.addEventListener("rsdh-debug-events",q),()=>{document.removeEventListener("click",z,!0),window.removeEventListener("rsdh-output",V),window.removeEventListener("rsdh-debug-events",q)}});function En(){const g=(o(n)||"").trim();if(!g){A(a,'<div class="card"><div class="h">Output</div><div class="sub">Capture a draft modal or run Ask AI.</div></div>');return}try{const E=JSON.parse(g);if(E&&E.ok===!0){A(a,Jc(E));return}if(E&&Array.isArray(E.lineup)&&Array.isArray(E.bets)){let $=[];try{$=JSON.parse(localStorage.getItem(Ta)||"[]")||[]}catch{}let z;try{z=JSON.parse(o(s)||"{}")?.draft_type}catch{}A(a,ko(E,$,z));return}}catch{}A(a,`<div class="card"><div class="h">Output</div><pre class="code-output">${g.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</pre></div>`)}function ar(g){try{GM_setClipboard(g),Sn("Copied to clipboard!")}catch(E){const $=`Copy failed: ${String(E?.message||E)}`;Cr($)}}function Pt(){const g=parseInt(o(N),10);if(isNaN(g)||g<1){A(N,"1"),Cr("Max tokens must be at least 1");return}o(b).trim()&&o(b).trim()!=="********"&&ye(xa,o(b).trim()),ye(wa,(o(x)||wr).trim()),ye(Sa,String(o(R))),ye(Ea,String(g)),ye(Aa,String(o(L))),ye(Un,U?"1":"0"),ye(zn,Y?"1":"0"),ye(Sr,o(D)==="profile"?"1":"0"),ye(Er,o(D)==="search"?"1":"0"),ye(Ar,o(I)?"1":"0"),ye(xn,o(ot)?"1":"0"),ye(ka,o(le)?"1":"0"),ye(wn,o(Rr)?"1":"0"),Jl(o(S)),!o(S)&&o(r)==="debug"&&nr("context"),Sn("Settings saved!")}Fl();var Ut=Fu(),Vr=v(p(Ut),2),Zr=v(p(Vr),2),An=p(Zr);{var qe=g=>{var E=dd();y(g,E)};C(An,g=>{o(i)&&g(qe)})}var Ae=v(An,2),Rt=v(Vr,2),Tn=v(p(Rt),2),sr=p(Tn);{var kn=g=>{const E=Ne(()=>JSON.parse(o(s))),$=Ne(()=>o(E).player_pool?.length||4),z=Ne(()=>Math.max(20,o($)*1.5));var V=Et(),q=te(V);{var H=ae=>{var Ge=pd(),mt=p(Ge);Tt(mt,1,()=>o(E).player_pool,At,(or,lt)=>{var zt=ud(),Or=te(zt),Ht=p(Or),me=v(Ht);{var Re=Ke=>{var ir=Me();O(en=>T(ir,`(${en??""}x)`),[()=>o(lt).boost_x.toFixed(1)]),y(Ke,ir)};C(me,Ke=>{o(lt).boost_x&&Ke(Re)})}O(()=>T(Ht,o(lt).name)),y(or,zt)});var Ot=v(mt,2);Tt(Ot,1,()=>o(E).player_pool,At,(or,lt)=>{var zt=fd(),Or=te(zt),Ht=p(Or),me=v(Ht);{var Re=Ke=>{var ir=Me();O(en=>T(ir,`(${en??""}x)`),[()=>o(lt).boost_x.toFixed(1)]),y(Ke,ir)};C(me,Ke=>{o(lt).boost_x&&Ke(Re)})}O(()=>T(Ht,o(lt).name)),y(or,zt)}),O(()=>kt(Ge,`animation-duration: ${o(z)??""}s;`)),y(ae,Ge)};C(q,ae=>{o(E).player_pool&&ae(H)})}y(g,V)},Ga=g=>{var E=md();y(g,E)};C(sr,g=>{o(s)?g(kn):g(Ga,!1)})}var Cn=v(Rt,2),Pn=p(Cn),M=v(Pn,2),Rn=v(M,2),re=v(Rn,2);{var Ua=g=>{var E=vd();O(()=>st(E,1,`tab ${o(r)==="debug"?"active":""}`)),de("click",E,()=>nr("debug")),y(g,E)};C(re,g=>{o(S)&&g(Ua)})}var za=v(Cn,2),zu=p(za);{var Hu=g=>{var E=hd(),$=v(p(E),2),z=p($);O(()=>T(z,o(c))),y(g,E)},Yu=g=>{var E=Et(),$=te(E);{var z=q=>{var H=gd(),ae=p(H);Xs(ae,()=>o(a)),y(q,H)},V=q=>{var H=_d();y(q,H)};C($,q=>{o(a)?q(z):q(V,!1)},!0)}y(g,E)};C(zu,g=>{o(i)?g(Hu):g(Yu,!1)})}var Ha=v(za,2),ju=p(Ha);{var Ju=g=>{var E=yd(),$=v(p(E),2),z=p($);O(()=>T(z,o(c))),y(g,E)},Ku=g=>{var E=Et(),$=te(E);{var z=q=>{var H=bd(),ae=p(H);Xs(ae,()=>o(k)),y(q,H)},V=q=>{var H=xd();y(q,H)};C($,q=>{o(k)?q(z):q(V,!1)},!0)}y(g,E)};C(ju,g=>{o(i)?g(Ju):g(Ku,!1)})}var Ya=v(Ha,2),Fo=p(Ya),Wu=v(p(Fo),2);{var Xu=g=>{var E=Td(),$=te(E),z=p($);{var V=me=>{var Re=wd();O(()=>eo(Re,"src",o(Be).avatarUrl)),y(me,Re)},q=me=>{var Re=Sd();y(me,Re)};C(z,me=>{o(Be).avatarUrl?me(V):me(q,!1)})}var H=v(z,2),ae=p(H);{var Ge=me=>{var Re=Ed(),Ke=p(Re);O(()=>T(Ke,o(Be).displayName)),y(me,Re)};C(ae,me=>{o(Be).displayName&&o(Be).displayName!==o(Be).username&&me(Ge)})}var mt=v(ae,2),Ot=p(mt),or=v($,2),lt=p(or),zt=v(lt,2),Or=v(or,2);{var Ht=me=>{var Re=Ad(),Ke=p(Re);O(()=>T(Ke,o(it))),y(me,Re)};C(Or,me=>{o(it)&&me(Ht)})}O(()=>T(Ot,`@${o(Be).username??""}`)),de("click",lt,Xr),de("click",zt,Ct),y(g,E)},Vu=g=>{var E=Cd(),$=v(te(E),2),z=v($,2);{var V=q=>{var H=kd(),ae=p(H);O(()=>T(ae,o(it))),y(q,H)};C(z,q=>{o(it)&&q(V)})}de("click",$,Xr),y(g,E)};C(Wu,g=>{o(Be)?g(Xu):g(Vu,!1)})}var $o=v(Fo,2),Bo=v(p($o),2);{var Zu=g=>{var E=Pd(),$=v(te(E),4);ro($,()=>o(b),z=>A(b,z)),y(g,E)};C(Bo,g=>{bn||g(Zu)})}var qo=v(Bo,2),Go=p(qo),Qr=v(p(Go),2),Qu=v(Qr,2);{var ef=g=>{var E=Od();Tt(E,5,()=>o(Gt),At,($,z)=>{var V=Rd(),q=p(V),H={};O(()=>{T(q,o(z)),H!==(H=o(z))&&(V.value=(V.__value=o(z))??"")}),y($,V)}),y(g,E)};C(Qu,g=>{o(I)&&g(ef)})}var Uo=v(Go,2),Wn=v(p(Uo),2),zo=v(Uo,2),Ho=p(zo),tf=p(Ho),Xn=v(Ho,2),rf=v(zo,2);{var nf=g=>{var E=Nd();y(g,E)};C(rf,g=>{o(I)||g(nf)})}var ja=v(qo,2),Ja=p(ja),Yo=v(ja,2);{var af=g=>{var E=Id(),$=p(E),z=p($),V=v($,2);O(()=>{kt(E,`margin-top:8px; margin-left: 28px; ${o(I)?"":"opacity: 0.6;"}`),T(z,`Max results: ${(!o(I)&&o(fe)?.webMaxResults!==void 0?o(fe).webMaxResults:o(L))??""}`),ft(V,!o(I)&&o(fe)?.webMaxResults!==void 0?o(fe).webMaxResults:o(L)),V.disabled=!o(I)}),de("input",V,q=>o(I)&&A(L,parseInt(q.target.value,10))),y(g,E)};C(Yo,g=>{(!o(I)&&o(fe)?.enableWebSearch!==void 0?o(fe).enableWebSearch:o(le))&&g(af)})}var jo=v(Yo,2),sf=p(jo),Jo=v(jo,2),of=p(Jo),lf=v(Jo,2),Vn=v(p(lf),2);O(()=>{o(qt),Fs(()=>{})});var Ka=p(Vn);Ka.value=Ka.__value="safe";var Wa=v(Ka);Wa.value=Wa.__value="balanced";var Ko=v(Wa);Ko.value=Ko.__value="risky";var cf=v(Vn,2),df=p(cf);{var uf=g=>{var E=Me("Prioritizes consistent performers for reliable results");y(g,E)},ff=g=>{var E=Et(),$=te(E);{var z=q=>{var H=Me("Targets high upside players for ceiling plays");y(q,H)},V=q=>{var H=Me("Default strategy balancing consistency and upside");y(q,H)};C($,q=>{o(qt)==="risky"?q(z):q(V,!1)},!0)}y(g,E)};C(df,g=>{o(qt)==="safe"?g(uf):g(ff,!1)})}var Wo=v($o,2),pf=p(Wo),mf=v(p(pf),2),Xo=p(mf),vf=p(Xo),Vo=v(Xo,2);{var hf=g=>{var E=Md(),$=v(te(E),2);ro($,()=>o(b),z=>A(b,z)),y(g,E)};C(Vo,g=>{o(I)&&g(hf)})}var Zo=v(Vo,2),gf=p(Zo),Qo=v(Zo,2),ei=p(Qo),_f=v(Qo,2);{var yf=g=>{var E=Ld(),$=p(E);O(()=>{o(D),Fs(()=>{})});var z=p($);z.value=z.__value="profile";var V=v(z);V.value=V.__value="search",Zs($,()=>o(D),q=>A(D,q)),de("change",$,()=>{ye(Sr,o(D)==="profile"?"1":"0"),ye(Er,o(D)==="search"?"1":"0")}),y(g,E)};C(_f,g=>{o(D)!=="none"&&g(yf)})}var bf=v(Wo,2),xf=p(bf),wf=v(Ya,2);{var Sf=g=>{var E=Du(),$=p(E),z=v(p($),2);{var V=P=>{const _=Ne(()=>(()=>{try{return JSON.parse(o(s))}catch{return null}})());var Q=Et(),Ue=te(Q);{var Yt=se=>{var G=qd(),oe=te(G),ge=p(oe),Nt=p(ge),jt=p(Nt),lr=v(ge,2);{var Nr=K=>{var ie=Dd(),we=p(ie);O(()=>{kt(ie,`color: ${o(_).draft_type==="game"?"#f59e0b":"inherit"};`),T(we,o(_).draft_type==="game"?" Game Draft":" League Draft")}),y(K,ie)};C(lr,K=>{o(_).draft_type&&K(Nr)})}var Jt=v(lr,2),cr=p(Jt),Xe=v(Jt,2);{var ce=K=>{var ie=Fd(),we=p(ie);O(()=>T(we,` ${o(_).game_matchup.team1??""} vs ${o(_).game_matchup.team2??""}`)),y(K,ie)},be=K=>{var ie=Et(),we=te(ie);{var It=Ve=>{var ct=$d(),Ir=p(ct);O(()=>T(Ir,` ${o(_).games.length??""} games`)),y(Ve,ct)};C(we,Ve=>{o(_).games?.length&&Ve(It)},!0)}y(K,ie)};C(Xe,K=>{o(_).game_matchup?K(ce):K(be,!1)})}var vt=v(Xe,2);{var ve=K=>{var ie=Bd(),we=p(ie);O(()=>T(we,`${o(_).game_entries_remaining??""} entries left`)),y(K,ie)};C(vt,K=>{typeof o(_).game_entries_remaining=="number"&&K(ve)})}var xe=v(oe,2),_e=p(xe);O(K=>{T(jt,o(_).sport||"Unknown"),T(cr,` ${(o(_).player_pool_count||o(_).player_pool?.length||"?")??""} players`),T(_e,`Captured: ${K??""}`)},[()=>o(_).captured_at?new Date(o(_).captured_at).toLocaleTimeString():"Unknown"]),y(se,G)},We=se=>{var G=Gd();y(se,G)};C(Ue,se=>{o(_)?se(Yt):se(We,!1)})}y(P,Q)},q=P=>{var _=Ud();y(P,_)};C(z,P=>{o(s)?P(V):P(q,!1)})}var H=v($,2),ae=v(p(H),2),Ge=p(ae),mt=p(Ge),Ot=p(mt),or=v(mt,4),lt=p(or);{var zt=P=>{const _=Ne(()=>(()=>{try{return JSON.parse(o(n))}catch{return null}})());var Q=Me();O(()=>T(Q,`${(o(_)?.player_pool_count||o(_)?.player_pool?.length||"?")??""} players,
                ${(o(_)?.slots?.length||"?")??""} slots`)),y(P,Q)},Or=P=>{var _=Me("Pending");y(P,_)};C(lt,P=>{o(n)?P(zt):P(Or,!1)})}var Ht=v(Ge,2),me=p(Ht);{var Re=P=>{const _=Ne(()=>(()=>{try{return JSON.parse(o(n))}catch{return null}})());var Q=Et(),Ue=te(Q);{var Yt=We=>{var se=fu(),G=p(se),oe=v(p(G)),ge=v(oe,2),Nt=v(ge);{var jt=W=>{var pe=zd(),ze=v(te(pe),3),He=p(ze);O(()=>{kt(ze,`color: ${o(_).draft_type==="game"?"#f59e0b":"inherit"};`),T(He,o(_).draft_type==="game"?" Game":" League")}),y(W,pe)};C(Nt,W=>{o(_).draft_type&&W(jt)})}var lr=v(Nt,2);{var Nr=W=>{var pe=Hd(),ze=v(te(pe)),He=p(ze);O(()=>T(He,`${o(_).game_entries_remaining??""} entries left`)),y(W,pe)};C(lr,W=>{typeof o(_).game_entries_remaining=="number"&&W(Nr)})}var Jt=v(G,2),cr=p(Jt),Xe=p(cr),ce=v(cr,2);{var be=W=>{var pe=Kd();Tt(pe,5,()=>o(_).slots,At,(ze,He,dr)=>{var Ze=Jd(),Oe=p(Ze);Oe.nodeValue=`${dr+1}. `;var ht=v(Oe),Se=p(ht),Te=v(ht,2);{var dt=Qe=>{var gt=Yd(),Mr=v(te(gt)),et=p(Mr);O(()=>T(et,o(He).selection)),y(Qe,gt)},Kt=Qe=>{var gt=jd();y(Qe,gt)};C(Te,Qe=>{o(He).selection?Qe(dt):Qe(Kt,!1)})}O(()=>T(Se,`${o(He).multiplier??""}x`)),y(ze,Ze)}),y(W,pe)},vt=W=>{var pe=Wd();y(W,pe)};C(ce,W=>{o(_).slots?.length?W(be):W(vt,!1)})}var ve=v(Jt,2),xe=p(ve),_e=p(xe),K=v(xe,2);{var ie=W=>{var pe=eu(),ze=p(pe);Tt(ze,1,()=>o(_).player_pool.slice(0,15),At,(Ze,Oe)=>{const ht=Ne(()=>o(Oe).status?.match(/\b(Active|Questionable|Doubtful|Out|Inactive|IR|COVID|Probable)\b/i)),Se=Ne(()=>o(ht)?.[0]||""),Te=Ne(()=>o(Se)?o(Oe).status?.replace(o(ht)[0],"").replace(/^[\s,]+|[\s,]+$/g,"").trim():o(Oe).status);var dt=Zd(),Kt=p(dt),Qe=p(Kt),gt=v(Kt,2),Mr=p(gt),et=v(gt,2);{var Wt=Ye=>{var _t=Xd(),Lr=p(_t);O((Qa,ee)=>{kt(_t,`color: ${Qa??""}; font-size: 10px; font-weight: 500; padding: 1px 4px; border-radius: 3px; background: ${ee??""}`),T(Lr,o(Se))},[()=>o(Se).toLowerCase()==="out"?"#ef4444":o(Se).toLowerCase()==="active"?"#10b981":"#f59e0b",()=>o(Se).toLowerCase()==="out"?"rgba(239,68,68,0.1)":o(Se).toLowerCase()==="active"?"rgba(16,185,129,0.1)":"rgba(245,158,11,0.1)"]),y(Ye,_t)};C(et,Ye=>{o(Se)&&Ye(Wt)})}var ur=v(et,2);{var On=Ye=>{var _t=Vd(),Lr=p(_t);O(()=>T(Lr,o(Te))),y(Ye,_t)};C(ur,Ye=>{o(Te)&&Ye(On)})}O(()=>{T(Qe,o(Oe).name),T(Mr,`+${o(Oe).boost_x??0??""}x`)}),y(Ze,dt)});var He=v(ze,2);{var dr=Ze=>{var Oe=Qd(),ht=p(Oe);O(()=>T(ht,`...and ${o(_).player_pool.length-15} more`)),y(Ze,Oe)};C(He,Ze=>{o(_).player_pool.length>15&&Ze(dr)})}y(W,pe)},we=W=>{var pe=tu();y(W,pe)};C(K,W=>{o(_).player_pool?.length?W(ie):W(we,!1)})}var It=v(ve,2);{var Ve=W=>{var pe=ou(),ze=v(p(pe),2),He=p(ze),dr=p(He),Ze=p(dr),Oe=v(dr,2);{var ht=ee=>{var he=ru(),Dr=p(he);O(()=>T(Dr,`(${o(_).game_matchup.team1_record??""})`)),y(ee,he)};C(Oe,ee=>{o(_).game_matchup.team1_record&&ee(ht)})}var Se=v(Oe,2);{var Te=ee=>{var he=nu(),Dr=p(he);O(()=>T(Dr,o(_).game_matchup.team1_score)),y(ee,he)};C(Se,ee=>{o(_).game_matchup.team1_score!==null&&o(_).game_matchup.team1_score!==void 0&&ee(Te)})}var dt=v(Se,4),Kt=p(dt),Qe=v(dt,2);{var gt=ee=>{var he=au(),Dr=p(he);O(()=>T(Dr,`(${o(_).game_matchup.team2_record??""})`)),y(ee,he)};C(Qe,ee=>{o(_).game_matchup.team2_record&&ee(gt)})}var Mr=v(Qe,2);{var et=ee=>{var he=su(),Dr=p(he);O(()=>T(Dr,o(_).game_matchup.team2_score)),y(ee,he)};C(Mr,ee=>{o(_).game_matchup.team2_score!==null&&o(_).game_matchup.team2_score!==void 0&&ee(et)})}var Wt=v(He,2),ur=p(Wt);{var On=ee=>{var he=Me();O(()=>T(he,`@ ${o(_).game_matchup.time??""}`)),y(ee,he)};C(ur,ee=>{o(_).game_matchup.time&&ee(On)})}var Ye=v(ur,2);{var _t=ee=>{var he=Me();O(()=>T(he,` ${o(_).game_matchup.spread??""}`)),y(ee,he)};C(Ye,ee=>{o(_).game_matchup.spread&&ee(_t)})}var Lr=v(Ye,2);{var Qa=ee=>{var he=Me();O(()=>T(he,` ${o(_).game_matchup.status==="finished"?"Final":"Live"}`)),y(ee,he)};C(Lr,ee=>{o(_).game_matchup.status!=="upcoming"&&ee(Qa)})}O(()=>{T(Ze,o(_).game_matchup.team1),T(Kt,o(_).game_matchup.team2)}),y(W,pe)};C(It,W=>{o(_).game_matchup&&W(Ve)})}var ct=v(It,2);{var Ir=W=>{var pe=uu(),ze=p(pe),He=p(ze),dr=v(ze,2),Ze=p(dr);Tt(Ze,1,()=>o(_).games.slice(0,6),At,(Se,Te)=>{var dt=cu(),Kt=p(dt),Qe=v(Kt);{var gt=et=>{var Wt=iu(),ur=p(Wt);O(()=>T(ur,`@ ${o(Te).time??""}`)),y(et,Wt)},Mr=et=>{var Wt=Et(),ur=te(Wt);{var On=Ye=>{var _t=lu(),Lr=p(_t);O(()=>T(Lr,`(Final${o(Te).score?`: ${o(Te).score}`:""})`)),y(Ye,_t)};C(ur,Ye=>{o(Te).status==="finished"&&Ye(On)},!0)}y(et,Wt)};C(Qe,et=>{o(Te).time?et(gt):et(Mr,!1)})}O(()=>T(Kt,`${o(Te).team1??""} vs ${o(Te).team2??""} `)),y(Se,dt)});var Oe=v(Ze,2);{var ht=Se=>{var Te=du(),dt=p(Te);O(()=>T(dt,`...and ${o(_).games.length-6} more`)),y(Se,Te)};C(Oe,Se=>{o(_).games.length>6&&Se(ht)})}O(()=>T(He,`Games (${o(_).games.length??""}):`)),y(W,pe)};C(ct,W=>{o(_).games?.length&&W(Ir)})}O(()=>{T(oe,` ${(o(_).sport||"Unknown")??""} (${(o(_).sport_detection_method||"unknown")??""}) | `),T(ge,` ${(o(_).mode||"unknown")??""} `),T(Xe,`Slots (${(o(_).slots?.length||0)??""}):`),T(_e,`Player Pool (${(o(_).player_pool?.length||o(_).player_pool_count||0)??""}):`)}),y(We,se)};C(Ue,We=>{o(_)&&We(Yt)})}y(P,Q)},Ke=P=>{var _=pu();y(P,_)};C(me,P=>{o(n)?P(Re):P(Ke,!1)})}var ir=v(ae,2),en=p(ir),Xa=p(en),Ef=p(Xa),Af=v(Xa,4),Tf=p(Af),kf=v(en,2),ti=v(p(kf),2),Cf=v(p(ti),2);{var Pf=P=>{var _=mu(),Q=te(_),Ue=v(Q,2);O(()=>ft(Q,o(d))),de("click",Ue,()=>ar(o(d))),y(P,_)},Rf=P=>{var _=vu();y(P,_)};C(Cf,P=>{o(d)?P(Pf):P(Rf,!1)})}var Of=v(ti,2),Nf=v(p(Of),2);{var If=P=>{var _=hu(),Q=te(_),Ue=v(Q,2);O(()=>ft(Q,o(u))),de("click",Ue,()=>ar(o(u))),y(P,_)},Mf=P=>{var _=gu();y(P,_)};C(Nf,P=>{o(u)?P(If):P(Mf,!1)})}var ri=v(ir,2),ni=p(ri),Va=p(ni),Lf=p(Va),Df=v(Va,4),Ff=p(Df);{var $f=P=>{const _=Ne(()=>(o(m).match(/tool_call/g)||[]).length);var Q=Me();O(()=>T(Q,`${o(_)??""} call${o(_)!==1?"s":""}`)),y(P,Q)},Bf=P=>{var _=Me("None");y(P,_)};C(Ff,P=>{o(m)&&o(m).includes("tool_call")?P($f):P(Bf,!1)})}var qf=v(ni,2),Gf=p(qf);{var Uf=P=>{const _=Ne(()=>(()=>{const se=[];try{const G=JSON.parse(o(m));if(Array.isArray(G))for(const oe of G)oe.kind==="tool_call"&&se.push({name:oe.name||"Unknown",args:oe.args||oe.arguments||{},result:oe.result||null})}catch{const G=o(m).split(`
`);for(const oe of G)if(oe.includes('"kind": "tool_call"')||oe.includes('"name":'))try{const ge=JSON.parse(oe);ge.name&&se.push({name:ge.name,args:ge.args||ge.arguments||{},result:ge.result})}catch{}}return se})());var Q=Eu(),Ue=p(Q);Tt(Ue,1,()=>o(_),At,(se,G)=>{var oe=wu(),ge=p(oe),Nt=p(ge),jt=p(Nt),lr=v(ge,2),Nr=p(lr);{var Jt=Xe=>{var ce=yu(),be=v(te(ce)),vt=p(be),ve=v(be,2);{var xe=_e=>{var K=_u(),ie=v(te(K),2),we=p(ie);O(()=>T(we,`${o(G).result?.players_found??o(G).result?.length??"?"??""} players`)),y(_e,K)};C(ve,_e=>{o(G).result&&_e(xe)})}O(()=>T(vt,`"${(o(G).args?.query||"N/A")??""}"`)),y(Xe,ce)},cr=Xe=>{var ce=Et(),be=te(ce);{var vt=xe=>{var _e=xu(),K=v(te(_e)),ie=p(K),we=v(K,2);{var It=Ve=>{var ct=bu(),Ir=v(te(ct));O(()=>T(Ir,`Team: ${(o(G).result.header.team||"N/A")??""} | Pos: ${(o(G).result.header.position||"N/A")??""}`)),y(Ve,ct)};C(we,Ve=>{o(G).result?.header&&Ve(It)})}O(()=>T(ie,o(G).args?.player_name||"N/A")),y(xe,_e)},ve=xe=>{var _e=Me();O(K=>T(_e,`Args: ${K??""}`),[()=>JSON.stringify(o(G).args).slice(0,100)]),y(xe,_e)};C(be,xe=>{o(G).name==="get_player_profile_stats"?xe(vt):xe(ve,!1)},!0)}y(Xe,ce)};C(Nr,Xe=>{o(G).name==="search_draft_players"?Xe(Jt):Xe(cr,!1)})}O(()=>T(jt,`${o(G).name==="search_draft_players"?"":""}
                        ${o(G).name??""}`)),y(se,oe)});var Yt=v(Ue,2);{var We=se=>{var G=Su();y(se,G)};C(Yt,se=>{o(_).length===0&&se(We)})}y(P,Q)},zf=P=>{var _=Au();y(P,_)};C(Gf,P=>{o(m)&&o(m).includes("tool_call")?P(Uf):P(zf,!1)})}var ai=v(ri,2),si=p(ai),Za=p(si),Hf=p(Za),Yf=v(Za,4),jf=p(Yf);{var Jf=P=>{const _=Ne(()=>(()=>{try{return JSON.parse(o(l))}catch{return null}})());var Q=Me();O(()=>T(Q,`${(o(_)?.lineup?.length||"?")??""} players, ${(o(_)?.bets?.length||"?")??""} bets`)),y(P,Q)},Kf=P=>{var _=Me("Pending");y(P,_)};C(jf,P=>{o(l)?P(Jf):P(Kf,!1)})}var Wf=v(si,2),Xf=p(Wf);{var Vf=P=>{const _=Ne(()=>(()=>{try{return JSON.parse(o(l))}catch{return null}})());var Q=Et(),Ue=te(Q);{var Yt=We=>{var se=Nu(),G=p(se),oe=p(G),ge=p(oe),Nt=v(oe,2);{var jt=ce=>{var be=ku();Tt(be,5,()=>o(_).lineup,At,(vt,ve,xe)=>{var _e=Tu(),K=p(_e),ie=p(K),we=v(K,2),It=p(we),Ve=v(we,2),ct=p(Ve),Ir=v(ct),W=p(Ir);O(()=>{T(ie,`S${o(ve).slot_index??xe+1??""}`),T(It,o(ve).player||"N/A"),T(ct,`${o(ve).slot_multiplier??"?"??""}x slot + ${o(ve).player_boost_x??0??""}x boost = `),T(W,`${o(ve).effective_multiplier??"?"??""}x`)}),y(vt,_e)}),y(ce,be)},lr=ce=>{var be=Cu();y(ce,be)};C(Nt,ce=>{o(_).lineup?.length?ce(jt):ce(lr,!1)})}var Nr=v(G,2),Jt=v(p(Nr),2);{var cr=ce=>{var be=Ru();Tt(be,5,()=>o(_).bets,At,(vt,ve)=>{var xe=Pu(),_e=p(xe),K=p(_e),ie=v(_e,2),we=p(ie),It=v(ie,2),Ve=p(It);O(ct=>{T(K,o(ve).tier||"N/A"),kt(ie,`font-weight: 600; color: ${o(ve).recommend?"#22c55e":"#ef4444"}; min-width: 30px;`),T(we,o(ve).recommend?"YES":"NO"),T(Ve,`${ct??""}${o(ve).reason?.length>60?"...":""}`)},[()=>o(ve).reason?.slice(0,60)||""]),y(vt,xe)}),y(ce,be)},Xe=ce=>{var be=Ou();y(ce,be)};C(Jt,ce=>{o(_).bets?.length?ce(cr):ce(Xe,!1)})}O(()=>T(ge,`Lineup (${(o(_).lineup?.length||0)??""} players):`)),y(We,se)};C(Ue,We=>{o(_)&&We(Yt)})}y(P,Q)},Zf=P=>{var _=Iu();y(P,_)};C(Xf,P=>{o(l)?P(Vf):P(Zf,!1)})}var Qf=v(ai,2);{var ep=P=>{var _=Lu(),Q=p(_),Ue=v(p(Q),4),Yt=p(Ue),We=v(Q,2),se=p(We);Tt(se,5,()=>o(f).split(`
`).filter(G=>G.trim()).slice(0,5),At,(G,oe)=>{var ge=Mu(),Nt=p(ge);O(jt=>T(Nt,` ${jt??""}${o(oe).length>60?"...":""}`),[()=>o(oe).slice(0,60)]),y(G,ge)}),O(G=>T(Yt,`${G??""} sources`),[()=>o(f).split(`
`).filter(G=>G.trim()).length]),y(P,_)};C(Qf,P=>{o(f)&&P(ep)})}var tp=v(H,2),rp=p(tp),np=v(p(rp),2),oi=p(np),ii=v(p(oi),2),ap=v(ii,2),li=v(oi,2),ci=v(p(li),2),sp=v(ci,2),di=v(li,2),ui=v(p(di),2),op=v(ui,2),ip=v(di,2),fi=v(p(ip),4),lp=v(fi,4);O((P,_)=>{st(E,1,`view ${o(r)==="debug"?"":"hidden"}`),st(mt,1,`timeline-icon ${o(n)?"success":""}`),T(Ot,o(n)?"":""),st(Xa,1,`timeline-icon ${o(u)?"success":""}`),T(Ef,o(u)?"":""),T(Tf,o(u)?`${o(u).length} chars`:"Pending"),st(Va,1,`timeline-icon ${P??""}`),T(Lf,_),st(Za,1,`timeline-icon ${o(l)?"success":""}`),T(Hf,o(l)?"":""),ft(ii,o(n)||"(No capture data)"),ft(ci,o(m)||"(No tool calls)"),ft(ui,o(l)||"(No AI response)"),ft(fi,o(d)||"(No chat prompt)"),ft(lp,o(u)||"(No structured prompt)")},[()=>o(m)&&o(m).includes("tool_call")?"success":"",()=>o(m)&&o(m).includes("tool_call")?"":""]),de("click",ap,()=>ar(o(n))),de("click",sp,()=>ar(o(m))),de("click",op,()=>ar(o(l))),y(g,E)};C(wf,g=>{o(S)&&g(Sf)})}O(g=>{st(Pn,1,`tab ${o(r)==="context"?"active":""}`),st(M,1,`tab ${o(r)==="results"?"active":""}`),st(Rn,1,`tab ${o(r)==="settings"?"active":""}`),st(za,1,`view ${o(r)==="context"?"":"hidden"}`),st(Ha,1,`view ${o(r)==="results"?"":"hidden"}`),st(Ya,1,`view ${o(r)==="settings"?"":"hidden"}`),kt(Qr,`width:100%; margin-bottom:8px; ${o(I)?"":"opacity: 0.6; font-style: italic;"}`),ft(Qr,!o(I)&&o(fe)?.defaultModel?o(fe).defaultModel==="any"?"Dynamic Selection":o(fe).defaultModel:o(x)),eo(Qr,"placeholder",o(I)?"Start typing to search...":"Managed by Admin"),Qr.disabled=!o(I),kt(Wn,`width:100%; ${o(I)?"":"opacity: 0.6;"}`),ft(Wn,g),Wn.disabled=!o(I),T(tf,`Temperature: ${(!o(I)&&o(fe)?.temperature!==void 0?o(fe).temperature:o(R))??""}`),kt(Xn,`width:100%; ${o(I)?"":"opacity: 0.6;"}`),ft(Xn,!o(I)&&o(fe)?.temperature!==void 0?o(fe).temperature:o(R)),Xn.disabled=!o(I),kt(ja,`display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer; margin-top: 12px; ${o(I)?"":"opacity: 0.6;"}`),Qs(Ja,!o(I)&&o(fe)?.enableWebSearch!==void 0?o(fe).enableWebSearch:o(le)),Ja.disabled=!o(I),Qs(ei,o(D)!=="none")},[()=>!o(I)&&o(fe)?.maxTokens?String(o(fe).maxTokens):o(N)]),de("click",Ae,()=>qa({hidden:!0})),de("click",Pn,()=>nr("context")),de("click",M,()=>nr("results")),de("click",Rn,()=>nr("settings")),de("input",Qr,g=>o(I)&&A(x,g.target.value)),de("input",Wn,g=>o(I)&&A(N,g.target.value)),de("input",Xn,g=>o(I)&&A(R,parseFloat(g.target.value))),de("change",Ja,g=>o(I)&&A(le,g.target.checked)),Gn(sf,()=>o(ot),g=>A(ot,g)),Gn(of,()=>o(Rr),g=>A(Rr,g)),Zs(Vn,()=>o(qt),g=>A(qt,g)),de("change",Vn,()=>ye(Ca,o(qt))),Gn(vf,()=>o(I),g=>A(I,g)),Gn(gf,()=>o(S),g=>A(S,g)),de("change",ei,g=>{g.target.checked?A(D,"profile"):A(D,"none"),ye(Sr,o(D)==="profile"?"1":"0"),ye(Er,o(D)==="search"?"1":"0")}),de("click",xf,Pt),y(e,Ut),ds()}function Bu(){const e="rsdh-svelte-root";let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,document.documentElement.appendChild(t)),t}function qu(e){const t="rsdh-svelte-handle";let r=e.getElementById(t);return r||(r=document.createElement("button"),r.id=t,r.className="fab",r.type="button",r.title="Open Draft Helper",r.setAttribute("aria-label","Open Draft Helper"),r.style.cssText=`
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 2147483647;
      width: 50px;
      height: 50px;
      border-radius: 4px;
      background: rgba(18, 18, 26, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: #00E5FF;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
      transition: all 0.2s ease;
    `,r.innerHTML=`
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 2l1.2 4.3L17.5 8l-4.3 1.2L12 13.5l-1.2-4.3L6.5 8l4.3-1.7L12 2Z" fill="currentColor" opacity="0.95"/>
        <path d="M19 11l.8 2.8L22.6 15l-2.8.8L19 18.6l-.8-2.8L15.4 15l2.8-1.2L19 11Z" fill="currentColor" opacity="0.85"/>
      </svg>
    `,r.addEventListener("click",()=>qa({hidden:!1})),r.addEventListener("mouseenter",()=>{r.style.background="#00E5FF",r.style.color="#000"}),r.addEventListener("mouseleave",()=>{r.style.background="rgba(18, 18, 26, 0.95)",r.style.color="#00E5FF"}),e.appendChild(r)),r}function Do(e,t,r){e.style.display=r?"none":"",t.style.display=r?"":"none"}function Gu(e){const t=()=>{const r=Ec();r&&e.style.setProperty("--rsdh-accent",r)};t();try{setInterval(t,5e3)}catch{}}function Uu(){const e=Bu(),t=e.shadowRoot??e.attachShadow({mode:"open"}),r="rsdh-style";if(!t.getElementById(r)){const c=document.createElement("style");c.id=r,c.textContent=pi,t.appendChild(c)}const n=qu(t),s="app";let a=t.getElementById(s);a||(a=document.createElement("div"),a.id=s,t.appendChild(a)),wl($u,{target:a});const i=Ba();Do(a,n,!!i.hidden),window.addEventListener("rsdh-ui-state",c=>{const l=c.detail;l&&typeof l.hidden=="boolean"&&Do(a,n,l.hidden)}),Gu(e)}Uu(),sd()})();
