// ==UserScript==
// @name         RealSports Draft Helper
// @namespace    local.realsports.drafthelper
// @version      0.9.56
// @description  RealSports Draft Helper (Svelte + TypeScript)
// @homepageURL  https://github.com/itsreverence/real-helper
// @supportURL   https://github.com/itsreverence/real-helper/issues
// @downloadURL  https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @updateURL    https://raw.githubusercontent.com/itsreverence/real-helper/main/userscript-svelte/script/realsports-draft-helper.user.js
// @match        https://realsports.io/*
// @run-at       document-idle
// @grant        GM_setClipboard
// @grant        GM_xmlhttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @connect      openrouter.ai
// @connect      realsports.io
// ==/UserScript==

(function(){"use strict";const eo='@import"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap";:host,#app{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*,*:before,*:after{box-sizing:border-box}:host{--rsdh-accent: #2c6cff;--rsdh-accent-light: color-mix(in srgb, var(--rsdh-accent) 70%, white);--rsdh-accent-dark: color-mix(in srgb, var(--rsdh-accent) 80%, black);--rsdh-accent-glow: color-mix(in srgb, var(--rsdh-accent) 40%, transparent);--rsdh-accent-subtle: color-mix(in srgb, var(--rsdh-accent) 15%, transparent);--rsdh-glass: rgba(255, 255, 255, .03);--rsdh-glass-border: rgba(255, 255, 255, .08);--rsdh-transition-fast: .15s ease;--rsdh-transition: .25s ease}.panel{position:fixed;right:12px;top:12px;bottom:12px;width:380px;max-width:calc(100vw - 24px);z-index:2147483647;background:linear-gradient(135deg,#19191ef7,#0f0f12fa);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);color:#f5f5f5;border:1px solid var(--rsdh-glass-border);border-radius:16px;box-shadow:0 25px 50px -12px #0009,0 0 0 1px var(--rsdh-accent-glow),inset 0 1px #ffffff0d;display:flex;flex-direction:column;overflow:hidden}.header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px 12px;background:linear-gradient(180deg,rgba(255,255,255,.04) 0%,transparent 100%);border-bottom:1px solid var(--rsdh-glass-border)}.title{font-weight:800;font-size:14px;letter-spacing:-.02em;background:linear-gradient(135deg,#fff,#fffc);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.tabs{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:12px 16px 14px;background:#0003;border-bottom:1px solid var(--rsdh-glass-border)}.view{flex:1;min-height:0;overflow:auto;padding:16px;box-sizing:border-box;animation:fadeIn .2s ease}@keyframes fadeIn{0%{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}.actions{display:grid;grid-template-columns:1fr 1fr;gap:8px}.span2{grid-column:1 / -1}.split{position:relative;display:flex;gap:6px}.split>button:first-child{flex:1 1 auto}.splitCaret{flex:0 0 auto;width:42px;padding-left:0;padding-right:0}.menu{position:absolute;right:0;top:calc(100% + 8px);width:220px;z-index:2147483647;background:#141419fa;backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid var(--rsdh-glass-border);border-radius:12px;box-shadow:0 20px 40px #00000080,0 0 0 1px var(--rsdh-accent-glow);padding:8px;display:grid;gap:4px;animation:menuAppear .15s ease}@keyframes menuAppear{0%{opacity:0;transform:translateY(-8px) scale(.96)}to{opacity:1;transform:translateY(0) scale(1)}}.menuItem{text-align:left;background:#ffffff0f;border-radius:8px}.menuItem:hover{background:var(--rsdh-accent-subtle);color:var(--rsdh-accent-light)}button{background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);color:#fff;border:0;border-radius:10px;padding:10px 14px;font-weight:700;font-size:12px;letter-spacing:-.01em;cursor:pointer;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:transform var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast),background var(--rsdh-transition-fast);box-shadow:0 2px 8px #0003}button:hover{transform:translateY(-1px);box-shadow:0 4px 16px #0000004d,0 0 20px var(--rsdh-accent-glow)}button:active{transform:translateY(0);box-shadow:0 1px 4px #0003}button.secondary{background:#ffffff14;box-shadow:none;border:1px solid rgba(255,255,255,.08)}button.secondary:hover{background:#ffffff1f;border-color:#ffffff26;box-shadow:0 4px 12px #0003}button.tab{background:#ffffff0f;border:1px solid transparent;box-shadow:none}button.tab:hover{background:#ffffff1a;box-shadow:none}button.tab.active{background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);border-color:transparent;box-shadow:0 2px 12px var(--rsdh-accent-glow),inset 0 1px #ffffff1a}textarea{width:100%;min-height:140px;resize:none;background:#0006;color:#eaeaea;border:1px solid var(--rsdh-glass-border);border-radius:10px;padding:12px;font-family:SF Mono,Fira Code,Consolas,monospace;font-size:11px;line-height:1.5;box-sizing:border-box;transition:border-color var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}textarea:focus{outline:none;border-color:var(--rsdh-accent);box-shadow:0 0 0 3px var(--rsdh-accent-glow)}textarea::placeholder{color:#ffffff59}.status{margin-top:12px;padding:8px 12px;font-size:11px;font-weight:500;color:#ffffffbf;background:#ffffff08;border-radius:8px;border-left:3px solid var(--rsdh-accent);transition:all var(--rsdh-transition-fast)}.card{border:1px solid var(--rsdh-glass-border);background:linear-gradient(135deg,var(--rsdh-glass) 0%,transparent 100%);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);border-radius:12px;padding:14px;margin-bottom:12px;transition:border-color var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}.card:hover{border-color:#ffffff1f;box-shadow:0 4px 20px #00000026}.h{font-weight:800;font-size:13px;margin-bottom:8px;letter-spacing:-.01em;color:#fff}.sub{font-size:11px;color:#fff9;line-height:1.45}.muted{color:#ffffff73}.table{width:100%;border-collapse:collapse;font-size:11px}.table th,.table td{text-align:left;padding:8px 10px;border-bottom:1px solid var(--rsdh-glass-border);vertical-align:top}.table thead th{color:var(--rsdh-accent-light);font-weight:700;text-transform:uppercase;font-size:10px;letter-spacing:.04em}.table tbody tr:hover{background:#ffffff05}.table tbody tr:last-child td{border-bottom:none}.list{display:grid;gap:8px;margin-top:10px}.row{display:flex;gap:10px;align-items:baseline;justify-content:space-between;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.04)}.row:last-child{border-bottom:none}.rowLeft{flex:1;min-width:0}.rowRight{flex:0 0 auto}.pill{display:inline-block;padding:3px 8px;border-radius:999px;border:1px solid var(--rsdh-accent-glow);background:linear-gradient(135deg,var(--rsdh-accent-subtle) 0%,transparent 100%);font-size:10px;font-weight:600;color:var(--rsdh-accent-light)}.link{color:var(--rsdh-accent-light);text-decoration:none;transition:color var(--rsdh-transition-fast)}.link:hover{color:#fff;text-decoration:underline}.code-output{margin:0;white-space:pre-wrap;font-family:SF Mono,Fira Code,Consolas,monospace;font-size:11px;line-height:1.5;color:#ffffffd9;background:#0003;padding:10px;border-radius:8px;overflow-x:auto}.bet-item{padding:10px 0;border-bottom:1px solid var(--rsdh-glass-border)}.bet-item:last-child{border-bottom:none}.bet-header{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.bet-tier{font-weight:700;color:#fff}.bet-rec{font-size:10px;font-weight:700;padding:3px 8px;border-radius:4px}.bet-rec.yes{background:#22c55e33;color:#22c55e}.bet-rec.no{background:#ef444433;color:#ef4444}.bet-reason{margin-top:6px;font-size:11px;color:#ffffffa6;line-height:1.4;word-wrap:break-word;overflow-wrap:break-word}.details summary{cursor:pointer;color:#fff9;font-size:11px;font-weight:600;user-select:none;padding:8px 0;transition:color var(--rsdh-transition-fast)}.details summary:hover{color:#ffffffd9}.details[open] summary{margin-bottom:8px}input[type=text],input[type=password]{width:100%;max-width:100%;background:#00000059;color:#eaeaea;border:1px solid var(--rsdh-glass-border);border-radius:8px;padding:10px 12px;font-size:12px;font-family:inherit;transition:border-color var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}input[type=text]:focus,input[type=password]:focus{outline:none;border-color:var(--rsdh-accent);box-shadow:0 0 0 3px var(--rsdh-accent-glow)}input[type=text]::placeholder,input[type=password]::placeholder{color:#ffffff4d}input[type=checkbox]{width:16px;height:16px;accent-color:var(--rsdh-accent);cursor:pointer}input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:6px;background:#ffffff1a;border-radius:3px;cursor:pointer;margin-top:6px}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);cursor:pointer;box-shadow:0 2px 6px #0000004d;transition:transform .15s ease}input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.15)}input[type=range]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;border:none;background:linear-gradient(135deg,var(--rsdh-accent) 0%,var(--rsdh-accent-dark) 100%);cursor:pointer;box-shadow:0 2px 6px #0000004d}.hidden{display:none}.fab{position:fixed;right:20px;bottom:20px;width:56px;height:56px;z-index:2147483647;border-radius:999px;border:1px solid rgba(255,255,255,.1);background:radial-gradient(circle at 30% 30%,color-mix(in srgb,var(--rsdh-accent) 50%,white) 0%,transparent 50%),radial-gradient(circle at 70% 70%,var(--rsdh-accent-dark) 0%,transparent 60%),linear-gradient(135deg,#19191ef2,#0f0f12fa);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);box-shadow:0 8px 32px #0006,0 0 0 1px var(--rsdh-accent-glow),inset 0 1px #ffffff1a;color:#fff;cursor:pointer;display:grid;place-items:center;transition:transform var(--rsdh-transition-fast),box-shadow var(--rsdh-transition-fast)}.fab:hover{transform:translateY(-2px) scale(1.04);box-shadow:0 12px 40px #00000080,0 0 30px var(--rsdh-accent-glow),inset 0 1px #ffffff26}.fab:active{transform:translateY(0) scale(.98)}.view::-webkit-scrollbar{width:6px}.view::-webkit-scrollbar-track{background:transparent}.view::-webkit-scrollbar-thumb{background:#ffffff26;border-radius:3px}.view::-webkit-scrollbar-thumb:hover{background:#ffffff40}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;gap:16px}.spinner{width:40px;height:40px;border:3px solid rgba(255,255,255,.1);border-top-color:var(--rsdh-accent);border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.loading-text{font-size:13px;font-weight:600;color:#ffffffb3;animation:pulse 1.5s ease-in-out infinite}@keyframes pulse{0%,to{opacity:.7}50%{opacity:1}}.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:48px 24px;gap:16px}.empty-icon{font-size:48px;opacity:.6;filter:grayscale(20%)}.empty-title{font-size:15px;font-weight:700;color:#ffffffe6;margin:0}.empty-description{font-size:12px;color:#ffffff8c;max-width:280px;line-height:1.5;margin:0}.empty-hint{display:inline-flex;align-items:center;gap:6px;margin-top:8px;padding:8px 14px;background:var(--rsdh-accent-subtle);border:1px solid var(--rsdh-accent-glow);border-radius:8px;font-size:11px;font-weight:600;color:var(--rsdh-accent-light)}';typeof window<"u"&&((window.__svelte??={}).v??=new Set).add("5");let xt=!1,to=!1;function ro(){xt=!0}ro();const no=1,so=2,oo=16,ao=1,io=2,j=Symbol(),lo="http://www.w3.org/1999/xhtml",fr=!1;var en=Array.isArray,co=Array.prototype.indexOf,Kt=Array.from,uo=Object.defineProperty,wt=Object.getOwnPropertyDescriptor,fo=Object.getOwnPropertyDescriptors,po=Object.prototype,ho=Array.prototype,tn=Object.getPrototypeOf,rn=Object.isExtensible;function mo(e){return e()}function pr(e){for(var t=0;t<e.length;t++)e[t]()}function nn(){var e,t,r=new Promise((n,s)=>{e=n,t=s});return{promise:r,resolve:e,reject:t}}const H=2,sn=4,jt=8,go=1<<24,Se=16,ke=32,ze=64,Wt=128,he=512,W=1024,ee=2048,ve=4096,oe=8192,Ie=16384,hr=32768,at=65536,on=1<<17,an=1<<18,it=1<<19,ln=1<<20,Me=1<<25,Ke=32768,mr=1<<21,gr=1<<22,Oe=1<<23,St=Symbol("$state"),lt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function vo(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function bo(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function _o(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function yo(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function xo(e){throw new Error("https://svelte.dev/e/effect_orphan")}function wo(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function So(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ko(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Eo(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ao(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}function To(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function cn(e){return e===this.v}function Co(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function un(e){return!Co(e,this.v)}let D=null;function ct(e){D=e}function dn(e,t=!1,r){D={p:D,i:!1,c:null,e:null,s:e,x:null,l:xt&&!t?{s:null,u:null,$:[]}:null}}function fn(e){var t=D,r=t.e;if(r!==null){t.e=null;for(var n of r)On(n)}return t.i=!0,D=t.p,{}}function kt(){return!xt||D!==null&&D.l===null}let je=[];function pn(){var e=je;je=[],pr(e)}function Jt(e){if(je.length===0&&!Et){var t=je;queueMicrotask(()=>{t===je&&pn()})}je.push(e)}function Po(){for(;je.length>0;)pn()}function hn(e){var t=T;if(t===null)return E.f|=Oe,e;if((t.f&hr)===0){if((t.f&Wt)===0)throw e;t.b.error(e)}else ut(e,t)}function ut(e,t){for(;t!==null;){if((t.f&Wt)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e}const Vt=new Set;let P=null,Xt=null,le=null,ce=[],Zt=null,vr=!1,Et=!1;class be{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#l=null;#o=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#r>0}process(t){ce=[],Xt=null,this.apply();var r={parent:null,effect:null,effects:[],render_effects:[]};for(const n of t)this.#a(n,r);this.is_fork||this.#u(),this.is_deferred()?(this.#i(r.effects),this.#i(r.render_effects)):(Xt=this,P=null,gn(r.render_effects),gn(r.effects),Xt=null,this.#l?.resolve()),le=null}#a(t,r){t.f^=W;for(var n=t.first;n!==null;){var s=n.f,o=(s&(ke|ze))!==0,l=o&&(s&W)!==0,i=l||(s&oe)!==0||this.skipped_effects.has(n);if((n.f&Wt)!==0&&n.b?.is_pending()&&(r={parent:r,effect:n,effects:[],render_effects:[]}),!i&&n.fn!==null){o?n.f^=W:(s&sn)!==0?r.effects.push(n):Mt(n)&&((n.f&Se)!==0&&this.#o.add(n),Ot(n));var c=n.first;if(c!==null){n=c;continue}}var a=n.parent;for(n=n.next;n===null&&a!==null;)a===r.effect&&(this.#i(r.effects),this.#i(r.render_effects),r=r.parent),n=a.next,a=a.parent}}#i(t){for(const r of t)(r.f&ee)!==0?this.#o.add(r):(r.f&ve)!==0&&this.#s.add(r),this.#c(r.deps),J(r,W)}#c(t){if(t!==null)for(const r of t)(r.f&H)===0||(r.f&Ke)===0||(r.f^=Ke,this.#c(r.deps))}capture(t,r){this.previous.has(t)||this.previous.set(t,r),(t.f&Oe)===0&&(this.current.set(t,t.v),le?.set(t,t.v))}activate(){P=this,this.apply()}deactivate(){P===this&&(P=null,le=null)}flush(){if(this.activate(),ce.length>0){if(mn(),P!==null&&P!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#u(){if(this.#r===0){for(const t of this.#e)t();this.#e.clear()}this.#n===0&&this.#d()}#d(){if(Vt.size>1){this.previous.clear();var t=le,r=!0,n={parent:null,effect:null,effects:[],render_effects:[]};for(const o of Vt){if(o===this){r=!1;continue}const l=[];for(const[c,a]of this.current){if(o.current.has(c))if(r&&a!==o.current.get(c))o.current.set(c,a);else continue;l.push(c)}if(l.length===0)continue;const i=[...o.current.keys()].filter(c=>!this.current.has(c));if(i.length>0){var s=ce;ce=[];const c=new Set,a=new Map;for(const u of l)vn(u,i,c,a);if(ce.length>0){P=o,o.apply();for(const u of ce)o.#a(u,n);o.deactivate()}ce=s}}P=null,le=t}this.committed=!0,Vt.delete(this)}increment(t){this.#n+=1,t&&(this.#r+=1)}decrement(t){this.#n-=1,t&&(this.#r-=1),this.revive()}revive(){for(const t of this.#o)this.#s.delete(t),J(t,ee),We(t);for(const t of this.#s)J(t,ve),We(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=nn()).promise}static ensure(){if(P===null){const t=P=new be;Vt.add(P),Et||be.enqueue(()=>{P===t&&t.flush()})}return P}static enqueue(t){Jt(t)}apply(){}}function Ro(e){var t=Et;Et=!0;try{for(var r;;){if(Po(),ce.length===0&&(P?.flush(),ce.length===0))return Zt=null,r;mn()}}finally{Et=t}}function mn(){var e=Xe;vr=!0;var t=null;try{var r=0;for(tr(!0);ce.length>0;){var n=be.ensure();if(r++>1e3){var s,o;Io()}n.process(ce),Ne.clear()}}finally{vr=!1,tr(e),Zt=null}}function Io(){try{wo()}catch(e){ut(e,Zt)}}let Ee=null;function gn(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var n=e[r++];if((n.f&(Ie|oe))===0&&Mt(n)&&(Ee=new Set,Ot(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?Dn(n):n.fn=null),Ee?.size>0)){Ne.clear();for(const s of Ee){if((s.f&(Ie|oe))!==0)continue;const o=[s];let l=s.parent;for(;l!==null;)Ee.has(l)&&(Ee.delete(l),o.push(l)),l=l.parent;for(let i=o.length-1;i>=0;i--){const c=o[i];(c.f&(Ie|oe))===0&&Ot(c)}}Ee.clear()}}Ee=null}}function vn(e,t,r,n){if(!r.has(e)&&(r.add(e),e.reactions!==null))for(const s of e.reactions){const o=s.f;(o&H)!==0?vn(s,t,r,n):(o&(gr|Se))!==0&&(o&ee)===0&&bn(s,t,n)&&(J(s,ee),We(s))}}function bn(e,t,r){const n=r.get(e);if(n!==void 0)return n;if(e.deps!==null)for(const s of e.deps){if(t.includes(s))return!0;if((s.f&H)!==0&&bn(s,t,r))return r.set(s,!0),!0}return r.set(e,!1),!1}function We(e){for(var t=Zt=e;t.parent!==null;){t=t.parent;var r=t.f;if(vr&&t===T&&(r&Se)!==0&&(r&an)===0)return;if((r&(ze|ke))!==0){if((r&W)===0)return;t.f^=W}}ce.push(t)}function Mo(e){let t=0,r=Je(0),n;return()=>{Rt()&&(m(r),wr(()=>(t===0&&(n=Nt(()=>e(()=>At(r)))),t+=1,()=>{Jt(()=>{t-=1,t===0&&(n?.(),n=void 0,At(r))})})))}}var Oo=at|it|Wt;function No(e,t,r){new Lo(e,t,r)}class Lo{parent;#e=!1;#t;#n=null;#r;#l;#o;#s=null;#a=null;#i=null;#c=null;#u=null;#d=0;#f=0;#h=!1;#p=null;#_=Mo(()=>(this.#p=Je(this.#d),()=>{this.#p=null}));constructor(t,r,n){this.#t=t,this.#r=r,this.#l=n,this.parent=T.b,this.#e=!!this.#r.pending,this.#o=Sr(()=>{T.b=this;{var s=this.#v();try{this.#s=ue(()=>n(s))}catch(o){this.error(o)}this.#f>0?this.#g():this.#e=!1}return()=>{this.#u?.remove()}},Oo)}#y(){try{this.#s=ue(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#x(){const t=this.#r.pending;t&&(this.#a=ue(()=>t(this.#t)),be.enqueue(()=>{var r=this.#v();this.#s=this.#m(()=>(be.ensure(),ue(()=>this.#l(r)))),this.#f>0?this.#g():(Ve(this.#a,()=>{this.#a=null}),this.#e=!1)}))}#v(){var t=this.#t;return this.#e&&(this.#u=Ae(),this.#t.before(this.#u),t=this.#u),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(t){var r=T,n=E,s=D;xe(this.#o),re(this.#o),ct(this.#o.ctx);try{return t()}catch(o){return hn(o),null}finally{xe(r),re(n),ct(s)}}#g(){const t=this.#r.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),qn(this.#s,this.#c)),this.#a===null&&(this.#a=ue(()=>t(this.#t)))}#b(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#b(t);return}this.#f+=t,this.#f===0&&(this.#e=!1,this.#a&&Ve(this.#a,()=>{this.#a=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(t){this.#b(t),this.#d+=t,this.#p&&dt(this.#p,this.#d)}get_effect_pending(){return this.#_(),m(this.#p)}error(t){var r=this.#r.onerror;let n=this.#r.failed;if(this.#h||!r&&!n)throw t;this.#s&&(te(this.#s),this.#s=null),this.#a&&(te(this.#a),this.#a=null),this.#i&&(te(this.#i),this.#i=null);var s=!1,o=!1;const l=()=>{if(s){To();return}s=!0,o&&Ao(),be.ensure(),this.#d=0,this.#i!==null&&Ve(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#s=this.#m(()=>(this.#h=!1,ue(()=>this.#l(this.#t)))),this.#f>0?this.#g():this.#e=!1};var i=E;try{re(null),o=!0,r?.(t,l),o=!1}catch(c){ut(c,this.#o&&this.#o.parent)}finally{re(i)}n&&Jt(()=>{this.#i=this.#m(()=>{be.ensure(),this.#h=!0;try{return ue(()=>{n(this.#t,()=>t,()=>l)})}catch(c){return ut(c,this.#o.parent),null}finally{this.#h=!1}})})}}function Bo(e,t,r,n){const s=kt()?br:_n;if(r.length===0&&e.length===0){n(t.map(s));return}var o=P,l=T,i=Do();function c(){Promise.all(r.map(a=>Fo(a))).then(a=>{i();try{n([...t.map(s),...a])}catch(u){(l.f&Ie)===0&&ut(u,l)}o?.deactivate(),Qt()}).catch(a=>{ut(a,l)})}e.length>0?Promise.all(e).then(()=>{i();try{return c()}finally{o?.deactivate(),Qt()}}):c()}function Do(){var e=T,t=E,r=D,n=P;return function(o=!0){xe(e),re(t),ct(r),o&&n?.activate()}}function Qt(){xe(null),re(null),ct(null)}function br(e){var t=H|ee,r=E!==null&&(E.f&H)!==0?E:null;return T!==null&&(T.f|=it),{ctx:D,deps:null,effects:null,equals:cn,f:t,fn:e,reactions:null,rv:0,v:j,wv:0,parent:r??T,ac:null}}function Fo(e,t){let r=T;r===null&&bo();var n=r.b,s=void 0,o=Je(j),l=!E,i=new Map;return jo(()=>{var c=nn();s=c.promise;try{Promise.resolve(e()).then(c.resolve,c.reject).then(()=>{a===P&&a.committed&&a.deactivate(),Qt()})}catch(f){c.reject(f),Qt()}var a=P;if(l){var u=!n.is_pending();n.update_pending_count(1),a.increment(u),i.get(a)?.reject(lt),i.delete(a),i.set(a,c)}const d=(f,p=void 0)=>{if(a.activate(),p)p!==lt&&(o.f|=Oe,dt(o,p));else{(o.f&Oe)!==0&&(o.f^=Oe),dt(o,f);for(const[h,S]of i){if(i.delete(h),h===a)break;S.reject(lt)}}l&&(n.update_pending_count(-1),a.decrement(u))};c.promise.then(d,f=>d(null,f||"unknown"))}),Mn(()=>{for(const c of i.values())c.reject(lt)}),new Promise(c=>{function a(u){function d(){u===s?c(o):a(s)}u.then(d,d)}a(s)})}function _n(e){const t=br(e);return t.equals=un,t}function yn(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)te(t[r])}}function $o(e){for(var t=e.parent;t!==null;){if((t.f&H)===0)return(t.f&Ie)===0?t:null;t=t.parent}return null}function _r(e){var t,r=T;xe($o(e));try{e.f&=~Ke,yn(e),t=Kn(e)}finally{xe(r)}return t}function xn(e){var t=_r(e);if(e.equals(t)||(P?.is_fork||(e.v=t),e.wv=Gn()),!ft)if(le!==null)(Rt()||P?.is_fork)&&le.set(e,t);else{var r=(e.f&he)===0?ve:W;J(e,r)}}let yr=new Set;const Ne=new Map;let wn=!1;function Je(e,t){var r={f:0,v:e,reactions:null,equals:cn,rv:0,wv:0};return r}function Le(e,t){const r=Je(e);return Jo(r),r}function L(e,t=!1,r=!0){const n=Je(e);return t||(n.equals=un),xt&&r&&D!==null&&D.l!==null&&(D.l.s??=[]).push(n),n}function v(e,t,r=!1){E!==null&&(!ye||(E.f&on)!==0)&&kt()&&(E.f&(H|Se|gr|on))!==0&&!Ce?.includes(e)&&Eo();let n=r?Tt(t):t;return dt(e,n)}function dt(e,t){if(!e.equals(t)){var r=e.v;ft?Ne.set(e,t):Ne.set(e,r),e.v=t;var n=be.ensure();n.capture(e,r),(e.f&H)!==0&&((e.f&ee)!==0&&_r(e),J(e,(e.f&he)!==0?W:ve)),e.wv=Gn(),Sn(e,ee),kt()&&T!==null&&(T.f&W)!==0&&(T.f&(ke|ze))===0&&(de===null?Vo([e]):de.push(e)),!n.is_fork&&yr.size>0&&!wn&&qo()}return t}function qo(){wn=!1;var e=Xe;tr(!0);const t=Array.from(yr);try{for(const r of t)(r.f&W)!==0&&J(r,ve),Mt(r)&&Ot(r)}finally{tr(e)}yr.clear()}function At(e){v(e,e.v+1)}function Sn(e,t){var r=e.reactions;if(r!==null)for(var n=kt(),s=r.length,o=0;o<s;o++){var l=r[o],i=l.f;if(!(!n&&l===T)){var c=(i&ee)===0;if(c&&J(l,t),(i&H)!==0){var a=l;le?.delete(a),(i&Ke)===0&&(i&he&&(l.f|=Ke),Sn(a,ve))}else c&&((i&Se)!==0&&Ee!==null&&Ee.add(l),We(l))}}}function Tt(e){if(typeof e!="object"||e===null||St in e)return e;const t=tn(e);if(t!==po&&t!==ho)return e;var r=new Map,n=en(e),s=Le(0),o=Ze,l=i=>{if(Ze===o)return i();var c=E,a=Ze;re(null),Hn(o);var u=i();return re(c),Hn(a),u};return n&&r.set("length",Le(e.length)),new Proxy(e,{defineProperty(i,c,a){(!("value"in a)||a.configurable===!1||a.enumerable===!1||a.writable===!1)&&So();var u=r.get(c);return u===void 0?u=l(()=>{var d=Le(a.value);return r.set(c,d),d}):v(u,a.value,!0),!0},deleteProperty(i,c){var a=r.get(c);if(a===void 0){if(c in i){const u=l(()=>Le(j));r.set(c,u),At(s)}}else v(a,j),At(s);return!0},get(i,c,a){if(c===St)return e;var u=r.get(c),d=c in i;if(u===void 0&&(!d||wt(i,c)?.writable)&&(u=l(()=>{var p=Tt(d?i[c]:j),h=Le(p);return h}),r.set(c,u)),u!==void 0){var f=m(u);return f===j?void 0:f}return Reflect.get(i,c,a)},getOwnPropertyDescriptor(i,c){var a=Reflect.getOwnPropertyDescriptor(i,c);if(a&&"value"in a){var u=r.get(c);u&&(a.value=m(u))}else if(a===void 0){var d=r.get(c),f=d?.v;if(d!==void 0&&f!==j)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return a},has(i,c){if(c===St)return!0;var a=r.get(c),u=a!==void 0&&a.v!==j||Reflect.has(i,c);if(a!==void 0||T!==null&&(!u||wt(i,c)?.writable)){a===void 0&&(a=l(()=>{var f=u?Tt(i[c]):j,p=Le(f);return p}),r.set(c,a));var d=m(a);if(d===j)return!1}return u},set(i,c,a,u){var d=r.get(c),f=c in i;if(n&&c==="length")for(var p=a;p<d.v;p+=1){var h=r.get(p+"");h!==void 0?v(h,j):p in i&&(h=l(()=>Le(j)),r.set(p+"",h))}if(d===void 0)(!f||wt(i,c)?.writable)&&(d=l(()=>Le(void 0)),v(d,Tt(a)),r.set(c,d));else{f=d.v!==j;var S=l(()=>Tt(a));v(d,S)}var y=Reflect.getOwnPropertyDescriptor(i,c);if(y?.set&&y.set.call(u,a),!f){if(n&&typeof c=="string"){var O=r.get("length"),C=Number(c);Number.isInteger(C)&&C>=O.v&&v(O,C+1)}At(s)}return!0},ownKeys(i){m(s);var c=Reflect.ownKeys(i).filter(d=>{var f=r.get(d);return f===void 0||f.v!==j});for(var[a,u]of r)u.v!==j&&!(a in i)&&c.push(a);return c},setPrototypeOf(){ko()}})}var kn,En,An,Tn;function Yo(){if(kn===void 0){kn=window,En=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;An=wt(t,"firstChild").get,Tn=wt(t,"nextSibling").get,rn(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),rn(r)&&(r.__t=void 0)}}function Ae(e=""){return document.createTextNode(e)}function Be(e){return An.call(e)}function Ct(e){return Tn.call(e)}function w(e,t){return Be(e)}function Pt(e,t=!1){{var r=Be(e);return r instanceof Comment&&r.data===""?Ct(r):r}}function b(e,t=1,r=!1){let n=e;for(;t--;)n=Ct(n);return n}function Uo(e){e.textContent=""}function Cn(){return!1}let Pn=!1;function Ho(){Pn||(Pn=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function er(e){var t=E,r=T;re(null),xe(null);try{return e()}finally{re(t),xe(r)}}function Rn(e,t,r,n=r){e.addEventListener(t,()=>er(r));const s=e.__on_r;s?e.__on_r=()=>{s(),n(!0)}:e.__on_r=()=>n(!0),Ho()}function In(e){T===null&&(E===null&&xo(),yo()),ft&&_o()}function Go(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function Te(e,t,r){var n=T;n!==null&&(n.f&oe)!==0&&(e|=oe);var s={ctx:D,deps:null,nodes:null,f:e|ee|he,first:null,fn:t,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ot(s),s.f|=hr}catch(i){throw te(s),i}else t!==null&&We(s);var o=s;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&it)===0&&(o=o.first,(e&Se)!==0&&(e&at)!==0&&o!==null&&(o.f|=at)),o!==null&&(o.parent=n,n!==null&&Go(o,n),E!==null&&(E.f&H)!==0&&(e&ze)===0)){var l=E;(l.effects??=[]).push(o)}return s}function Rt(){return E!==null&&!ye}function Mn(e){const t=Te(jt,null,!1);return J(t,W),t.teardown=e,t}function xr(e){In();var t=T.f,r=!E&&(t&ke)!==0&&(t&hr)===0;if(r){var n=D;(n.e??=[]).push(e)}else return On(e)}function On(e){return Te(sn|ln,e,!1)}function zo(e){return In(),Te(jt|ln,e,!0)}function Ko(e){be.ensure();const t=Te(ze|it,e,!0);return(r={})=>new Promise(n=>{r.outro?Ve(t,()=>{te(t),n(void 0)}):(te(t),n(void 0))})}function jo(e){return Te(gr|it,e,!0)}function wr(e,t=0){return Te(jt|t,e,!0)}function _e(e,t=[],r=[],n=[]){Bo(n,t,r,s=>{Te(jt,()=>e(...s.map(m)),!0)})}function Sr(e,t=0){var r=Te(Se|t,e,!0);return r}function ue(e){return Te(ke|it,e,!0)}function Nn(e){var t=e.teardown;if(t!==null){const r=ft,n=E;Yn(!0),re(null);try{t.call(null)}finally{Yn(r),re(n)}}}function Ln(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const s=r.ac;s!==null&&er(()=>{s.abort(lt)});var n=r.next;(r.f&ze)!==0?r.parent=null:te(r,t),r=n}}function Wo(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&ke)===0&&te(t),t=r}}function te(e,t=!0){var r=!1;(t||(e.f&an)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Bn(e.nodes.start,e.nodes.end),r=!0),Ln(e,t&&!r),rr(e,0),J(e,Ie);var n=e.nodes&&e.nodes.t;if(n!==null)for(const o of n)o.stop();Nn(e);var s=e.parent;s!==null&&s.first!==null&&Dn(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Bn(e,t){for(;e!==null;){var r=e===t?null:Ct(e);e.remove(),e=r}}function Dn(e){var t=e.parent,r=e.prev,n=e.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function Ve(e,t,r=!0){var n=[];Fn(e,n,!0);var s=()=>{r&&te(e),t&&t()},o=n.length;if(o>0){var l=()=>--o||s();for(var i of n)i.out(l)}else s()}function Fn(e,t,r){if((e.f&oe)===0){e.f^=oe;var n=e.nodes&&e.nodes.t;if(n!==null)for(const i of n)(i.is_global||r)&&t.push(i);for(var s=e.first;s!==null;){var o=s.next,l=(s.f&at)!==0||(s.f&ke)!==0&&(e.f&Se)!==0;Fn(s,t,l?r:!1),s=o}}}function kr(e){$n(e,!0)}function $n(e,t){if((e.f&oe)!==0){e.f^=oe,(e.f&W)===0&&(J(e,ee),We(e));for(var r=e.first;r!==null;){var n=r.next,s=(r.f&at)!==0||(r.f&ke)!==0;$n(r,s?t:!1),r=n}var o=e.nodes&&e.nodes.t;if(o!==null)for(const l of o)(l.is_global||t)&&l.in()}}function qn(e,t){if(e.nodes)for(var r=e.nodes.start,n=e.nodes.end;r!==null;){var s=r===n?null:Ct(r);t.append(r),r=s}}let Xe=!1;function tr(e){Xe=e}let ft=!1;function Yn(e){ft=e}let E=null,ye=!1;function re(e){E=e}let T=null;function xe(e){T=e}let Ce=null;function Jo(e){E!==null&&(Ce===null?Ce=[e]:Ce.push(e))}let X=null,ae=0,de=null;function Vo(e){de=e}let Un=1,It=0,Ze=It;function Hn(e){Ze=e}function Gn(){return++Un}function Mt(e){var t=e.f;if((t&ee)!==0)return!0;if(t&H&&(e.f&=~Ke),(t&ve)!==0){var r=e.deps;if(r!==null)for(var n=r.length,s=0;s<n;s++){var o=r[s];if(Mt(o)&&xn(o),o.wv>e.wv)return!0}(t&he)!==0&&le===null&&J(e,W)}return!1}function zn(e,t,r=!0){var n=e.reactions;if(n!==null&&!Ce?.includes(e))for(var s=0;s<n.length;s++){var o=n[s];(o.f&H)!==0?zn(o,t,!1):t===o&&(r?J(o,ee):(o.f&W)!==0&&J(o,ve),We(o))}}function Kn(e){var t=X,r=ae,n=de,s=E,o=Ce,l=D,i=ye,c=Ze,a=e.f;X=null,ae=0,de=null,E=(a&(ke|ze))===0?e:null,Ce=null,ct(e.ctx),ye=!1,Ze=++It,e.ac!==null&&(er(()=>{e.ac.abort(lt)}),e.ac=null);try{e.f|=mr;var u=e.fn,d=u(),f=e.deps;if(X!==null){var p;if(rr(e,ae),f!==null&&ae>0)for(f.length=ae+X.length,p=0;p<X.length;p++)f[ae+p]=X[p];else e.deps=f=X;if(Rt()&&(e.f&he)!==0)for(p=ae;p<f.length;p++)(f[p].reactions??=[]).push(e)}else f!==null&&ae<f.length&&(rr(e,ae),f.length=ae);if(kt()&&de!==null&&!ye&&f!==null&&(e.f&(H|ve|ee))===0)for(p=0;p<de.length;p++)zn(de[p],e);return s!==null&&s!==e&&(It++,de!==null&&(n===null?n=de:n.push(...de))),(e.f&Oe)!==0&&(e.f^=Oe),d}catch(h){return hn(h)}finally{e.f^=mr,X=t,ae=r,de=n,E=s,Ce=o,ct(l),ye=i,Ze=c}}function Xo(e,t){let r=t.reactions;if(r!==null){var n=co.call(r,e);if(n!==-1){var s=r.length-1;s===0?r=t.reactions=null:(r[n]=r[s],r.pop())}}r===null&&(t.f&H)!==0&&(X===null||!X.includes(t))&&(J(t,ve),(t.f&he)!==0&&(t.f^=he,t.f&=~Ke),yn(t),rr(t,0))}function rr(e,t){var r=e.deps;if(r!==null)for(var n=t;n<r.length;n++)Xo(e,r[n])}function Ot(e){var t=e.f;if((t&Ie)===0){J(e,W);var r=T,n=Xe;T=e,Xe=!0;try{(t&(Se|go))!==0?Wo(e):Ln(e),Nn(e);var s=Kn(e);e.teardown=typeof s=="function"?s:null,e.wv=Un;var o;fr&&to&&(e.f&ee)!==0&&e.deps}finally{Xe=n,T=r}}}async function Zo(){await Promise.resolve(),Ro()}function m(e){var t=e.f,r=(t&H)!==0;if(E!==null&&!ye){var n=T!==null&&(T.f&Ie)!==0;if(!n&&!Ce?.includes(e)){var s=E.deps;if((E.f&mr)!==0)e.rv<It&&(e.rv=It,X===null&&s!==null&&s[ae]===e?ae++:X===null?X=[e]:X.includes(e)||X.push(e));else{(E.deps??=[]).push(e);var o=e.reactions;o===null?e.reactions=[E]:o.includes(E)||o.push(E)}}}if(ft){if(Ne.has(e))return Ne.get(e);if(r){var l=e,i=l.v;return((l.f&W)===0&&l.reactions!==null||Wn(l))&&(i=_r(l)),Ne.set(l,i),i}}else r&&(!le?.has(e)||P?.is_fork&&!Rt())&&(l=e,Mt(l)&&xn(l),Xe&&Rt()&&(l.f&he)===0&&jn(l));if(le?.has(e))return le.get(e);if((e.f&Oe)!==0)throw e.v;return e.v}function jn(e){if(e.deps!==null){e.f^=he;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&H)!==0&&(t.f&he)===0&&jn(t)}}function Wn(e){if(e.v===j)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Ne.has(t)||(t.f&H)!==0&&Wn(t))return!0;return!1}function Nt(e){var t=ye;try{return ye=!0,e()}finally{ye=t}}const Qo=-7169;function J(e,t){e.f=e.f&Qo|t}function ea(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(St in e)Er(e);else if(!Array.isArray(e))for(let t in e){const r=e[t];typeof r=="object"&&r&&St in r&&Er(r)}}}function Er(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{Er(e[n],t)}catch{}const r=tn(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=fo(r);for(let s in n){const o=n[s].get;if(o)try{o.call(e)}catch{}}}}}const ta=new Set,Jn=new Set;function ra(e,t,r,n={}){function s(o){if(n.capture||Lt.call(t,o),!o.cancelBubble)return er(()=>r?.call(this,o))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Jt(()=>{t.addEventListener(e,s,n)}):t.addEventListener(e,s,n),s}function Z(e,t,r,n,s){var o={capture:n,passive:s},l=ra(e,t,r,o);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Mn(()=>{t.removeEventListener(e,l,o)})}let Vn=null;function Lt(e){var t=this,r=t.ownerDocument,n=e.type,s=e.composedPath?.()||[],o=s[0]||e.target;Vn=e;var l=0,i=Vn===e&&e.__root;if(i){var c=s.indexOf(i);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var a=s.indexOf(t);if(a===-1)return;c<=a&&(l=c)}if(o=s[l]||e.target,o!==t){uo(e,"currentTarget",{configurable:!0,get(){return o||r}});var u=E,d=T;re(null),xe(null);try{for(var f,p=[];o!==null;){var h=o.assignedSlot||o.parentNode||o.host||null;try{var S=o["__"+n];S!=null&&(!o.disabled||e.target===o)&&S.call(o,e)}catch(y){f?p.push(y):f=y}if(e.cancelBubble||h===t||h===null)break;o=h}if(f){for(let y of p)queueMicrotask(()=>{throw y});throw f}}finally{e.__root=t,delete e.currentTarget,re(u),xe(d)}}}function Xn(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Bt(e,t){var r=T;r.nodes===null&&(r.nodes={start:e,end:t,a:null,t:null})}function G(e,t){var r=(t&ao)!==0,n=(t&io)!==0,s,o=!e.startsWith("<!>");return()=>{s===void 0&&(s=Xn(o?e:"<!>"+e),r||(s=Be(s)));var l=n||En?document.importNode(s,!0):s.cloneNode(!0);if(r){var i=Be(l),c=l.lastChild;Bt(i,c)}else Bt(l,l);return l}}function na(e=""){{var t=Ae(e+"");return Bt(t,t),t}}function Zn(){var e=document.createDocumentFragment(),t=document.createComment(""),r=Ae();return e.append(t,r),Bt(t,r),e}function $(e,t){e!==null&&e.before(t)}const sa=["touchstart","touchmove"];function oa(e){return sa.includes(e)}function De(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function aa(e,t){return ia(e,t)}const pt=new Map;function ia(e,{target:t,anchor:r,props:n={},events:s,context:o,intro:l=!0}){Yo();var i=new Set,c=d=>{for(var f=0;f<d.length;f++){var p=d[f];if(!i.has(p)){i.add(p);var h=oa(p);t.addEventListener(p,Lt,{passive:h});var S=pt.get(p);S===void 0?(document.addEventListener(p,Lt,{passive:h}),pt.set(p,1)):pt.set(p,S+1)}}};c(Kt(ta)),Jn.add(c);var a=void 0,u=Ko(()=>{var d=r??t.appendChild(Ae());return No(d,{pending:()=>{}},f=>{if(o){dn({});var p=D;p.c=o}s&&(n.$$events=s),a=e(f,n)||{},o&&fn()}),()=>{for(var f of i){t.removeEventListener(f,Lt);var p=pt.get(f);--p===0?(document.removeEventListener(f,Lt),pt.delete(f)):pt.set(f,p)}Jn.delete(c),d!==r&&d.parentNode?.removeChild(d)}});return la.set(a,u),a}let la=new WeakMap;class ca{anchor;#e=new Map;#t=new Map;#n=new Map;#r=new Set;#l=!0;constructor(t,r=!0){this.anchor=t,this.#l=r}#o=()=>{var t=P;if(this.#e.has(t)){var r=this.#e.get(t),n=this.#t.get(r);if(n)kr(n),this.#r.delete(r);else{var s=this.#n.get(r);s&&(this.#t.set(r,s.effect),this.#n.delete(r),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),n=s.effect)}for(const[o,l]of this.#e){if(this.#e.delete(o),o===t)break;const i=this.#n.get(l);i&&(te(i.effect),this.#n.delete(l))}for(const[o,l]of this.#t){if(o===r||this.#r.has(o))continue;const i=()=>{if(Array.from(this.#e.values()).includes(o)){var a=document.createDocumentFragment();qn(l,a),a.append(Ae()),this.#n.set(o,{effect:l,fragment:a})}else te(l);this.#r.delete(o),this.#t.delete(o)};this.#l||!n?(this.#r.add(o),Ve(l,i,!1)):i()}}};#s=t=>{this.#e.delete(t);const r=Array.from(this.#e.values());for(const[n,s]of this.#n)r.includes(n)||(te(s.effect),this.#n.delete(n))};ensure(t,r){var n=P,s=Cn();if(r&&!this.#t.has(t)&&!this.#n.has(t))if(s){var o=document.createDocumentFragment(),l=Ae();o.append(l),this.#n.set(t,{effect:ue(()=>r(l)),fragment:o})}else this.#t.set(t,ue(()=>r(this.anchor)));if(this.#e.set(n,t),s){for(const[i,c]of this.#t)i===t?n.skipped_effects.delete(c):n.skipped_effects.add(c);for(const[i,c]of this.#n)i===t?n.skipped_effects.delete(c.effect):n.skipped_effects.add(c.effect);n.oncommit(this.#o),n.ondiscard(this.#s)}else this.#o()}}function ua(e){D===null&&vo(),xt&&D.l!==null?da(D).m.push(e):xr(()=>{const t=Nt(e);if(typeof t=="function")return t})}function da(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}function fe(e,t,r=!1){var n=new ca(e),s=r?at:0;function o(l,i){n.ensure(l,i)}Sr(()=>{var l=!1;t((i,c=!0)=>{l=!0,o(c,i)}),l||o(!1,null)},s)}function fa(e,t){return t}function pa(e,t,r){for(var n=[],s=t.length,o,l=t.length,i=0;i<s;i++){let d=t[i];Ve(d,()=>{if(o){if(o.pending.delete(d),o.done.add(d),o.pending.size===0){var f=e.outrogroups;Ar(Kt(o.done)),f.delete(o),f.size===0&&(e.outrogroups=null)}}else l-=1},!1)}if(l===0){var c=n.length===0&&r!==null;if(c){var a=r,u=a.parentNode;Uo(u),u.append(a),e.items.clear()}Ar(t,!c)}else o={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(o)}function Ar(e,t=!0){for(var r=0;r<e.length;r++)te(e[r],t)}var Qn;function ha(e,t,r,n,s,o=null){var l=e,i=new Map;{var c=e;l=c.appendChild(Ae())}var a=null,u=_n(()=>{var y=r();return en(y)?y:y==null?[]:Kt(y)}),d,f=!0;function p(){S.fallback=a,ma(S,d,l,t,n),a!==null&&(d.length===0?(a.f&Me)===0?kr(a):(a.f^=Me,Dt(a,null,l)):Ve(a,()=>{a=null}))}var h=Sr(()=>{d=m(u);for(var y=d.length,O=new Set,C=P,ne=Cn(),Y=0;Y<y;Y+=1){var z=d[Y],pe=n(z,Y),U=f?null:i.get(pe);U?(U.v&&dt(U.v,z),U.i&&dt(U.i,Y),ne&&C.skipped_effects.delete(U.e)):(U=ga(i,f?l:Qn??=Ae(),z,pe,Y,s,t,r),f||(U.e.f|=Me),i.set(pe,U)),O.add(pe)}if(y===0&&o&&!a&&(f?a=ue(()=>o(l)):(a=ue(()=>o(Qn??=Ae())),a.f|=Me)),!f)if(ne){for(const[K,ie]of i)O.has(K)||C.skipped_effects.add(ie.e);C.oncommit(p),C.ondiscard(()=>{})}else p();m(u)}),S={effect:h,items:i,outrogroups:null,fallback:a};f=!1}function ma(e,t,r,n,s){var o=t.length,l=e.items,i=e.effect.first,c,a=null,u=[],d=[],f,p,h,S;for(S=0;S<o;S+=1){if(f=t[S],p=s(f,S),h=l.get(p).e,e.outrogroups!==null)for(const K of e.outrogroups)K.pending.delete(h),K.done.delete(h);if((h.f&Me)!==0)if(h.f^=Me,h===i)Dt(h,null,r);else{var y=a?a.next:i;h===e.effect.last&&(e.effect.last=h.prev),h.prev&&(h.prev.next=h.next),h.next&&(h.next.prev=h.prev),Fe(e,a,h),Fe(e,h,y),Dt(h,y,r),a=h,u=[],d=[],i=a.next;continue}if((h.f&oe)!==0&&kr(h),h!==i){if(c!==void 0&&c.has(h)){if(u.length<d.length){var O=d[0],C;a=O.prev;var ne=u[0],Y=u[u.length-1];for(C=0;C<u.length;C+=1)Dt(u[C],O,r);for(C=0;C<d.length;C+=1)c.delete(d[C]);Fe(e,ne.prev,Y.next),Fe(e,a,ne),Fe(e,Y,O),i=O,a=Y,S-=1,u=[],d=[]}else c.delete(h),Dt(h,i,r),Fe(e,h.prev,h.next),Fe(e,h,a===null?e.effect.first:a.next),Fe(e,a,h),a=h;continue}for(u=[],d=[];i!==null&&i!==h;)(c??=new Set).add(i),d.push(i),i=i.next;if(i===null)continue}(h.f&Me)===0&&u.push(h),a=h,i=h.next}if(e.outrogroups!==null){for(const K of e.outrogroups)K.pending.size===0&&(Ar(Kt(K.done)),e.outrogroups?.delete(K));e.outrogroups.size===0&&(e.outrogroups=null)}if(i!==null||c!==void 0){var z=[];if(c!==void 0)for(h of c)(h.f&oe)===0&&z.push(h);for(;i!==null;)(i.f&oe)===0&&i!==e.fallback&&z.push(i),i=i.next;var pe=z.length;if(pe>0){var U=o===0?r:null;pa(e,z,U)}}}function ga(e,t,r,n,s,o,l,i){var c=(l&no)!==0?(l&oo)===0?L(r,!1,!1):Je(r):null,a=(l&so)!==0?Je(s):null;return{v:c,i:a,e:ue(()=>(o(t,c??r,a??s,i),()=>{e.delete(n)}))}}function Dt(e,t,r){if(e.nodes)for(var n=e.nodes.start,s=e.nodes.end,o=t&&(t.f&Me)===0?t.nodes.start:r;n!==null;){var l=Ct(n);if(o.before(n),n===s)return;n=l}}function Fe(e,t,r){t===null?e.effect.first=r:t.next=r,r===null?e.effect.last=t:r.prev=t}function es(e,t,r=!1,n=!1,s=!1){var o=e,l="";_e(()=>{var i=T;if(l!==(l=t()??"")&&(i.nodes!==null&&(Bn(i.nodes.start,i.nodes.end),i.nodes=null),l!=="")){var c=l+"";r?c=`<svg>${c}</svg>`:n&&(c=`<math>${c}</math>`);var a=Xn(c);if((r||n)&&(a=Be(a)),Bt(Be(a),a.lastChild),r||n)for(;Be(a);)o.before(Be(a));else o.before(a)}})}function va(e,t,r){var n=e==null?"":""+e;return n===""?null:n}function ba(e,t){return e==null?null:String(e)}function $e(e,t,r,n,s,o){var l=e.__className;if(l!==r||l===void 0){var i=va(r);i==null?e.removeAttribute("class"):e.className=i,e.__className=r}return o}function _a(e,t,r,n){var s=e.__style;if(s!==t){var o=ba(t);o==null?e.removeAttribute("style"):e.style.cssText=o,e.__style=t}return n}const ya=Symbol("is custom element"),xa=Symbol("is html");function Ft(e,t){var r=wa(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function wa(e){return e.__attributes??={[ya]:e.nodeName.includes("-"),[xa]:e.namespaceURI===lo}}function Qe(e,t,r=t){var n=new WeakSet;Rn(e,"input",async s=>{var o=s?e.defaultValue:e.value;if(o=Cr(e)?Pr(o):o,r(o),P!==null&&n.add(P),await Zo(),o!==(o=t())){var l=e.selectionStart,i=e.selectionEnd,c=e.value.length;if(e.value=o??"",i!==null){var a=e.value.length;l===i&&i===c&&a>c?(e.selectionStart=a,e.selectionEnd=a):(e.selectionStart=l,e.selectionEnd=Math.min(i,a))}}}),Nt(t)==null&&e.value&&(r(Cr(e)?Pr(e.value):e.value),P!==null&&n.add(P)),wr(()=>{var s=t();if(e===document.activeElement){var o=Xt??P;if(n.has(o))return}Cr(e)&&s===Pr(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function Tr(e,t,r=t){Rn(e,"change",n=>{var s=n?e.defaultChecked:e.checked;r(s)}),Nt(t)==null&&r(e.checked),wr(()=>{var n=t();e.checked=!!n})}function Cr(e){var t=e.type;return t==="number"||t==="range"}function Pr(e){return e===""?null:+e}function Sa(e=!1){const t=D,r=t.l.u;if(!r)return;let n=()=>ea(t.s);if(e){let s=0,o={};const l=br(()=>{let i=!1;const c=t.s;for(const a in c)c[a]!==o[a]&&(o[a]=c[a],i=!0);return i&&s++,s});n=()=>m(l)}r.b.length&&zo(()=>{ts(t,n),pr(r.b)}),xr(()=>{const s=Nt(()=>r.m.map(mo));return()=>{for(const o of s)typeof o=="function"&&o()}}),r.a.length&&xr(()=>{ts(t,n),pr(r.a)})}function ts(e,t){if(e.l.s)for(const r of e.l.s)m(r);t()}function Pe(e,t=document){return Array.from(t.querySelectorAll(e))}function N(e){const t=e;return String(t&&(t.innerText||t.textContent)||"").trim()}const ka=["Select 5 players","Press two player","Press two players","to swap"],rs=/(\d+(?:\.\d+)?)x\b/gi,Ea=/^\+(\d+(?:\.\d+)?)x\b/i,Aa=200,ns=["NFL","NHL","NBA","MLB","CFB","CBB","UFC","Golf","FC","WNBA"],ss="rsdh_accent_rgb",Rr="rsdh_openrouter_api_key",Ir="rsdh_openrouter_model",Mr="rsdh_openrouter_temp",Or="rsdh_openrouter_max_tokens",Nr="rsdh_openrouter_web_max_results",nr="rsdh_openrouter_structured_json",sr="rsdh_openrouter_response_healing",et="google/gemini-2.5-flash",or=.2,ar=1e3,$t=2,Ta=!0,Ca=!0,Pa="https://openrouter.ai/api/v1/chat/completions",os="https://rsdh-proxy.cloudflare-okay454.workers.dev",Ra="H8UIBeO5C9BJ8Ze8WUXb+Y+x4wuNp2K+Lz+HwVdanBk=",ir=!!os,as="rsdh_last_payload",Lr="rsdh_last_ai_sources",Ia="rsdh_last_ai_json",is="rsdh_last_tool_trace",lr="rsdh_last_debug_events",Ma="rsdh_last_messages",qt="rsdh_force_tool_call",tt="rsdh_bypass_proxy";function M(e,t){try{if(typeof GM_getValue=="function")return GM_getValue(e,t)}catch{}try{const r=localStorage.getItem(e);return r??t}catch{return t}}function Re(e,t){try{if(typeof GM_setValue=="function"){GM_setValue(e,t);return}}catch{}try{localStorage.setItem(e,String(t))}catch{}}function rt(){try{return localStorage.getItem("rsdh_debug_mode")==="1"}catch{return!1}}function Oa(e){try{localStorage.setItem("rsdh_debug_mode",e?"1":"0")}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-debug-mode",{detail:{on:e}}))}catch{}}function ht(e){const r=String(e||"").match(/rgba?\(\s*(\d+)[,\s]+(\d+)[,\s]+(\d+)/i);return r?{r:parseInt(r[1],10),g:parseInt(r[2],10),b:parseInt(r[3],10)}:null}function Na(e){return(.2126*e.r+.7152*e.g+.0722*e.b)/255}function Br(e,t){const r=e.r-t.r,n=e.g-t.g,s=e.b-t.b;return Math.sqrt(r*r+n*n+s*s)}function La(e){const t=Math.max(e.r,e.g,e.b),r=Math.min(e.r,e.g,e.b);return(t-r)/255}function ls(e){const t=String(e||"").toLowerCase();return t==="transparent"||t.includes("rgba(")&&t.endsWith(", 0)")||t.includes(",0)")}function Ba(){const e=Math.max(240,window.innerHeight*.6),t=Pe("div,nav,aside").map(r=>{try{const n=r.getBoundingClientRect();return n.width<40||n.width>95||n.height<e||n.left>40||n.top>80?null:{el:r,area:n.width*n.height}}catch{return null}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function Da(){function e(){try{const l=localStorage.getItem(ss);if(!l)return null;const i=JSON.parse(l);return!i||typeof i.r!="number"||typeof i.g!="number"||typeof i.b!="number"?null:{r:i.r,g:i.g,b:i.b}}catch{return null}}function t(l){try{localStorage.setItem(ss,JSON.stringify(l))}catch{}}const r=Ba()||document,n=r===document?null:(()=>{try{const l=r.getBoundingClientRect();return{top:l.top,height:l.height}}catch{return null}})(),s=Pe("div,button,a,span",r).map(l=>{try{const i=l.getBoundingClientRect();if(i.width<16||i.width>80||i.height<16||i.height>80||i.width/i.height<.7||i.width/i.height>1.3)return null;const c=getComputedStyle(l),a=parseFloat(c.borderWidth||"0"),u=parseFloat(c.outlineWidth||"0");if((Number.isNaN(a)||a<=0)&&(Number.isNaN(u)||u<=0))return null;const d=ht(c.borderColor)||ht(c.outlineColor);if(!d)return null;const f=La(d);if(f<.1)return null;let p=1;n&&(p=(i.top-n.top)/Math.max(1,n.height)>.4?1.4:.8);const h=Math.min(i.width,i.height)>=20?1.1:1,S=(f*3+(a>=2?.2:0))*p*h;return{rgb:d,score:S}}catch{return null}}).filter(Boolean);if(s.length===0){const l=e();return l?{rgb:l,source:"cache",scope:r===document?"document":"sidebar"}:null}s.sort((l,i)=>i.score-l.score);const o=s[0];return t(o.rgb),{rgb:o.rgb,source:"borderColor",scope:r===document?"document":"sidebar"}}function cs(){const t=Pe("div,nav,header").filter(a=>{const u=N(a);return u?ns.filter(f=>u.includes(f)).length>=4:!1})[0]||null;if(!t)return{sport:null,method:"not_found"};const r=ns.filter(a=>N(t).includes(a)),n=Pe("a,button,[role='tab'],[role='button'],div,span",t).map(a=>({el:a,t:N(a)})).filter(a=>r.includes(a.t));function s(a){const u=a.getAttribute("aria-selected"),d=a.getAttribute("aria-current");if(u==="true"||d&&d!=="false"||a.getAttribute("data-active")==="true"||a.getAttribute("data-state")==="active")return!0;const f=(a.className||"").toString().toLowerCase();return!!(f.includes("active")||f.includes("selected")||f.includes("current"))}const o=n.find(a=>s(a.el));if(o)return{sport:String(o.t),method:"navbar_active_attr"};const l=Da();if(l?.rgb&&n.length>0){const a=n.map(u=>{let d=1/0;try{const f=getComputedStyle(u.el),p=ht(f.color),h=ht(f.borderBottomColor),S=ht(f.borderColor);p&&(d=Math.min(d,Br(l.rgb,p))),h&&!ls(f.borderBottomColor)&&(d=Math.min(d,Br(l.rgb,h))),S&&!ls(f.borderColor)&&(d=Math.min(d,Br(l.rgb,S)))}catch{}return{sport:String(u.t),dist:d}}).sort((u,d)=>u.dist-d.dist);if(a.length>0&&a[0].dist<60)return{sport:a[0].sport,method:"navbar_theme_accent",accent:l}}if(n.length>0){const a=n.map(u=>{let d=0;try{const f=getComputedStyle(u.el),p=parseInt(f.fontWeight,10);!Number.isNaN(p)&&p>=600&&(d+=2);const h=parseFloat(f.opacity);!Number.isNaN(h)&&h>=.95&&(d+=1),(f.textDecorationLine||"").includes("underline")&&(d+=2);const S=parseFloat(f.borderBottomWidth);!Number.isNaN(S)&&S>0&&(f.borderBottomStyle||"")!=="none"&&(d+=2);const y=ht(f.color);y&&(d+=Na(y))}catch{}return{sport:String(u.t),score:d}}).sort((u,d)=>d.score-u.score);if(a.length===1)return{sport:a[0].sport,method:"navbar_style_single"};if(a.length>=2&&a[0].score-a[1].score>=1)return{sport:a[0].sport,method:"navbar_style_score"}}const i=location.href.toUpperCase(),c=r.find(a=>i.includes("/"+a+"/")||i.endsWith("/"+a)||i.includes("SPORT="+a));return c?{sport:String(c),method:"url_hint"}:{sport:null,method:"navbar_no_active"}}function mt(){const e=document.querySelector("#rsdh-modal-actions");if(e){let r=e;for(let n=0;n<18&&r;n++){if((N(r).match(/\d+(?:\.\d+)?x\b/gi)||[]).length>=3)return r;r=r.parentElement}return e.parentElement}const t=Pe('div[tabindex="0"]');for(const r of t){const n=N(r);if(!n)continue;const s=/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n),o=(n.match(/\d+(?:\.\d+)?x\b/gi)||[]).length;if(s&&o>=3)return r}for(const r of t){const n=N(r);if(n&&/(Select\s+\d+\s+players|Press\s+two\s+players?|to\s+swap)/i.test(n))return r}return null}function Fa(e,t=[]){let r=-1;for(const n of t){const s=e.indexOf(n);s!==-1&&(r===-1||s<r)&&(r=s)}return r===-1?e:e.slice(0,r)}function $a(e,t=[]){let r=-1;for(const s of t){const o=e.indexOf(s);o!==-1&&(r===-1||o<r)&&(r=o)}if(r===-1)return"";const n=e.indexOf(`
`,r);return n===-1?"":e.slice(n+1)}function us(e,t=[],r=null){e=Fa(e,t);const n=[];rs.lastIndex=0;let s;for(;(s=rs.exec(e))!==null;)s.index>0&&e[s.index-1]==="+"||n.push({idx:s.index,end:s.index+s[0].length,mult:parseFloat(s[1])});const o=[];for(let l=0;l<n.length&&!(typeof r=="number"&&o.length>=r);l++){const i=n[l],c=n[l+1];let a=e.slice(i.end,c?c.idx:e.length).trim();for(const f of t){const p=a.indexOf(f);p!==-1&&(a=a.slice(0,p).trim())}a=a.split(`
`)[0].trim(),a.length>80&&(a=a.slice(0,80).trim());let u=a||null,d=!1;u&&u.toLowerCase()==="empty"&&(u=null,d=!0),o.push({multiplier:i.mult,selection:u,is_empty:d})}return o}function qa(e){const t=$a(e,["Press two player","Press two players"]);if(!t)return[];const r=t.split(`
`).map(l=>(l||"").trim()).filter(Boolean),n=[];let s=null;function o(){s&&(s.name&&!/%$/.test(s.name.trim())&&n.push(s),s=null)}for(const l of r){if(/^(submit|update|cancel|close|done)$/i.test(l)){o();break}if(/^(draft lineup)$/i.test(l)||/^\d+%$/.test(l))continue;const i=l.match(Ea);if(i){const d=parseFloat(i[1]);s?s.boost_x=d:n.length>0&&n[n.length-1].boost_x==null&&(n[n.length-1].boost_x=d),s&&o();continue}const c=l.split("").map(d=>d.trim()).filter(Boolean),a=c[0]||l,u=c.length>1?c.slice(1).join("  "):null;s&&o(),s={name:a,status:u,boost_x:null}}return o(),n}function Ya(e){const t=/\+(\d+(?:\.\d+)?)x\b/i,r=Pe("div[tabindex='0'],[role='button'],button,a",e).filter(o=>{const l=N(o);if(!l||!t.test(l))return!1;const i=o.getBoundingClientRect();return i.width>120&&i.height>=28}).slice(0,400),n=new Set,s=[];for(const o of r){const l=N(o),i=l.match(t);if(!i)continue;const c=parseFloat(i[1]);if(!Number.isFinite(c))continue;const u=l.slice(0,l.toLowerCase().lastIndexOf(i[0].toLowerCase())).trim().split("").map(O=>O.trim()).filter(Boolean),d=u[0]||"";if(!d)continue;const f=u.length>1?u.slice(1).join("  "):null,p=d.toLowerCase();if(n.has(p))continue;let h=null;const S=o.querySelector("a[href]")||o.parentElement?.querySelector("a[href]")||o.closest("a[href]");if(S?.getAttribute("href")&&(h=S.getAttribute("href")),!h){const O=o.querySelector("svg")||o.parentElement?.querySelector("svg"),C=O?O.closest("a[href]"):null;C?.getAttribute("href")&&(h=C.getAttribute("href"))}const y=h?new URL(h,location.href).toString():null;s.push({name:d,status:f,boost_x:c,profile_url:y}),n.add(p)}return s}function Ua(){const e=Pe("div,button").filter(n=>{const s=N(n);return s.includes("Draft")&&/\bUpdate\b/i.test(s)&&/\bx\b/i.test(s)}),t=new Set,r=[];for(const n of e){const s=N(n);!s||t.has(s)||(t.add(s),r.push(n))}return r.slice(0,10)}function Ha(){function e(n){try{n.scrollIntoView({block:"center",inline:"center"})}catch{}try{n.focus()}catch{}let s=0,o=0;try{const l=n.getBoundingClientRect();s=Math.max(1,Math.floor(l.left+l.width/2)),o=Math.max(1,Math.floor(l.top+l.height/2))}catch{}try{const l=window.PointerEvent;typeof l=="function"&&(n.dispatchEvent(new l("pointerdown",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:s,clientY:o})),n.dispatchEvent(new l("pointerup",{bubbles:!0,cancelable:!0,pointerType:"mouse",buttons:1,clientX:s,clientY:o})))}catch{}try{n.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:o}))}catch{}try{n.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:o}))}catch{}try{n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:s,clientY:o}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{n.click()}catch{}}const t=document.querySelector("#realrootcontents")||document,r=Pe("div[tabindex='0'],button,[role='button'],a,span",t).map(n=>{const s=N(n);if(!s||!/^(draft|update)$/i.test(s.trim()))return null;const o=n.getBoundingClientRect();if(!(o.width>=60&&o.width<=500&&o.height>=20&&o.height<=80))return null;const l=o.top>=0&&o.top<=window.innerHeight?1.5:1,i=o.width*l;return{el:n,score:i,text:s.trim()}}).filter(Boolean);return r.length===0?!1:(r.sort((n,s)=>s.score-n.score),e(r[0].el),!0)}async function Ga(e){const t=e.timeoutMs,r=Date.now();function n(){return document.querySelector("#rsdh-modal-actions")?!0:!!mt()}function s(){const i=document.querySelector("#realrootcontents")||document,c=Pe("div[tabindex='0'],button,[role='button'],a,span",i).map(a=>{const u=N(a);if(!u||!/^(draft|update)$/i.test(u.trim()))return null;const d=a.getBoundingClientRect();return d.width>=60&&d.width<=500&&d.height>=20&&d.height<=80?{el:a,width:d.width}:null}).filter(Boolean);return c.length===0?null:(c.sort((a,u)=>u.width-a.width),c[0].el)}function o(i){try{const c=i.getBoundingClientRect(),a=Math.floor(c.left+c.width/2),u=Math.floor(c.top+c.height/2),d=document.elementFromPoint(a,u);return d===i||!!d&&i.contains(d)}catch{return!0}}for(;Date.now()-r<t;){if(n())return{clicked:!1,opened:!0};const i=s();if(i&&o(i))break;await new Promise(c=>setTimeout(c,200))}let l=!1;for(let i=0;i<3&&Date.now()-r<t;i++){if(n())return{clicked:l,opened:!0};const c=s();if(!c){await new Promise(u=>setTimeout(u,250));continue}try{l=Ha()||l}catch{}if(!n()){const u=c.parentElement;if(u){try{u.scrollIntoView({block:"center"})}catch{}try{u.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0}))}catch{}}}if(await new Promise(u=>{const d=Date.now()+2200,f=()=>{if(n())return u(!0);if(Date.now()>d)return u(!1);setTimeout(f,100)};f()}))return{clicked:l,opened:!0};await new Promise(u=>setTimeout(u,350))}return{clicked:l,opened:n()}}function za(e){const t=N(e),r=["Update",...ka],n=us(t,r);return{text:t.slice(0,500),slots:n}}function Ka(e={}){const t=typeof e.includeDebug=="boolean"?e.includeDebug:rt(),r=cs(),n=mt();if(!n){const d=Ua().map(za).filter(f=>f.slots.length>0);return d.length===0?{ok:!1,error:"Draft modal not found. Click the site's Draft/Update button to open the Draft Lineup modal, then click Capture again.",url:location.href,sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{}}:{ok:!0,mode:"tile",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{},drafts:d}}const s=N(n),o=s.match(/Select\s+(\d+)\s+players/i),l=o?parseInt(o[1],10):null,c=us(s,["Press two player","Press two players"],l),a=Ya(n),u=a.length>0?a:qa(s);return{ok:!0,mode:"modal",url:location.href,captured_at:new Date().toISOString(),sport:r.sport,sport_detection_method:r.method,...t?{sport_detection:r}:{},...t?{modal_text_sample:s.slice(0,400)}:{},expected_slots:l,slots:c,player_pool_count:u.length,player_pool:u}}function ds(e){let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]);const r=(t||[]).map((a,u)=>{const d=a.selection?`selected="${a.selection}"`:"selected=<empty>";return`- slot ${u+1}: multiplier=${a.multiplier}x, ${d}`}).join(`
`),n=Array.isArray(e?.player_pool)?e.player_pool:[],s=n.slice(0,Aa),o=s.map(a=>{const u=a.status?` (${a.status})`:"",d=typeof a.boost_x=="number"?` +${a.boost_x}x`:"";return`- ${a.name}${u}${d}`}).join(`
`),l=n.length>s.length?`NOTE: player pool truncated to first ${s.length} of ${n.length} for prompt size. For the full list, re-capture and inspect the payload in Debug Mode.`:`Player pool items: ${n.length}.`,i=typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:Array.isArray(t)?t.length:5;return{context:["You are helping build an optimal Draft Lineup.","","### Context (captured from realsports.io UI)",`URL: ${e?.url||"<unknown>"}`,`Captured At: ${e?.captured_at||"<unknown>"}`,`Capture Mode: ${e?.mode||"<unknown>"}`,`Sport: ${e?.sport||"<unknown>"}`,"","### Rules / how scoring multipliers work",`- You must select EXACTLY ${i} unique players.`,"- Each lineup slot has a slot multiplier (e.g. 2.0x, 1.8x, 1.6x...).","- Each player also has a boost shown as +Bx (e.g. +0.9x).","- ASSUME boosts are additive with the slot multiplier:","  effective_multiplier = slot_multiplier + player_boost_x","  example: slot 2.0x + player +0.9x => effective 2.9x","- Goal: assign the best combination of players to slots to maximize expected Real score.","","### Betting payouts (Rax)","- Entry fee is ALWAYS 100 Rax for any bet tier.","- If lineup finishes Top 50%: payout 170 Rax (profit +70).","- If lineup finishes Top 20%: payout 350 Rax (profit +250).","- If lineup finishes Top 10%: payout 700 Rax (profit +600).","","Slots (higher multiplier = bigger boost):",r||"- <no slots found>","","Available player pool (with their +boost values shown in the UI):",o||"- <no pool detected>",l,"","### Task","Choose exactly the required number of players from the pool and assign them to slots.","Prefer players who are not Out/Inactive (if status is provided).","Explain briefly why each player goes into each slot.","Also provide bet recommendations for: Top 50%, Top 20%, Top 10.",""].join(`
`),expectedSlots:i}}function fs(e){const{context:t,expectedSlots:r}=ds(e);return[t,"### Output format (human-readable)","Reply in plain English with these sections:","1) Lineup (final)",`- List exactly ${r} slots in order (slot 1..${r}), showing: player, slot multiplier, player boost, and effective multiplier.`,"2) Why this lineup","- 13 bullets summarizing the approach.","3) Slot-by-slot rationale","- Short note per slot explaining the assignment.","4) Bets","- Recommendations for Top 50%, Top 20%, Top 10 (recommend yes/no + confidence + one sentence reason).","","Do NOT include JSON. Keep it readable and actionable."].join(`
`)}function ps(e,t){const{context:r}=ds(e),n=t?.webHint?"If web search is available, use it ONLY to verify time-sensitive info like injury status, starters, scratches, minutes restrictions, and recent news.":null;return[r,n?`
${n}
`:"","If you need player projections/stats beyond the boost values, DO NOT ask the user generic follow-up questions. Instead, request player profile stats using the tool for specific players you want to evaluate.","Return data that matches the provided JSON schema exactly."].join(`
`).trim()}function ja(){try{return localStorage.getItem(as)||""}catch{return""}}function Wa(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));return fs(t)}function Ja(e){const t=JSON.parse(e||"null");if(!t||t.ok!==!0)throw new Error(String(t?.error||"No valid capture payload. Click Capture first."));return ps(t)}const Dr="rsdh_user_identity";function hs(){try{const e=localStorage.getItem(Dr);if(!e)return null;const t=JSON.parse(e);return t?.username&&t?.displayName?t:null}catch{return null}}function Va(e){localStorage.setItem(Dr,JSON.stringify(e))}function Xa(){localStorage.removeItem(Dr)}function ms(){const e=window.location.href;return e==="https://realsports.io/"||e==="https://realsports.io"||e.startsWith("https://realsports.io/?")||e.startsWith("https://realsports.io/#")}function Za(){if(!ms())return null;const e=Array.from(document.querySelectorAll("div"));let t=null,r=null;for(const l of e){const i=l.textContent?.trim()||"";if(i.startsWith("@")&&i.length>1&&i.length<30&&!i.includes(" ")&&l.closest('[style*="padding-top"]')?.textContent?.includes("Karma")){t=l;break}}if(!t)return null;const n=t.parentElement;if(n){const l=n.parentElement?.parentElement;if(l){const i=Array.from(l.querySelectorAll("div"));for(const c of i){const a=c.textContent?.trim()||"";if(a&&!a.startsWith("@")&&a.length>1&&a.length<50&&c!==t&&!a.includes("Karma")&&!a.includes("Rax")&&(c.childElementCount===0||c.textContent===a)){r=c;break}}}}const s=t.textContent?.trim().replace(/^@/,"")||"",o=r?.textContent?.trim()||s;return s?{username:s,displayName:o,linkedAt:new Date().toISOString()}:null}function Qa(e){return e?`rgb(${e.r}, ${e.g}, ${e.b})`:null}function ei(){try{const t=cs()?.accent?.rgb;return Qa(t||null)}catch{return null}}const gs="rsdh-debug-highlight-",ti=999999;function vs(e,t,r="rgba(4, 131, 215, 0.4)"){if(!e||!rt())return null;const n=gs+Date.now(),s=e.getBoundingClientRect(),o=document.createElement("div");o.id=n,o.style.cssText=`
    position: fixed;
    top: ${s.top}px;
    left: ${s.left}px;
    width: ${s.width}px;
    height: ${s.height}px;
    background: ${r};
    border: 2px solid ${r.replace(/[\d.]+\)$/,"0.9)")};
    border-radius: 4px;
    z-index: ${ti};
    pointer-events: none;
    transition: opacity 0.3s ease;
  `;const l=document.createElement("div");return l.style.cssText=`
    position: absolute;
    bottom: 100%;
    left: 0;
    background: rgba(0, 0, 0, 0.85);
    color: #fff;
    padding: 4px 8px;
    font-size: 12px;
    font-family: system-ui, sans-serif;
    border-radius: 4px;
    white-space: nowrap;
    margin-bottom: 4px;
  `,l.textContent=t,o.appendChild(l),document.body.appendChild(o),n}function bs(e){if(e)try{document.getElementById(e)?.remove()}catch{}}function ri(){try{document.querySelectorAll(`[id^="${gs}"]`).forEach(e=>e.remove())}catch{}}function gt(e,t){const r=t?.timeoutMs??8e3,n=t?.intervalMs??100,s=Date.now();return new Promise(o=>{const l=()=>{if(e())return o(!0);if(Date.now()-s>r)return o(!1);setTimeout(l,n)};l()})}function ni(e){try{e.focus()}catch{}let t=0,r=0;try{const n=e.getBoundingClientRect();t=Math.max(1,Math.floor(n.left+n.width/2)),r=Math.max(1,Math.floor(n.top+n.height/2))}catch{}try{const n=window.PointerEvent;typeof n=="function"&&(e.dispatchEvent(new n("pointerdown",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})),e.dispatchEvent(new n("pointerup",{bubbles:!0,cancelable:!0,pointerId:1,pointerType:"mouse",isPrimary:!0,clientX:t,clientY:r})))}catch{}try{e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,buttons:1,clientX:t,clientY:r}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",bubbles:!0,cancelable:!0}))}catch{}try{e.click()}catch{}}function si(e,t=6e3){try{const r=JSON.stringify(e);return r?r.length<=t?e:{_truncated:!0,_len:r.length}:null}catch{return{_unserializable:!0}}}function oi(){try{const e=String(localStorage.getItem(lr)||"");if(!e.trim())return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}function ai(e){try{localStorage.setItem(lr,JSON.stringify(e.slice(-250)))}catch{}}function k(e,t,r){if(!rt())return;const n={t:new Date().toISOString(),kind:e,scope:r?.scope,msg:String(t||""),data:si(r?.data)},s=oi();s.push(n),ai(s);try{window.dispatchEvent(new CustomEvent("rsdh-debug-event",{detail:n})),window.dispatchEvent(new CustomEvent("rsdh-debug-events",{detail:{events:s.slice(-250)}}))}catch{}}let qe=null;function ii(){return qe&&document.body.contains(qe)||(qe=document.createElement("div"),qe.id="rsdh-toast-container",qe.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 2147483647;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: center;
    pointer-events: none;
  `,document.body.appendChild(qe)),qe}function Fr(e,t="info",r=3e3){const n=ii(),s=document.createElement("div");if(s.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
    font-size: 13px;
    font-weight: 600;
    padding: 12px 20px;
    border-radius: 10px;
    color: white;
    pointer-events: auto;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    animation: toastIn 0.25s ease;
    max-width: 320px;
    text-align: center;
    ${t==="success"?"background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); border: 1px solid rgba(34, 197, 94, 0.3);":t==="error"?"background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); border: 1px solid rgba(239, 68, 68, 0.3);":"background: linear-gradient(135deg, #2c6cff 0%, #1d4ed8 100%); border: 1px solid rgba(44, 108, 255, 0.3);"}
  `,s.textContent=e,!document.getElementById("rsdh-toast-styles")){const o=document.createElement("style");o.id="rsdh-toast-styles",o.textContent=`
      @keyframes toastIn {
        from { opacity: 0; transform: translateY(20px) scale(0.95); }
        to { opacity: 1; transform: translateY(0) scale(1); }
      }
      @keyframes toastOut {
        from { opacity: 1; transform: translateY(0) scale(1); }
        to { opacity: 0; transform: translateY(-10px) scale(0.95); }
      }
    `,document.head.appendChild(o)}n.appendChild(s),setTimeout(()=>{s.style.animation="toastOut 0.2s ease forwards",setTimeout(()=>{s.remove()},200)},r)}const Yt=(e,t)=>Fr(e,"success",t),nt=(e,t)=>Fr(e,"error",t),$r=(e,t)=>Fr(e,"info",t);function qr(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div, span, button"));let r=null,n=null,s=null;for(const o of t){const l=N(o).trim().toLowerCase(),i=o.getBoundingClientRect();if(!(i.width<=20||i.width>200||i.height<=10||i.height>60)){if(l==="feed"){r=o;const c=window.getComputedStyle(o);(o.className.includes("r-1q142lx")||c.borderBottomColor==="rgb(4, 131, 215)"||c.color==="rgb(4, 131, 215)"||o.getAttribute("aria-selected")==="true")&&(s="feed")}else if(l==="plays"){n=o;const c=window.getComputedStyle(o);(o.className.includes("r-1q142lx")||c.borderBottomColor==="rgb(4, 131, 215)"||c.color==="rgb(4, 131, 215)"||o.getAttribute("aria-selected")==="true")&&(s="plays")}}}if(s===null&&(r||n)){const o=N(e).toLowerCase();/\d+(?:\.\d+)?\s*fps\s+\d/.test(o)&&/vs\s+[A-Z]{2,4}|@\s+[A-Z]{2,4}/i.test(o)?s="feed":/\d+-\d+\s+P\d+\s+\d{1,2}:\d{2}/i.test(o)&&(s="plays")}return{feedBtn:r,playsBtn:n,activeTab:s}}async function li(){const{feedBtn:e,activeTab:t}=qr();if(k("info",`Toggle to Feed: activeTab=${t}, feedBtn=${e?"found":"not found"}`,{scope:"scrape"}),t==="feed")return!0;if(!e)return!1;k("step","Clicking Feed button with humanActivate",{scope:"scrape"}),ni(e);const r=await gt(()=>qr().activeTab==="feed",{timeoutMs:4e3});return k("info",`Feed tab switch result: ${r}`,{scope:"scrape"}),r}function ci(){const e=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,t=Array.from(e.querySelectorAll("div,header")).map(r=>{const n=N(r);if(!n||!n.includes("Player"))return null;const s=r.getBoundingClientRect();return s.top<-5||s.top>80||s.height<32||s.height>90?null:{el:r,area:s.width*s.height}}).filter(Boolean);return t.length===0?null:(t.sort((r,n)=>n.area-r.area),t[0].el)}function ui(){const e=ci();if(!e)return!1;const r=Array.from(e.querySelectorAll("button,[role='button'],a,div[tabindex='0']")).map(n=>{const s=n.getBoundingClientRect();if(s.width<=0||s.height<=0||s.width>80||s.height>80)return null;const o=Math.max(0,120-s.left),l=n.querySelector("svg")?20:0,i=N(n).toLowerCase(),c=(n.getAttribute("aria-label")||"").toLowerCase(),a=i.includes("back")||c.includes("back")?30:0;return{el:n,score:o+l+a}}).filter(Boolean);if(r.length===0)return!1;r.sort((n,s)=>s.score-n.score);try{return r[0].el.click(),!0}catch{return!1}}const di={code:"NHL",name:"National Hockey League",stats:[{code:"G",name:"Goals",aliases:["goal","goals","g"],isPrimary:!0},{code:"A",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"PTS",name:"Points",aliases:["pt","pts","points"],isPrimary:!0},{code:"SOG",name:"Shots on Goal",aliases:["sog","shot","shots"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"HIT",name:"Hits",aliases:["hit","hits"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]},{code:"PIM",name:"Penalty Minutes",aliases:["pim","penalty"]},{code:"FOW",name:"Faceoff Wins",aliases:["fow","fo","faceoff"]},{code:"FO%",name:"Faceoff Percentage",aliases:["fo%","fopct"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"GA",name:"Goals Against",aliases:["ga","goalsagainst"]},{code:"SV%",name:"Save Percentage",aliases:["sv%","savepct"]},{code:"GAA",name:"Goals Against Average",aliases:["gaa"]},{code:"SO",name:"Shutouts",aliases:["so","shutout","shutouts"]},{code:"GP",name:"Games Played",aliases:["gp","games"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"OTL",name:"Overtime Losses",aliases:["otl","ot loss"]},{code:"TOI",name:"Time on Ice",aliases:["toi"]},{code:"GVA",name:"Giveaways",aliases:["gva","gwa","giveaway","giveaways"]},{code:"TKA",name:"Takeaways",aliases:["tka","takeaway","takeaways"]},{code:"PPG",name:"Power Play Goals",aliases:["ppg","pp goal"]},{code:"SHG",name:"Short Handed Goals",aliases:["shg","sh goal"]}],periods:{pattern:/P[1-3]|OT\d?|SO/i,labels:["P1","P2","P3","OT","SO"],hasClock:!0,timePattern:/:?\d{1,2}(?::\d{2})?/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["G","A","PTS","SOG","BLK"]},Yr={code:"NBA",name:"National Basketball Association",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"FGM",name:"Field Goals Made",aliases:["fgm","fg"]},{code:"FGA",name:"Field Goals Attempted",aliases:["fga"]},{code:"3PM",name:"3-Pointers Made",aliases:["3pm","3pt","three","threes"],isPrimary:!0},{code:"3PA",name:"3-Pointers Attempted",aliases:["3pa"]},{code:"FTM",name:"Free Throws Made",aliases:["ftm","ft"]},{code:"FTA",name:"Free Throws Attempted",aliases:["fta"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"],isPrimary:!0},{code:"OREB",name:"Offensive Rebounds",aliases:["oreb","or"]},{code:"DREB",name:"Defensive Rebounds",aliases:["dreb","dr"]},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"],isPrimary:!0},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"],isPrimary:!0},{code:"BLK",name:"Blocks",aliases:["blk","block","blocks"],isPrimary:!0},{code:"MIN",name:"Minutes",aliases:["min","mins","minutes"]},{code:"PF",name:"Personal Fouls",aliases:["pf","foul","fouls"]},{code:"+/-",name:"Plus/Minus",aliases:["+/-","plusminus","pm"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","REB","AST","STL","BLK","3PM"]},_s={code:"NFL",name:"National Football League",stats:[{code:"PASS_YD",name:"Passing Yards",aliases:["pass yd","pass yds","passing","pass"],isPrimary:!0},{code:"PASS_TD",name:"Passing Touchdowns",aliases:["pass td","pass tds","ptd"]},{code:"INT",name:"Interceptions Thrown",aliases:["int","ints","interception"]},{code:"CMP",name:"Completions",aliases:["cmp","comp","completions"]},{code:"ATT",name:"Pass Attempts",aliases:["att","attempts"]},{code:"RUSH_YD",name:"Rushing Yards",aliases:["rush yd","rush yds","rushing","rush"],isPrimary:!0},{code:"RUSH_TD",name:"Rushing Touchdowns",aliases:["rush td","rush tds","rtd"]},{code:"CAR",name:"Carries",aliases:["car","carry","carries"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception","receptions"],isPrimary:!0},{code:"REC_YD",name:"Receiving Yards",aliases:["rec yd","rec yds","receiving"]},{code:"REC_TD",name:"Receiving Touchdowns",aliases:["rec td","rec tds"]},{code:"TGT",name:"Targets",aliases:["tgt","target","targets"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown","touchdowns"],isPrimary:!0},{code:"YD",name:"Total Yards",aliases:["yd","yds","yards"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"XP",name:"Extra Points",aliases:["xp","pat","extra point"]},{code:"SACK",name:"Sacks",aliases:["sack","sacks","sk"]},{code:"TKL",name:"Tackles",aliases:["tkl","tackle","tackles"]},{code:"FF",name:"Forced Fumbles",aliases:["ff","forced fumble"]},{code:"FR",name:"Fumble Recoveries",aliases:["fr","fumble recovery"]},{code:"DEF_INT",name:"Defensive Interceptions",aliases:["def int","pick"]}],periods:{pattern:/Q[1-4]|OT\d?/i,labels:["Q1","Q2","Q3","Q4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PASS_YD","RUSH_YD","REC","TD"]},fi={code:"MLB",name:"Major League Baseball",stats:[{code:"H",name:"Hits",aliases:["h","hit","hits"],isPrimary:!0},{code:"HR",name:"Home Runs",aliases:["hr","hrs","homer","homers","home run"],isPrimary:!0},{code:"RBI",name:"Runs Batted In",aliases:["rbi","rbis"],isPrimary:!0},{code:"R",name:"Runs",aliases:["r","run","runs"],isPrimary:!0},{code:"SB",name:"Stolen Bases",aliases:["sb","stolen","steal","steals"]},{code:"BB",name:"Walks",aliases:["bb","walk","walks"]},{code:"K",name:"Strikeouts",aliases:["k","so","strikeout","strikeouts"]},{code:"AB",name:"At Bats",aliases:["ab","at bat","at bats"]},{code:"2B",name:"Doubles",aliases:["2b","double","doubles"]},{code:"3B",name:"Triples",aliases:["3b","triple","triples"]},{code:"AVG",name:"Batting Average",aliases:["avg","average"]},{code:"IP",name:"Innings Pitched",aliases:["ip","innings"]},{code:"ER",name:"Earned Runs",aliases:["er","earned run","earned runs"]},{code:"W",name:"Wins",aliases:["w","win","wins"]},{code:"L",name:"Losses",aliases:["l","loss","losses"]},{code:"SV",name:"Saves",aliases:["sv","save","saves"]},{code:"ERA",name:"Earned Run Average",aliases:["era"]},{code:"WHIP",name:"Walks+Hits per IP",aliases:["whip"]},{code:"QS",name:"Quality Starts",aliases:["qs","quality start"]}],periods:{pattern:/(?:Top|Bot|T|B)\s*\d+|Inning\s*\d+|\d+(?:st|nd|rd|th)/i,labels:["1st","2nd","3rd","4th","5th","6th","7th","8th","9th","Extra"],hasClock:!1},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["H","HR","RBI","R","SB"]},Ur={code:"NFL",name:"Generic Sport",stats:[{code:"PTS",name:"Points",aliases:["pt","pts","points","point"],isPrimary:!0},{code:"AST",name:"Assists",aliases:["ast","assist","assists","a"]},{code:"REB",name:"Rebounds",aliases:["reb","rebs","rebound","rebounds"]},{code:"BLK",name:"Blocks",aliases:["blk","blks","block","blocks"]},{code:"STL",name:"Steals",aliases:["stl","steal","steals"]},{code:"G",name:"Goals",aliases:["goal","goals","g"]},{code:"SOG",name:"Shots",aliases:["sog","shot","shots"]},{code:"TO",name:"Turnovers",aliases:["to","tov","turnover","turnovers"]},{code:"FG",name:"Field Goals",aliases:["fg","fgs","field goal"]},{code:"3PM",name:"3-Pointers",aliases:["3pm","3pt","three","threes"]},{code:"TD",name:"Touchdowns",aliases:["td","tds","touchdown"]},{code:"YD",name:"Yards",aliases:["yd","yds","yards"]},{code:"REC",name:"Receptions",aliases:["rec","recs","reception"]},{code:"BIRDIE",name:"Birdies",aliases:["birdie","birdies"]},{code:"PAR",name:"Pars",aliases:["par","pars"]},{code:"BOGEY",name:"Bogeys",aliases:["bogey","bogeys"]},{code:"EAGLE",name:"Eagles",aliases:["eagle","eagles"]},{code:"KO",name:"Knockouts",aliases:["ko","knockout","knockouts"]},{code:"SUB",name:"Submissions",aliases:["sub","submission","submissions"]},{code:"TKD",name:"Takedowns",aliases:["tkd","takedown","takedowns"]},{code:"STR",name:"Strikes",aliases:["str","strike","strikes"]},{code:"GLS",name:"Goals",aliases:["gls","goal","goals"]},{code:"SHT",name:"Shots",aliases:["sht","shot","shots"]},{code:"SOT",name:"Shots on Target",aliases:["sot"]},{code:"CRN",name:"Corners",aliases:["crn","corner","corners"]}],periods:{pattern:/(?:P[1-3]|Q[1-4]|H[1-2]|OT\d?|SO|R\d+|RD\s*\d+)/i,labels:["1","2","3","4","OT"],hasClock:!0,timePattern:/\d{1,2}:\d{2}/},scoring:{pattern:/\d+-\d+/,separator:"-"},fpsPattern:/(\d+(?:\.\d+)?)\s*fps/i,primaryStats:["PTS","G","TD","REC"]};function pi(e,t){return{...Ur,code:e,name:t}}const hi={NHL:di,NBA:Yr,NFL:_s,MLB:fi,CFB:{..._s,code:"CFB",name:"College Football"},CBB:{...Yr,code:"CBB",name:"College Basketball"},WNBA:{...Yr,code:"WNBA",name:"Women's NBA"},FC:pi("FC","Football Club / Soccer")};function mi(e){if(!e)return Ur;const t=e.toUpperCase().trim();return hi[t]||Ur}function Hr(e){return(e||"").trim().toLowerCase()}function gi(e){const t=(e||"").trim(),r=t.split("").map(o=>o.trim()).filter(Boolean),n=r[0]||t,s=r.slice(1).join("  ");return{name:n,rest:s}}function ys(e,t){const r=Hr(t);if(!r)return null;const n=/\+(\d+(?:\.\d+)?)x\b/i,s=Array.from(e.querySelectorAll("div[tabindex='0'],[role='button'],button")).map(o=>{const l=N(o);if(!l||!n.test(l))return null;const{name:i}=gi(l),c=o.getBoundingClientRect();if(c.width<=140||c.height<28)return null;const a=(Hr(i)===r?1e3:Hr(i).includes(r)?100:0)+Math.min(200,Math.round(c.width));return a<=0?null:{el:o,score:a,rect:c,name:i}}).filter(Boolean);return s.length===0?null:(s.sort((o,l)=>l.score-o.score),s[0].el)}function xs(e){const s=Array.from(e.querySelectorAll("a[href],a,button,div[tabindex='0'],[role='button']")).filter(i=>!!i.querySelector("svg")).map(i=>({el:i,r:i.getBoundingClientRect()})).filter(i=>i.r.width>8&&i.r.width<=28&&i.r.height>8&&i.r.height<=28);if(s.length===0)return null;s.sort((i,c)=>c.r.left-i.r.left);const o=s[0].el;return(o instanceof HTMLAnchorElement?o:null)||o.querySelector("a[href]")||o.closest("a[href]")||o}async function vi(e){const t=mt();if(!t)return k("warn","No modal found for profile URL discovery",{scope:"profile"}),null;k("step",`Finding player row: ${e}`,{scope:"profile"});const r=ys(t,e);if(!r)return k("warn","Player row not found",{scope:"profile"}),null;const n=xs(r);if(!n)return k("warn","Profile icon button not found",{scope:"profile"}),null;const s=n instanceof HTMLAnchorElement?n:n.closest("a[href]");if(s?.getAttribute("href")){const o=new URL(String(s.getAttribute("href")),location.href).toString();return k("info","Got profile URL from href",{scope:"profile",data:{url:o}}),o}return k("info","No href on icon, will click to navigate",{scope:"profile"}),"__CLICK_TO_NAVIGATE__"}function bi(e){const t=e.querySelector("#realrootcontents")||e.querySelector("#realweb")||e.body,n=Array.from(t.querySelectorAll("div,section,header,article")).slice(0,2e3).map(s=>{const o=(N(s)||"").replace(/\s+/g," ").trim();if(!o||o.length<40||o.length>320)return null;const l=o.toUpperCase();let i=0;return l.includes("7-DAY")&&(i+=4),l.includes("30-DAY")&&(i+=4),l.includes("SEASON")&&(i+=3),l.includes("CARD")&&(i+=2),o.includes("")&&(i+=2),/#\d+/.test(o)&&(i+=1),/\b\d+(st|nd|rd|th)\b/i.test(o)&&(i+=2),i<6?null:{t:o,score:i}}).filter(Boolean);return n.length===0?null:(n.sort((s,o)=>o.score-s.score),n[0].t)}function _i(e){const t={},r=e.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/gi);if(r)for(const s of r){const o=s.match(/(\d+)(st|nd|rd|th)\s*(7-DAY|30-DAY|SEASON)?/i);if(o){const l=parseInt(o[1],10),i=o[3]||"overall";t[`rank_${i.toLowerCase().replace("-","_")}`]=l}}const n=e.match(/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)\s*\s*([A-Z]+)\s*\s*#(\d+)/);return n&&(t.team=n[1],t.position=n[2],t.number=parseInt(n[3],10)),t}function yi(e){const t=e.replace(/\s+/g," "),r=/([A-Z]+(?:%||\+\/-)?)\s+(-?\d+(?:\.\d+)?(?::\d+)?)\s+(\d+)(?:st|nd|rd|th)\b/gi,n=[];let s;for(;(s=r.exec(t))!==null;)n.push({stat:s[1],value:s[2],rank:parseInt(s[3],10)});return n.length>0?{entries:n}:null}function ws(e){const t=e.replace(/\s+/g," ");let r=[];const n=t.match(/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps[^A-Z]*/gi);if(n&&(r=n.map(s=>s.trim().slice(0,200)).filter(s=>s.length>20).slice(0,15)),r.length===0){const s=e.split(/\n/).map(o=>o.trim()).filter(Boolean);for(const o of s)if((/\d+(?:\.\d+)?\s*fps/i.test(o)||/\d+(?:\.\d+)?\s*@\s*[A-Z]{2,4}/i.test(o))&&(r.push(o.slice(0,200)),r.length>=15))break}return r.length>0?{entries:r}:null}function Ss(e){const t=e.replace(/\s+/g," "),r=[],n=/([A-Z]\.[\s]*[\w'-]+)\s*\s*(\d+(?:\.\d+)?)\s*fps\s+([\d.]+)?/gi;let s;const o=[];for(;(s=n.exec(t))!==null&&(o.push({player:s[1].trim(),fps:parseFloat(s[2]),multiplier:s[3]?parseFloat(s[3]):null,startIdx:s.index,endIdx:s.index+s[0].length}),!(o.length>=30)););for(let l=0;l<o.length;l++){const i=o[l],c=o[l+1]?.startIdx??t.length,a=t.slice(i.endIdx,c).trim(),u=a.match(/(\d+\s+(?:hours?|days?|weeks?|months?)\s+ago|yesterday|today)/i),d=a.match(/(vs|@)\s*([A-Z]{2,4})\s*([WL])?/i);let f=a;u?f=a.slice(0,u.index).trim():d&&(f=a.slice(0,d.index).trim()),f=f.replace(/\s+\d+\s*$/,"").trim(),r.push({player:i.player,fps:i.fps,multiplier:i.multiplier,stats:f.slice(0,100),date:u?.[1]||"",opponent:d?.[2]||"",result:d?.[3]||""})}return r}async function xi(e,t,r=null){mi(r),k("step","Scraping profile from current DOM",{scope:"scrape"});const n=bi(document),s=n?_i(n):null,o=document.querySelector("#realrootcontents")||document.querySelector("#realweb")||document.body,l=N(o),i=yi(l),{activeTab:c}=qr();k("info",`Initial tab: ${c||"unknown"}`,{scope:"scrape"});let a=[],u=null;if(c==="plays"){if(k("step","Switching to Feed tab",{scope:"scrape"}),await li()){await gt(()=>{const h=N(o).replace(/\s+/g," ");return/[A-Z]\.\s*\w+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(h)},{timeoutMs:3e3,intervalMs:100});const p=N(o);a=Ss(p),u=ws(p)}}else a=Ss(l),u=ws(l);k("info",`Feed extraction: ${a.length} entries`,{scope:"scrape"});const d={player_name:e,profile_url:t,title:document.title||"",header_text:n,header_parsed:s,season_summary:i,recent_performances:u,feed_entries:a,active_tab:c,raw_text_length:l.length};return k("info","Scrape complete",{scope:"scrape",data:{header:!!n,season_summary:i?.entries?.length??0,recent_performances:u?.entries?.length??0,feed_entries:a.length,active_tab:c}}),d}async function wi(e){const t=location.href,r=e.profile_url==="__CLICK_TO_NAVIGATE__";k("step","Starting profile scrape flow",{scope:"flow",data:{player_name:e.player_name,profile_url:r?"(will click icon)":e.profile_url,return_to_draft:e.return_to_draft}});const n=mt();k("info",`Draft modal at start: ${n?"found":"not found"}`,{scope:"flow"}),k("step","Navigating to profile page",{scope:"flow"});const s=n?ys(n,e.player_name):null,o=s?xs(s):null;let l=null,i=null;if(s&&rt()&&(l=vs(s,`Player: ${e.player_name}`,"rgba(0, 161, 99, 0.3)")),o&&rt()&&(i=vs(o,"Profile Icon","rgba(4, 131, 215, 0.5)")),r||o)o?(k("step","Clicking profile icon",{scope:"flow"}),o.click()):k("warn","Could not find icon button to click",{scope:"flow"});else if(e.profile_url&&!r){k("step","Using pushState to navigate",{scope:"flow"});try{const p=new URL(e.profile_url,location.href);history.pushState({},"",p.pathname+p.search+p.hash),window.dispatchEvent(new PopStateEvent("popstate"))}catch(p){k("warn","pushState failed",{scope:"flow",data:{error:String(p)}})}}bs(l),bs(i),k("step","Waiting for profile page to load",{scope:"flow"});const c=await gt(()=>location.href!==t,{timeoutMs:6e3,intervalMs:100});k("info",`Navigation result: ${c?"URL changed":"URL unchanged"}`,{scope:"flow",data:{prevUrl:t,currentUrl:location.href}}),c&&(k("step","Waiting for profile content to render",{scope:"flow"}),await gt(()=>{const p=document.querySelector("#realrootcontents")||document.body,h=N(p),S=/[A-Z]\.\s*[\w'-]+\s*\s*\d+(?:\.\d+)?\s*fps/i.test(h),y=/PTS\s+\d+\s+\d+/i.test(h)||/GOAL\s+\d+/i.test(h);return S||y},{timeoutMs:1e4,intervalMs:100}));const a=c?location.href:e.profile_url,u=await xi(e.player_name,a,e.sport||null);let d=!1,f=!1;if(e.return_to_draft&&c){k("step","Going back to home page",{scope:"flow"});try{history.back()}catch{}if(d=await gt(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}),d||(k("step","Clicking back button in nav",{scope:"flow"}),ui()&&(d=await gt(()=>location.href===t||document.querySelector("#realrootcontents")!==null,{timeoutMs:6e3,intervalMs:100}))),k("info",`Returned to home: ${d}`,{scope:"flow",data:{currentUrl:location.href}}),d)if(k("step","Reopening draft modal",{scope:"flow"}),await new Promise(p=>setTimeout(p,500)),mt())f=!0,k("info","Modal already open",{scope:"flow"});else{const p=await Ga({timeoutMs:8e3});f=p.opened,k("info",`Modal reopen attempt: clicked=${p.clicked}, opened=${p.opened}`,{scope:"flow"})}}return ri(),{...u,return_to_draft:e.return_to_draft,returned_to_draft:d,modal_reopened:f,prev_url:t,navigated_to_profile:c,modal_was_open:!!n}}function q(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Gr(e){const t=typeof e=="number"&&!Number.isNaN(e)?e:null;return t==null?"":`${(Math.round(t*100)/100).toString()}x`}function Si(e){if(!e||e.ok!==!0)return`<div class="card"><div class="h">Nothing captured</div><div class="sub">${q(e?.error||"Open a draft modal and click Capture.")}</div></div>`;let t=Array.isArray(e?.slots)?e.slots:[];(!t||t.length===0)&&Array.isArray(e?.drafts)&&e.drafts.length>0&&(t=e.drafts[0].slots||[]);const r=typeof e?.expected_slots=="number"&&e.expected_slots>0?e.expected_slots:t.length,n=e?.sport||"",s=e?.mode||"",o=Array.isArray(e?.player_pool)?e.player_pool:[],l=(t||[]).map((a,u)=>{const d=a?.selection?q(a.selection):"<span class='muted'>Empty</span>",f=Gr(a?.multiplier);return`<tr><td>${u+1}</td><td>${f}</td><td>${d}</td></tr>`}).join(""),i=o.slice(0,40).map(a=>{const u=q(a?.name||""),d=a?.status?`<span class="muted">(${q(a.status)})</span>`:"",f=typeof a?.boost_x=="number"?`<span class="pill">+${q(a.boost_x)}x</span>`:"";return`<div class="row"><div class="rowLeft">${u} ${d}</div><div class="rowRight">${f}</div></div>`}).join(""),c=o.length>40?`<div class="sub">Showing 40 of ${o.length} players.</div>`:`<div class="sub">Players: ${o.length}.</div>`;return`
    <div class="card">
      <div class="h">Capture</div>
      <div class="sub">Sport: <b>${q(n)}</b>  Mode: <b>${q(s)}</b>  Slots: <b>${q(r)}</b></div>
    </div>
    <div class="card">
      <div class="h">Slots</div>
      <table class="table">
        <thead><tr><th>#</th><th>Multiplier</th><th>Selection</th></tr></thead>
        <tbody>${l||"<tr><td colspan='3' class='muted'>No slots found.</td></tr>"}</tbody>
      </table>
    </div>
    <div class="card">
      <div class="h">Player pool</div>
      ${c}
      <div class="list">${i||"<div class='muted'>No pool detected.</div>"}</div>
    </div>
  `.trim()}function ks(e,t=[]){const r=Array.isArray(e?.lineup)?e.lineup:[],n=Array.isArray(e?.bets)?e.bets:[],s=Array.isArray(e?.assumptions)?e.assumptions:[],o=Array.isArray(e?.questions)?e.questions:[],l=r.map(a=>{const u=q(a?.slot_index),d=q(a?.player||""),f=Gr(a?.slot_multiplier),p=typeof a?.player_boost_x=="number"?`+${q(a.player_boost_x)}x`:"+0x",h=Gr(a?.effective_multiplier);return`<tr><td>${u}</td><td>${d}</td><td>${f}</td><td>${p}</td><td><b>${h}</b></td></tr>`}).join(""),i=n.map(a=>{const u=q(a?.tier||""),d=a?.recommend?"YES":"NO",f=a?.recommend?"yes":"no",p=q(a?.confidence||""),h=q(a?.reason||"");return`<div class="bet-item"><div class="bet-header"><span class="bet-tier">${u}</span><span class="bet-rec ${f}">${d}</span><span class="muted">(${p})</span></div><div class="bet-reason">${h}</div></div>`}).join(""),c=(t||[]).slice(0,8).map(a=>`<div class="row"><a class="link" href="${q(a)}" target="_blank" rel="noreferrer">${q(a)}</a></div>`).join("");return`
    <div class="card"><div class="h">AI result</div><div class="sub">Structured JSON parsed successfully.</div></div>
    <div class="card">
      <div class="h">Lineup</div>
      <table class="table">
        <thead><tr><th>Slot</th><th>Player</th><th>Slot</th><th>Boost</th><th>Effective</th></tr></thead>
        <tbody>${l||"<tr><td colspan='5' class='muted'>No lineup returned.</td></tr>"}</tbody>
      </table>
    </div>
    <div class="card"><div class="h">Bets</div><div class="list">${i||"<div class='muted'>No bets returned.</div>"}</div></div>
    ${o.length?`<div class="card"><div class="h">Questions</div><div class="list">${o.map(a=>`<div class="row">${q(a)}</div>`).join("")}</div></div>`:""}
    ${s.length?`<div class="card"><div class="h">Assumptions</div><div class="list">${s.map(a=>`<div class="row">${q(a)}</div>`).join("")}</div></div>`:""}
    ${c?`<div class="card"><div class="h">Sources</div><div class="list">${c}</div></div>`:""}
  `.trim()}function ki(){const e=String(M(Rr,"")||"").trim(),t=String(M(Ir,et)||et).trim()||et,r=M(Mr,or),n=M(Or,ar),s=M(Nr,$t),o=M(nr,Ta),l=M(sr,Ca),i=Math.max(0,Math.min(2,parseFloat(String(r)))),c=Math.max(64,Math.min(4e3,parseInt(String(n),10)||ar)),a=Math.max(1,Math.min(5,parseInt(String(s),10)||$t)),u=String(o)==="1"||o===!0,d=String(l)==="1"||l===!0;return{apiKey:e,model:t,temperature:i,max_tokens:c,web_max_results:a,structured:u,response_healing:d}}function Ei({method:e,url:t,headers:r,bodyObj:n,timeoutMs:s=6e4}){return new Promise((o,l)=>{const i=n==null?null:JSON.stringify(n);if(typeof GM_xmlhttpRequest!="function"){l(new Error("GM_xmlhttpRequest is not available (check grants)."));return}GM_xmlhttpRequest({method:e,url:t,headers:{"Content-Type":"application/json",...r||{}},data:i??void 0,timeout:s,onload:c=>{try{const a=c?.responseText||"",u=a?JSON.parse(a):null;c.status>=200&&c.status<300?o(u):l(new Error(u?.error?.message||u?.message||`HTTP ${c.status}`))}catch(a){l(a)}},onerror:()=>l(new Error("Network error.")),ontimeout:()=>l(new Error("Request timed out."))})})}function Ai(){return{type:"object",additionalProperties:!1,properties:{lineup:{type:"array",items:{type:"object",additionalProperties:!1,properties:{slot_index:{type:"number"},slot_multiplier:{type:"number"},player:{type:"string"},player_boost_x:{type:["number","null"]},effective_multiplier:{type:"number"}},required:["slot_index","slot_multiplier","player","player_boost_x","effective_multiplier"]}},bets:{type:"array",items:{type:"object",additionalProperties:!1,properties:{tier:{type:"string",enum:["top50","top20","top10"]},recommend:{type:"boolean"},confidence:{type:"string",enum:["low","medium","high"]},reason:{type:"string"}},required:["tier","recommend","confidence","reason"]}},assumptions:{type:"array",items:{type:"string"}},questions:{type:"array",items:{type:"string"}}},required:["lineup","bets","assumptions","questions"]}}function Es(e){const r=(Array.isArray(e?.annotations)?e.annotations:[]).filter(n=>n&&n.type==="url_citation"&&n.url_citation&&n.url_citation.url).map(n=>n.url_citation.url).slice(0,25);return Array.from(new Set(r))}function Ti(e){return String(e?.message||e||"").toLowerCase().includes("no endpoints found")}function vt(){return new Date().toISOString()}function bt(e){try{localStorage.setItem(is,JSON.stringify(e,null,2))}catch{}}async function As(e,t){let r=null;for(const n of e)try{return{res:await Ei({method:"POST",url:t.url,headers:t.headers,bodyObj:n.body,timeoutMs:t.timeoutMs}),usedLabel:n.label}}catch(s){if(r=s,!Ti(s))throw s}throw r||new Error("OpenRouter request failed.")}function Ci(){return{type:"function",function:{name:"get_player_profile_stats",description:"Fetch and summarize a player's RealSports profile page (rankings, prior performances, recent game logs). Clicks the player's profile icon in the draft modal, scrapes their stats, then returns to the draft. Use when deciding between players beyond boost values.",parameters:{type:"object",additionalProperties:!1,properties:{player_name:{type:"string",description:"Player name exactly as shown in the draft modal."}},required:["player_name"]}}}}async function Pi(e,t,r){if(e==="get_player_profile_stats"){const n=String(t?.player_name||"").trim();if(!n)return{error:"missing_player_name"};k("step",`Tool call: get_player_profile_stats(${n})`,{scope:"tool"}),k("step","Discovering profile URL via click",{scope:"tool"});const s=await vi(n);if(!s)return{error:"player_not_found",player_name:n,hint:"Could not find this player in the draft modal. Make sure the draft modal is open and the player is visible in the list."};k("step","Scraping profile",{scope:"tool",data:{profile_url:s}});const o=r.payload?.sport||null,l=await wi({player_name:n,profile_url:s,return_to_draft:!0,sport:o});return k("info","Tool result ready",{scope:"tool",data:{scraped_via:l?.scraped_via,navigated_to_profile:l?.navigated_to_profile}}),{...l,discovery:"click",mode:"live_dom"}}return{error:"unknown_tool",toolName:e}}async function Ri(e){const t=ki(),r=String(M(tt,"0"))==="1"||M(tt,"0")===!0;if((!ir||r)&&!t.apiKey)throw new Error("Missing OpenRouter API key.");const o=String(M(qt,"0"))==="1"||M(qt,"0")===!0?["DEBUG TOOL TEST: You MUST call the tool `get_player_profile_stats` exactly once before producing the final JSON schema answer.","Pick ONE player from the available pool (prefer a high-boost or a close decision).","IMPORTANT: Call the tool with return_to_draft=true so you can read dynamic Feed/Plays content, then come back to the draft.","After you receive the tool result, continue normally and return the final JSON schema output.","",e.prompt].join(`
`):e.prompt,l=[{t:vt(),kind:"start",model:t.model,web:!!e.web}];bt(l);const i=[Ci()],c=String(M(tt,"0"))==="1"||M(tt,"0")===!0,a=ir&&!c,u=a?{"X-RSDH-Auth":Ra,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"}:{Authorization:`Bearer ${t.apiKey}`,"HTTP-Referer":"https://realsports.io/","X-Title":"RealSports Draft Helper"};if(a){const ie=hs();ie?.username&&(u["X-RSDH-User"]=ie.username)}const d=a?os:Pa,f=[];e.web&&f.push({id:"web",engine:"exa",max_results:t.web_max_results}),t.response_healing&&f.push({id:"response-healing"});const p=[],h=[{role:"user",content:o}],S=6;let y=[];for(let ie=0;ie<S;ie++){const se={model:t.model,messages:h,temperature:t.temperature,max_tokens:t.max_tokens,tools:i},Ue=[{label:"tools+tool_choice+parallel+provider",body:{...se,tool_choice:"auto",parallel_tool_calls:!1,provider:{require_parameters:!0},plugins:p}},{label:"tools+tool_choice+provider",body:{...se,tool_choice:"auto",provider:{require_parameters:!0},plugins:p}},{label:"tools+tool_choice",body:{...se,tool_choice:"auto",plugins:p}},{label:"tools-only",body:{...se,plugins:p}}],{res:Jr,usedLabel:ur}=await As(Ue,{url:d,headers:u,timeoutMs:9e4});ur!==Ue[0].label&&(l.push({t:vt(),kind:"routing_fallback",stage:"tool_loop",label:ur}),bt(l));const st=Jr?.choices?.[0]?.message;y=Es(st);const we=Array.isArray(st?.tool_calls)?st.tool_calls:null;if(!we||we.length===0)break;h.push({role:"assistant",content:st?.content??null,tool_calls:we});for(const He of we.slice(0,3)){const me=He?.function?.name,Ut=He?.function?.arguments;let Ge={};try{Ge=Ut?JSON.parse(Ut):{}}catch{Ge={_raw:Ut}}const _t=String(He?.id||"");l.push({t:vt(),kind:"tool_call",name:String(me||""),id:_t,args:Ge}),bt(l);const Vr=performance.now(),yt=await Pi(String(me||""),Ge,{payload:e.payload}),Ht=Math.round(performance.now()-Vr),x=yt,Gt=!x?.error,B={};me==="get_player_profile_stats"&&(B.player_name=x?.player_name||Ge?.player_name,B.profile_url=x?.profile_url||null,B.discovery=x?.discovery||null,B.mode=x?.mode||"live_dom",B.returned_to_draft=typeof x?.returned_to_draft=="boolean"?x.returned_to_draft:null,B.modal_reopened=typeof x?.modal_reopened=="boolean"?x.modal_reopened:null,B.navigated_to_profile=typeof x?.navigated_to_profile=="boolean"?x.navigated_to_profile:null,B.modal_was_open=typeof x?.modal_was_open=="boolean"?x.modal_was_open:null,B.header=!!x?.header_text,B.season_summary=x?.season_summary?.entries?x.season_summary.entries.length:null,B.recent_performances=x?.recent_performances?.entries?x.recent_performances.entries.length:null,B.feed_entries=Array.isArray(x?.feed_entries)?x.feed_entries.length:null,B.lines=Array.isArray(x?.interesting_lines)?x.interesting_lines.length:null,B.tables=Array.isArray(x?.tables)?x.tables.length:null,B.embedded_json=Array.isArray(x?.embedded_json)?x.embedded_json.length:null,B.facts=Array.isArray(x?.facts)?x.facts.length:null,B.recent_log=Array.isArray(x?.recent_log)?x.recent_log.length:null,x?.error&&(B.error=x.error),B.scraped_data={header_text:x?.header_text||null,season_summary:x?.season_summary||null,recent_performances:x?.recent_performances||null,feed_entries:x?.feed_entries||[]}),l.push({t:vt(),kind:"tool_result",name:String(me||""),id:_t,ok:Gt,ms:Ht,summary:B}),bt(l),h.push({role:"tool",tool_call_id:_t,content:JSON.stringify(yt)})}}const O={type:"json_schema",json_schema:{name:"draft_lineup",strict:!0,schema:Ai()}},C={model:t.model,messages:h,temperature:t.temperature,max_tokens:t.max_tokens,response_format:O},ne=[{label:"final+tools+tool_choice+provider+plugins",body:{...C,tools:i,tool_choice:"none",provider:{require_parameters:!0},plugins:f}},{label:"final+tools+tool_choice",body:{...C,tools:i,tool_choice:"none",plugins:[]}},{label:"final+schema+plugins",body:{...C,plugins:f}},{label:"final+schema-only",body:{...C}}],{res:Y,usedLabel:z}=await As(ne,{url:d,headers:u,timeoutMs:9e4});z!==ne[0].label&&(l.push({t:vt(),kind:"routing_fallback",stage:"final",label:z}),bt(l));const pe=Y?.choices?.[0]?.message,U=pe?.content;if(!U)throw new Error("No content returned.");try{localStorage.setItem(Ia,U)}catch{}const K=Es(pe);try{localStorage.setItem(Lr,JSON.stringify(K,null,2))}catch{}try{localStorage.setItem(Ma,JSON.stringify(h,null,2))}catch{}return l.push({t:vt(),kind:"done"}),bt(l),{jsonText:U,sources:K.length?K:y||[]}}function Ii(e){try{localStorage.setItem(as,JSON.stringify(e,null,2))}catch{}}function Ts(e){try{window.dispatchEvent(new CustomEvent("rsdh-output",{detail:{raw:e}}))}catch{}}function Ye(e){try{window.dispatchEvent(new CustomEvent("rsdh-status",{detail:{text:e}}))}catch{}}function zr(e,t=!1){const r=document.createElement("button");return r.type="button",r.textContent=e,r.style.cssText=`
    font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: -0.01em;
    padding: 10px 14px;
    border-radius: 10px;
    cursor: pointer;
    width: 100%;
    white-space: nowrap;
    transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    ${t?`background: linear-gradient(135deg, var(--rsdh-accent, #2c6cff) 0%, color-mix(in srgb, var(--rsdh-accent, #2c6cff) 80%, black) 100%);
         color: white;
         border: none;
         box-shadow: 0 2px 8px rgba(0,0,0,0.2);`:`background: rgba(255,255,255,0.08);
         color: #f5f5f5;
         border: 1px solid rgba(255,255,255,0.1);
         box-shadow: none;`}
  `,r.addEventListener("mouseenter",()=>{r.style.transform="translateY(-1px)",t?r.style.boxShadow="0 4px 16px rgba(0,0,0,0.3), 0 0 20px color-mix(in srgb, var(--rsdh-accent, #2c6cff) 40%, transparent)":(r.style.background="rgba(255,255,255,0.12)",r.style.boxShadow="0 4px 12px rgba(0,0,0,0.2)")}),r.addEventListener("mouseleave",()=>{r.style.transform="translateY(0)",t?r.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)":(r.style.background="rgba(255,255,255,0.08)",r.style.boxShadow="none")}),r.addEventListener("mousedown",()=>{r.style.transform="translateY(0)"}),r}function Mi(){const e=document.createElement("div");return e.id="rsdh-modal-actions",e.style.cssText=`
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 10px;
    margin-top: 14px;
    padding: 14px 16px 0 16px;
    border-top: 1px solid color-mix(in srgb, var(--rsdh-accent, #2c6cff) 30%, rgba(255,255,255,0.1));
  `,e}function Oi(e){const r=Array.from(e.querySelectorAll("button,div,[role='button']")).find(n=>{const s=(n.innerText||n.textContent||"").trim();return/^(submit|update)$/i.test(s)});return r?r.parentElement||r:null}async function Kr(e){Ye("Capturing...");const t=Ka({includeDebug:rt()});if(Ii(t),Ts(JSON.stringify(t,null,2)),!t||t.ok!==!0){const o=t?.error||"Could not capture modal.";Ye(o),nt(o);return}if(e==="copy_prompt"){const o=fs(t);GM_setClipboard(o),Ye("Copied prompt to clipboard."),Yt("Copied prompt to clipboard!");return}const r=e==="ask_ai_web"?"Asking AI + Web...":"Asking AI...";Ye(r),$r(r);const n=ps(t,{webHint:e==="ask_ai_web"}),s=await Ri({prompt:n,web:e==="ask_ai_web",payload:t});Ts(s.jsonText),Ye("AI response received."),Yt("AI response received!")}function Ni(){const e=()=>{const r=mt();if(!r||r.querySelector("#rsdh-modal-actions"))return;const n=Mi(),s=zr(" Copy Prompt"),o=zr(" Ask AI",!0),l=zr(" AI + Web",!0);s.addEventListener("click",()=>Kr("copy_prompt").catch(c=>{const a=String(c?.message||c);Ye(a),nt(a)})),o.addEventListener("click",()=>Kr("ask_ai").catch(c=>{const a=String(c?.message||c);Ye(a),nt(a)})),l.addEventListener("click",()=>Kr("ask_ai_web").catch(c=>{const a=String(c?.message||c);Ye(a),nt(a)})),n.appendChild(s),n.appendChild(o),n.appendChild(l);const i=Oi(r);i&&i.parentElement?i.parentElement.insertBefore(n,i.nextSibling):r.appendChild(n)};e(),new MutationObserver(()=>e()).observe(document.documentElement,{childList:!0,subtree:!0})}const Cs="rsdh_openrouter_models_cache",Li=1440*60*1e3,cr=["google/gemini-2.5-flash","google/gemini-2.5-pro","google/gemini-2.0-flash-001","anthropic/claude-sonnet-4","anthropic/claude-3.5-sonnet","anthropic/claude-3.5-haiku","openai/gpt-4o","openai/gpt-4o-mini","openai/gpt-4-turbo","openai/o1","openai/o1-mini","meta-llama/llama-3.3-70b-instruct","deepseek/deepseek-chat-v3-0324","mistralai/mistral-large","qwen/qwen-2.5-72b-instruct"];function Ps(){try{const e=localStorage.getItem(Cs);if(!e)return null;const t=JSON.parse(e);return Date.now()-t.timestamp>Li?null:t}catch{return null}}function Bi(e){try{const t={models:e,timestamp:Date.now()};localStorage.setItem(Cs,JSON.stringify(t))}catch{}}async function Di(){const e=Ps();if(e&&e.models.length>0)return e.models;try{if(typeof GM_xmlhttpRequest!="function")return cr;const t=await new Promise((r,n)=>{GM_xmlhttpRequest({method:"GET",url:"https://openrouter.ai/api/v1/models",headers:{"Content-Type":"application/json"},timeout:1e4,onload:s=>{try{const o=s?.responseText?JSON.parse(s.responseText):null;r(o)}catch{n(new Error("Failed to parse models response"))}},onerror:()=>n(new Error("Network error")),ontimeout:()=>n(new Error("Request timed out"))})});if(t?.data&&Array.isArray(t.data)){const r=t.data.map(n=>n.id).filter(n=>n&&!n.includes(":free")&&!n.includes(":extended")).sort((n,s)=>{const o=["google/","anthropic/","openai/","meta-llama/","deepseek/","mistralai/"],l=o.findIndex(c=>n.startsWith(c)),i=o.findIndex(c=>s.startsWith(c));return l!==-1&&i===-1?-1:i!==-1&&l===-1?1:l!==-1&&i!==-1?l-i:n.localeCompare(s)});if(r.length>0)return Bi(r),r}return cr}catch{return cr}}function Fi(){return Ps()?.models||cr}const Rs="rsdh_svelte_ui_state";function jr(){try{const e=localStorage.getItem(Rs);if(!e)return{tab:"context",hidden:!1};const t=JSON.parse(e),r=String(t?.tab||"context");return{tab:r==="settings"?"settings":r==="results"?"results":r==="debug"?"debug":"context",hidden:!!t?.hidden}}catch{return{tab:"context",hidden:!1}}}function Wr(e){const r={...jr(),...e};try{localStorage.setItem(Rs,JSON.stringify(r))}catch{}try{window.dispatchEvent(new CustomEvent("rsdh-ui-state",{detail:r}))}catch{}}var $i=G('<button style="background: rgba(245, 158, 11, 0.15); border-color: rgba(245, 158, 11, 0.3);"> Debug</button>'),qi=G('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),Yi=G("<div><!></div>"),Ui=G(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">No Data Captured</h3> <p class="empty-description">Open a draft modal on the site, then use the Capture button to collect
          player and contest data.</p> <div class="empty-hint"> Look for "Draft" or "Update" buttons</div></div>`),Hi=G('<div class="loading-container"><div class="spinner"></div> <div class="loading-text"> </div></div>'),Gi=G("<div><!></div>"),zi=G(`<div class="empty-state"><div class="empty-icon"></div> <h3 class="empty-title">No AI Results Yet</h3> <p class="empty-description">Capture a draft modal first, then use "Ask AI" from the modal to get
          lineup recommendations.</p> <div class="empty-hint"> AI will analyze your roster and suggest optimal picks</div></div>`),Ki=G('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(34,197,94,0.08); border-radius: 6px; border-left: 2px solid rgba(34,197,94,0.4);"> Linked as <strong> </strong> <!></div> <button class="secondary" style="font-size: 11px;">Unlink Account</button>',1),ji=G('<div class="sub" style="margin-top: 8px; color: rgba(245,158,11,0.9);"> </div>'),Wi=G('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(245,158,11,0.08); border-radius: 6px; border-left: 2px solid rgba(245,158,11,0.4);">Link your RealSports account to enable usage tracking.</div> <button> Link Account</button> <!>',1),Ji=G('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(34,197,94,0.08); border-radius: 6px; border-left: 2px solid rgba(34,197,94,0.4);"> Using hosted proxy  no API key needed.</div>'),Vi=G('<div class="sub" style="margin-bottom:12px; padding: 8px 10px; background: rgba(255,200,0,0.08); border-radius: 6px; border-left: 2px solid rgba(255,200,0,0.4);">Your API key is stored locally and never shared.</div> <label class="sub" for="or-key">API Key</label> <input id="or-key" style="width:100%; margin-bottom:8px;" type="password" placeholder="sk-or-..."/>',1),Xi=G("<option> </option>"),Zi=G('<div style="margin-top: 10px;"><label class="sub" for="or-key-debug">API Key</label> <input id="or-key-debug" style="width:100%;" type="password" placeholder="sk-or-..."/></div>'),Qi=G('<div class="card" style="background: rgba(255,255,255,0.04);"><label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer;"><input type="checkbox"/> <span><strong>Bypass Proxy (dev)</strong><br/><span class="sub">Use your own OpenRouter API key instead of the hosted proxy.</span></span></label> <!></div>'),el=G(`<div><div class="card" style="border-left: 3px solid rgba(245, 158, 11, 0.6);"><div class="h"> Developer Tools</div> <div class="sub">Raw data, prompts, and debugging utilities.</div></div> <div class="card" style="background: rgba(255,255,255,0.04);"><label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer;"><input type="checkbox"/> <span><strong>Force Tool Call (test)</strong><br/><span class="sub">Makes AI call <code>get_player_profile_stats</code> once to verify
              tool tracing.</span></span></label></div> <!> <details class="details" style="margin-top:10px;" open><summary> Raw Payload</summary> <textarea placeholder="Raw JSON / text..."></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details> <details class="details" style="margin-top:8px;"><summary> Chat Prompt (for Copy Prompt button)</summary> <textarea readonly="" placeholder="Capture a draft modal to see the prompt here."></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details> <details class="details" style="margin-top:8px;"><summary> Structured Prompt (sent to Ask AI)</summary> <textarea readonly="" placeholder="Capture a draft modal and use Ask AI to see the prompt here."></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details> <details class="details" style="margin-top:8px;"><summary> Web Sources (Ask AI + Web)</summary> <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 4px;">URLs referenced by the AI when using web search:</div> <textarea readonly=""></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details> <details class="details" style="margin-top:8px;"><summary> Tool Calls & Scraped Data</summary> <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 4px;">Shows tool calls made during Ask AI, including scraped profile data:</div> <textarea readonly=""></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details> <details class="details" style="margin-top:8px;"><summary> AI Response JSON</summary> <textarea readonly="" placeholder="No AI response yet."></textarea> <button class="secondary" style="margin-top:6px; width:auto; padding:6px 12px; font-size:11px;"> Copy</button></details></div>`),tl=G('<div class="panel"><div class="header"><div class="title"><span style="margin-right: 6px;"></span> Draft Helper</div> <button class="secondary"><span style="font-size: 14px;"></span></button></div> <div class="tabs"><button>Context</button> <button>Results</button> <button>Settings</button> <!></div> <div><!></div> <div><!></div> <div><div class="card" style="background: linear-gradient(135deg, var(--rsdh-accent-subtle) 0%, transparent 100%);"><label style="display:flex; align-items:center; gap:10px; font-size:12px; color: rgba(255,255,255,0.90); user-select:none; cursor:pointer;"><input type="checkbox"/> <span><strong>Debug Mode</strong><br/><span class="sub">Show Debug tab with raw data and developer tools</span></span></label></div> <div class="card"><div class="h"><span style="opacity: 0.6; margin-right: 6px;"></span>Account</div> <!></div> <div class="card"><div class="h"><span style="opacity: 0.6; margin-right: 6px;"></span>OpenRouter API</div> <!> <label class="sub" for="or-model">Model</label> <input id="or-model" style="width:100%; margin-bottom:8px;" type="text" list="model-list" placeholder="Start typing to search..."/> <datalist id="model-list"></datalist> <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 12px;"><div><label class="sub" for="or-temp"> </label> <input id="or-temp" style="width:100%;" type="range" min="0" max="2" step="0.1"/></div> <div><label class="sub" for="or-max">Max tokens</label> <input id="or-max" style="width:100%;" type="text"/></div></div> <div style="margin-top:10px;"><label class="sub" for="or-web"> </label> <input id="or-web" style="width:100%;" type="range" min="1" max="5" step="1"/></div> <div style="display:flex; gap:8px; margin-top:14px;"><button style="display:flex; align-items:center; justify-content:center; gap:6px;"><span></span> Save Settings</button></div></div></div> <!></div>');function rl(e,t){dn(t,!1);let r=L("context"),n="Tip: open a Draft modal, then click Capture.",s=L(""),o="",l=L(""),i=L(!1),c=L(""),a=L(""),u=L(""),d=L(""),f=L(""),p=L(""),h="",S=L(""),y=L(!1),O=L(""),C=L(et),ne=L(or),Y=L(String(ar)),z=L($t),pe=!0,U=!0,K=L(!1),ie=L(!1),se=L(null),Ue=L("");function Jr(){if(!ms()){v(Ue,"Navigate to realsports.io to link your profile"),$r("Navigate to the RealSports homepage first");return}const g=Za();g?(Va(g),v(se,g),v(Ue,""),Yt(`Linked as @${g.username}`)):(v(Ue,"Could not find profile. Make sure you're logged in."),nt("Profile not found"))}function ur(){Xa(),v(se,null),$r("Account unlinked")}let st=L(Fi());function we(g){g==="debug"&&!m(y)&&(g="context"),v(r,g),Wr({tab:g})}ua(()=>{const g=jr();v(y,rt()),v(r,g.tab==="debug"&&!m(y)?"context":g.tab),o=ja(),v(s,o),He(),v(O,String(M(Rr,"")||"")),v(C,String(M(Ir,et)||et)),v(ne,parseFloat(String(M(Mr,or)))||or),v(Y,String(M(Or,ar))),v(z,parseInt(String(M(Nr,$t)),10)||$t),pe=String(M(nr,!0))==="1"||M(nr,!0)===!0,U=String(M(sr,!0))==="1"||M(sr,!0)===!0,v(K,String(M(qt,"0"))==="1"||M(qt,"0")===!0),v(ie,String(M(tt,"0"))==="1"||M(tt,"0")===!0),v(se,hs()),Di().then(R=>{v(st,R)});const _=R=>{};document.addEventListener("click",_,!0);const A=R=>{const I=R.detail;if(I?.raw){try{const V=JSON.parse(I.raw);if(V?.ok===!0){v(s,I.raw),o=I.raw;try{v(u,Wa(I.raw))}catch{v(u,"")}try{v(d,Ja(I.raw))}catch{v(d,"")}He(),v(r,"context");return}if(V&&Array.isArray(V.lineup)&&Array.isArray(V.bets)){v(a,I.raw);try{const ge=JSON.parse(localStorage.getItem(Lr)||"[]");v(f,Array.isArray(ge)?ge.join(`
`):String(ge))}catch{v(f,"")}try{v(p,String(localStorage.getItem(is)||""))}catch{v(p,"")}try{h=String(localStorage.getItem(lr)||"")}catch{h=""}v(S,ks(V,m(f)?m(f).split(`
`):[])),v(r,"results");return}}catch{}v(s,I.raw),He(),v(r,"context")}},F=R=>{const I=R.detail;I?.text&&(n=I.text)},Q=()=>{try{h=String(localStorage.getItem(lr)||"")}catch{h=""}};return window.addEventListener("rsdh-output",A),window.addEventListener("rsdh-status",F),window.addEventListener("rsdh-debug-events",Q),()=>{document.removeEventListener("click",_,!0),window.removeEventListener("rsdh-output",A),window.removeEventListener("rsdh-status",F),window.removeEventListener("rsdh-debug-events",Q)}});function He(){const g=(m(s)||"").trim();if(!g){v(l,'<div class="card"><div class="h">Output</div><div class="sub">Capture a draft modal or run Ask AI.</div></div>');return}try{const _=JSON.parse(g);if(_&&_.ok===!0){v(l,Si(_));return}if(_&&Array.isArray(_.lineup)&&Array.isArray(_.bets)){let A=[];try{A=JSON.parse(localStorage.getItem(Lr)||"[]")||[]}catch{}v(l,ks(_,A));return}}catch{}v(l,`<div class="card"><div class="h">Output</div><pre class="code-output">${g.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</pre></div>`)}function me(g){try{GM_setClipboard(g),n="Copied to clipboard.",Yt("Copied to clipboard!")}catch(_){const A=`Copy failed: ${String(_?.message||_)}`;n=A,nt(A)}}function Ut(){const g=parseInt(m(Y),10);if(isNaN(g)||g<1){v(Y,"1"),nt("Max tokens must be at least 1");return}m(O).trim()&&m(O).trim()!=="********"&&Re(Rr,m(O).trim()),Re(Ir,(m(C)||et).trim()),Re(Mr,String(m(ne))),Re(Or,String(g)),Re(Nr,String(m(z))),Re(nr,pe?"1":"0"),Re(sr,U?"1":"0"),Re(qt,m(K)?"1":"0"),Re(tt,m(ie)?"1":"0"),Oa(m(y)),!m(y)&&m(r)==="debug"&&we("context"),Yt("Settings saved!")}Sa();var Ge=tl(),_t=w(Ge),Vr=b(w(_t),2),yt=b(_t,2),Ht=w(yt),x=b(Ht,2),Gt=b(x,2),B=b(Gt,2);{var il=g=>{var _=$i();_e(()=>$e(_,1,`tab secondary ${m(r)==="debug"?"active":""}`)),Z("click",_,()=>we("debug")),$(g,_)};fe(B,g=>{m(y)&&g(il)})}var Xr=b(yt,2),ll=w(Xr);{var cl=g=>{var _=qi(),A=b(w(_),2),F=w(A);_e(()=>De(F,m(c))),$(g,_)},ul=g=>{var _=Zn(),A=Pt(_);{var F=R=>{var I=Yi(),V=w(I);es(V,()=>m(l)),$(R,I)},Q=R=>{var I=Ui();$(R,I)};fe(A,R=>{m(l)?R(F):R(Q,!1)},!0)}$(g,_)};fe(ll,g=>{m(i)?g(cl):g(ul,!1)})}var Zr=b(Xr,2),dl=w(Zr);{var fl=g=>{var _=Hi(),A=b(w(_),2),F=w(A);_e(()=>De(F,m(c))),$(g,_)},pl=g=>{var _=Zn(),A=Pt(_);{var F=R=>{var I=Gi(),V=w(I);es(V,()=>m(S)),$(R,I)},Q=R=>{var I=zi();$(R,I)};fe(A,R=>{m(S)?R(F):R(Q,!1)},!0)}$(g,_)};fe(dl,g=>{m(i)?g(fl):g(pl,!1)})}var Qr=b(Zr,2),Ms=w(Qr),hl=w(Ms),ml=w(hl),Os=b(Ms,2),gl=b(w(Os),2);{var vl=g=>{var _=Ki(),A=Pt(_),F=b(w(A)),Q=w(F),R=b(F,2);{var I=ge=>{var dr=na();_e(()=>De(dr,`(${m(se).displayName??""})`)),$(ge,dr)};fe(R,ge=>{m(se).displayName&&m(se).displayName!==m(se).username&&ge(I)})}var V=b(A,2);_e(()=>De(Q,`@${m(se).username??""}`)),Z("click",V,ur),$(g,_)},bl=g=>{var _=Wi(),A=b(Pt(_),2),F=b(A,2);{var Q=R=>{var I=ji(),V=w(I);_e(()=>De(V,m(Ue))),$(R,I)};fe(F,R=>{m(Ue)&&R(Q)})}Z("click",A,Jr),$(g,_)};fe(gl,g=>{m(se)?g(vl):g(bl,!1)})}var _l=b(Os,2),Ns=b(w(_l),2);{var yl=g=>{var _=Ji();$(g,_)},xl=g=>{var _=Vi(),A=b(Pt(_),4);Qe(A,()=>m(O),F=>v(O,F)),$(g,_)};fe(Ns,g=>{ir?g(yl):g(xl,!1)})}var Ls=b(Ns,4),Bs=b(Ls,2);ha(Bs,5,()=>m(st),fa,(g,_)=>{var A=Xi(),F=w(A),Q={};_e(()=>{De(F,m(_)),Q!==(Q=m(_))&&(A.value=(A.__value=m(_))??"")}),$(g,A)});var Ds=b(Bs,2),Fs=w(Ds),$s=w(Fs),wl=w($s),Sl=b($s,2),kl=b(Fs,2),El=b(w(kl),2),qs=b(Ds,2),Ys=w(qs),Al=w(Ys),Tl=b(Ys,2),Cl=b(qs,2),Pl=w(Cl),Rl=b(Qr,2);{var Il=g=>{var _=el(),A=b(w(_),2),F=w(A),Q=w(F),R=b(A,2);{var I=ot=>{var Xs=Qi(),Zs=w(Xs),Fl=w(Zs),$l=b(Zs,2);{var ql=zt=>{var Qs=Zi(),Yl=b(w(Qs),2);Qe(Yl,()=>m(O),Ul=>v(O,Ul)),$(zt,Qs)};fe($l,zt=>{m(ie)&&zt(ql)})}Tr(Fl,()=>m(ie),zt=>v(ie,zt)),$(ot,Xs)};fe(R,ot=>{ir&&ot(I)})}var V=b(R,2),ge=b(w(V),2),dr=b(ge,2),Us=b(V,2),Hs=b(w(Us),2),Ml=b(Hs,2),Gs=b(Us,2),zs=b(w(Gs),2),Ol=b(zs,2),Ks=b(Gs,2),js=b(w(Ks),4),Nl=b(js,2),Ws=b(Ks,2),Js=b(w(Ws),4),Ll=b(Js,2),Bl=b(Ws,2),Vs=b(w(Bl),2),Dl=b(Vs,2);_e(()=>{$e(_,1,`view ${m(r)==="debug"?"":"hidden"}`),Ft(Hs,m(u)),Ft(zs,m(d)),Ft(js,m(f)||"(No web sources - use Ask AI + Web to see sources)"),Ft(Js,m(p)||"(No tool calls yet - Ask AI may call tools to scrape player profiles)"),Ft(Vs,m(a))}),Tr(Q,()=>m(K),ot=>v(K,ot)),Qe(ge,()=>m(s),ot=>v(s,ot)),Z("input",ge,He),Z("click",dr,()=>me(m(s))),Z("click",Ml,()=>me(m(u))),Z("click",Ol,()=>me(m(d))),Z("click",Nl,()=>me(m(f))),Z("click",Ll,()=>me(m(p))),Z("click",Dl,()=>me(m(a))),$(g,_)};fe(Rl,g=>{m(y)&&g(Il)})}_e(()=>{_a(yt,`grid-template-columns: ${m(y)?"1fr 1fr 1fr 1fr":"1fr 1fr 1fr"};`),$e(Ht,1,`tab secondary ${m(r)==="context"?"active":""}`),$e(x,1,`tab secondary ${m(r)==="results"?"active":""}`),$e(Gt,1,`tab secondary ${m(r)==="settings"?"active":""}`),$e(Xr,1,`view ${m(r)==="context"?"":"hidden"}`),$e(Zr,1,`view ${m(r)==="results"?"":"hidden"}`),$e(Qr,1,`view ${m(r)==="settings"?"":"hidden"}`),De(wl,`Temperature: ${m(ne)??""}`),De(Al,`Web results (Ask AI + Web): ${m(z)??""}`)}),Z("click",Vr,()=>Wr({hidden:!0})),Z("click",Ht,()=>we("context")),Z("click",x,()=>we("results")),Z("click",Gt,()=>we("settings")),Tr(ml,()=>m(y),g=>v(y,g)),Qe(Ls,()=>m(C),g=>v(C,g)),Qe(Sl,()=>m(ne),g=>v(ne,g)),Qe(El,()=>m(Y),g=>v(Y,g)),Qe(Tl,()=>m(z),g=>v(z,g)),Z("click",Pl,Ut),$(e,Ge),fn()}function nl(){const e="rsdh-svelte-root";let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,document.documentElement.appendChild(t)),t}function sl(e){const t="rsdh-svelte-handle";let r=e.getElementById(t);return r||(r=document.createElement("button"),r.id=t,r.className="fab",r.type="button",r.title="Open Draft Helper",r.setAttribute("aria-label","Open Draft Helper"),r.innerHTML=`
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 2l1.2 4.3L17.5 8l-4.3 1.2L12 13.5l-1.2-4.3L6.5 8l4.3-1.7L12 2Z" fill="currentColor" opacity="0.95"/>
        <path d="M19 11l.8 2.8L22.6 15l-2.8.8L19 18.6l-.8-2.8L15.4 15l2.8-1.2L19 11Z" fill="currentColor" opacity="0.85"/>
      </svg>
    `,r.addEventListener("click",()=>Wr({hidden:!1})),e.appendChild(r)),r}function Is(e,t,r){e.style.display=r?"none":"",t.style.display=r?"":"none"}function ol(e){const t=()=>{const r=ei();r&&e.style.setProperty("--rsdh-accent",r)};t();try{setInterval(t,5e3)}catch{}}function al(){const e=nl(),t=e.shadowRoot??e.attachShadow({mode:"open"}),r="rsdh-style";if(!t.getElementById(r)){const i=document.createElement("style");i.id=r,i.textContent=eo,t.appendChild(i)}const n=sl(t),s="app";let o=t.getElementById(s);o||(o=document.createElement("div"),o.id=s,t.appendChild(o)),aa(rl,{target:o});const l=jr();Is(o,n,!!l.hidden),window.addEventListener("rsdh-ui-state",i=>{const c=i.detail;c&&typeof c.hidden=="boolean"&&Is(o,n,c.hidden)}),ol(e)}al(),Ni()})();
